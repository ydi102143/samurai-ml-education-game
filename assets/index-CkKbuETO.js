const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./privateEvaluationScheduler-DICi3J8x.js","./vendor-B1sUnLqs.js","./ui-BXNMeVkq.js"])))=>i.map(i=>d[i]);
import{r as Ps,a as mg,b as _w,g as ar}from"./vendor-B1sUnLqs.js";import{r as v,S as jw,T as tn,R as Sw,B as wo,G as Di,M as hc,D as _o,a as Ei,L as En,E as ju,b as Xt,A as fc,c as ks,d as jo,C as So,e as pg,f as Nw,g as Mh,X as Pw,h as kw,i as Kr,P as mc,j as Zt,U as Mw,k as Wt,l as gg,m as Ci,n as Ow,o as Aw,p as vg,q as Ew,s as Oh,t as Cw,u as Tw,I as yg,v as Ah,w as Iw,x as Dw,y as Eh,F as Ch,z as $w,Z as Rw,H as Lw,J as Bw}from"./ui-BXNMeVkq.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var No={exports:{}},sa={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Th;function Uw(){if(Th)return sa;Th=1;var t=Ps(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(o,l,d){var u,h={},f=null,m=null;d!==void 0&&(f=""+d),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(m=l.ref);for(u in l)n.call(l,u)&&!i.hasOwnProperty(u)&&(h[u]=l[u]);if(o&&o.defaultProps)for(u in l=o.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:e,type:o,key:f,ref:m,props:h,_owner:a.current}}return sa.Fragment=r,sa.jsx=s,sa.jsxs=s,sa}var Ih;function Fw(){return Ih||(Ih=1,No.exports=Uw()),No.exports}var c=Fw(),si={},Dh;function zw(){if(Dh)return si;Dh=1;var t=mg();return si.createRoot=t.createRoot,si.hydrateRoot=t.hydrateRoot,si}var qw=zw();const Ww=[{id:"kyoto",name:"京都",daimyo:"足利将軍家",description:"商業の中心地として栄え、多くの茶器が取引される中で贋作を見抜く目が求められている。",problem_type:"classification",problem_description:"茶器の情報から真贋を判定するAIを構築する。",required_accuracy:.8,unlock_condition:null,difficulty:1,reward_xp:100,order_index:1,dataset_info:{features:["年代","職人技","材質","古色"],classes:["贋作","本物"],samples:300},created_at:new Date().toISOString()},{id:"sakai",name:"堺",daimyo:"商人自治",description:"南蛮貿易で栄える国際港湾都市。世界中から届く品物の産地を正確に識別する必要がある。",problem_type:"classification",problem_description:"貿易品の特徴から産地を分類する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:2,dataset_info:{features:["材質","装飾","職人技","価格"],classes:["中国","南蛮","朝鮮","日本"],samples:300},created_at:new Date().toISOString()},{id:"kai",name:"甲斐",daimyo:"武田信玄",description:"豊富な金山を有する武田領。鉱山の産出量を予測し、効率的な資源管理を実現する。",problem_type:"regression",problem_description:"気象条件と労働力から金山の月間産出量を予測する。",required_accuracy:.7,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:3,dataset_info:{features:["労働者数","経験値","気温","降水量","機具の質","鉱石の品質"],samples:300},created_at:new Date().toISOString()},{id:"echigo",name:"越後",daimyo:"上杉謙信",description:"豊かな穀倉地帯として知られる越後。気象データから米の収穫量を予測し、領民を飢饉から守る。",problem_type:"regression",problem_description:"気象条件と土壌データから米の収穫量を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:4,dataset_info:{features:["気温","降水量","日照時間","土壌の質","種子の質","肥料の量"],samples:300},created_at:new Date().toISOString()},{id:"owari",name:"尾張",daimyo:"織田信長",description:"兵農分離を進める織田領。兵士の適性を科学的に分析し、最適な配置を実現する。",problem_type:"classification",problem_description:"兵士の能力データから最適な役職を判定する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:5,dataset_info:{features:["年齢","筋力","敏捷性","知力","戦闘経験","社会階級"],classes:["槍兵","弓兵","鉄砲隊","騎馬隊"],samples:300},created_at:new Date().toISOString()},{id:"satsuma",name:"薩摩",daimyo:"島津義弘",description:"鉄砲生産で名高い薩摩。火縄銃の品質検査を自動化し、不良品を検出する。",problem_type:"classification",problem_description:"鉄砲の製造データから品質を判定する。",required_accuracy:.85,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:6,dataset_info:{features:["鉄の品質","鋼の品質","鍛造技術","組み立て精度","検査の厳密さ","製造温度"],classes:["不良品","良品"],samples:300},created_at:new Date().toISOString()},{id:"hizen",name:"肥前",daimyo:"鍋島直茂",description:"有田焼など陶磁器で名高い肥前。焼成条件から等級を見極める。",problem_type:"classification",problem_description:"陶器の製造データから等級（上・中・下）を分類する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:180,order_index:7,dataset_info:{features:["粘土の品質","釉薬の品質","焼成温度","陶工の技能","装飾の美しさ","厚さの均一性"],classes:["下級","中級","上級"],samples:300},created_at:new Date().toISOString()},{id:"sagami",name:"相模",daimyo:"北条氏康",description:"小田原を擁する北条領。政治・経済指標から地域の繁栄度を判断する。",problem_type:"classification",problem_description:"地域指標から繁栄レベル（低・中・高）を分類する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:8,dataset_info:{features:["人口","商業の発達度","農業の発達度","統治の質","政治安定性","立地の良さ"],classes:["低い","中程度","高い"],samples:300},created_at:new Date().toISOString()},{id:"dewa",name:"出羽",daimyo:"最上義光",description:"山形の険しい地形での物流網最適化。条件から輸送効率を予測する。",problem_type:"regression",problem_description:"距離や標高、天候などから輸送効率を予測する。",required_accuracy:.7,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:9,dataset_info:{features:["距離","標高","天候の良さ","道路の質","荷物の価値","季節"],samples:300},created_at:new Date().toISOString()},{id:"morioka",name:"盛岡",daimyo:"南部信直",description:"南部藩の中心地。馬の品種改良データから最適な繁殖条件を予測する。",problem_type:"regression",problem_description:"馬の血統と環境条件から繁殖成功率を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:10,dataset_info:{features:["血統スコア","年齢","健康状態","飼育環境","季節","交配回数"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"sendai",name:"仙台",daimyo:"伊達政宗",description:"東北最大の藩。米の収穫量を気象データから予測し、年貢を最適化する。",problem_type:"regression",problem_description:"気象条件から米の収穫量を予測する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:11,dataset_info:{features:["気温","降水量","日照時間","土壌水分","肥料量","植え付け時期"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"kanazawa",name:"金沢",daimyo:"前田利家",description:"加賀百万石。金箔の品質を製造条件から判定し、最高級品を選別する。",problem_type:"classification",problem_description:"金箔の製造データから品質等級を分類する。",required_accuracy:.85,unlock_condition:"kai",difficulty:4,reward_xp:250,order_index:12,dataset_info:{features:["金の純度","温度","湿度","圧延回数","職人経験","作業時間"],classes:["下級","中級","上級","最高級"],samples:300},created_at:new Date().toISOString()},{id:"takamatsu",name:"高松",daimyo:"生駒親正",description:"四国の要衝。海運の安全を天候と海流データから予測する。",problem_type:"classification",problem_description:"天候と海流から航海の安全性を判定する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:180,order_index:13,dataset_info:{features:["風速","波高","海流速度","雲量","気圧","潮汐"],classes:["危険","注意","安全"],samples:300},created_at:new Date().toISOString()},{id:"kumamoto",name:"熊本",daimyo:"加藤清正",description:"肥後熊本藩。城の石垣の強度を材料と工法から予測する。",problem_type:"regression",problem_description:"石の材質と積み方から石垣の強度を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:14,dataset_info:{features:["石の硬さ","石の大きさ","積み方","モルタル量","角度","基礎の深さ"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"yamaguchi",name:"長門",daimyo:"毛利元就",description:"中国地方の雄。水軍の戦術データから最適な戦略を予測する。",problem_type:"classification",problem_description:"海戦の条件から勝利確率を予測する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:15,dataset_info:{features:["風速","波高","船数","兵数","距離","時間"],classes:["敗北","引き分け","勝利"],samples:300},created_at:new Date().toISOString()},{id:"kaga",name:"加賀",daimyo:"一向一揆",description:"一向宗の自治領。信者の分布データから布教戦略を最適化する。",problem_type:"regression",problem_description:"地域の特性から信者獲得数を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:16,dataset_info:{features:["人口密度","経済状況","教育レベル","既存宗教","交通便","季節"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"tosa",name:"土佐",daimyo:"長宗我部元親",description:"四国の統一者。領土拡大の戦略をデータから最適化する。",problem_type:"classification",problem_description:"戦略条件から成功確率を予測する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:180,order_index:17,dataset_info:{features:["兵力","装備","地形","天候","敵兵力","補給"],classes:["失敗","部分成功","完全成功"],samples:300},created_at:new Date().toISOString()},{id:"modern_stock_prediction",name:"株価予測",daimyo:"現代金融",description:"現代の金融市場で株価の変動を予測し、投資戦略を最適化する。",problem_type:"regression",problem_description:"企業の財務データから株価変化率を予測する。",required_accuracy:.7,unlock_condition:null,difficulty:5,reward_xp:500,order_index:30,dataset_info:{features:["始値","出来高","時価総額","PER","負債比率","売上成長率","利益率"],samples:1e3},created_at:new Date().toISOString()},{id:"modern_sentiment_analysis",name:"感情分析",daimyo:"テキスト解析",description:"SNSやレビューのテキストから感情を分析し、顧客満足度を向上させる。",problem_type:"classification",problem_description:"テキストの特徴から感情を分類する。",required_accuracy:.8,unlock_condition:null,difficulty:4,reward_xp:400,order_index:31,dataset_info:{features:["単語数","ポジティブ単語比率","ネガティブ単語比率","ニュートラル単語比率","感嘆符比率","疑問符比率","大文字比率"],classes:["ネガティブ","ニュートラル","ポジティブ"],samples:2e3},created_at:new Date().toISOString()},{id:"modern_image_classification",name:"画像分類",daimyo:"コンピュータビジョン",description:"画像の特徴量から物体を分類し、自動認識システムを構築する。",problem_type:"classification",problem_description:"画像の特徴量から物体を分類する。",required_accuracy:.85,unlock_condition:null,difficulty:5,reward_xp:500,order_index:32,dataset_info:{features:["明度","コントラスト","色彩豊かさ","エッジ密度","テクスチャ複雑さ","対称性","アスペクト比"],classes:["猫","犬","車","飛行機","建物","花","食べ物","人物"],samples:1500},created_at:new Date().toISOString()},{id:"modern_recommendation",name:"推薦システム",daimyo:"ECサイト",description:"ユーザーの行動データから購入確率を予測し、パーソナライズされた推薦を行う。",problem_type:"regression",problem_description:"ユーザーとアイテムの特徴から購入確率を予測する。",required_accuracy:.75,unlock_condition:null,difficulty:4,reward_xp:400,order_index:33,dataset_info:{features:["ユーザー年齢","ユーザー収入","ユーザー活動度","アイテム価格","アイテム評価","アイテムカテゴリ","アイテム人気度"],samples:3e3},created_at:new Date().toISOString()},{id:"modern_fraud_detection",name:"不正検出",daimyo:"セキュリティ",description:"取引データから不正な行為を検出し、金融システムの安全性を守る。",problem_type:"classification",problem_description:"取引の特徴から不正を検出する（不均衡データ）。",required_accuracy:.95,unlock_condition:null,difficulty:5,reward_xp:600,order_index:34,dataset_info:{features:["取引金額","時間","曜日","地域","店舗タイプ","ユーザー履歴","デバイスタイプ"],classes:["正常","不正"],samples:5e3},created_at:new Date().toISOString()}],Pa=(t,e)=>`samurai_${e}_${t}`;async function bg(){return Ww}async function Kw(t){const e={id:`user_${Date.now()}`,shogun_name:t,level:1,total_xp:0,title:"足軽",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return localStorage.setItem(Pa(e.id,"profile"),JSON.stringify(e)),e}async function pc(t){const e=localStorage.getItem(Pa(t,"progress"));return e?JSON.parse(e):[]}async function Su(t,e,r){const n=await pc(t),a=n.findIndex(i=>i.region_id===e);a>=0?n[a]={...n[a],...r}:n.push({id:`progress_${e}`,user_id:t,region_id:e,is_unlocked:!1,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString(),...r}),localStorage.setItem(Pa(t,"progress"),JSON.stringify(n))}async function Vw(t,e){await Su(t,e,{is_unlocked:!0})}async function Hw(){return[{id:"logistic_regression",name:"Logistic Regression",name_ja:"ロジスティック回帰",description:"線形分類器で、シンプルで理解しやすいモデルです。",category:"classification",unlock_level:1,icon:"TrendingUp",parameters_schema:{learning_rate:{type:"number",min:.001,max:.1,default:.01},max_iterations:{type:"number",min:10,max:1e3,default:100}},created_at:new Date().toISOString()},{id:"linear_regression",name:"Linear Regression",name_ja:"線形回帰",description:"連続値を予測する基本的な回帰モデルです。",category:"regression",unlock_level:1,icon:"BarChart",parameters_schema:{learning_rate:{type:"number",min:.001,max:.1,default:.01},max_iterations:{type:"number",min:10,max:1e3,default:100}},created_at:new Date().toISOString()},{id:"neural_network",name:"Neural Network",name_ja:"ニューラルネットワーク",description:"複雑なパターンを学習できる高度なモデルです。",category:"classification",unlock_level:2,icon:"Brain",parameters_schema:{hidden_layers:{type:"number",min:1,max:5,default:2},neurons_per_layer:{type:"number",min:4,max:128,default:16},learning_rate:{type:"number",min:.001,max:.1,default:.01},epochs:{type:"number",min:10,max:500,default:100}},created_at:new Date().toISOString()}]}async function Gw(t){const e=localStorage.getItem(Pa(t.user_id,"attempts")),r=e?JSON.parse(e):[],n={id:`attempt_${Date.now()}`,...t,created_at:new Date().toISOString()};r.push(n),localStorage.setItem(Pa(t.user_id,"attempts"),JSON.stringify(r))}async function Yw(t){const e=await bg();for(const r of e)await Su(t,r.id,{is_unlocked:!0,is_completed:!1,best_accuracy:0,stars:0,attempts:0})}new Date().toISOString(),new Date().toISOString(),new Date().toISOString();new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString();new Date().toISOString(),new Date().toISOString();new Date().toISOString();const xg=v.createContext(null);function Jw({children:t}){const[e,r]=v.useState(null),[n,a]=v.useState([]),[i,s]=v.useState({}),[o,l]=v.useState([]),[d,u]=v.useState(!0),[h,f]=v.useState(null),[m,g]=v.useState("home"),[p,y]=v.useState(null),b=async _=>{try{f(null);const S=await Kw(_);r(S),await Yw(S.id),await x()}catch(S){console.error("Failed to initialize user:",S),f("ユーザーの初期化に失敗しました。もう一度お試しください。")}},x=async()=>{if(e)try{f(null);const _=await pc(e.id),S={};for(const j of n){const N=_.find(O=>O.region_id===j.id),M=w(j,S,n);N?S[j.id]={...N,is_unlocked:M}:S[j.id]={id:`progress_${j.id}`,user_id:e.id,region_id:j.id,is_unlocked:M,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString()}}s(S)}catch(_){console.error("Failed to refresh progress:",_),f("進捗データの取得に失敗しました。")}},w=(_,S,j)=>{if(!_.unlock_condition||S[_.unlock_condition]?.is_completed)return!0;const M=_.difficulty-1;return!!(M>0&&j.filter(P=>P.difficulty===M).every(P=>S[P.id]?.is_completed||!1))};return v.useEffect(()=>{(async()=>{try{console.log("useGameState: データ読み込み開始"),u(!0),f(null),console.log("useGameState: getRegions()を呼び出し");const S=await bg();console.log("useGameState: getRegions()完了:",S?.length),console.log("useGameState: getMLModels()を呼び出し");const j=await Hw();if(console.log("useGameState: getMLModels()完了:",j?.length),!S||S.length===0)throw console.error("useGameState: 地域データが空です"),new Error("No regions data available");if(!j||j.length===0)throw console.error("useGameState: モデルデータが空です"),new Error("No models data available");a(S),l(j);const N=JSON.parse(localStorage.getItem("samurai_current_user")||"null");if(N){const M={id:N.id,shogun_name:N.username,title:N.title||"足軽",level:N.level||1,total_xp:N.experience||0,created_at:N.createdAt||new Date().toISOString(),updated_at:new Date().toISOString()};r(M);const O=await pc(M.id),C={};for(const P of S){const k=O.find(I=>I.region_id===P.id),D=w(P,C,S);k?C[P.id]={...k,is_unlocked:D}:C[P.id]={id:`progress_${P.id}`,user_id:M.id,region_id:P.id,is_unlocked:D,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString()}}s(C)}else{const M={id:"mock_user",shogun_name:"テスト将軍",level:1,total_xp:0,title:"足軽",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};r(M);const O={};for(const C of S){const P=w(C,O,S);O[C.id]={id:`progress_${C.id}`,user_id:M.id,region_id:C.id,is_unlocked:P,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString()}}s(O)}}catch(S){console.error("useGameState: データ読み込みエラー:",S),S instanceof Error?S.message==="Timeout"?f("データの読み込みに時間がかかりすぎています。ネットワーク接続を確認してください。"):S.message.includes("No regions")||S.message.includes("No models")?f("データベースが空です。管理者に連絡してください。"):f(`データの読み込みに失敗しました: ${S.message}`):f(`予期しないエラーが発生しました: ${String(S)}`)}finally{console.log("useGameState: データ読み込み完了、loading=false"),u(!1)}})()},[]),v.useEffect(()=>{e&&localStorage.setItem("samurai_user_id",e.id)},[e]),c.jsx(xg.Provider,{value:{user:e,regions:n,progress:i,models:o,loading:d,error:h,currentView:m,selectedRegion:p,setCurrentView:g,setSelectedRegion:y,initializeUser:b,refreshProgress:x},children:t})}function Ms(){const t=v.useContext(xg);if(!t)throw new Error("useGameState must be used within GameProvider");return t}function Xw({onComplete:t,durationScale:e=1.3}){const[r,n]=v.useState(0),[a,i]=v.useState(!1),[s,o]=v.useState(!1),[l,d]=v.useState(!1),[u,h]=v.useState(!1),[f,m]=v.useState(!1),g=v.useMemo(()=>["Data is the sword of the 21st century,","those who wield it well, the Samurai."],[]),p=v.useMemo(()=>["データは21世紀の刀、","それを使いこなす者こそ、侍。"],[]),[y,b]=v.useState(["",""]),[x,w]=v.useState(["",""]),[_,S]=v.useState(!1),[j,N]=v.useState(!1);v.useEffect(()=>{if(typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches){t();return}const C=[],P=(D,I)=>{const W=window.setTimeout(D,I);C.push(W)},k=[200].map(D=>Math.round(D*e));return P(()=>i(!0),k[0]),P(()=>n(1),k[0]),()=>{C.forEach(D=>clearTimeout(D))}},[e,t]),v.useEffect(()=>{if(r!==1)return;let O=0,C=0,P=0;const k=setInterval(()=>{P===0?O<=g[0].length?(b(D=>[g[0].slice(0,O),D[1]]),w(D=>[p[0].slice(0,Math.min(C,p[0].length)),D[1]]),O++,C=Math.floor(O*.3)):(P=1,O=0,C=0):P===1&&(O<=g[1].length?(b(D=>[D[0],g[1].slice(0,O)]),w(D=>[D[0],p[1].slice(0,Math.min(Math.floor(O*.43),p[1].length))]),O++):(clearInterval(k),N(!0),setTimeout(()=>S(!0),1e3)))},Math.max(40,70*e));return()=>clearInterval(k)},[r,e,g,p]),v.useEffect(()=>{j&&console.log("タイプライタ完了。ユーザーのクリックを待機中...")},[j,t]),v.useEffect(()=>{r===2&&(console.log("タイトル表示画面に到達。フェードインを開始します..."),setTimeout(()=>{console.log("フェードインを開始します"),console.log("titleFadeIn状態:",l),h(!0),setTimeout(()=>{d(!0),console.log("setTitleFadeIn(true)を実行しました"),setTimeout(()=>{console.log("タイトル表示完了。ホーム画面に自動遷移します..."),t()},7e3)},100)},500))},[r,t]),v.useEffect(()=>{if(r===2){console.log("タイトル表示画面に到達しました。ユーザーインタラクション後なので確実に音声を再生します...");const O=()=>{try{const C=new Audio("./audio/拍子木3.mp3");C.volume=.8,C.preload="auto",console.log("🎵 音声ファイルを読み込み中...");const P=C.play();P!==void 0&&P.then(()=>{console.log("🎵 拍子木の音が再生されました！"),m(!0)}).catch(k=>{console.log("音声再生に失敗しました:",k)})}catch(C){console.log("音声の初期化に失敗しました:",C)}};setTimeout(()=>{console.log("🎵 タイトル表示画面で音声を再生します..."),O()},200)}},[r]),v.useEffect(()=>{const O=C=>{C.key==="Escape"&&t()};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[t]);const M=()=>{if(console.log("スキップボタンがクリックされました"),s){console.log("既にスキップ処理中です");return}o(!0),console.log("スキップ処理を開始します");try{const O=new Audio("./audio/拍子木3.mp3");O.volume=.8,O.preload="auto",console.log("🎵 スキップ時に音声を再生します...");const C=O.play();C!==void 0&&C.then(()=>{console.log("🎵 スキップ時に拍子木の音が再生されました！"),m(!0)}).catch(P=>{console.warn("スキップ時の音声再生に失敗:",P)})}catch(O){console.warn("スキップ時の音声初期化に失敗:",O)}setTimeout(()=>{console.log("イントロを完了します"),t()},100)};return c.jsx("div",{className:"h-screen",style:{background:"#404040"},children:c.jsxs("div",{className:"w-full h-full flex items-center justify-center p-4 relative overflow-hidden",children:[c.jsx("button",{onClick:M,className:"absolute top-4 right-4 text-sm px-3 py-1 rounded-lg transition-colors",style:{color:"white",background:"rgba(255,255,255,0.2)",border:"1px solid var(--gold)"},"aria-label":"イントロをスキップ（音声再生）",children:r===2&&!f?"🎵 音声付きでスキップ":"スキップ"}),c.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`
            radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 70%, rgba(255,255,255,0.05) 0%, transparent 50%),
            radial-gradient(circle at 40% 80%, rgba(255,255,255,0.08) 0%, transparent 50%),
            repeating-linear-gradient(
              0deg,
              transparent 0px,
              rgba(255,255,255,0.02) 1px,
              transparent 2px,
              rgba(0,0,0,0.02) 3px,
              transparent 4px
            )
          `,animation:"noise 0.2s steps(8) infinite"}}),c.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((O,C)=>c.jsx("div",{className:"absolute w-0.5 h-0.5 rounded-full animate-pulse",style:{background:"var(--gold)",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*4}s`,opacity:.8}},C))}),c.jsxs("div",{className:`text-center z-10 transition-all duration-1000 ${a?"opacity-100":"opacity-0"}`,children:[r===1&&c.jsxs("div",{className:"fixed inset-0 w-full h-full flex items-center justify-center",style:{background:"#404040"},children:[c.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`
                  repeating-linear-gradient(
                    0deg,
                    transparent 0px,
                    rgba(0,0,0,0.3) 0.5px,
                    transparent 1px,
                    rgba(0,0,0,0.4) 1.5px,
                    transparent 2px,
                    rgba(0,0,0,0.2) 2.5px,
                    transparent 3px,
                    rgba(0,0,0,0.5) 3.5px,
                    transparent 4px,
                    rgba(0,0,0,0.1) 4.5px,
                    transparent 5px
                  ),
                  repeating-linear-gradient(
                    90deg,
                    transparent 0px,
                    rgba(0,0,0,0.25) 0.3px,
                    transparent 0.8px,
                    rgba(0,0,0,0.35) 1.3px,
                    transparent 1.8px,
                    rgba(0,0,0,0.15) 2.3px,
                    transparent 2.8px,
                    rgba(0,0,0,0.45) 3.3px,
                    transparent 3.8px
                  ),
                  repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    rgba(0,0,0,0.2) 0.2px,
                    transparent 0.6px,
                    rgba(0,0,0,0.3) 1.1px,
                    transparent 1.6px,
                    rgba(0,0,0,0.1) 2.1px,
                    transparent 2.6px
                  ),
                  repeating-linear-gradient(
                    135deg,
                    transparent 0px,
                    rgba(0,0,0,0.18) 0.1px,
                    transparent 0.5px,
                    rgba(0,0,0,0.28) 1px,
                    transparent 1.5px,
                    rgba(0,0,0,0.08) 2px,
                    transparent 2.5px
                  )
                `,animation:"tvNoise 0.005s steps(1) infinite"}}),c.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`
                  radial-gradient(circle at 5% 10%, rgba(0,0,0,0.4) 0%, transparent 0.2px),
                  radial-gradient(circle at 15% 25%, rgba(0,0,0,0.5) 0%, transparent 0.1px),
                  radial-gradient(circle at 25% 40%, rgba(0,0,0,0.3) 0%, transparent 0.3px),
                  radial-gradient(circle at 35% 55%, rgba(0,0,0,0.6) 0%, transparent 0.15px),
                  radial-gradient(circle at 45% 70%, rgba(0,0,0,0.35) 0%, transparent 0.4px),
                  radial-gradient(circle at 55% 15%, rgba(0,0,0,0.7) 0%, transparent 0.08px),
                  radial-gradient(circle at 65% 30%, rgba(0,0,0,0.25) 0%, transparent 0.6px),
                  radial-gradient(circle at 75% 45%, rgba(0,0,0,0.55) 0%, transparent 0.2px),
                  radial-gradient(circle at 85% 60%, rgba(0,0,0,0.45) 0%, transparent 0.35px),
                  radial-gradient(circle at 95% 75%, rgba(0,0,0,0.65) 0%, transparent 0.12px)
                `,animation:"tvNoise 0.003s steps(1) infinite"}}),c.jsxs("div",{className:"space-y-8 w-full px-4 relative z-10",style:{maxWidth:"90vw"},children:[c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-3xl font-bold leading-relaxed",style:{color:"#ffffff",textShadow:"0 0 5px #ffffff, 0 0 10px #ffffff, 0 0 15px #ffffff, 0 0 20px #ffffff",fontFamily:"monospace",textAlign:"center",fontWeight:"bold"},children:y[0]}),c.jsx("div",{className:"text-lg font-medium leading-relaxed",style:{color:"#cccccc",textShadow:"0 0 3px #cccccc, 0 0 6px #cccccc, 0 0 9px #cccccc",fontFamily:"monospace",textAlign:"center",whiteSpace:"nowrap"},children:x[0]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-3xl font-bold leading-relaxed",style:{color:"#ffffff",textShadow:"0 0 5px #ffffff, 0 0 10px #ffffff, 0 0 15px #ffffff, 0 0 20px #ffffff",fontFamily:"monospace",textAlign:"center",fontWeight:"bold"},children:y[1]}),c.jsx("div",{className:"text-lg font-medium leading-relaxed",style:{color:"#cccccc",textShadow:"0 0 3px #cccccc, 0 0 6px #cccccc, 0 0 9px #cccccc",fontFamily:"monospace",textAlign:"center",whiteSpace:"nowrap"},children:x[1]})]})]}),_&&c.jsxs("div",{className:`transition-all duration-3000 mt-6 ${_?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[c.jsx("p",{className:"text-xl font-light text-center",style:{color:"#999999",textShadow:"0 0 3px #999999, 0 0 6px #999999",fontFamily:"monospace"},children:"— Jonathan Rosenberg"}),c.jsx("div",{className:"mt-8",children:c.jsx("button",{onClick:()=>{console.log("ユーザーがクリックしました。タイトル画面に遷移します..."),n(2),h(!0),setTimeout(()=>{d(!0),console.log("setTitleFadeIn(true)を実行しました")},100)},className:"px-6 py-3 rounded-lg transition-all duration-300 hover:scale-105",style:{background:"linear-gradient(135deg, var(--accent-strong) 0%, var(--accent) 100%)",color:"white",border:"2px solid var(--gold)",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",fontFamily:"monospace",fontSize:"16px",fontWeight:"bold"},children:"開始"})})]})]})]}),r===2&&c.jsxs("div",{className:"fixed inset-0 w-full h-full flex items-center justify-center",style:{background:"linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%)"},children:[c.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[...Array(40)].map((O,C)=>{const P=Math.random()*7+4,k=Math.random()*120-10,D=Math.random()*30-30,I=6,W=Math.random()*3,V=Math.random()*360,K=Math.random()*.2+.2;return c.jsx("div",{className:"absolute",style:{left:`${k}%`,top:`${D}%`,width:`${P}px`,height:`${P}px`,background:"radial-gradient(circle at 30% 30%, #ffb3d1, #ff69b4, #ff1493)",borderRadius:"50% 10% 50% 10%",transform:`rotate(${V}deg)`,animation:`sakura6Sec ${I}s linear forwards`,animationDelay:`${W}s`,opacity:K,boxShadow:"0 0 8px rgba(255, 105, 180, 0.3)",filter:"blur(0.5px)"}},C)})}),c.jsxs("div",{className:"space-y-8",style:{opacity:u&&l?1:0,transform:u&&l?"translateY(0) scale(1)":"translateY(12px) scale(0.95)",transition:u?"opacity 6s ease-out 0s, transform 6s ease-out 0s":"none",willChange:"opacity, transform"},children:[c.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-8",children:[c.jsx(jw,{className:"w-16 h-16",style:{color:"#D4AF37",filter:"drop-shadow(0 0 8px rgba(212, 175, 55, 0.6))",transition:u?"opacity 6s ease-out 0s, transform 6s ease-out 0s":"none",opacity:u&&l?1:0,transform:u&&l?"scale(1) rotate(0deg)":"scale(0.8) rotate(-5deg)",willChange:"opacity, transform"}}),c.jsx("h1",{className:"text-6xl font-bold text-white tracking-wider",style:{textShadow:"0 0 20px rgba(255,255,255,0.8)",transition:u?"opacity 6s ease-out 0s, transform 6s ease-out 0s":"none",opacity:u&&l?1:0,transform:u&&l?"translateY(0) scale(1)":"translateY(20px) scale(0.9)",willChange:"opacity, transform"},children:"samurAI"})]}),c.jsx("p",{className:"text-2xl text-white/90 font-light tracking-wide",style:{textShadow:"0 0 10px rgba(255,255,255,0.6)",transition:u?"opacity 6s ease-out 0.5s, transform 6s ease-out 0.5s":"none",opacity:u&&l?1:0,transform:u&&l?"translateY(0) scale(1)":"translateY(15px) scale(0.95)",willChange:"opacity, transform"},children:"機械学習で天下統一"})]})]})]})]})})}class Zw{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=e.map(u=>u.features),l=e.map(u=>u.label);if(!o[0]||!Array.isArray(o[0]))throw new Error("特徴量が配列ではありません");const d=o[0].length;this.weights=new Array(d).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=0,console.log(`ロジスティック回帰学習開始: ${e.length}サンプル, ${d}特徴量, ${i}エポック`);for(let u=0;u<i;u++){let h=0,f=0;for(let m=0;m<o.length;m++){const g=this.sigmoid(this.dotProduct(o[m],this.weights)+this.bias),p=l[m]-g;if(isFinite(p)&&isFinite(g)){for(let y=0;y<this.weights.length;y++)this.weights[y]+=s*p*o[m][y];this.bias+=s*p,h+=p*p,f++}}if(n){const m=f>0?h/f:0,g=this.calculateAccuracy(o,l),p=(u+1)/i*100,y=Date.now()-a;n({epoch:u+1,total:i,message:`ロジスティック回帰 - エポック ${u+1}/${i} (${p.toFixed(1)}%)`,loss:isFinite(m)?m:0,accuracy:isFinite(g)?g:0,progress:Math.round(p),elapsed:y,eta:Math.round(y/(u+1)*(i-u-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`ロジスティック回帰学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.sigmoid(this.dotProduct(e,this.weights)+this.bias)}evaluate(e){const r=e.map(d=>d.features),n=e.map(d=>d.label),a=r.map(d=>this.predict(d)),i=this.calculateAccuracyFromPredictions(a,n),{precision:s,recall:o,f1_score:l}=this.calculateMetrics(a,n);return{accuracy:i,training_time:this.trainingTime,precision:s,recall:o,f1_score:l,predictions:a,actual:n}}dotProduct(e,r){return e.reduce((n,a,i)=>n+a*r[i],0)}sigmoid(e){return 1/(1+Math.exp(-e))}calculateAccuracy(e,r){if(e.length===0)return 0;let n=0;for(let a=0;a<e.length;a++)(this.sigmoid(this.dotProduct(e[a],this.weights)+this.bias)>.5?1:0)===r[a]&&n++;return n/e.length}calculateAccuracyFromPredictions(e,r){let n=0;for(let a=0;a<e.length;a++)(e[a]>.5?1:0)===r[a]&&n++;return n/e.length}calculateMetrics(e,r){let n=0,a=0,i=0;for(let d=0;d<e.length;d++){const u=e[d]>.5?1:0;u===1&&r[d]===1&&n++,u===1&&r[d]===0&&a++,u===0&&r[d]===1&&i++}const s=n/(n+a)||0,o=n/(n+i)||0,l=2*(s*o)/(s+o)||0;return{precision:s,recall:o,f1_score:l}}}class Qw{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=e.map(u=>u.features),l=e.map(u=>u.label);if(!o[0]||!Array.isArray(o[0]))throw new Error("特徴量が配列ではありません");const d=o[0].length;this.weights=new Array(d).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=0,console.log(`線形回帰学習開始: ${e.length}サンプル, ${d}特徴量, ${i}エポック`);for(let u=0;u<i;u++){let h=0,f=0;for(let m=0;m<o.length;m++){const g=this.dotProduct(o[m],this.weights)+this.bias,p=l[m]-g;if(isFinite(p)&&isFinite(g)){for(let y=0;y<this.weights.length;y++)this.weights[y]+=s*p*o[m][y];this.bias+=s*p,h+=p*p,f++}}if(n){const m=f>0?h/f:0,g=this.calculateR2(o,l),p=(u+1)/i*100,y=Date.now()-a;n({epoch:u+1,total:i,message:`線形回帰 - エポック ${u+1}/${i} (${p.toFixed(1)}%)`,loss:isFinite(m)?m:0,accuracy:isFinite(g)?g:0,progress:Math.round(p),elapsed:y,eta:Math.round(y/(u+1)*(i-u-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`線形回帰学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.dotProduct(e,this.weights)+this.bias}evaluate(e){const r=e.map(o=>o.features),n=e.map(o=>o.label),a=r.map(o=>this.predict(o)),i=this.calculateR2(r,n),s=this.calculateMAE(a,n);return{accuracy:Math.max(0,i),training_time:this.trainingTime,precision:1-s,recall:1-s,f1_score:1-s,predictions:a,actual:n}}dotProduct(e,r){return e.reduce((n,a,i)=>n+a*r[i],0)}calculateR2(e,r){if(e.length===0)return 0;const n=e.map(l=>this.dotProduct(l,this.weights)+this.bias),a=r.reduce((l,d)=>l+d,0)/r.length,i=n.reduce((l,d,u)=>l+Math.pow(r[u]-d,2),0),s=r.reduce((l,d)=>l+Math.pow(d-a,2),0);if(s===0)return 1;const o=1-i/s;return Math.max(0,Math.min(1,o))}calculateMAE(e,r){return e.reduce((n,a,i)=>n+Math.abs(a-r[i]),0)/e.length}}class e1{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=e.map(u=>u.features),l=e.map(u=>u.label);if(!o[0]||!Array.isArray(o[0]))throw new Error("特徴量が配列ではありません");const d=o[0].length;this.weights=new Array(d).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=(Math.random()-.5)*.1,console.log(`ニューラルネットワーク学習開始: ${e.length}サンプル, ${d}特徴量, ${i}エポック`);for(let u=0;u<i;u++){let h=0;for(let f=0;f<o.length;f++){const m=this.forward(o[f]),g=l[f]-m;for(let p=0;p<this.weights.length;p++)this.weights[p]+=s*g*o[f][p];this.bias+=s*g,h+=g*g}if(n){const f=(u+1)/i*100,m=Date.now()-a;n({epoch:u+1,total:i,message:`ニューラルネットワーク - エポック ${u+1}/${i} (${f.toFixed(1)}%)`,loss:h/o.length,accuracy:this.calculateAccuracy(o,l),progress:Math.round(f),elapsed:m,eta:Math.round(m/(u+1)*(i-u-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`ニューラルネットワーク学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.forward(e)}evaluate(e){const r=e.map(d=>d.features),n=e.map(d=>d.label),a=r.map(d=>this.predict(d)),i=this.calculateAccuracyFromPredictions(a,n),{precision:s,recall:o,f1_score:l}=this.calculateMetrics(a,n);return{accuracy:i,training_time:this.trainingTime,precision:s,recall:o,f1_score:l,predictions:a,actual:n}}forward(e){let r=0;for(let n=0;n<e.length;n++)r+=e[n]*this.weights[n];return this.sigmoid(r+this.bias)}sigmoid(e){return 1/(1+Math.exp(-e))}calculateAccuracy(e,r){let n=0;for(let a=0;a<e.length;a++)(this.forward(e[a])>.5?1:0)===r[a]&&n++;return n/e.length}calculateAccuracyFromPredictions(e,r){let n=0;for(let a=0;a<e.length;a++)(e[a]>.5?1:0)===r[a]&&n++;return n/e.length}calculateMetrics(e,r){let n=0,a=0,i=0;for(let d=0;d<e.length;d++){const u=e[d]>.5?1:0;u===1&&r[d]===1&&n++,u===1&&r[d]===0&&a++,u===0&&r[d]===1&&i++}const s=n/(n+a)||0,o=n/(n+i)||0,l=2*(s*o)/(s+o)||0;return{precision:s,recall:o,f1_score:l}}}class t1{trainingData=[];k=3;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now();this.k=r.k||3,this.trainingData=e.map(i=>({features:i.features,label:i.label})),this.isTrained=!0,this.trainingTime=Date.now()-a,console.log(`KNN学習完了: ${e.length}サンプル, k=${this.k}, ${this.trainingTime}ms`),n&&n({epoch:1,total:1,message:`KNN学習完了 - ${e.length}サンプル, k=${this.k}`,loss:0,accuracy:1,progress:100,elapsed:this.trainingTime,eta:0})}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");const r=this.trainingData.map(o=>({distance:this.euclideanDistance(e,o.features),label:o.label}));r.sort((o,l)=>o.distance-l.distance);const n=r.slice(0,this.k);if(typeof n[0].label=="number")return n.reduce((l,d)=>l+d.label,0)/n.length;const a={};n.forEach(o=>{const l=String(o.label);a[l]=(a[l]||0)+1});let i=0,s=n[0].label;for(const[o,l]of Object.entries(a))l>i&&(i=l,s=Number(o));return s}evaluate(e){const r=e.map(s=>s.features),n=e.map(s=>s.label),a=r.map(s=>this.predict(s)),i=this.calculateAccuracy(a,n);return{accuracy:i,training_time:this.trainingTime,precision:i,recall:i,f1_score:i,predictions:a,actual:n}}euclideanDistance(e,r){if(e.length!==r.length)throw new Error("特徴量の次元が一致しません");let n=0;for(let a=0;a<e.length;a++)n+=Math.pow(e[a]-r[a],2);return Math.sqrt(n)}calculateAccuracy(e,r){if(e.length===0)return 0;let n=0;for(let a=0;a<e.length;a++)Math.abs(e[a]-r[a])<.1&&n++;return n/e.length}}class r1{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=r.C||1,l=e.map(h=>h.features),d=e.map(h=>h.label);if(!l[0]||!Array.isArray(l[0]))throw new Error("特徴量が配列ではありません");const u=l[0].length;this.weights=new Array(u).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=0,console.log(`SVM学習開始: ${e.length}サンプル, ${u}特徴量, ${i}エポック, C=${o}`);for(let h=0;h<i;h++){let f=0,m=0;for(let g=0;g<l.length;g++){const p=this.dotProduct(l[g],this.weights)+this.bias,y=d[g]===0?-1:1,b=Math.max(0,1-y*p);if(b>0){for(let x=0;x<this.weights.length;x++)this.weights[x]+=s*(y*l[g][x]-o*this.weights[x]);this.bias+=s*y}else for(let x=0;x<this.weights.length;x++)this.weights[x]-=s*o*this.weights[x];f+=b,m++}if(n){const g=m>0?f/m:0,p=this.calculateAccuracy(l,d),y=(h+1)/i*100,b=Date.now()-a;n({epoch:h+1,total:i,message:`SVM - エポック ${h+1}/${i} (${y.toFixed(1)}%)`,loss:isFinite(g)?g:0,accuracy:isFinite(p)?p:0,progress:Math.round(y),elapsed:b,eta:Math.round(b/(h+1)*(i-h-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`SVM学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.dotProduct(e,this.weights)+this.bias>0?1:0}evaluate(e){const r=e.map(d=>d.features),n=e.map(d=>d.label),a=r.map(d=>this.predict(d)),i=this.calculateAccuracyFromPredictions(a,n),{precision:s,recall:o,f1_score:l}=this.calculateMetrics(a,n);return{accuracy:i,training_time:this.trainingTime,precision:s,recall:o,f1_score:l,predictions:a,actual:n}}dotProduct(e,r){return e.reduce((n,a,i)=>n+a*r[i],0)}calculateAccuracy(e,r){if(e.length===0)return 0;let n=0;for(let a=0;a<e.length;a++)(this.dotProduct(e[a],this.weights)+this.bias>0?1:0)===r[a]&&n++;return n/e.length}calculateAccuracyFromPredictions(e,r){let n=0;for(let a=0;a<e.length;a++)e[a]===r[a]&&n++;return n/e.length}calculateMetrics(e,r){let n=0,a=0,i=0;for(let d=0;d<e.length;d++)e[d]===1&&r[d]===1&&n++,e[d]===1&&r[d]===0&&a++,e[d]===0&&r[d]===1&&i++;const s=n/(n+a)||0,o=n/(n+i)||0,l=2*(s*o)/(s+o)||0;return{precision:s,recall:o,f1_score:l}}}function $i(t){switch(t){case"logistic_regression":return new Zw;case"linear_regression":return new Qw;case"neural_network":return new e1;case"knn":return new t1;case"svm":return new r1;default:throw new Error(`未知のモデルタイプ: ${t}`)}}class $h{static async trainModel(e,r,n){const a=Date.now();try{console.log("動的学習システム開始:",{datasetSize:e.train.length,modelType:r.modelType,selectedFeatures:r.selectedFeatures,parameters:r.parameters});const{train:i,validation:s,test:o}=this.splitData(e,r.dataSplit);console.log("データ分割完了:",{trainSize:i.length,validationSize:s.length,testSize:o.length});const l=i.map(g=>({features:r.selectedFeatures.map(p=>g.features[p]),label:g.label})),d=o.map(g=>({features:r.selectedFeatures.map(p=>g.features[p]),label:g.label}));console.log("モデル作成中:",r.modelType);const u=$i(r.modelType);console.log("モデル作成完了:",u.constructor.name),console.log("学習開始:",{trainDataSize:l.length,parameters:r.parameters}),await u.train(l,r.parameters,n),console.log("学習完了"),console.log("評価開始:",{testDataSize:d.length});const h=u.evaluate(d);console.log("評価結果:",{accuracy:h.accuracy,loss:h.loss,precision:h.precision,recall:h.recall,f1_score:h.f1_score});const f=Date.now()-a,m={validationScore:h.accuracy,testScore:h.accuracy,metrics:this.buildMetrics(h,r.evaluationMetrics),predictions:h.predictions,actual:h.actual,trainingTime:f/1e3,config:r};return{model:u,result:h,trainingTime:f,evaluation:m,config:r}}catch(i){throw console.error("動的学習エラー:",{error:i,message:i instanceof Error?i.message:"Unknown error",stack:i instanceof Error?i.stack:void 0,config:r}),i}}static splitData(e,r){const{trainRatio:n,validationRatio:a,testRatio:i,randomSeed:s,stratified:o}=r,l=Math.random;s!==void 0&&(Math.random=()=>{const p=Math.sin(s)*1e4;return p-Math.floor(p)});const u=[...[...e.train,...e.test]].sort(()=>Math.random()-.5);if(o&&e.classes&&e.classes.length>0){const p=this.stratifiedSplit(u,n,a,i);return Math.random=l,p}const h=u.length,f=Math.floor(h*n),m=Math.floor(h*a),g={train:u.slice(0,f),validation:u.slice(f,f+m),test:u.slice(f+m)};return Math.random=l,g}static stratifiedSplit(e,r,n,a){const i={};e.forEach(d=>{const u=d.label.toString();i[u]||(i[u]=[]),i[u].push(d)});const s=[],o=[],l=[];return Object.values(i).forEach(d=>{const u=d.length,h=Math.floor(u*r),f=Math.floor(u*n),m=[...d].sort(()=>Math.random()-.5);s.push(...m.slice(0,h)),o.push(...m.slice(h,h+f)),l.push(...m.slice(h+f))}),{train:s,validation:o,test:l}}static buildMetrics(e,r){const n={};return r.forEach(a=>{switch(a){case"accuracy":n.accuracy=e.accuracy;break;case"precision":n.precision=e.precision;break;case"recall":n.recall=e.recall;break;case"f1_score":n.f1_score=e.f1_score;break;case"mae":n.mae=e.accuracy;break;case"mse":n.mse=e.accuracy;break;case"rmse":n.rmse=e.accuracy;break}}),n}static async batchTrain(e,r,n){const a=[];for(let i=0;i<r.length;i++)try{const s=await this.trainModel(e,r[i]);a.push(s),n&&n({current:i+1,total:r.length,result:s})}catch(s){console.error(`設定${i+1}の学習に失敗:`,s)}return a}static generateLearningConfigs(e,r,n,a,i){const s=[];return e.forEach(o=>{r.forEach(l=>{(n[o]||[{}]).forEach(u=>{i.forEach(h=>{s.push({modelType:o,parameters:u,selectedFeatures:l,evaluationMetrics:a,dataSplit:h})})})})}),s}}class Mn{static instance;currentUser=null;static getInstance(){return Mn.instance||(Mn.instance=new Mn),Mn.instance}getCurrentUser(){return this.currentUser}setUser(e){this.currentUser=e,this.saveUserToStorage()}loginUser(e,r){const n=this.loadUserFromStorage();if(n&&n.username===e)return this.currentUser=n,this.updateLastActive(),n;const a={id:this.generateUserId(),username:e,email:r,avatar:this.generateAvatar(e),createdAt:new Date().toISOString(),lastActiveAt:new Date().toISOString(),totalBattles:0,wins:0,losses:0,winRate:0,bestScore:0,currentStreak:0};return this.currentUser=a,this.saveUserToStorage(),a}logoutUser(){this.currentUser=null,localStorage.removeItem("currentUser")}updateBattleResult(e,r){if(!this.currentUser)return;const n=this.currentUser;n.totalBattles++,e?(n.wins++,n.currentStreak++):(n.losses++,n.currentStreak=0),n.winRate=n.totalBattles>0?n.wins/n.totalBattles:0,r>n.bestScore&&(n.bestScore=r),this.updateUser(n)}generateUserId(){const e=Date.now().toString(36),r=Math.random().toString(36).substr(2,5);return`user_${e}_${r}`}generateAvatar(e){const r=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8"],n=e.charCodeAt(0)%r.length;return r[n]}updateUser(e){this.currentUser=e,this.saveUserToStorage()}updateLastActive(){this.currentUser&&(this.currentUser.lastActiveAt=new Date().toISOString(),this.saveUserToStorage())}saveUserToStorage(){this.currentUser&&localStorage.setItem("currentUser",JSON.stringify(this.currentUser))}loadUserFromStorage(){try{const e=localStorage.getItem("currentUser");return e?JSON.parse(e):null}catch(e){return console.error("ユーザーデータの読み込みに失敗:",e),null}}getLevelInfo(){return{level:1,experience:0,nextLevelExp:0,progress:0}}}const Ct=Mn.getInstance();class Rh{static getRecommendedModel(e){return e<3?"logistic_regression":e<5?"linear_regression":"neural_network"}static getRecommendedFeatures(e,r){const n=Math.min(3+r,e.featureNames.length),a=[],s=this.calculateFeatureImportance(e).map((o,l)=>({index:l,importance:o})).sort((o,l)=>l.importance-o.importance);for(let o=0;o<n&&o<s.length;o++)a.push(s[o].index);return a}static calculateFeatureImportance(e){const r=[];for(let n=0;n<e.featureNames.length;n++){const a=e.train.map(o=>o.features[n]),i=this.calculateVariance(a),s=this.calculateCorrelation(a,e.train.map(o=>o.label));r.push(i*Math.abs(s))}return r}static calculateVariance(e){const r=e.reduce((a,i)=>a+i,0)/e.length;return e.reduce((a,i)=>a+Math.pow(i-r,2),0)/e.length}static calculateCorrelation(e,r){if(e.length!==r.length)return 0;const n=r.map(f=>typeof f=="string"?f.charCodeAt(0):f),a=e.length,i=e.reduce((f,m)=>f+m,0),s=n.reduce((f,m)=>f+m,0),o=e.reduce((f,m,g)=>f+m*n[g],0),l=e.reduce((f,m)=>f+m*m,0),d=n.reduce((f,m)=>f+m*m,0),u=a*o-i*s,h=Math.sqrt((a*l-i*i)*(a*d-s*s));return h===0?0:u/h}static analyzeUserStrengths(e){const r=[],n=[];return e.winRate>.8?r.push("high_accuracy"):e.winRate<.5&&n.push("low_accuracy"),e.averageTrainingTime<30?r.push("fast_learning"):e.averageTrainingTime>120&&n.push("slow_learning"),e.preferredModel==="neural_network"?r.push("advanced_models"):e.preferredModel==="logistic_regression"&&n.push("basic_models"),{strengths:r,weaknesses:n}}static adjustProblemDifficulty(e,r){return r>.9?this.increaseDifficulty(e):r<.6?this.decreaseDifficulty(e):e}static increaseDifficulty(e){const r=["modern_fraud_detection","modern_image_classification"];return r[Math.floor(Math.random()*r.length)]}static decreaseDifficulty(e){const r=["modern_stock_prediction","modern_sentiment_analysis"];return r[Math.floor(Math.random()*r.length)]}static getRecommendedParameters(e,r){const a={...{logistic_regression:{learning_rate:.01,max_iterations:100,regularization:.1},linear_regression:{learning_rate:.001,max_iterations:200,regularization:.01},neural_network:{learning_rate:.001,max_iterations:300,hidden_layers:2,neurons_per_layer:64}}[e]};return r>5&&(a.learning_rate*=.5,a.max_iterations*=1.5),a}static getLearningTips(e,r){const a={data:["データの分布を確認して、異常値がないかチェックしましょう","特徴量間の相関を確認して、重複する情報がないか見てみましょう"],preprocessing:["数値データは正規化して、スケールを統一しましょう","カテゴリデータは適切にエンコーディングしましょう"],features:["重要度の高い特徴量を優先的に選択しましょう","特徴量が多すぎると過学習の原因になります"],model:["シンプルなモデルから始めて、徐々に複雑にしていきましょう","パラメータはデフォルト値から始めて調整しましょう"],train:["学習曲線を確認して、過学習していないかチェックしましょう","バリデーション精度が向上しない場合は、学習を停止しましょう"]}[e]||[];return r>3&&a.push("高度なテクニック: アンサンブル学習を試してみましょう"),a}}const n1="modulepreload",a1=function(t,e){return new URL(t,e).href},Lh={},Wn=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){let d=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");a=d(r.map(u=>{if(u=a1(u,n),u in Lh)return;Lh[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(n)for(let g=s.length-1;g>=0;g--){const p=s[g];if(p.href===u&&(!h||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":n1,h||(m.as="script"),m.crossOrigin="",m.href=u,l&&m.setAttribute("nonce",l),document.head.appendChild(m),h)return new Promise((g,p)=>{m.addEventListener("load",g),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};class i1{static createCompetitionDataset(e,r,n,a,i){const s=this.shuffleArray([...e]),o=Math.floor(s.length*.7),l=Math.floor(s.length*.15),d=s.slice(0,o),u=s.slice(o,o+l),h=s.slice(o+l);return{data:s,train:d,validation:u,test:h,featureNames:r,labelName:n,classes:i,problemType:a,description:`${a}問題 - ${r.length}個の特徴量`,defaultMetric:a==="classification"?"accuracy":"mae",metric:a==="classification"?"accuracy":"mae"}}static shuffleArray(e){const r=[...e];for(let n=r.length-1;n>0;n--){const a=Math.floor(Math.random()*(n+1));[r[n],r[a]]=[r[a],r[n]]}return r}static selectFeatures(e,r){return{...e,train:e.train.map(n=>({...n,features:r.map(a=>n.features[a])})),validation:e.validation.map(n=>({...n,features:r.map(a=>n.features[a])})),test:e.test.map(n=>({...n,features:r.map(a=>n.features[a])})),featureNames:r.map(n=>e.featureNames[n])}}static preprocessDataset(e,r,n){return r==="none"?e:r==="normalize"?this.normalizeDataset(e):r==="standardize"?this.standardizeDataset(e):r==="encode"&&n?this.encodeDataset(e,n):e}static normalizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(1/0),a=Array(r).fill(-1/0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]=Math.min(n[l],o),a[l]=Math.max(a[l],o)})});const i=s=>({...s,features:s.features.map((o,l)=>{const d=a[l]-n[l];return!isFinite(d)||d===0?0:(o-n[l])/d})});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static standardizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(0),a=Array(r).fill(0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]+=o})}),n.forEach((s,o)=>{n[o]=s/e.train.length}),e.train.forEach(s=>{s.features.forEach((o,l)=>{a[l]+=Math.pow(o-n[l],2)})}),a.forEach((s,o)=>{a[o]=Math.sqrt(s/e.train.length)});const i=s=>({...s,features:s.features.map((o,l)=>a[l]===0?0:(o-n[l])/a[l])});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static encodeDataset(e,r){const n={};e.train.forEach(i=>{r.forEach(s=>{n[s]||(n[s]=new Map);const o=String(i.features[s]);n[s].has(o)||n[s].set(o,n[s].size)})});const a=i=>({...i,features:i.features.map((s,o)=>{if(r.includes(o)){const l=String(s);return n[o].get(l)??0}return s})});return{...e,train:e.train.map(a),validation:e.validation.map(a),test:e.test.map(a)}}static getPlayerDataset(e){return{train:e.train,test:e.validation,featureNames:e.featureNames,labelName:e.labelName,classes:e.classes}}static getOfficialDataset(e){return{train:e.train,test:e.test,featureNames:e.featureNames,labelName:e.labelName,classes:e.classes}}}class Be{static problems=new Map;static async createProblem(e,r,n,a,i,s,o,l){const d=a.map((m,g)=>({id:`point_${g}`,features:m.features||m.slice(0,-1),label:m.label||m[m.length-1]})),u=i1.createCompetitionDataset(d,i,s,o,l),h={id:e,title:r,description:n,dataset:u,metric:o==="classification"?"accuracy":"mae",constraints:{maxFeatures:Math.min(i.length,20),maxTrainingTime:300,maxSubmissions:10,allowedModels:["logistic_regression","linear_regression","neural_network","knn"]},startTime:new Date,endTime:new Date(Date.now()+10080*60*1e3),participantCount:0,submissionCount:0};this.problems.set(e,h);const{PrivateEvaluationScheduler:f}=await Wn(async()=>{const{PrivateEvaluationScheduler:m}=await import("./privateEvaluationScheduler-DICi3J8x.js");return{PrivateEvaluationScheduler:m}},__vite__mapDeps([0,1,2]),import.meta.url);return f.scheduleForNewProblem(e),h}static getProblem(e){return this.problems.get(e)}static getAllProblems(){return Array.from(this.problems.values())}static getActiveProblems(){const e=new Date;return Array.from(this.problems.values()).filter(r=>r.startTime<=e&&r.endTime>=e)}static updateParticipantCount(e,r){const n=this.problems.get(e);n&&(n.participantCount=r)}static isProblemActive(e){const r=this.problems.get(e);if(!r)return!1;const n=new Date;return r.startTime<=n&&r.endTime>=n}static updateSubmissionCount(e,r){const n=this.problems.get(e);n&&(n.submissionCount=r)}static getRemainingTime(e){const r=this.problems.get(e);if(!r)return 0;const n=new Date,a=r.endTime.getTime()-n.getTime();return Math.max(0,Math.floor(a/1e3))}static getProblemProgress(e){const r=this.problems.get(e);if(!r)return 0;const n=new Date,a=r.endTime.getTime()-r.startTime.getTime(),i=n.getTime()-r.startTime.getTime();return Math.min(1,Math.max(0,i/a))}static async createDefaultProblems(){console.log("CompetitionProblemManager: オンライン対戦用問題を作成中...");const e=this.generateStockMarketData(5e3);console.log("株式市場データ生成完了:",e.length,"件"),await this.createProblem("stock_market_prediction","AI株価予測チャレンジ","過去の株価データ、市場指標、ニュース感情分析から未来の株価を予測する高度な回帰問題。金融業界で実際に使用される手法を学習できます。",e,["過去価格","出来高","RSI","MACD","ボリンジャーバンド","ニュース感情スコア","VIX","金利","GDP成長率","失業率"],"予測価格","regression"),console.log("株式市場問題作成完了");const r=this.generateMedicalImageData(8e3);console.log("医療画像データ生成完了:",r.length,"件"),await this.createProblem("medical_image_diagnosis","AI医療画像診断コンペ","X線画像から疾患を自動診断する分類問題。医療AIの最先端技術を体験し、人命に関わる重要な判断を学びます。",r,["画像特徴1","画像特徴2","画像特徴3","画像特徴4","画像特徴5","画像特徴6","画像特徴7","画像特徴8","患者年齢","性別"],"疾患タイプ","classification",["正常","肺炎","結核","がん","その他"]),console.log("医療画像問題作成完了");const n=this.generateNLPData(6e3);console.log("NLPデータ生成完了:",n.length,"件"),await this.createProblem("sentiment_analysis_advanced","高度感情分析AI","ソーシャルメディアの投稿から感情を分析し、ブランド評価や市場動向を予測する分類問題。自然言語処理の最新技術を学習します。",n,["単語数","感情語彙スコア","否定語数","大文字率","感嘆符数","疑問符数","URL数","ハッシュタグ数","メンション数","投稿時間"],"感情","classification",["ポジティブ","ネガティブ","ニュートラル","複雑"]),console.log("NLP問題作成完了");const a=this.generateAutonomousDrivingData(7e3);console.log("自動運転データ生成完了:",a.length,"件"),await this.createProblem("autonomous_driving","自動運転AI開発","センサーデータから交通状況を認識し、適切な運転行動を決定する分類問題。自動運転技術の核心を学習します。",a,["前方距離","左側距離","右側距離","後方距離","速度","加速度","ステアリング角度","ブレーキ圧","天候","時間帯"],"運転行動","classification",["直進","左折","右折","停止","加速","減速"]),console.log("自動運転問題作成完了");const i=this.generateClimateData(4e3);console.log("気候データ生成完了:",i.length,"件"),await this.createProblem("climate_prediction","気候変動予測AI","気象データから地球温暖化の影響を予測する回帰問題。環境科学とAIの融合技術を学習します。",i,["気温","湿度","気圧","降水量","風速","CO2濃度","海面温度","氷河面積","森林面積","人口密度"],"温度上昇","regression"),console.log("気候変動問題作成完了"),console.log("CompetitionProblemManager: オンライン対戦用問題作成完了。総問題数:",this.problems.size)}static generateStockMarketData(e){const r=[];for(let n=0;n<e;n++){const a=100+Math.random()*900,i=Math.random()*1e6,s=Math.random()*100,o=(Math.random()-.5)*10,l=Math.random()*50,d=(Math.random()-.5)*2,u=Math.random()*50,h=Math.random()*5,f=(Math.random()-.5)*10,m=Math.random()*15,g=a*(1+(s-50)*.001+o*.01+d*.05+(u-25)*-.002+(h-2.5)*-.01+f*.005+(m-7.5)*-.003+(Math.random()-.5)*.1);r.push({features:[a,i,s,o,l,d,u,h,f,m],label:Math.max(0,g)})}return r}static generateMedicalImageData(e){const r=[],n=["正常","肺炎","結核","がん","その他"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=20+Math.random()*60,o=Math.random()>.5?1:0,l=Array(8).fill(0).map(()=>Math.random()*100);i>0&&(l[i-1]+=50+Math.random()*50,l[7]+=30),r.push({features:[...l,s,o],label:n[i]})}return r}static generateNLPData(e){const r=[],n=["ポジティブ","ネガティブ","ニュートラル","複雑"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=10+Math.random()*200,o=Math.random()*100,l=Math.random()*10,d=Math.random(),u=Math.random()*20,h=Math.random()*10,f=Math.random()*5,m=Math.random()*10,g=Math.random()*5,p=Math.random()*24;r.push({features:[s,o,l,d,u,h,f,m,g,p],label:n[i]})}return r}static generateAutonomousDrivingData(e){const r=[],n=["直進","左折","右折","停止","加速","減速"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=Math.random()*100,o=Math.random()*50,l=Math.random()*50,d=Math.random()*30,u=Math.random()*120,h=(Math.random()-.5)*10,f=(Math.random()-.5)*180,m=Math.random()*100,g=Math.random()*10,p=Math.random()*24;r.push({features:[s,o,l,d,u,h,f,m,g,p],label:n[i]})}return r}static generateClimateData(e){const r=[];for(let n=0;n<e;n++){const a=15+Math.random()*20,i=Math.random()*100,s=980+Math.random()*40,o=Math.random()*200,l=Math.random()*30,d=300+Math.random()*200,u=15+Math.random()*15,h=Math.random()*1e6,f=Math.random()*1e7,m=Math.random()*1e3,g=(d-400)*.01+(h-5e5)*-1e-6+(f-5e6)*1e-7+(m-500)*.001+(Math.random()-.5)*.5;r.push({features:[a,i,s,o,l,d,u,h,f,m],label:Math.max(0,g)})}return r}static generateClassificationData(e){const r=[],n=["織田","豊臣","徳川","武田","上杉"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=[Math.random()*100,Math.random()*100,Math.random()*100,Math.random()*100,Math.random()*100];r.push({features:s,label:n[i]})}return r}static generateRegressionData(e){const r=[];for(let n=0;n<e;n++){const a=[Math.random()*1e5,Math.random()*100,Math.random()*100,Math.random()*500,Math.random()*10],i=a[0]*.3+a[1]*.2+a[2]*.2+a[3]*.1+a[4]*.2+(Math.random()-.5)*1e4;r.push({features:a,label:Math.max(0,i)})}return r}}class Po{static splitData(e,r){const{trainRatio:n,validationRatio:a,testRatio:i,randomSeed:s,stratified:o}=r,l=n+a+i;if(Math.abs(l-1)>.001)throw new Error("データ分割比率の合計が1.0になる必要があります");if(s!==void 0){const m=s;Math.random=()=>{const g=Math.sin(m)*1e4;return g-Math.floor(g)}}const d=[...e].sort(()=>Math.random()-.5);if(o&&e.length>0&&typeof e[0].label=="string")return this.stratifiedSplit(d,n,a,i);const u=d.length,h=Math.floor(u*n),f=Math.floor(u*a);return{train:d.slice(0,h),validation:d.slice(h,h+f),test:d.slice(h+f)}}static stratifiedSplit(e,r,n,a){const i=new Map;e.forEach(d=>{const u=d.label.toString();i.has(u)||i.set(u,[]),i.get(u).push(d)});const s=[],o=[],l=[];return i.forEach(d=>{const u=d.length,h=Math.floor(u*r),f=Math.floor(u*n),m=d.sort(()=>Math.random()-.5);s.push(...m.slice(0,h)),o.push(...m.slice(h,h+f)),l.push(...m.slice(h+f))}),{train:s,validation:o,test:l}}static async evaluatePlayerModel(e,r,n,a,i,s){try{console.log("安定版機械学習モデルを使用中...");const o=s||{metrics:[e.defaultMetric],dataSplit:{trainRatio:.7,validationRatio:.2,testRatio:.1,randomSeed:42,stratified:e.problemType==="classification"}},l={train:e.train.map(b=>({features:r.map(x=>b.features[x]),label:b.label})),test:e.test.map(b=>({features:r.map(x=>b.features[x]),label:b.label})),featureNames:r.map(b=>e.featureNames[b]),labelName:e.labelName,classes:e.classes},d=Date.now(),u=$i(n);await u.train(l.train,a);const h=Date.now()-d;console.log("モデル評価を開始しています...");const f=u.evaluate(l.test);console.log("評価が完了しました");const m=o.metrics,g=m[0]||e.defaultMetric,p=this.calculateScore(f,g),y={};return m.forEach(b=>{switch(b){case"accuracy":y.accuracy=f.accuracy||0;break;case"precision":y.precision=f.precision||0;break;case"recall":y.recall=f.recall||0;break;case"f1_score":y.f1_score=f.f1_score||0;break;case"mae":y.mae=f.accuracy||0;break;case"mse":y.mse=f.accuracy||0;break;case"rmse":y.rmse=f.accuracy||0;break}}),{validationScore:p,testScore:0,metrics:y,predictions:f.predictions.map(b=>typeof b=="string"?parseFloat(b):b),actual:f.actual.map(b=>typeof b=="string"?parseFloat(b):b),probabilities:void 0,featureImportance:void 0,trainingTime:h/1e3,modelComplexity:this.calculateModelComplexity(n,a,r.length),evaluationOptions:o}}catch(o){throw console.error("評価エラー:",o),new Error(`モデル評価に失敗しました: ${o}`)}}static async evaluateOfficialModel(e,r){const n=this.selectFeatures(e,r.selectedFeatures),a=this.preprocessDataset(n,r.preprocessing),i={train:a.train,test:a.test,featureNames:a.featureNames,labelName:a.labelName,classes:a.classes},s=Date.now(),o=$i(r.modelType);await o.train(i.train,r.parameters);const l=Date.now()-s,d=o.evaluate(i.test);return{validationScore:0,testScore:this.calculateScore(d,e.metric),metrics:{accuracy:d.accuracy,precision:d.precision,recall:d.recall,f1_score:d.f1_score,mae:d.accuracy,mse:d.accuracy,rmse:d.accuracy},predictions:d.predictions.map(u=>typeof u=="string"?parseFloat(u):u),actual:d.actual.map(u=>typeof u=="string"?parseFloat(u):u),probabilities:void 0,featureImportance:void 0,trainingTime:l/1e3,modelComplexity:this.calculateModelComplexity(r.modelType,r.parameters,r.selectedFeatures.length)}}static selectFeatures(e,r){return{...e,train:e.train.map(n=>({...n,features:r.map(a=>n.features[a])})),validation:e.validation.map(n=>({...n,features:r.map(a=>n.features[a])})),test:e.test.map(n=>({...n,features:r.map(a=>n.features[a])})),featureNames:r.map(n=>e.featureNames[n])}}static preprocessDataset(e,r){return r.method==="none"?e:r.method==="normalize"?this.normalizeDataset(e):r.method==="standardize"?this.standardizeDataset(e):r.method==="encode"&&r.encodedFeatures?this.encodeDataset(e,r.encodedFeatures):e}static normalizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(1/0),a=Array(r).fill(-1/0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]=Math.min(n[l],o),a[l]=Math.max(a[l],o)})});const i=s=>({...s,features:s.features.map((o,l)=>{const d=a[l]-n[l];return!isFinite(d)||d===0?0:(o-n[l])/d})});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static standardizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(0),a=Array(r).fill(0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]+=o})}),n.forEach((s,o)=>{n[o]=s/e.train.length}),e.train.forEach(s=>{s.features.forEach((o,l)=>{a[l]+=Math.pow(o-n[l],2)})}),a.forEach((s,o)=>{a[o]=Math.sqrt(s/e.train.length)});const i=s=>({...s,features:s.features.map((o,l)=>a[l]===0?0:(o-n[l])/a[l])});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static encodeDataset(e,r){const n={};e.train.forEach(i=>{r.forEach(s=>{n[s]||(n[s]=new Map);const o=String(i.features[s]);n[s].has(o)||n[s].set(o,n[s].size)})});const a=i=>({...i,features:i.features.map((s,o)=>{if(r.includes(o)){const l=String(s);return n[o].get(l)??0}return s})});return{...e,train:e.train.map(a),validation:e.validation.map(a),test:e.test.map(a)}}static calculateScore(e,r){switch(r){case"accuracy":return e.accuracy||0;case"f1_score":return e.f1_score||0;case"precision":return e.precision||0;case"recall":return e.recall||0;case"mae":return Math.max(0,1-(e.mae||0)/100);case"mse":return 1/(1+(e.mse||0));case"rmse":return 1/(1+(e.rmse||0));default:return e.accuracy||0}}static calculateModelComplexity(e,r,n){let a=0;switch(e){case"logistic_regression":a=n;break;case"linear_regression":a=n;break;case"neural_network":const i=r.hidden_units||16;a=n*i+i*(r.num_classes||2);break;case"knn":a=n*(r.k||5);break;default:a=n}return a}}const s1=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Wn(async()=>{const{default:n}=await Promise.resolve().then(()=>Kn);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class Nu extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class o1 extends Nu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Bh extends Nu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Uh extends Nu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var gc;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(gc||(gc={}));var l1=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};class c1{constructor(e,{headers:r={},customFetch:n,region:a=gc.Any}={}){this.url=e,this.headers=r,this.region=a,this.fetch=s1(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return l1(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region);const d=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,d.searchParams.set("forceFunctionRegion",l));let u;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=s):typeof s=="string"?(o["Content-Type"]="text/plain",u=s):typeof FormData<"u"&&s instanceof FormData?u=s:(o["Content-Type"]="application/json",u=JSON.stringify(s)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(p=>{throw new o1(p)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new Bh(h);if(!h.ok)throw new Uh(h);let m=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return m==="application/json"?g=yield h.json():m==="application/octet-stream"?g=yield h.blob():m==="text/event-stream"?g=h:m==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof Uh||a instanceof Bh?a.context:void 0}}})}}var Re={},pn={},gn={},vn={},yn={},bn={},u1=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},In=u1();const d1=In.fetch,wg=In.fetch.bind(In),_g=In.Headers,h1=In.Request,f1=In.Response,Kn=Object.freeze(Object.defineProperty({__proto__:null,Headers:_g,Request:h1,Response:f1,default:wg,fetch:d1},Symbol.toStringTag,{value:"Module"})),m1=_w(Kn);var oi={},Fh;function jg(){if(Fh)return oi;Fh=1,Object.defineProperty(oi,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return oi.default=t,oi}var zh;function Sg(){if(zh)return bn;zh=1;var t=bn&&bn.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(bn,"__esModule",{value:!0});const e=t(m1),r=t(jg());class n{constructor(i){var s,o;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(o=i.isMaybeSingle)!==null&&o!==void 0?o:!1,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var u,h,f,m;let g=null,p=null,y=null,b=d.status,x=d.statusText;if(d.ok){if(this.method!=="HEAD"){const j=await d.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?p=j:p=JSON.parse(j))}const _=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),S=(f=d.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");_&&S&&S.length>1&&(y=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(g={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,y=null,b=406,x="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const _=await d.text();try{g=JSON.parse(_),Array.isArray(g)&&d.status===404&&(p=[],g=null,b=200,x="OK")}catch{d.status===404&&_===""?(b=204,x="No Content"):g={message:_}}if(g&&this.isMaybeSingle&&(!((m=g?.details)===null||m===void 0)&&m.includes("0 rows"))&&(g=null,b=200,x="OK"),g&&this.shouldThrowOnError)throw new r.default(g)}return{error:g,data:p,count:y,status:b,statusText:x}});return this.shouldThrowOnError||(l=l.catch(d=>{var u,h,f;return{error:{message:`${(u=d?.name)!==null&&u!==void 0?u:"FetchError"}: ${d?.message}`,details:`${(h=d?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=d?.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,s)}returns(){return this}overrideTypes(){return this}}return bn.default=n,bn}var qh;function Ng(){if(qh)return yn;qh=1;var t=yn&&yn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(yn,"__esModule",{value:!0});const e=t(Sg());class r extends e.default{select(a){let i=!1;const s=(a??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:i=!0,nullsFirst:s,foreignTable:o,referencedTable:l=o}={}){const d=l?`${l}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${a}.${i?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:s=i}={}){const o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${a}`),this}range(a,i,{foreignTable:s,referencedTable:o=s}={}){const l=typeof o>"u"?"offset":`${o}.offset`,d=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${a}`),this.url.searchParams.set(d,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:i=!1,settings:s=!1,buffers:o=!1,wal:l=!1,format:d="text"}={}){var u;const h=[a?"analyze":null,i?"verbose":null,s?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${f}"; options=${h};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return yn.default=r,yn}var Wh;function Pu(){if(Wh)return vn;Wh=1;var t=vn&&vn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vn,"__esModule",{value:!0});const e=t(Ng());class r extends e.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const s=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(a,`in.(${s})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:s,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const d=s===void 0?"":`(${s})`;return this.url.searchParams.append(a,`${l}fts${d}.${i}`),this}match(a){return Object.entries(a).forEach(([i,s])=>{this.url.searchParams.append(i,`eq.${s}`)}),this}not(a,i,s){return this.url.searchParams.append(a,`not.${i}.${s}`),this}or(a,{foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.or`:"or";return this.url.searchParams.append(o,`(${a})`),this}filter(a,i,s){return this.url.searchParams.append(a,`${i}.${s}`),this}}return vn.default=r,vn}var Kh;function Pg(){if(Kh)return gn;Kh=1;var t=gn&&gn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(gn,"__esModule",{value:!0});const e=t(Pu());class r{constructor(a,{headers:i={},schema:s,fetch:o}){this.url=a,this.headers=new Headers(i),this.schema=s,this.fetch=o}select(a,{head:i=!1,count:s}={}){const o=i?"HEAD":"GET";let l=!1;const d=(a??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",d),s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:i,defaultToNull:s=!0}={}){var o;const l="POST";if(i&&this.headers.append("Prefer",`count=${i}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const d=a.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(d.length>0){const u=[...new Set(d)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(a,{onConflict:i,ignoreDuplicates:s=!1,count:o,defaultToNull:l=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(h.length>0){const f=[...new Set(h)].map(m=>`"${m}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(a,{count:i}={}){var s;const o="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:a}={}){var i;const s="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return gn.default=r,gn}var Vh;function p1(){if(Vh)return pn;Vh=1;var t=pn&&pn.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(pn,"__esModule",{value:!0});const e=t(Pg()),r=t(Pu());class n{constructor(i,{headers:s={},schema:o,fetch:l}={}){this.url=i,this.headers=new Headers(s),this.schemaName=o,this.fetch=l}from(i){const s=new URL(`${this.url}/${i}`);return new e.default(s,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,s={},{head:o=!1,get:l=!1,count:d}={}){var u;let h;const f=new URL(`${this.url}/rpc/${i}`);let m;o||l?(h=o?"HEAD":"GET",Object.entries(s).filter(([p,y])=>y!==void 0).map(([p,y])=>[p,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([p,y])=>{f.searchParams.append(p,y)})):(h="POST",m=s);const g=new Headers(this.headers);return d&&g.set("Prefer",`count=${d}`),new r.default({method:h,url:f,headers:g,schema:this.schemaName,body:m,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return pn.default=n,pn}var Hh;function g1(){if(Hh)return Re;Hh=1;var t=Re&&Re.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Re,"__esModule",{value:!0}),Re.PostgrestError=Re.PostgrestBuilder=Re.PostgrestTransformBuilder=Re.PostgrestFilterBuilder=Re.PostgrestQueryBuilder=Re.PostgrestClient=void 0;const e=t(p1());Re.PostgrestClient=e.default;const r=t(Pg());Re.PostgrestQueryBuilder=r.default;const n=t(Pu());Re.PostgrestFilterBuilder=n.default;const a=t(Ng());Re.PostgrestTransformBuilder=a.default;const i=t(Sg());Re.PostgrestBuilder=i.default;const s=t(jg());return Re.PostgrestError=s.default,Re.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:i.default,PostgrestError:s.default},Re}var v1=g1();const y1=ar(v1),{PostgrestClient:b1,PostgrestQueryBuilder:H4,PostgrestFilterBuilder:G4,PostgrestTransformBuilder:Y4,PostgrestBuilder:J4,PostgrestError:X4}=y1;class x1{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const w1="2.15.5",_1=`realtime-js/${w1}`,j1="1.0.0",vc=1e4,S1=1e3,N1=100;var ba;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ba||(ba={}));var Oe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Oe||(Oe={}));var kt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(kt||(kt={}));var yc;(function(t){t.websocket="websocket"})(yc||(yc={}));var Vr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Vr||(Vr={}));class P1{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(e.slice(s,s+a));s=s+a;const l=n.decode(e.slice(s,s+i));s=s+i;const d=JSON.parse(n.decode(e.slice(s,e.byteLength)));return{ref:null,topic:o,event:l,payload:d}}}class kg{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var fe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(fe||(fe={}));const Gh=(t,e,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,s)=>(i[s]=k1(s,t,e,a),i),{})},k1=(t,e,r,n)=>{const a=e.find(o=>o.name===t),i=a?.type,s=r[t];return i&&!n.includes(i)?Mg(i,s):bc(s)},Mg=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return E1(e,r)}switch(t){case fe.bool:return M1(e);case fe.float4:case fe.float8:case fe.int2:case fe.int4:case fe.int8:case fe.numeric:case fe.oid:return O1(e);case fe.json:case fe.jsonb:return A1(e);case fe.timestamp:return C1(e);case fe.abstime:case fe.date:case fe.daterange:case fe.int4range:case fe.int8range:case fe.money:case fe.reltime:case fe.text:case fe.time:case fe.timestamptz:case fe.timetz:case fe.tsrange:case fe.tstzrange:return bc(e);default:return bc(e)}},bc=t=>t,M1=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},O1=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},A1=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},E1=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const s=t.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>Mg(e,o))}return t},C1=t=>typeof t=="string"?t.replace(" ","T"):t,Og=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class ko{constructor(e,r,n={},a=vc){this.channel=e,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Yh;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Yh||(Yh={}));class xa{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xa.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=xa.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=xa.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,a){const i=this.cloneDeep(e),s=this.transformState(r),o={},l={};return this.map(i,(d,u)=>{s[d]||(l[d]=u)}),this.map(s,(d,u)=>{const h=i[d];if(h){const f=u.map(y=>y.presence_ref),m=h.map(y=>y.presence_ref),g=u.filter(y=>m.indexOf(y.presence_ref)<0),p=h.filter(y=>f.indexOf(y.presence_ref)<0);g.length>0&&(o[d]=g),p.length>0&&(l[d]=p)}else o[d]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(e,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var d;const u=(d=e[o])!==null&&d!==void 0?d:[];if(e[o]=this.cloneDeep(l),u.length>0){const h=e[o].map(m=>m.presence_ref),f=u.filter(m=>h.indexOf(m.presence_ref)<0);e[o].unshift(...f)}n(o,u,l)}),this.map(s,(o,l)=>{let d=e[o];if(!d)return;const u=l.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[o]=d,a(o,d,l),d.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const a=e[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jh;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Jh||(Jh={}));var wa;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(wa||(wa={}));var qt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qt||(qt={}));class ku{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Oe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ko(this,kt.join,this.params,this.timeout),this.rejoinTimer=new kg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Oe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Oe.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(kt.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new xa(this),this.broadcastEndpointURL=Og(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Oe.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[wa.PRESENCE]&&this.bindings[wa.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:d,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>e?.(qt.CHANNEL_ERROR,m)),this._onClose(()=>e?.(qt.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var g;if(this.socket.setAuth(),m===void 0){e?.(qt.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,y=(g=p?.length)!==null&&g!==void 0?g:0,b=[];for(let x=0;x<y;x++){const w=p[x],{filter:{event:_,schema:S,table:j,filter:N}}=w,M=m&&m[x];if(M&&M.event===_&&M.schema===S&&M.table===j&&M.filter===N)b.push(Object.assign(Object.assign({},w),{id:M.id}));else{this.unsubscribe(),this.state=Oe.errored,e?.(qt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(qt.SUBSCRIBED);return}}).receive("error",m=>{this.state=Oe.errored,e?.(qt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e?.(qt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===Oe.joined&&e===wa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:s}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Oe.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(kt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new ko(this,kt.leave,{},e),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Oe.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ko(this,e,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>N1){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var a,i;const s=e.toLocaleLowerCase(),{close:o,error:l,leave:d,join:u}=kt;if(n&&[o,l,d,u].indexOf(s)>=0&&n!==this._joinRef())return;let f=this._onMessage(s,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var g,p,y;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(p=m.filter)===null||p===void 0?void 0:p.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===s}).map(m=>m.callback(f,n)):(i=this.bindings[s])===null||i===void 0||i.filter(m=>{var g,p,y,b,x,w;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in m){const _=m.id,S=(g=m.filter)===null||g===void 0?void 0:g.event;return _&&((p=r.ids)===null||p===void 0?void 0:p.includes(_))&&(S==="*"||S?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const _=(x=(b=m?.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return _==="*"||_===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===s}).map(m=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:p,table:y,commit_timestamp:b,type:x,errors:w}=g;f=Object.assign(Object.assign({},{schema:p,table:y,commit_timestamp:b,eventType:x,new:{},old:{},errors:w}),this._getPayloadRecords(g))}m.callback(f,n)})}_isClosed(){return this.state===Oe.closed}_isJoined(){return this.state===Oe.joined}_isJoining(){return this.state===Oe.joining}_isLeaving(){return this.state===Oe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const a=e.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&ku.isEqual(a.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(kt.close,{},e)}_onError(e){this._on(kt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Oe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Gh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Gh(e.columns,e.old_record)),r}}const Mo=()=>{},li={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},T1=[1e3,2e3,5e3,1e4],I1=1e4,D1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $1{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=vc,this.transport=null,this.heartbeatIntervalMs=li.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Mo,this.ref=0,this.reconnectTimer=null,this.logger=Mo,this.conn=null,this.sendBuffer=[],this.serializer=new P1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...s)=>Wn(async()=>{const{default:o}=await Promise.resolve().then(()=>Kn);return{default:o}},void 0,import.meta.url).then(({default:o})=>o(...s)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...s)=>i(...s)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${yc.websocket}`,this.httpEndpoint=Og(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=x1.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:j1}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ba.connecting:return Vr.Connecting;case ba.open:return Vr.Open;case ba.closing:return Vr.Closing;default:return Vr.Closed}}isConnected(){return this.connectionState()===Vr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new ku(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:a,ref:i}=e,s=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(S1,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},li.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:s}=r,o=s?`(${s})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(kt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${e}${n}${a}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([D1],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:_1};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(kt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new kg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},li.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,a,i,s,o,l,d,u;if(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:vc,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:li.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(s=e?.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(o=e?.heartbeatCallback)!==null&&o!==void 0?o:Mo,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:(h=>T1[h-1]||I1),this.encode=(d=e?.encode)!==null&&d!==void 0?d:((h,f)=>f(JSON.stringify(h))),this.decode=(u=e?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Mu extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ae(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class R1 extends Mu{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xc extends Mu{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var L1=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const Ag=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Wn(async()=>{const{default:n}=await Promise.resolve().then(()=>Kn);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},B1=()=>L1(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Wn(()=>Promise.resolve().then(()=>Kn),void 0,import.meta.url)).Response:Response}),wc=t=>{if(Array.isArray(t))return t.map(r=>wc(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=wc(n)}),e},U1=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var un=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const Oo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),F1=(t,e,r)=>un(void 0,void 0,void 0,function*(){const n=yield B1();t instanceof n&&!r?.noResolveJson?t.json().then(a=>{const i=t.status||500,s=a?.statusCode||i+"";e(new R1(Oo(a),i,s))}).catch(a=>{e(new xc(Oo(a),a))}):e(new xc(Oo(t),t))}),z1=(t,e,r,n)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"||!n?a:(U1(n)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(n)):a.body=n,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),r))};function Fa(t,e,r,n,a,i){return un(this,void 0,void 0,function*(){return new Promise((s,o)=>{t(r,z1(e,n,a,i)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>F1(l,o,n))})})}function Ri(t,e,r,n){return un(this,void 0,void 0,function*(){return Fa(t,"GET",e,r,n)})}function Et(t,e,r,n,a){return un(this,void 0,void 0,function*(){return Fa(t,"POST",e,n,a,r)})}function _c(t,e,r,n,a){return un(this,void 0,void 0,function*(){return Fa(t,"PUT",e,n,a,r)})}function q1(t,e,r,n){return un(this,void 0,void 0,function*(){return Fa(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Eg(t,e,r,n,a){return un(this,void 0,void 0,function*(){return Fa(t,"DELETE",e,n,a,r)})}var Qe=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const W1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class K1{constructor(e,r={},n,a){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=Ag(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,a){return Qe(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},Xh),a);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a?.headers&&(o=Object.assign(Object.assign({},o),a.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),h=yield(e=="PUT"?_c:Et)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:o},s?.duplex?{duplex:s.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ae(i))return{data:null,error:i};throw i}})}upload(e,r,n){return Qe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,a){return Qe(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const d=Object.assign({upsert:Xh.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",d.cacheControl)):(l=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield _c(this.fetch,o.toString(),l,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ae(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return Qe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const i=yield Et(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new Mu("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}update(e,r,n){return Qe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Qe(this,void 0,void 0,function*(){try{return{data:yield Et(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}copy(e,r,n){return Qe(this,void 0,void 0,function*(){try{return{data:{path:(yield Et(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}createSignedUrl(e,r,n){return Qe(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Et(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}createSignedUrls(e,r,n){return Qe(this,void 0,void 0,function*(){try{const a=yield Et(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}download(e,r){return Qe(this,void 0,void 0,function*(){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Ri(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ae(o))return{data:null,error:o};throw o}})}info(e){return Qe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Ri(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:wc(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}exists(e){return Qe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield q1(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n)&&n instanceof xc){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),a=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&a.push(l);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${d}`)}}}remove(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield Eg(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}list(e,r,n){return Qe(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},W1),r),{prefix:e||""});return{data:yield Et(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}listV2(e,r){return Qe(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Et(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const V1="2.12.1",H1={"X-Client-Info":`storage-js/${V1}`};var xn=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};class G1{constructor(e,r={},n,a){this.shouldThrowOnError=!1;const i=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},H1),r),this.fetch=Ag(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return xn(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ae(e))return{data:null,error:e};throw e}})}getBucket(e){return xn(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return xn(this,void 0,void 0,function*(){try{return{data:yield Et(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return xn(this,void 0,void 0,function*(){try{return{data:yield _c(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}emptyBucket(e){return xn(this,void 0,void 0,function*(){try{return{data:yield Et(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}deleteBucket(e){return xn(this,void 0,void 0,function*(){try{return{data:yield Eg(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}}class Y1 extends G1{constructor(e,r={},n,a){super(e,r,n,a)}from(e){return new K1(this.url,this.headers,e,this.fetch)}}const J1="2.57.4";let pa="";typeof Deno<"u"?pa="deno":typeof document<"u"?pa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?pa="react-native":pa="node";const X1={"X-Client-Info":`supabase-js-${pa}/${J1}`},Z1={headers:X1},Q1={schema:"public"},e_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},t_={};var r_=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const n_=t=>{let e;return t?e=t:typeof fetch>"u"?e=wg:e=fetch,(...r)=>e(...r)},a_=()=>typeof Headers>"u"?_g:Headers,i_=(t,e,r)=>{const n=n_(r),a=a_();return(i,s)=>r_(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:t;let d=new a(s?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:d}))})};var s_=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};function o_(t){return t.endsWith("/")?t:t+"/"}function l_(t,e){var r,n;const{db:a,auth:i,realtime:s,global:o}=t,{db:l,auth:d,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),s),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(n=o?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>s_(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function c_(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(o_(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Cg="2.71.1",Pn=30*1e3,jc=3,Ao=jc*Pn,u_="http://localhost:9999",d_="supabase.auth.token",h_={"X-Client-Info":`gotrue-js/${Cg}`},Sc="X-Supabase-Api-Version",Tg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},f_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,m_=600*1e3;class Ou extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function G(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class p_ extends Ou{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function g_(t){return G(t)&&t.name==="AuthApiError"}class Ig extends Ou{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Ar extends Ou{constructor(e,r,n,a){super(e,n,a),this.name=r,this.status=n}}class pr extends Ar{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function v_(t){return G(t)&&t.name==="AuthSessionMissingError"}class ci extends Ar{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ui extends Ar{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class di extends Ar{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function y_(t){return G(t)&&t.name==="AuthImplicitGrantRedirectError"}class Zh extends Ar{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nc extends Ar{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Eo(t){return G(t)&&t.name==="AuthRetryableFetchError"}class Qh extends Ar{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Pc extends Ar{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ef=` 	
\r=`.split(""),b_=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ef.length;e+=1)t[ef[e].charCodeAt(0)]=-2;for(let e=0;e<Li.length;e+=1)t[Li[e].charCodeAt(0)]=e;return t})();function tf(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Li[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Li[n]),e.queuedBits-=6}}function Dg(t,e,r){const n=b_[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function rf(t){const e=[],r=s=>{e.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{__(s,n,r)};for(let s=0;s<t.length;s+=1)Dg(t.charCodeAt(s),a,i);return e.join("")}function x_(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function w_(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}x_(n,e)}}function __(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function j_(t){const e=[],r={queue:0,queuedBits:0},n=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)Dg(t.charCodeAt(a),r,n);return new Uint8Array(e)}function S_(t){const e=[];return w_(t,r=>e.push(r)),new Uint8Array(e)}function N_(t){const e=[],r={queue:0,queuedBits:0},n=a=>{e.push(a)};return t.forEach(a=>tf(a,r,n)),tf(null,r,n),e.join("")}function P_(t){return Math.round(Date.now()/1e3)+t}function k_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Pt=()=>typeof window<"u"&&typeof document<"u",Lr={tested:!1,writable:!1},$g=()=>{if(!Pt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Lr.tested)return Lr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Lr.tested=!0,Lr.writable=!0}catch{Lr.tested=!0,Lr.writable=!1}return Lr.writable};function M_(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{e[a]=n}),e}const Rg=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Wn(async()=>{const{default:n}=await Promise.resolve().then(()=>Kn);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},O_=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",kn=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Br=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},mr=async(t,e)=>{await t.removeItem(e)};class Os{constructor(){this.promise=new Os.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Os.promiseConstructor=Promise;function Co(t){const e=t.split(".");if(e.length!==3)throw new Pc("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!f_.test(e[n]))throw new Pc("JWT not in base64url format");return{header:JSON.parse(rf(e[0])),payload:JSON.parse(rf(e[1])),signature:j_(e[2]),raw:{header:e[0],payload:e[1]}}}async function A_(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function E_(t,e){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await t(i);if(!e(i,null,s)){n(s);return}}catch(s){if(!e(i,s)){a(s);return}}})()})}function C_(t){return("0"+t.toString(16)).substr(-2)}function T_(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(e),Array.from(e,C_).join("")}async function I_(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function D_(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await I_(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wn(t,e,r=!1){const n=T_();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await kn(t,`${e}-code-verifier`,a);const i=await D_(n);return[i,n===i?"plain":"s256"]}const $_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function R_(t){const e=t.headers.get(Sc);if(!e||!e.match($_))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function L_(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function B_(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const U_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _n(t){if(!U_.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function To(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function nf(t){return JSON.parse(JSON.stringify(t))}var F_=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r};const Fr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),z_=[502,503,504];async function af(t){var e;if(!O_(t))throw new Nc(Fr(t),0);if(z_.includes(t.status))throw new Nc(Fr(t),t.status);let r;try{r=await t.json()}catch(i){throw new Ig(Fr(i),i)}let n;const a=R_(t);if(a&&a.getTime()>=Tg["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Qh(Fr(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new pr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new Qh(Fr(r),t.status,r.weak_password.reasons);throw new p_(Fr(r),t.status||500,n)}const q_=(t,e,r,n)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function J(t,e,r,n){var a;const i=Object.assign({},n?.headers);i[Sc]||(i[Sc]=Tg["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await W_(t,e,r+o,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function W_(t,e,r,n,a,i){const s=q_(e,n,a,i);let o;try{o=await t(r,Object.assign({},s))}catch(l){throw console.error(l),new Nc(Fr(l),0)}if(o.ok||await af(o),n?.noResolveJson)return o;try{return await o.json()}catch(l){await af(l)}}function zt(t){var e;let r=null;G_(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=P_(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function sf(t){const e=zt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function yr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function K_(t){return{data:t,error:null}}function V_(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=t,s=F_(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function H_(t){return t}function G_(t){return t.access_token&&t.refresh_token&&t.expires_in}const Io=["global","local","others"];var Y_=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r};class J_{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Rg(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Io[0]){if(Io.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Io.join(", ")}`);try{return await J(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await J(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:yr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=Y_(e,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await J(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:V_,redirectTo:r?.redirectTo})}catch(r){if(G(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await J(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yr})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,a,i,s,o,l;try{const d={nextPage:null,lastPage:0,total:0},u=await J(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:H_});if(u.error)throw u.error;const h=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,m=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);d[`${y}Page`]=p}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(G(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){_n(e);try{return await J(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yr})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){_n(e);try{return await J(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:yr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){_n(e);try{return await J(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:yr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){_n(e.userId);try{const{data:r,error:n}=await J(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(G(r))return{data:null,error:r};throw r}}async _deleteFactor(e){_n(e.userId),_n(e.id);try{return{data:await J(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}}}function of(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function X_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const jn={debug:!!(globalThis&&$g()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lg extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Z_ extends Lg{}async function Q_(t,e,r){jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),jn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await r()}finally{jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Z_(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(jn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}X_();const ej={url:u_,storageKey:d_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:h_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function lf(t,e,r){return await r()}const Sn={};class ka{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ka.nextInstanceID,ka.nextInstanceID+=1,this.instanceID>0&&Pt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},ej),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new J_({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Rg(a.fetch),this.lock=a.lock||lf,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Pt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=Q_:this.lock=lf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:$g()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=of(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=of(this.memoryStorage)),Pt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Sn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Sn[this.storageKey]=Object.assign(Object.assign({},Sn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Sn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Sn[this.storageKey]=Object.assign(Object.assign({},Sn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Cg}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=M_(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Pt()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),y_(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return G(r)?{error:r}:{error:new Ig("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,a;try{const i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:zt}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(G(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,a;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let m=null,g=null;this.flowType==="pkce"&&([m,g]=await wn(this.storage,this.storageKey)),i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:u,password:h,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:g},xform:zt})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=f?.data)!==null&&n!==void 0?n:{},channel:(a=f?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:zt})}else throw new ui("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(G(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:s,options:o}=e;r=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:sf})}else if("phone"in e){const{phone:i,password:s,options:o}=e;r=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:sf})}else throw new ui("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ci}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,a,i,s,o,l,d,u,h,f,m;let g,p;if("message"in e)g=e.message,p=e.signature;else{const{chain:y,wallet:b,statement:x,options:w}=e;let _;if(Pt())if(typeof b=="object")_=b;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))_=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=b}const S=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const j=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),x?{statement:x}:null));let N;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")N=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)N=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)g=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),p=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${S.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((s=w?.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const j=await _.signMessage(new TextEncoder().encode(g),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=j}}try{const{data:y,error:b}=await J(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:N_(p)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:zt});if(b)throw b;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new ci}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:b})}catch(y){if(G(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const r=await Br(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await J(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:zt});if(await mr(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ci}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(G(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=e,o=await J(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:zt}),{data:l,error:d}=o;return d?{data:{user:null,session:null},error:d}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ci}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:d})}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,a,i,s;try{if("email"in e){const{email:o,options:l}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await wn(this.storage,this.storageKey));const{error:h}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:d,error:u}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l?.data)!==null&&a!==void 0?a:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(s=l?.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:u}}throw new ui("You must provide either an email or phone number.")}catch(o){if(G(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var r,n;try{let a,i;"options"in e&&(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await J(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:zt});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,d=s.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(a){if(G(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await wn(this.storage,this.storageKey)),await J(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:K_})}catch(i){if(G(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new pr;const{error:a}=await J(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(G(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:i}=e,{error:s}=await J(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in e){const{phone:n,type:a,options:i}=e,{data:s,error:o}=await J(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:s?.message_id},error:o}}throw new ui("You must provide either an email or phone number and a type")}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Br(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Ao:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const s=await Br(this.userStorage,this.storageKey+"-user");s?.user?e.user=s.user:e.user=To()}if(this.storage.isServer&&e.user){let s=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,d,u)=>(!s&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,d,u))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yr}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pr}:await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:yr})})}catch(r){if(G(r))return v_(r)&&(await this._removeSession(),await mr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new pr;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await wn(this.storage,this.storageKey));const{data:d,error:u}=await J(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:yr});if(u)throw u;return s.user=d.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new pr;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=Co(e.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(G(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:s,error:o}=r;if(o)throw o;e=(n=s.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new pr;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Pt())throw new di("No browser detected.");if(e.error||e.error_description||e.error_code)throw new di(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Zh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new di("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Zh("No code detected.");const{data:x,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:d}=e;if(!i||!o||!s||!d)throw new di("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let f=u+h;l&&(f=parseInt(l));const m=f-u;m*1e3<=Pn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const g=f-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,u);const{data:p,error:y}=await this._getUser(i);if(y)throw y;const b={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:f,refresh_token:s,token_type:d,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(G(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Br(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,e);if(o&&!(g_(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await mr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=k_(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await wn(this.storage,this.storageKey,!0));try{return await J(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(G(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,d,u;const{data:h,error:f}=i;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await J(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Pt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(G(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await J(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await E_(async a=>(a>0&&await A_(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await J(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:zt})),(a,i)=>{const s=200*Math.pow(2,a);return i&&Eo(i)&&Date.now()+s-n<Pn})}catch(n){if(this._debug(r,"error",n),G(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Pt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Br(this.storage,this.storageKey);if(a&&this.userStorage){let s=await Br(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await kn(this.userStorage,this.storageKey+"-user",s)),a.user=(e=s?.user)!==null&&e!==void 0?e:To()}else if(a&&!a.user&&!a.user){const s=await Br(this.storage,this.storageKey+"-user");s&&s?.user?(a.user=s.user,await mr(this.storage,this.storageKey+"-user"),await kn(this.storage,this.storageKey,a)):a.user=To()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ao;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Ao}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),Eo(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:o}=await this._getUser(a.access_token);!o&&s?.user?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new pr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Os;const{data:i,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!i.session)throw new pr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),G(i)){const s={session:null,error:i};return Eo(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,r,n=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await kn(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=nf(a);await kn(this.storage,this.storageKey,i)}else{const a=nf(r);await kn(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await mr(this.storage,this.storageKey),await mr(this.storage,this.storageKey+"-code-verifier"),await mr(this.storage,this.storageKey+"-user"),this.userStorage&&await mr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Pt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Pn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-e)/Pn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Pn}ms, refresh threshold is ${jc} ticks`),a<=jc&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Lg)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Pt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await wn(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await J(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:d}=await J(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((a=l?.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await J(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(G(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await J(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(G(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=e?.factors||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Co(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(o=>o.kid===e);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+m_>a)return n;const{data:i,error:s}=await J(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:m,error:g}=await this.getSession();if(g||!m.session)return{data:null,error:g};n=m.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=Co(n);r?.allowExpired||L_(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:i,header:a,signature:s},error:null}}const u=B_(a.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,s,S_(`${o}.${l}`)))throw new Pc("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}}ka.nextInstanceID=0;const tj=ka;class rj extends tj{constructor(e){super(e)}}var nj=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{d(n.next(u))}catch(h){s(h)}}function l(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?i(u.value):a(u.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};class aj{constructor(e,r,n){var a,i,s;this.supabaseUrl=e,this.supabaseKey=r;const o=c_(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,d={db:Q1,realtime:t_,auth:Object.assign(Object.assign({},e_),{storageKey:l}),global:Z1},u=l_(n??{},d);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=i_(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new b1(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Y1(this.storageUrl.href,this.headers,this.fetch,n?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new c1(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return nj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:s,flowType:o,lock:l,debug:d},u,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rj({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:o,lock:l,debug:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new $1(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Bg=(t,e,r)=>new aj(t,e,r);function ij(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}ij()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ug={supabase:{url:"https://ovghanpxibparkuyxxdh.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92Z2hhbnB4aWJwYXJrdXl4eGRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDQ3MjksImV4cCI6MjA3NTQ4MDcyOX0.56Caf4btExzGvizmzJwZZA8KZIh81axQVcds8eXlq_Y"}};function sj(){const t=[];return t.length>0?(console.warn("⚠️ 環境変数が設定されていません:",t),console.warn("オフラインモードで動作します"),!1):!0}const oj=sj(),cf=Ug.supabase.url,lj=Ug.supabase.anonKey;let Bi=null;oj&&cf!=="https://placeholder.supabase.co"?Bi=Bg(cf,lj):(Bi={auth:{getUser:()=>Promise.resolve({data:{user:null},error:null}),signIn:()=>Promise.resolve({data:{user:null},error:{message:"オフラインモードです"}}),signUp:()=>Promise.resolve({data:{user:null},error:{message:"オフラインモードです"}}),signOut:()=>Promise.resolve({error:null})},from:()=>({select:()=>Promise.resolve({data:[],error:null}),insert:()=>Promise.resolve({data:[],error:null}),update:()=>Promise.resolve({data:[],error:null}),delete:()=>Promise.resolve({data:[],error:null})})},console.warn("Supabase環境変数が設定されていません。オフラインモードで動作します。"));class Ma{static async saveBattleResult(e){const r=`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n={...e,id:r};if(this.saveToLocalStorage(n),console.log("ローカルストレージに保存完了:",n),navigator.onLine===!1)return console.log("オフラインモード: ローカルストレージのみ使用"),n;try{console.log("Supabaseに保存を試行:",{room_id:e.roomId,user_id:e.userId,username:e.username,problem_id:e.problemId,accuracy:e.accuracy,training_time:Math.round(Number(e.trainingTime)),model_type:e.modelType,battle_type:e.battleType});const{data:a,error:i}=await Bi.from("battle_results").insert([{room_id:e.roomId,user_id:e.userId,username:e.username,problem_id:e.problemId,accuracy:e.accuracy,training_time:Math.round(Number(e.trainingTime)),model_type:e.modelType,parameters:e.parameters,is_private:e.isPrivate,battle_type:e.battleType,team_id:e.teamId,team_members:e.teamMembers,score:e.score}]).select().single();i?(console.error("Supabase保存エラー:",i),console.error("エラー詳細:",{code:i.code,message:i.message,details:i.details,hint:i.hint}),this.scheduleRetry(n)):(console.log("Supabaseに保存完了:",a),this.removeFromLocalStorage(n.id))}catch(a){console.error("Supabase接続エラー:",a),this.scheduleRetry(n)}return n}static saveToLocalStorage(e){const r=JSON.parse(localStorage.getItem("battle_submissions")||"[]");r.push(e),localStorage.setItem("battle_submissions",JSON.stringify(r)),console.log("ローカルストレージに保存:",e)}static scheduleRetry(e){const r=JSON.parse(localStorage.getItem("retry_queue")||"[]");r.push({...e,retryCount:0,nextRetry:Date.now()+5e3}),localStorage.setItem("retry_queue",JSON.stringify(r))}static removeFromLocalStorage(e){const n=JSON.parse(localStorage.getItem("battle_submissions")||"[]").filter(a=>a.id!==e);localStorage.setItem("battle_submissions",JSON.stringify(n))}static async processRetryQueue(){const e=JSON.parse(localStorage.getItem("retry_queue")||"[]"),r=Date.now();for(let n=e.length-1;n>=0;n--){const a=e[n];if(r>=a.nextRetry&&a.retryCount<3)try{await this.saveBattleResult(a),e.splice(n,1)}catch{a.retryCount++,a.nextRetry=Date.now()+5e3*Math.pow(2,a.retryCount)}}localStorage.setItem("retry_queue",JSON.stringify(e))}static createTeam(e,r){const n=`team_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,a={id:n,leader:e,members:[e],usernames:[r],createdAt:new Date().toISOString(),isActive:!0},i=JSON.parse(localStorage.getItem("teams")||"[]");return i.push(a),localStorage.setItem("teams",JSON.stringify(i)),n}static joinTeam(e,r,n){const a=JSON.parse(localStorage.getItem("teams")||"[]"),i=a.find(s=>s.id===e);return!i||!i.isActive?!1:(i.members.includes(r)||(i.members.push(r),i.usernames.push(n),localStorage.setItem("teams",JSON.stringify(a))),!0)}static getTeam(e){return JSON.parse(localStorage.getItem("teams")||"[]").find(n=>n.id===e)||null}static async getLeaderboard(e=10,r=!1,n){try{let a=Bi.from("leaderboard_view").select("*").order("score",{ascending:!1}).limit(e);const{data:i,error:s}=await a;if(s)return console.error("Supabase取得エラー:",s),this.getLeaderboardFromLocal(e,r,n);if(i&&i.length>0)return console.log("Supabaseからリーダーボード取得:",i),i.map((o,l)=>({rank:l+1,userId:o.user_id,username:o.username,totalBattles:o.total_battles,wins:o.wins,losses:o.losses,winRate:o.total_battles>0?o.wins/o.total_battles:0,averageAccuracy:o.average_accuracy,bestAccuracy:o.best_accuracy,totalScore:o.total_score,lastBattleAt:o.last_battle_at,isPrivate:o.is_private,battleType:o.battle_type,teamId:o.team_id,teamMembers:o.team_members,level:1,streak:o.streak||0}))}catch(a){console.error("Supabase接続エラー:",a)}return this.getLeaderboardFromLocal(e,r,n)}static getLeaderboardFromLocal(e,r,n){const a=JSON.parse(localStorage.getItem("battle_submissions")||"[]");console.log("ローカルストレージから取得した提出データ:",a);const i=a.filter(s=>{const o=r?s.isPrivate===!0:s.isPrivate!==!0,l=!n||s.battleType===n;return o&&l});return console.log("フィルタリング後の提出データ:",i),this.getUnifiedLeaderboard(i,e)}static getUnifiedLeaderboard(e,r){const n=new Map;return e.forEach(i=>{const s=i.battleType==="team"?i.teamId||`team_${i.userId}`:i.userId,o=i.battleType==="team"?`チーム ${i.teamId?.split("_")[1]||i.username}`:i.username;n.has(s)||n.set(s,{userId:s,username:o,totalBattles:0,wins:0,losses:0,accuracies:[],totalScore:0,lastBattleAt:i.submittedAt,isPrivate:i.isPrivate||!1,battleType:i.battleType,teamId:i.teamId,teamMembers:i.teamMembers});const l=n.get(s);l.totalBattles++,i.accuracy>.8?l.wins++:l.losses++,l.accuracies.push(i.accuracy),l.totalScore+=i.accuracy*1e3,l.lastBattleAt=i.submittedAt}),Array.from(n.values()).map(i=>({userId:i.userId,username:i.username,totalBattles:i.totalBattles,wins:i.wins,losses:i.losses,winRate:i.totalBattles>0?i.wins/i.totalBattles:0,averageAccuracy:i.accuracies.reduce((s,o)=>s+o,0)/i.accuracies.length,bestAccuracy:Math.max(...i.accuracies),totalScore:i.totalScore,lastBattleAt:i.lastBattleAt,isPrivate:i.isPrivate,battleType:i.battleType,teamId:i.teamId,teamMembers:i.teamMembers,level:1,streak:0})).sort((i,s)=>s.totalScore-i.totalScore).slice(0,r).map((i,s)=>({...i,rank:s+1}))}static getTeamLeaderboard(e,r){const n=new Map;return e.forEach(i=>{const s=i.teamId||`team_${i.userId}`,o=`チーム ${s.split("_")[1]||i.username}`;n.has(s)||n.set(s,{teamId:s,teamName:o,teamMembers:i.teamMembers||[i.username],totalBattles:0,wins:0,losses:0,accuracies:[],totalScore:0,lastBattleAt:i.submittedAt,isPrivate:i.isPrivate||!1});const l=n.get(s);l.totalBattles++,i.accuracy>.8?l.wins++:l.losses++,l.accuracies.push(i.accuracy),l.totalScore+=i.accuracy*1e3,l.lastBattleAt=i.submittedAt}),Array.from(n.values()).map(i=>({userId:i.teamId,username:i.teamName,totalBattles:i.totalBattles,wins:i.wins,losses:i.losses,winRate:i.totalBattles>0?i.wins/i.totalBattles:0,averageAccuracy:i.accuracies.reduce((s,o)=>s+o,0)/i.accuracies.length,bestAccuracy:Math.max(...i.accuracies),totalScore:i.totalScore,lastBattleAt:i.lastBattleAt,isPrivate:i.isPrivate,teamId:i.teamId,teamMembers:i.teamMembers,level:1,streak:0,battleType:"team"})).sort((i,s)=>s.totalScore-i.totalScore).slice(0,r).map((i,s)=>({...i,rank:s+1}))}static async getUserStats(e){return(await this.getLeaderboard(100)).find(n=>n.userId===e)||null}static async getBattleHistory(e,r=20){return JSON.parse(localStorage.getItem("battle_submissions")||"[]").filter(a=>a.userId===e).sort((a,i)=>new Date(i.submittedAt).getTime()-new Date(a.submittedAt).getTime()).slice(0,r)}static async getProblemLeaderboard(e,r=10,n=!1,a){const i=JSON.parse(localStorage.getItem("battle_submissions")||"[]"),s=JSON.parse(localStorage.getItem("offline_data_battle_result")||"[]");console.log("リーダーボード取得:",{problemId:e,submissions:i.length,offlineData:s.length,isPrivate:n,battleType:a});const l=[...i,...s].filter(h=>{const f=h.problemId===e,m=n?h.isPrivate===!0:h.isPrivate!==!0,g=!a||h.battleType===a;return f&&m&&g});return console.log("フィルタリング後:",{filteredSubmissions:l.length,submissions:l}),l.length===0?(console.log("データなし - サンプルデータを生成"),[{userId:"sample_user_1",username:"サンプルプレイヤー1",accuracy:.85,score:850,rank:1,submittedAt:new Date().toISOString(),modelType:"logistic_regression",trainingTime:45,isPrivate:!1,battleType:"individual"},{userId:"sample_user_2",username:"サンプルプレイヤー2",accuracy:.78,score:780,rank:2,submittedAt:new Date().toISOString(),modelType:"neural_network",trainingTime:120,isPrivate:!1,battleType:"individual"}]):l.map(h=>{const f=typeof h.accuracy=="number"&&!isNaN(h.accuracy)?h.accuracy:0,m=typeof h.trainingTime=="number"&&!isNaN(h.trainingTime)?h.trainingTime:0,g=h.modelType||"logistic_regression",p=Math.round(f*1e3);return{...h,accuracy:f,trainingTime:m,modelType:g,score:p}}).sort((h,f)=>f.score-h.score).slice(0,r).map((h,f)=>({userId:h.userId||`user_${f+1}`,username:h.username||"プレイヤー",accuracy:h.accuracy||0,score:h.score||0,rank:f+1,submittedAt:h.submittedAt||new Date().toISOString(),modelType:h.modelType||"logistic_regression",trainingTime:h.trainingTime||120,isPrivate:h.isPrivate||!1,battleType:h.battleType||"individual"}))}static async getProblemStats(e){const n=JSON.parse(localStorage.getItem("battle_submissions")||"[]").filter(l=>l.problemId===e);if(n.length===0)return{totalSubmissions:0,averageAccuracy:0,bestAccuracy:0,topParticipants:[]};const a=n.map(l=>l.accuracy),i=a.reduce((l,d)=>l+d,0)/a.length,s=Math.max(...a),o=n.sort((l,d)=>d.accuracy-l.accuracy).slice(0,10).map(l=>({username:l.username,accuracy:l.accuracy,submittedAt:l.submittedAt}));return{totalSubmissions:n.length,averageAccuracy:i,bestAccuracy:s,topParticipants:o}}}const cj={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92Z2hhbnB4aWJwYXJrdXl4eGRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDQ3MjksImV4cCI6MjA3NTQ4MDcyOX0.56Caf4btExzGvizmzJwZZA8KZIh81axQVcds8eXlq_Y",VITE_SUPABASE_URL:"https://ovghanpxibparkuyxxdh.supabase.co"};class Pr{static instance;static REQUIRED_ENV_VARS=["VITE_SUPABASE_URL","VITE_SUPABASE_ANON_KEY"];static getInstance(){return this.instance||(this.instance=new Pr),this.instance}static validateEnvironment(){const e=[],r=[];for(const i of this.REQUIRED_ENV_VARS)cj[i]||e.push(i);return this.isValidSupabaseUrl("https://ovghanpxibparkuyxxdh.supabase.co")||r.push("VITE_SUPABASE_URLの形式が正しくありません"),this.isValidSupabaseKey("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92Z2hhbnB4aWJwYXJrdXl4eGRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDQ3MjksImV4cCI6MjA3NTQ4MDcyOX0.56Caf4btExzGvizmzJwZZA8KZIh81axQVcds8eXlq_Y")||r.push("VITE_SUPABASE_ANON_KEYの形式が正しくありません"),{isValid:e.length===0&&r.length===0,missingVars:e,errors:r}}static getSecureSupabaseConfig(){const e=this.validateEnvironment();return e.isValid?{url:"https://ovghanpxibparkuyxxdh.supabase.co",key:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92Z2hhbnB4aWJwYXJrdXl4eGRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDQ3MjksImV4cCI6MjA3NTQ4MDcyOX0.56Caf4btExzGvizmzJwZZA8KZIh81axQVcds8eXlq_Y"}:(console.error("環境変数の検証に失敗しました:",e),null)}static isValidSupabaseUrl(e){try{const r=new URL(e);return r.protocol==="https:"&&r.hostname.includes("supabase.co")&&r.pathname.includes("/rest/v1/")}catch{return!1}}static isValidSupabaseKey(e){return/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(e)&&e.length>100}static showSecurityWarning(){const e=this.validateEnvironment();e.isValid||(console.warn("🚨 セキュリティ警告: 環境変数が正しく設定されていません"),console.warn("不足している環境変数:",e.missingVars),console.warn("エラー:",e.errors),console.warn("本番環境では必ず適切な環境変数を設定してください"))}static checkDevelopmentSecurity(){}static checkProductionSecurity(){if(!this.validateEnvironment().isValid)throw new Error("本番環境で環境変数が設定されていません。セキュリティ上の理由でアプリケーションを停止します。")}}Pr.getInstance();class uj{socket=null;roomId=null;userId=null;callbacks=new Map;supabase=null;supabaseChannel=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;isReconnecting=!1;heartbeatInterval=null;constructor(){this.setupSupabaseRealtime()}setupSupabaseRealtime(){try{Pr.checkDevelopmentSecurity(),Pr.checkProductionSecurity();const e=Pr.getSecureSupabaseConfig();if(!e){console.error("Supabase設定の取得に失敗しました"),this.emit("error",new Error("Supabase設定が無効です"));return}this.supabase=Bg(e.url,e.key),console.log("Supabase Realtime接続を開始"),this.supabase.from("battle_events").select("count").limit(1).then(()=>{console.log("Supabase Realtime接続完了"),this.emit("connected")}).catch(r=>{console.error("Supabase接続エラー:",r),this.emit("error",r)})}catch(e){console.error("Supabase初期化エラー:",e),this.emit("error",e)}}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{console.log("WebSocket接続完了"),this.emit("connected")}),this.socket.on("disconnect",()=>{console.log("WebSocket接続切断"),this.emit("disconnected")}),this.socket.on("realtime_update",e=>{this.emit("realtime_update",e)}),this.socket.on("participant_update",e=>{this.emit("participant_update",e)}),this.socket.on("chat_message",e=>{this.emit("chat_message",e)}),this.socket.on("battle_start",e=>{this.emit("battle_start",e)}),this.socket.on("battle_end",e=>{this.emit("battle_end",e)}),this.socket.on("weekly_problem_change",e=>{this.emit("weekly_problem_change",e)}),this.socket.on("participant_count_update",e=>{this.emit("participant_count_update",e)}),this.socket.on("submission_count_update",e=>{this.emit("submission_count_update",e)}),this.socket.on("error",e=>{console.error("WebSocketエラー:",e),this.emit("error",e)}))}connect(e,r){this.userId=e,this.roomId=r,this.supabase?this.setupSupabaseChannel(r):this.socket&&!this.socket.connected&&this.socket.connect()}setupSupabaseChannel(e){this.supabase&&(this.supabaseChannel&&this.supabaseChannel.unsubscribe(),this.supabaseChannel=this.supabase.channel(`battle_room_${e}`).on("postgres_changes",{event:"*",schema:"public",table:"battle_events",filter:`room_id=eq.${e}`},r=>{this.handleSupabaseUpdate(r)}).on("broadcast",{event:"battle_progress"},r=>{this.handleBattleProgress(r)}).on("broadcast",{event:"chat_message"},r=>{this.handleChatMessage(r)}).subscribe())}handleSupabaseUpdate(e){const{eventType:r,new:n,old:a}=e;switch(r){case"INSERT":this.emit("participant_update",{userId:n.user_id,username:n.username,status:n.status,progress:n.progress});break;case"UPDATE":this.emit("realtime_update",{type:"progress",data:n,timestamp:new Date().toISOString(),userId:n.user_id,roomId:n.room_id});break;case"DELETE":this.emit("participant_update",{userId:a.user_id,username:a.username,status:"left",progress:0});break}}handleBattleProgress(e){this.emit("realtime_update",{type:"progress",data:e,timestamp:new Date().toISOString(),userId:e.userId,roomId:e.roomId})}handleChatMessage(e){this.emit("chat_message",{id:e.id,userId:e.userId,username:e.username,message:e.message,timestamp:e.timestamp,roomId:e.roomId})}disconnect(){this.socket&&this.socket.connected&&this.socket.disconnect(),this.userId=null,this.roomId=null}joinRoom(e,r){this.socket&&this.socket.connected&&this.socket.emit("join_room",{roomId:e,username:r})}leaveRoom(e){this.socket&&this.socket.connected&&this.socket.emit("leave_room",{roomId:e})}sendProgress(e,r,n=!1){console.log("進捗送信:",{progress:e,currentStep:r,isReady:n,userId:this.userId,roomId:this.roomId}),this.supabase&&this.supabaseChannel?this.supabaseChannel.send({type:"broadcast",event:"battle_progress",payload:{userId:this.userId,roomId:this.roomId,progress:e,currentStep:r,isReady:n,timestamp:new Date().toISOString()}}):this.socket&&this.socket.connected&&this.roomId&&this.socket.emit("progress_update",{roomId:this.roomId,progress:e,currentStep:r,isReady:n,timestamp:new Date().toISOString()})}sendChatMessage(e){this.supabase&&this.supabaseChannel?this.supabaseChannel.send({type:"broadcast",event:"chat_message",payload:{id:Date.now().toString(),userId:this.userId,username:"プレイヤー",message:e,timestamp:new Date().toISOString(),roomId:this.roomId}}):this.socket&&this.socket.connected&&this.roomId&&this.userId&&this.socket.emit("chat_message",{roomId:this.roomId,userId:this.userId,message:e,timestamp:new Date().toISOString()})}startBattle(e){this.socket&&this.socket.connected&&this.socket.emit("start_battle",{roomId:e})}endBattle(e,r){this.socket&&this.socket.connected&&this.socket.emit("end_battle",{roomId:e,result:r})}broadcastUpdate(e){this.socket&&this.socket.connected&&this.socket.emit("broadcast_update",e)}on(e,r){this.callbacks.has(e)||this.callbacks.set(e,[]),this.callbacks.get(e).push(r)}off(e,r){const n=this.callbacks.get(e);if(n){const a=n.indexOf(r);a>-1&&n.splice(a,1)}}emit(e,r){const n=this.callbacks.get(e);n&&n.forEach(a=>a(r))}isConnected(){return this.socket?this.socket.connected:!1}getCurrentRoom(){return this.roomId}getCurrentUser(){return this.userId}broadcastLeaderboardUpdate(e,r){this.broadcastUpdate({type:"leaderboard_update",data:{problemId:e,leaderboard:r},timestamp:new Date().toISOString(),userId:this.userId||"system",roomId:this.roomId||"global"})}}const se=new uj;class _a{static submissions=new Map;static leaderboards=new Map;static async createSubmission(e,r,n,a,i,s,o,l,d){const u=Be.getProblem(e);if(!u)throw new Error("問題が見つかりません");if(!Be.isProblemActive(e))throw new Error("この問題は既に終了しています");const h=await Po.evaluatePlayerModel(u.dataset,a,i,s,o),f={id:`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:r,username:n,problemId:e,predictions:h.predictions,probabilities:h.probabilities,selectedFeatures:a,modelType:i,parameters:s,preprocessing:o,submittedAt:new Date,teamId:l,teamMembers:d};this.submissions.has(e)||this.submissions.set(e,[]),this.submissions.get(e).push(f);try{const m=Math.round(h.validationScore*100);console.log("保存するスコア:",m,"validationScore:",h.validationScore),await Ma.saveBattleResult({problemId:f.problemId,roomId:`comp_${f.problemId}`,userId:f.userId,username:f.username,accuracy:h.validationScore,score:m,trainingTime:h.trainingTime,modelType:f.modelType,parameters:f.parameters,isPrivate:!1,battleType:f.teamId?"team":"individual",teamId:f.teamId,teamMembers:f.teamMembers?.map(g=>({userId:g,username:g}))}),console.log("BattleDatabaseに保存完了 - スコア:",m)}catch(m){console.error("BattleDatabaseへの保存に失敗:",m)}return await this.updateLeaderboard(e),this.broadcastLeaderboardUpdate(e),f}static broadcastLeaderboardUpdate(e){try{const r=this.getLeaderboard(e);r&&(se.broadcastLeaderboardUpdate(e,r),console.log("リーダーボード更新をブロードキャスト:",e))}catch(r){console.error("リーダーボードブロードキャストエラー:",r)}}static getSubmissions(e){return this.submissions.get(e)||[]}static getUserSubmissions(e,r){return this.getSubmissions(e).filter(a=>a.userId===r)}static getLeaderboard(e,r=20){return this.leaderboards.get(e)||null}static async updateLeaderboard(e,r=100){const n=Be.getProblem(e);if(!n)return;const a=this.getSubmissions(e),i=await Promise.all(a.map(async o=>{try{const l=await Po.evaluateOfficialModel(n.dataset,o);return{...o,score:l.testScore}}catch(l){return console.error("提出の評価に失敗:",l),{...o,score:0}}}));i.sort((o,l)=>(l.score||0)-(o.score||0)),i.forEach((o,l)=>{o.rank=l+1});const s={problemId:e,submissions:i.slice(0,r),lastUpdated:new Date,totalSubmissions:i.length,participantCount:new Set(i.map(o=>o.userId)).size};this.leaderboards.set(e,s);try{const o=await Ma.getProblemLeaderboard(e,"individual",r);console.log("BattleDatabaseリーダーボード同期:",o)}catch(o){console.error("リーダーボード同期エラー:",o)}Be.updateSubmissionCount(e,i.length),Be.updateParticipantCount(e,s.participantCount)}static async evaluatePrivateSubmission(e,r){const n=Be.getProblem(e);if(!n)throw new Error("問題が見つかりません");const a=this.getSubmissions(e).find(s=>s.id===r);if(!a)throw new Error("提出が見つかりません");const i=await Po.evaluateOfficialModel(n.dataset,a);return a.score=i.testScore,a.privateScore=i.testScore,a.privateEvaluationDate=new Date,i}static getSubmissionStats(e){const r=this.getSubmissions(e),n=r.map(a=>a.score||0).filter(a=>a>0);return{totalSubmissions:r.length,participantCount:new Set(r.map(a=>a.userId)).size,averageScore:n.length>0?n.reduce((a,i)=>a+i,0)/n.length:0,bestScore:n.length>0?Math.max(...n):0,worstScore:n.length>0?Math.min(...n):0}}static getSubmissionHistory(e,r){const n=this.getUserSubmissions(e,r);this.getSubmissions(e);const a=n.length>0?Math.max(...n.map(l=>l.score||0)):0,i=n.length>1?(n[n.length-1].score||0)-(n[0].score||0):0,s=n.find(l=>l.score===a),o=s&&s.rank||0;return{submissions:n,bestScore:a,improvement:i,rank:o}}static deleteSubmission(e,r){const n=this.getSubmissions(e),a=n.findIndex(i=>i.id===r);return a===-1?!1:(n.splice(a,1),this.updateLeaderboard(e),!0)}static clearSubmissions(e){this.submissions.delete(e),this.leaderboards.delete(e)}static checkSubmissionLimit(e,r){const n=Be.getProblem(e);if(!n)return{canSubmit:!1,remainingSubmissions:0,maxSubmissions:0};const a=this.getUserSubmissions(e,r),i=n.constraints.maxSubmissions-a.length;return{canSubmit:i>0,remainingSubmissions:Math.max(0,i),maxSubmissions:n.constraints.maxSubmissions}}}class hi{static currentWeek=0;static problemRotationInterval=null;static WEEK_DURATION=10080*60*1e3;static isInitialized=!1;static JST_OFFSET=540*60*1e3;static START_TIME=new Date("2024-01-01T00:00:00+09:00");static startWeeklyRotation(){if(this.isInitialized){console.log("週次問題切り替えシステムは既に開始されています");return}console.log("週次問題切り替えシステムを開始します"),this.isInitialized=!0,this.currentWeek=this.getCurrentWeekFromStart(),console.log(`現在の週: ${this.currentWeek} (日本時間基準)`),this.generateWeeklyProblems(),this.scheduleWeeklyRotation(),console.log(`週次問題切り替えシステム開始 - 現在の週: ${this.currentWeek}`)}static rotateToNextWeek(){this.currentWeek=this.getCurrentWeekFromStart(),console.log(`週次問題切り替え: 第${this.currentWeek}週開始 (日本時間基準)`),this.generateWeeklyProblems(),this.archivePreviousWeekProblems(),this.notifyWeeklyProblemChange(),this.scheduleWeeklyRotation()}static getCurrentWeek(){return this.currentWeek}static getCurrentWeekFromStart(){const e=new Date,n=new Date(e.getTime()+this.JST_OFFSET).getTime()-this.START_TIME.getTime(),a=Math.floor(n/this.WEEK_DURATION)+1;return Math.max(1,a)}static scheduleWeeklyRotation(){this.problemRotationInterval&&clearTimeout(this.problemRotationInterval);const e=new Date;new Date(e.getTime()+this.JST_OFFSET);const r=new Date(this.START_TIME.getTime()+(this.currentWeek-1)*this.WEEK_DURATION),n=new Date(r.getTime()+this.WEEK_DURATION),i=new Date(n.getTime()-this.JST_OFFSET).getTime()-e.getTime();console.log(`次の週次切り替え: ${n.toLocaleString("ja-JP",{timeZone:"Asia/Tokyo"})}`),this.problemRotationInterval=setTimeout(()=>{this.rotateToNextWeek()},i)}static getCurrentWeekProblem(){const e=`week_${this.currentWeek}`;return Be.getProblem(e)}static async generateWeeklyProblems(){const e=`week_${this.currentWeek}`,r=["classification","regression"],n=r[this.currentWeek%r.length];console.log(`第${this.currentWeek}週の問題を生成中: ${n}`);try{await Be.createProblem(e,`第${this.currentWeek}週 ${n==="classification"?"分類":"回帰"}問題`,`週次コンペティション問題 - ${n}。今週は${n==="classification"?"分類":"回帰"}問題に挑戦してください。`,this.generateWeeklyData(n),this.getWeeklyFeatureNames(n),"target",n,n==="classification"?["クラスA","クラスB","クラスC","クラスD"]:void 0),console.log(`第${this.currentWeek}週の問題生成完了: ${e}`)}catch(a){console.error(`第${this.currentWeek}週の問題生成エラー:`,a)}}static archivePreviousWeekProblems(){const e=`week_${this.currentWeek-1}`,r=Be.getProblem(e);r&&(r.endTime=new Date,console.log(`前週の問題をアーカイブしました: ${e}`))}static generateWeeklyData(e){const r=5e3+Math.random()*3e3;return e==="classification"?this.generateClassificationWeeklyData(Math.floor(r)):this.generateRegressionWeeklyData(Math.floor(r))}static generateClassificationWeeklyData(e){const r=[],n=["クラスA","クラスB","クラスC","クラスD"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=Math.sin(this.currentWeek*.5)*.3+.7,o=[Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s];i>0&&(o[i-1]+=50+Math.random()*50,o[7]+=30),r.push({features:o,label:n[i]})}return r}static generateRegressionWeeklyData(e){const r=[];for(let n=0;n<e;n++){const a=1+Math.sin(this.currentWeek*.3)*.5,i=[Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a],s=i.reduce((o,l,d)=>{const u=(d+1)*.1*a;return o+l*u},0)+(Math.random()-.5)*50;r.push({features:i,label:Math.max(0,s)})}return r}static getWeeklyFeatureNames(e){return e==="classification"?["特徴量1","特徴量2","特徴量3","特徴量4","特徴量5","特徴量6","特徴量7","特徴量8","特徴量9","特徴量10"]:["入力変数1","入力変数2","入力変数3","入力変数4","入力変数5","入力変数6","入力変数7","入力変数8","入力変数9","入力変数10"]}static stopWeeklyRotation(){this.problemRotationInterval&&(clearTimeout(this.problemRotationInterval),this.problemRotationInterval=null),this.isInitialized=!1,console.log("週次問題切り替えシステムを停止しました")}static getTimeUntilNextRotation(){const e=new Date;new Date(e.getTime()+this.JST_OFFSET);const r=new Date(this.START_TIME.getTime()+(this.currentWeek-1)*this.WEEK_DURATION),n=new Date(r.getTime()+this.WEEK_DURATION);return new Date(n.getTime()-this.JST_OFFSET).getTime()-e.getTime()}static getCurrentWeekProgress(){const e=new Date,r=new Date(e.getTime()+this.JST_OFFSET),n=new Date(this.START_TIME.getTime()+(this.currentWeek-1)*this.WEEK_DURATION),a=r.getTime()-n.getTime();return Math.min(1,Math.max(0,a/this.WEEK_DURATION))}static getCurrentJSTTime(){const e=new Date;return new Date(e.getTime()+this.JST_OFFSET)}static getWeekStartTime(e){return new Date(this.START_TIME.getTime()+(e-1)*this.WEEK_DURATION)}static getWeekEndTime(e){const r=this.getWeekStartTime(e);return new Date(r.getTime()+this.WEEK_DURATION)}static notifyWeeklyProblemChange(){try{const e=this.getCurrentWeekProblem();e&&(se.broadcastUpdate({type:"weekly_problem_change",data:{week:this.currentWeek,problem:{id:e.id,title:e.title,description:e.description,difficulty:e.difficulty,timeLimit:e.timeLimit,participantCount:e.participantCount||0},nextRotation:this.getTimeUntilNextRotation(),progress:this.getCurrentWeekProgress()},timestamp:new Date().toISOString(),userId:"system",roomId:"global"}),console.log(`週次問題切り替え通知送信: 第${this.currentWeek}週`))}catch(e){console.error("週次問題切り替え通知エラー:",e)}}static updateParticipantCount(e,r){try{const n=Be.getProblem(e);n&&(n.participantCount=(n.participantCount||0)+r,se.broadcastUpdate({type:"participant_count_update",data:{problemId:e,participantCount:n.participantCount,week:this.currentWeek},timestamp:new Date().toISOString(),userId:"system",roomId:"global"}),console.log(`参加者数更新: ${e} - ${n.participantCount}人`))}catch(n){console.error("参加者数更新エラー:",n)}}static updateSubmissionCount(e,r){try{const n=Be.getProblem(e);n&&(n.submissionCount=(n.submissionCount||0)+r,se.broadcastUpdate({type:"submission_count_update",data:{problemId:e,submissionCount:n.submissionCount,week:this.currentWeek},timestamp:new Date().toISOString(),userId:"system",roomId:"global"}),console.log(`提出数更新: ${e} - ${n.submissionCount}件`))}catch(n){console.error("提出数更新エラー:",n)}}static getWeeklyStats(){const e=this.getCurrentWeekProblem();return{week:this.currentWeek,problem:e,participantCount:e?.participantCount||0,submissionCount:e?.submissionCount||0,timeUntilNext:this.getTimeUntilNextRotation(),progress:this.getCurrentWeekProgress()}}}class Au{static instance;static CACHE_DURATION=300*1e3;cache=new Map;static getInstance(){return this.instance||(this.instance=new Au),this.instance}async getProblem(e){const r=`problem_${e}`,n=this.getCachedData(r);if(n)return n;try{const a=hi.getCurrentWeekProblem();if(a&&a.id===e)return this.setCachedData(r,a),a;const i=Be.getProblem(e);return i?(this.setCachedData(r,i),i):null}catch(a){return console.error("問題取得エラー:",a),null}}async getLeaderboard(e,r=20){const n=`leaderboard_${e}_${r}`,a=this.getCachedData(n);if(a)return a;try{const i=await _a.getLeaderboard(e,r);return this.setCachedData(n,i),i}catch(i){return console.error("リーダーボード取得エラー:",i),{submissions:[],total:0}}}async submitResult(e,r,n,a,i,s,o,l,d,u,h){try{const f=await _a.createSubmission(e,r,n,a,i,s,o,l,d);return this.broadcastSubmissionUpdate(e,f),this.clearCache(`leaderboard_${e}`),this.clearCache(`problem_${e}`),f}catch(f){throw console.error("提出エラー:",f),f}}async refreshLeaderboard(e){try{this.clearCache(`leaderboard_${e}`);const r=await _a.getLeaderboard(e);return r&&se.broadcastLeaderboardUpdate(e,r),r}catch(r){throw console.error("リーダーボード更新エラー:",r),r}}getWeeklyStats(){return hi.getWeeklyStats()}updateParticipantCount(e,r){try{hi.updateParticipantCount(e,r);const n=Be.getProblem(e);n&&(n.participantCount=(n.participantCount||0)+r)}catch(n){console.error("参加者数更新エラー:",n)}}updateSubmissionCount(e,r){try{hi.updateSubmissionCount(e,r);const n=Be.getProblem(e);n&&(n.submissionCount=(n.submissionCount||0)+r)}catch(n){console.error("提出数更新エラー:",n)}}broadcastSubmissionUpdate(e,r){try{se.broadcastUpdate({type:"submission_count_update",data:{problemId:e,submissionId:r.id,userId:r.userId,username:r.username,score:r.score,timestamp:r.submittedAt},timestamp:new Date().toISOString(),userId:"system",roomId:"global"})}catch(n){console.error("リアルタイム更新エラー:",n)}}getCachedData(e){const r=this.cache.get(e);return r&&Date.now()-r.timestamp<this.CACHE_DURATION?r.data:null}setCachedData(e,r){this.cache.set(e,{data:r,timestamp:Date.now()})}clearCache(e){this.cache.delete(e)}clearAllCache(){this.cache.clear()}async validateDataConsistency(e){try{const r=await this.getProblem(e),n=await this.getLeaderboard(e);if(!r)return!1;const a=n.submissions?.length||0,i=r.submissionCount||0;return Math.abs(a-i)>1?(console.warn("データ不整合を検出:",{problemId:e,actualSubmissions:a,reportedSubmissions:i}),r.submissionCount=a,!1):!0}catch(r){return console.error("データ整合性チェックエラー:",r),!1}}}const dj=Au.getInstance();function Oa(t){return t.reduce((e,r)=>e+r,0)/t.length}function hj(t){const e=[...t].sort((n,a)=>n-a),r=Math.floor(e.length/2);return e.length%2===0?(e[r-1]+e[r])/2:e[r]}function fj(t){const e=Oa(t),r=t.map(a=>Math.pow(a-e,2)),n=Oa(r);return Math.sqrt(n)}function uf(t,e){const r=[...t].sort((s,o)=>s-o),n=(r.length-1)*e,a=Math.floor(n),i=n-a;return r[a+1]!==void 0?r[a]+i*(r[a+1]-r[a]):r[a]}function mj(t){const e=[];for(let r=0;r<t.featureNames.length;r++){const n=t.raw?.train?.map(a=>a.features[r])??t.train.map(a=>a.features[r]);e.push({name:t.featureNames[r],mean:Oa(n),median:hj(n),std:fj(n),min:Math.min(...n),max:Math.max(...n),q1:uf(n,.25),q3:uf(n,.75)})}return e}function pj(t,e){const r=t.length,n=Oa(t),a=Oa(e);let i=0,s=0,o=0;for(let d=0;d<r;d++){const u=t[d]-n,h=e[d]-a;i+=u*h,s+=u*u,o+=h*h}const l=Math.sqrt(s*o);return l===0?0:i/l}function gj(t){const e=t.featureNames.length,r=[];for(let n=0;n<e;n++){r[n]=[];const a=t.raw?.train?.map(i=>i.features[n])??t.train.map(i=>i.features[n]);for(let i=0;i<e;i++){const s=t.raw?.train?.map(o=>o.features[i])??t.train.map(o=>o.features[i]);r[n][i]=pj(a,s)}}return r}function df(t,e=10){const r=Math.min(...t),i=(Math.max(...t)-r)/e,s=Array(e).fill(0),o=[];for(let l=0;l<e;l++){const d=r+l*i,u=r+(l+1)*i;o.push(`${d.toFixed(2)}-${u.toFixed(2)}`)}return t.forEach(l=>{const d=Math.min(Math.floor((l-r)/i),e-1);s[d]++}),s.map((l,d)=>({bin:o[d],count:l}))}function vj(t){if(!t.classes)return[];const e=new Map;return t.train.forEach(r=>{const n=r.label;e.set(n,(e.get(n)||0)+1)}),Array.from(e.entries()).map(([r,n])=>({class:t.classes?t.classes[Number(r)]:String(r),count:n}))}function Ne(t,e=2){if(t==null)return"";const r=typeof t=="string"?Number(t):t;return isFinite(r)?r.toFixed(e).replace(/\.0+$/,"").replace(/(\.\d*?[1-9])0+$/,"$1"):String(t)}function yj({dataset:t}){const e=mj(t);return c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-green-600",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(tn,{className:"w-5 h-5 text-green-900"}),c.jsx("h3",{className:"text-lg font-bold text-green-900",children:"統計情報"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b-2 border-green-300",children:[c.jsx("th",{className:"px-2 py-2 text-left text-green-900",children:"特徴量"}),c.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"平均"}),c.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"中央値"}),c.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"標準偏差"}),c.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"最小値"}),c.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"最大値"})]})}),c.jsx("tbody",{children:e.map((r,n)=>c.jsxs("tr",{className:"border-b border-green-200 hover:bg-green-50",children:[c.jsx("td",{className:"px-2 py-2 font-medium text-green-900",children:r.name}),c.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.mean)}),c.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.median)}),c.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.std)}),c.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.min)}),c.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.max)})]},n))})]})}),c.jsx("div",{className:"mt-4 grid grid-cols-1 gap-3",children:e.map((r,n)=>c.jsxs("div",{className:"bg-green-50 p-3 rounded border border-green-300",children:[c.jsx("div",{className:"text-sm font-medium text-green-900 mb-2",children:r.name}),c.jsxs("div",{className:"relative h-8 bg-green-100 rounded",children:[c.jsx("div",{className:"absolute h-full bg-green-300 rounded-l",style:{left:"0%",width:`${(r.q1-r.min)/(r.max-r.min)*100}%`}}),c.jsx("div",{className:"absolute h-full bg-green-500",style:{left:`${(r.q1-r.min)/(r.max-r.min)*100}%`,width:`${(r.q3-r.q1)/(r.max-r.min)*100}%`}}),c.jsx("div",{className:"absolute h-full bg-green-300 rounded-r",style:{left:`${(r.q3-r.min)/(r.max-r.min)*100}%`,width:`${(r.max-r.q3)/(r.max-r.min)*100}%`}}),c.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-red-600",style:{left:`${(r.mean-r.min)/(r.max-r.min)*100}%`}})]}),c.jsxs("div",{className:"flex justify-between text-xs text-green-700 mt-1",children:[c.jsxs("span",{children:["最小: ",r.min.toFixed(2)]}),c.jsxs("span",{children:["Q1: ",r.q1.toFixed(2)]}),c.jsxs("span",{className:"font-bold text-red-700",children:["平均: ",r.mean.toFixed(2)]}),c.jsxs("span",{children:["Q3: ",r.q3.toFixed(2)]}),c.jsxs("span",{children:["最大: ",r.max.toFixed(2)]})]})]},n))})]})}function Fg(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=Fg(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ee(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=Fg(t))&&(n&&(n+=" "),n+=e);return n}var Do={},$o={},hf;function bj(){return hf||(hf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})($o)),$o}var Ro={},ff;function zg(){return ff||(ff=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(Ro)),Ro}var Lo={},mf;function qg(){return mf||(mf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(Lo)),Lo}var Bo={},pf;function Eu(){return pf||(pf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",o="",l=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const d=r[i];o?d==="\\"&&i+1<a?(i++,s+=r[i]):d===o?o="":s+=d:l?d==='"'||d==="'"?o=d:d==="]"?(l=!1,n.push(s),s=""):s+=d:d==="["?(l=!0,s&&(n.push(s),s="")):d==="."?s&&(n.push(s),s=""):s+=d,i++}return s&&n.push(s),n}t.toPath=e})(Bo)),Bo}var gf;function Cu(){return gf||(gf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=bj(),r=zg(),n=qg(),a=Eu();function i(o,l,d){if(o==null)return d;switch(typeof l){case"string":{if(e.isUnsafeProperty(l))return d;const u=o[l];return u===void 0?r.isDeepKey(l)?i(o,a.toPath(l),d):d:u}case"number":case"symbol":{typeof l=="number"&&(l=n.toKey(l));const u=o[l];return u===void 0?d:u}default:{if(Array.isArray(l))return s(o,l,d);if(Object.is(l?.valueOf(),-0)?l="-0":l=String(l),e.isUnsafeProperty(l))return d;const u=o[l];return u===void 0?d:u}}}function s(o,l,d){if(l.length===0)return d;let u=o;for(let h=0;h<l.length;h++){if(u==null||e.isUnsafeProperty(l[h]))return d;u=u[l[h]]}return u===void 0?d:u}t.get=i})(Do)),Do}var Uo,vf;function xj(){return vf||(vf=1,Uo=Cu().get),Uo}var wj=xj();const rn=ar(wj);var Fo={exports:{}},de={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yf;function _j(){if(yf)return de;yf=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function g(p){if(typeof p=="object"&&p!==null){var y=p.$$typeof;switch(y){case t:switch(p=p.type,p){case r:case a:case n:case l:case d:case f:return p;default:switch(p=p&&p.$$typeof,p){case s:case o:case h:case u:return p;case i:return p;default:return y}}case e:return y}}}return de.ContextConsumer=i,de.ContextProvider=s,de.Element=t,de.ForwardRef=o,de.Fragment=r,de.Lazy=h,de.Memo=u,de.Portal=e,de.Profiler=a,de.StrictMode=n,de.Suspense=l,de.SuspenseList=d,de.isContextConsumer=function(p){return g(p)===i},de.isContextProvider=function(p){return g(p)===s},de.isElement=function(p){return typeof p=="object"&&p!==null&&p.$$typeof===t},de.isForwardRef=function(p){return g(p)===o},de.isFragment=function(p){return g(p)===r},de.isLazy=function(p){return g(p)===h},de.isMemo=function(p){return g(p)===u},de.isPortal=function(p){return g(p)===e},de.isProfiler=function(p){return g(p)===a},de.isStrictMode=function(p){return g(p)===n},de.isSuspense=function(p){return g(p)===l},de.isSuspenseList=function(p){return g(p)===d},de.isValidElementType=function(p){return typeof p=="string"||typeof p=="function"||p===r||p===a||p===n||p===l||p===d||typeof p=="object"&&p!==null&&(p.$$typeof===h||p.$$typeof===u||p.$$typeof===s||p.$$typeof===i||p.$$typeof===o||p.$$typeof===m||p.getModuleId!==void 0)},de.typeOf=g,de}var bf;function jj(){return bf||(bf=1,Fo.exports=_j()),Fo.exports}var Sj=jj(),Ue=t=>t===0?0:t>0?1:-1,ut=t=>typeof t=="number"&&t!=+t,Hr=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,q=t=>(typeof t=="number"||t instanceof Number)&&!ut(t),Dt=t=>q(t)||typeof t=="string",Nj=0,Aa=t=>{var e=++Nj;return"".concat(t||"").concat(e)},Ye=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!q(e)&&typeof e!="string")return n;var i;if(Hr(e)){if(r==null)return n;var s=e.indexOf("%");i=r*parseFloat(e.slice(0,s))/100}else i=+e;return ut(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},Wg=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[t[n]])r[t[n]]=!0;else return!0;return!1},fi=(t,e)=>q(t)&&q(e)?r=>t+r*(e-t):()=>e;function we(t,e,r){return q(t)&&q(e)?t+r*(e-t):e}function Kg(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):rn(n,e))===r)}var Pj=t=>{if(!t||!t.length)return null;for(var e=t.length,r=0,n=0,a=0,i=0,s=1/0,o=-1/0,l=0,d=0,u=0;u<e;u++)l=t[u].cx||0,d=t[u].cy||0,r+=l,n+=d,a+=l*d,i+=l*l,s=Math.min(s,l),o=Math.max(o,l);var h=e*i!==r*r?(e*a-r*n)/(e*i-r*r):0;return{xmin:s,xmax:o,a:h,b:(n-h*r)/e}},le=t=>t===null||typeof t>"u",za=t=>le(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),kj=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Tu(t){if(typeof t!="string")return!1;var e=kj;return e.includes(t)}var Mj=["viewBox","children"],xf=["points","pathLength"],zo={svg:Mj,polygon:xf,polyline:xf},Iu=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(v.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{Tu(a)&&(n[a]=(i=>r[a](r,i)))}),n},Oj=(t,e,r)=>n=>(t(e,r,n),null),Vn=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var i=t[a];Tu(a)&&typeof i=="function"&&(n||(n={}),n[a]=Oj(i,e,r))}),n},Aj=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Vg(t){if(typeof t!="string")return!1;var e=Aj;return e.includes(t)}function jt(t){var e=Object.entries(t).filter(r=>{var[n]=r;return Vg(n)});return Object.fromEntries(e)}var wf=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",_f=null,qo=null,Hg=t=>{if(t===_f&&Array.isArray(qo))return qo;var e=[];return v.Children.forEach(t,r=>{le(r)||(Sj.isFragment(r)?e=e.concat(Hg(r.props.children)):e.push(r))}),qo=e,_f=t,e};function As(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>wf(a)):n=[wf(e)],Hg(t).forEach(a=>{var i=rn(a,"type.displayName")||rn(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var Gg=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,Ej=(t,e,r,n)=>{var a;if(typeof e=="symbol"||typeof e=="number")return!0;var i=(a=n&&zo?.[n])!==null&&a!==void 0?a:[],s=e.startsWith("data-"),o=typeof t!="function"&&(!!n&&i.includes(e)||Vg(e)),l=!!r&&Tu(e);return s||o||l},ye=(t,e,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(v.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;Ej((s=n)===null||s===void 0?void 0:s[i],i,e,r)&&(a[i]=n[i])}),a},Cj=["children","width","height","viewBox","className","style","title","desc"];function kc(){return kc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kc.apply(null,arguments)}function Tj(t,e){if(t==null)return{};var r,n,a=Ij(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Ij(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Du=v.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:o,title:l,desc:d}=t,u=Tj(t,Cj),h=i||{width:n,height:a,x:0,y:0},f=ee("recharts-surface",s);return v.createElement("svg",kc({},ye(u,!0,"svg"),{className:f,width:n,height:a,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:e}),v.createElement("title",null,l),v.createElement("desc",null,d),r)}),Dj=["children","className"];function Mc(){return Mc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mc.apply(null,arguments)}function $j(t,e){if(t==null)return{};var r,n,a=Rj(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Rj(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _e=v.forwardRef((t,e)=>{var{children:r,className:n}=t,a=$j(t,Dj),i=ee("recharts-layer",n);return v.createElement("g",Mc({className:i},ye(a,!0),{ref:e}),r)}),Yg=mg(),Jg=v.createContext(null),Lj=()=>v.useContext(Jg);function me(t){return function(){return t}}const Xg=Math.cos,Ui=Math.sin,At=Math.sqrt,Fi=Math.PI,Es=2*Fi,Oc=Math.PI,Ac=2*Oc,zr=1e-6,Bj=Ac-zr;function Zg(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function Uj(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Zg;const r=10**e;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class Fj{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Zg:Uj(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,i,s){this._append`C${+e},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(e,r,n,a,i){if(e=+e,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,l=n-e,d=a-r,u=s-e,h=o-r,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(f>zr)if(!(Math.abs(h*l-d*u)>zr)||!i)this._append`L${this._x1=e},${this._y1=r}`;else{let m=n-s,g=a-o,p=l*l+d*d,y=m*m+g*g,b=Math.sqrt(p),x=Math.sqrt(f),w=i*Math.tan((Oc-Math.acos((p+f-y)/(2*b*x)))/2),_=w/x,S=w/b;Math.abs(_-1)>zr&&this._append`L${e+_*u},${r+_*h}`,this._append`A${i},${i},0,0,${+(h*m>u*g)},${this._x1=e+S*l},${this._y1=r+S*d}`}}arc(e,r,n,a,i,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),l=n*Math.sin(a),d=e+o,u=r+l,h=1^s,f=s?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>zr||Math.abs(this._y1-u)>zr)&&this._append`L${d},${u}`,n&&(f<0&&(f=f%Ac+Ac),f>Bj?this._append`A${n},${n},0,1,${h},${e-o},${r-l}A${n},${n},0,1,${h},${this._x1=d},${this._y1=u}`:f>zr&&this._append`A${n},${n},0,${+(f>=Oc)},${h},${this._x1=e+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function $u(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new Fj(e)}function Ru(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Qg(t){this._context=t}Qg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Cs(t){return new Qg(t)}function ev(t){return t[0]}function tv(t){return t[1]}function rv(t,e){var r=me(!0),n=null,a=Cs,i=null,s=$u(o);t=typeof t=="function"?t:t===void 0?ev:me(t),e=typeof e=="function"?e:e===void 0?tv:me(e);function o(l){var d,u=(l=Ru(l)).length,h,f=!1,m;for(n==null&&(i=a(m=s())),d=0;d<=u;++d)!(d<u&&r(h=l[d],d,l))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+t(h,d,l),+e(h,d,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(t=typeof l=="function"?l:me(+l),o):t},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:me(+l),o):e},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:me(!!l),o):r},o.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),o):a},o.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),o):n},o}function mi(t,e,r){var n=null,a=me(!0),i=null,s=Cs,o=null,l=$u(d);t=typeof t=="function"?t:t===void 0?ev:me(+t),e=typeof e=="function"?e:me(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?tv:me(+r);function d(h){var f,m,g,p=(h=Ru(h)).length,y,b=!1,x,w=new Array(p),_=new Array(p);for(i==null&&(o=s(x=l())),f=0;f<=p;++f){if(!(f<p&&a(y=h[f],f,h))===b)if(b=!b)m=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),g=f-1;g>=m;--g)o.point(w[g],_[g]);o.lineEnd(),o.areaEnd()}b&&(w[f]=+t(y,f,h),_[f]=+e(y,f,h),o.point(n?+n(y,f,h):w[f],r?+r(y,f,h):_[f]))}if(x)return o=null,x+""||null}function u(){return rv().defined(a).curve(s).context(i)}return d.x=function(h){return arguments.length?(t=typeof h=="function"?h:me(+h),n=null,d):t},d.x0=function(h){return arguments.length?(t=typeof h=="function"?h:me(+h),d):t},d.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:me(+h),d):n},d.y=function(h){return arguments.length?(e=typeof h=="function"?h:me(+h),r=null,d):e},d.y0=function(h){return arguments.length?(e=typeof h=="function"?h:me(+h),d):e},d.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:me(+h),d):r},d.lineX0=d.lineY0=function(){return u().x(t).y(e)},d.lineY1=function(){return u().x(t).y(r)},d.lineX1=function(){return u().x(n).y(e)},d.defined=function(h){return arguments.length?(a=typeof h=="function"?h:me(!!h),d):a},d.curve=function(h){return arguments.length?(s=h,i!=null&&(o=s(i)),d):s},d.context=function(h){return arguments.length?(h==null?i=o=null:o=s(i=h),d):i},d}class nv{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function zj(t){return new nv(t,!0)}function qj(t){return new nv(t,!1)}const Lu={draw(t,e){const r=At(e/Fi);t.moveTo(r,0),t.arc(0,0,r,0,Es)}},Wj={draw(t,e){const r=At(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},av=At(1/3),Kj=av*2,Vj={draw(t,e){const r=At(e/Kj),n=r*av;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},Hj={draw(t,e){const r=At(e),n=-r/2;t.rect(n,n,r,r)}},Gj=.8908130915292852,iv=Ui(Fi/10)/Ui(7*Fi/10),Yj=Ui(Es/10)*iv,Jj=-Xg(Es/10)*iv,Xj={draw(t,e){const r=At(e*Gj),n=Yj*r,a=Jj*r;t.moveTo(0,-r),t.lineTo(n,a);for(let i=1;i<5;++i){const s=Es*i/5,o=Xg(s),l=Ui(s);t.lineTo(l*r,-o*r),t.lineTo(o*n-l*a,l*n+o*a)}t.closePath()}},Wo=At(3),Zj={draw(t,e){const r=-At(e/(Wo*3));t.moveTo(0,r*2),t.lineTo(-Wo*r,-r),t.lineTo(Wo*r,-r),t.closePath()}},pt=-.5,gt=At(3)/2,Ec=1/At(12),Qj=(Ec/2+1)*3,eS={draw(t,e){const r=At(e/Qj),n=r/2,a=r*Ec,i=n,s=r*Ec+r,o=-i,l=s;t.moveTo(n,a),t.lineTo(i,s),t.lineTo(o,l),t.lineTo(pt*n-gt*a,gt*n+pt*a),t.lineTo(pt*i-gt*s,gt*i+pt*s),t.lineTo(pt*o-gt*l,gt*o+pt*l),t.lineTo(pt*n+gt*a,pt*a-gt*n),t.lineTo(pt*i+gt*s,pt*s-gt*i),t.lineTo(pt*o+gt*l,pt*l-gt*o),t.closePath()}};function tS(t,e){let r=null,n=$u(a);t=typeof t=="function"?t:me(t||Lu),e=typeof e=="function"?e:me(e===void 0?64:+e);function a(){let i;if(r||(r=i=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(t=typeof i=="function"?i:me(i),a):t},a.size=function(i){return arguments.length?(e=typeof i=="function"?i:me(+i),a):e},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function zi(){}function qi(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function sv(t){this._context=t}sv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:qi(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:qi(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function rS(t){return new sv(t)}function ov(t){this._context=t}ov.prototype={areaStart:zi,areaEnd:zi,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:qi(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function nS(t){return new ov(t)}function lv(t){this._context=t}lv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:qi(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function aS(t){return new lv(t)}function cv(t){this._context=t}cv.prototype={areaStart:zi,areaEnd:zi,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function iS(t){return new cv(t)}function jf(t){return t<0?-1:1}function Sf(t,e,r){var n=t._x1-t._x0,a=e-t._x1,i=(t._y1-t._y0)/(n||a<0&&-0),s=(r-t._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(jf(i)+jf(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function Nf(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function Ko(t,e,r){var n=t._x0,a=t._y0,i=t._x1,s=t._y1,o=(i-n)/3;t._context.bezierCurveTo(n+o,a+o*e,i-o,s-o*r,i,s)}function Wi(t){this._context=t}Wi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ko(this,this._t0,Nf(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Ko(this,Nf(this,r=Sf(this,t,e)),r);break;default:Ko(this,this._t0,r=Sf(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function uv(t){this._context=new dv(t)}(uv.prototype=Object.create(Wi.prototype)).point=function(t,e){Wi.prototype.point.call(this,e,t)};function dv(t){this._context=t}dv.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,i){this._context.bezierCurveTo(e,t,n,r,i,a)}};function sS(t){return new Wi(t)}function oS(t){return new uv(t)}function hv(t){this._context=t}hv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=Pf(t),a=Pf(e),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Pf(t){var e,r=t.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,i[e]=4,s[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/i[e-1],i[e]-=n,s[e]-=n*s[e-1];for(a[r-1]=s[r-1]/i[r-1],e=r-2;e>=0;--e)a[e]=(s[e]-a[e+1])/i[e];for(i[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)i[e]=2*t[e+1]-a[e+1];return[a,i]}function lS(t){return new hv(t)}function Ts(t,e){this._context=t,this._t=e}Ts.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function cS(t){return new Ts(t,.5)}function uS(t){return new Ts(t,0)}function dS(t){return new Ts(t,1)}function Dn(t,e){if((s=t.length)>1)for(var r=1,n,a,i=t[e[0]],s,o=i.length;r<s;++r)for(a=i,i=t[e[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Cc(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function hS(t,e){return t[e]}function fS(t){const e=[];return e.key=t,e}function mS(){var t=me([]),e=Cc,r=Dn,n=hS;function a(i){var s=Array.from(t.apply(this,arguments),fS),o,l=s.length,d=-1,u;for(const h of i)for(o=0,++d;o<l;++o)(s[o][d]=[0,+n(h,s[o].key,d,i)]).data=h;for(o=0,u=Ru(e(s));o<l;++o)s[u[o]].index=o;return r(s,u),s}return a.keys=function(i){return arguments.length?(t=typeof i=="function"?i:me(Array.from(i)),a):t},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:me(+i),a):n},a.order=function(i){return arguments.length?(e=i==null?Cc:typeof i=="function"?i:me(Array.from(i)),a):e},a.offset=function(i){return arguments.length?(r=i??Dn,a):r},a}function pS(t,e){if((n=t.length)>0){for(var r,n,a=0,i=t[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=t[r][a][1]||0;if(s)for(r=0;r<n;++r)t[r][a][1]/=s}Dn(t,e)}}function gS(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Dn(t,e)}}function vS(t,e){if(!(!((s=t.length)>0)||!((i=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,l=0,d=0;o<s;++o){for(var u=t[e[o]],h=u[n][1]||0,f=u[n-1][1]||0,m=(h-f)/2,g=0;g<o;++g){var p=t[e[g]],y=p[n][1]||0,b=p[n-1][1]||0;m+=y-b}l+=h,d+=m*h}a[n-1][1]+=a[n-1][0]=r,l&&(r-=d/l)}a[n-1][1]+=a[n-1][0]=r,Dn(t,e)}}var yS=["type","size","sizeType"];function Tc(){return Tc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Tc.apply(null,arguments)}function kf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Mf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kf(Object(r),!0).forEach(function(n){bS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kf(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bS(t,e,r){return(e=xS(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xS(t){var e=wS(t,"string");return typeof e=="symbol"?e:e+""}function wS(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _S(t,e){if(t==null)return{};var r,n,a=jS(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function jS(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var fv={symbolCircle:Lu,symbolCross:Wj,symbolDiamond:Vj,symbolSquare:Hj,symbolStar:Xj,symbolTriangle:Zj,symbolWye:eS},SS=Math.PI/180,NS=t=>{var e="symbol".concat(za(t));return fv[e]||Lu},PS=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*SS;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},kS=(t,e)=>{fv["symbol".concat(za(t))]=e},Is=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=_S(t,yS),i=Mf(Mf({},a),{},{type:e,size:r,sizeType:n}),s="circle";typeof e=="string"&&(s=e);var o=()=>{var f=NS(s),m=tS().type(f).size(PS(r,n,s));return m()},{className:l,cx:d,cy:u}=i,h=ye(i,!0);return d===+d&&u===+u&&r===+r?v.createElement("path",Tc({},h,{className:ee("recharts-symbols",l),transform:"translate(".concat(d,", ").concat(u,")"),d:o()})):null};Is.registerSymbol=kS;function Ic(){return Ic=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ic.apply(null,arguments)}function Of(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function MS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Of(Object(r),!0).forEach(function(n){Bu(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Of(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Bu(t,e,r){return(e=OS(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OS(t){var e=AS(t,"string");return typeof e=="symbol"?e:e+""}function AS(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vt=32;class Uu extends v.PureComponent{renderIcon(e,r){var{inactiveColor:n}=this.props,a=vt/2,i=vt/6,s=vt/3,o=e.inactive?n:e.color,l=r??e.type;if(l==="none")return null;if(l==="plainline")return v.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:a,x2:vt,y2:a,className:"recharts-legend-icon"});if(l==="line")return v.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(vt,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(l==="rect")return v.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(vt/8,"h").concat(vt,"v").concat(vt*3/4,"h").concat(-vt,"z"),className:"recharts-legend-icon"});if(v.isValidElement(e.legendIcon)){var d=MS({},e);return delete d.legendIcon,v.cloneElement(e.legendIcon,d)}return v.createElement(Is,{fill:o,cx:a,cy:a,size:vt,sizeType:"diameter",type:l})}renderItems(){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,o={x:0,y:0,width:vt,height:vt},l={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((u,h)=>{var f=u.formatter||a,m=ee({"recharts-legend-item":!0,["legend-item-".concat(h)]:!0,inactive:u.inactive});if(u.type==="none")return null;var g=u.inactive?i:u.color,p=f?f(u.value,u,h):u.value;return v.createElement("li",Ic({className:m,style:l,key:"legend-item-".concat(h)},Vn(this.props,u,h)),v.createElement(Du,{width:r,height:r,viewBox:o,style:d,"aria-label":"".concat(p," legend icon")},this.renderIcon(u,s)),v.createElement("span",{className:"recharts-legend-item-text",style:{color:g}},p))})}render(){var{payload:e,layout:r,align:n}=this.props;if(!e||!e.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return v.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}Bu(Uu,"displayName","Legend");Bu(Uu,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Vo={},Ho={},Af;function ES(){return Af||(Af=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],o=n(s);a.has(o)||a.set(o,s)}return Array.from(a.values())}t.uniqBy=e})(Ho)),Ho}var Go={},Ef;function mv(){return Ef||(Ef=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(Go)),Go}var Yo={},Jo={},Xo={},Cf;function CS(){return Cf||(Cf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(Xo)),Xo}var Tf;function Fu(){return Tf||(Tf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=CS();function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(Jo)),Jo}var Zo={},If;function TS(){return If||(If=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(Zo)),Zo}var Df;function IS(){return Df||(Df=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Fu(),r=TS();function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(Yo)),Yo}var Qo={},el={},$f;function DS(){return $f||($f=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cu();function r(n){return function(a){return e.get(a,n)}}t.property=r})(el)),el}var tl={},rl={},nl={},al={},Rf;function pv(){return Rf||(Rf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(al)),al}var il={},Lf;function gv(){return Lf||(Lf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(il)),il}var sl={},Bf;function vv(){return Bf||(Bf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(sl)),sl}var Uf;function $S(){return Uf||(Uf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zu(),r=pv(),n=gv(),a=vv();function i(h,f,m){return typeof m!="function"?e.isMatch(h,f):s(h,f,function g(p,y,b,x,w,_){const S=m(p,y,b,x,w,_);return S!==void 0?!!S:s(p,y,g,_)},new Map)}function s(h,f,m,g){if(f===h)return!0;switch(typeof f){case"object":return o(h,f,m,g);case"function":return Object.keys(f).length>0?s(h,{...f},m,g):a.eq(h,f);default:return r.isObject(h)?typeof f=="string"?f==="":!0:a.eq(h,f)}}function o(h,f,m,g){if(f==null)return!0;if(Array.isArray(f))return d(h,f,m,g);if(f instanceof Map)return l(h,f,m,g);if(f instanceof Set)return u(h,f,m,g);const p=Object.keys(f);if(h==null)return p.length===0;if(p.length===0)return!0;if(g&&g.has(f))return g.get(f)===h;g&&g.set(f,h);try{for(let y=0;y<p.length;y++){const b=p[y];if(!n.isPrimitive(h)&&!(b in h)||f[b]===void 0&&h[b]!==void 0||f[b]===null&&h[b]!==null||!m(h[b],f[b],b,h,f,g))return!1}return!0}finally{g&&g.delete(f)}}function l(h,f,m,g){if(f.size===0)return!0;if(!(h instanceof Map))return!1;for(const[p,y]of f.entries()){const b=h.get(p);if(m(b,y,p,h,f,g)===!1)return!1}return!0}function d(h,f,m,g){if(f.length===0)return!0;if(!Array.isArray(h))return!1;const p=new Set;for(let y=0;y<f.length;y++){const b=f[y];let x=!1;for(let w=0;w<h.length;w++){if(p.has(w))continue;const _=h[w];let S=!1;if(m(_,b,y,h,f,g)&&(S=!0),S){p.add(w),x=!0;break}}if(!x)return!1}return!0}function u(h,f,m,g){return f.size===0?!0:h instanceof Set?d([...h],[...f],m,g):!1}t.isMatchWith=i,t.isSetMatch=u})(nl)),nl}var Ff;function zu(){return Ff||(Ff=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$S();function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(rl)),rl}var ol={},ll={},cl={},zf;function RS(){return zf||(zf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(cl)),cl}var ul={},qf;function yv(){return qf||(qf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(ul)),ul}var dl={},Wf;function bv(){return Wf||(Wf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",o="[object Date]",l="[object Map]",d="[object Set]",u="[object Array]",h="[object Function]",f="[object ArrayBuffer]",m="[object Object]",g="[object Error]",p="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",x="[object Uint16Array]",w="[object Uint32Array]",_="[object BigUint64Array]",S="[object Int8Array]",j="[object Int16Array]",N="[object Int32Array]",M="[object BigInt64Array]",O="[object Float32Array]",C="[object Float64Array]";t.argumentsTag=i,t.arrayBufferTag=f,t.arrayTag=u,t.bigInt64ArrayTag=M,t.bigUint64ArrayTag=_,t.booleanTag=a,t.dataViewTag=p,t.dateTag=o,t.errorTag=g,t.float32ArrayTag=O,t.float64ArrayTag=C,t.functionTag=h,t.int16ArrayTag=j,t.int32ArrayTag=N,t.int8ArrayTag=S,t.mapTag=l,t.numberTag=n,t.objectTag=m,t.regexpTag=e,t.setTag=d,t.stringTag=r,t.symbolTag=s,t.uint16ArrayTag=x,t.uint32ArrayTag=w,t.uint8ArrayTag=y,t.uint8ClampedArrayTag=b})(dl)),dl}var hl={},Kf;function LS(){return Kf||(Kf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(hl)),hl}var Vf;function xv(){return Vf||(Vf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=RS(),r=yv(),n=bv(),a=gv(),i=LS();function s(u,h){return o(u,void 0,u,new Map,h)}function o(u,h,f,m=new Map,g=void 0){const p=g?.(u,h,f,m);if(p!==void 0)return p;if(a.isPrimitive(u))return u;if(m.has(u))return m.get(u);if(Array.isArray(u)){const y=new Array(u.length);m.set(u,y);for(let b=0;b<u.length;b++)y[b]=o(u[b],b,f,m,g);return Object.hasOwn(u,"index")&&(y.index=u.index),Object.hasOwn(u,"input")&&(y.input=u.input),y}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const y=new RegExp(u.source,u.flags);return y.lastIndex=u.lastIndex,y}if(u instanceof Map){const y=new Map;m.set(u,y);for(const[b,x]of u)y.set(b,o(x,b,f,m,g));return y}if(u instanceof Set){const y=new Set;m.set(u,y);for(const b of u)y.add(o(b,void 0,f,m,g));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(i.isTypedArray(u)){const y=new(Object.getPrototypeOf(u)).constructor(u.length);m.set(u,y);for(let b=0;b<u.length;b++)y[b]=o(u[b],b,f,m,g);return y}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const y=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return m.set(u,y),l(y,u,f,m,g),y}if(typeof File<"u"&&u instanceof File){const y=new File([u],u.name,{type:u.type});return m.set(u,y),l(y,u,f,m,g),y}if(u instanceof Blob){const y=new Blob([u],{type:u.type});return m.set(u,y),l(y,u,f,m,g),y}if(u instanceof Error){const y=new u.constructor;return m.set(u,y),y.message=u.message,y.name=u.name,y.stack=u.stack,y.cause=u.cause,l(y,u,f,m,g),y}if(typeof u=="object"&&d(u)){const y=Object.create(Object.getPrototypeOf(u));return m.set(u,y),l(y,u,f,m,g),y}return u}function l(u,h,f=u,m,g){const p=[...Object.keys(h),...e.getSymbols(h)];for(let y=0;y<p.length;y++){const b=p[y],x=Object.getOwnPropertyDescriptor(u,b);(x==null||x.writable)&&(u[b]=o(h[b],b,f,m,g))}}function d(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=s,t.cloneDeepWithImpl=o,t.copyProperties=l})(ll)),ll}var Hf;function BS(){return Hf||(Hf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xv();function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(ol)),ol}var Gf;function US(){return Gf||(Gf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zu(),r=BS();function n(a){return a=r.cloneDeep(a),i=>e.isMatch(i,a)}t.matches=n})(tl)),tl}var fl={},ml={},pl={},Yf;function FS(){return Yf||(Yf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xv(),r=bv();function n(a,i){return e.cloneDeepWith(a,(s,o,l,d)=>{const u=i?.(s,o,l,d);if(u!==void 0)return u;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new a.constructor(a?.valueOf());return e.copyProperties(h,a),h}case r.argumentsTag:{const h={};return e.copyProperties(h,a),h.length=a.length,h[Symbol.iterator]=a[Symbol.iterator],h}default:return}})}t.cloneDeepWith=n})(pl)),pl}var Jf;function zS(){return Jf||(Jf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=FS();function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(ml)),ml}var gl={},vl={},Xf;function wv(){return Xf||(Xf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(vl)),vl}var yl={},Zf;function qS(){return Zf||(Zf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yv();function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(yl)),yl}var Qf;function WS(){return Qf||(Qf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zg(),r=wv(),n=qS(),a=Eu();function i(s,o){let l;if(Array.isArray(o)?l=o:typeof o=="string"&&e.isDeepKey(o)&&s?.[o]==null?l=a.toPath(o):l=[o],l.length===0)return!1;let d=s;for(let u=0;u<l.length;u++){const h=l[u];if((d==null||!Object.hasOwn(d,h))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(h)&&h<d.length))return!1;d=d[h]}return!0}t.has=i})(gl)),gl}var em;function KS(){return em||(em=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zu(),r=qg(),n=zS(),a=Cu(),i=WS();function s(o,l){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return l=n.cloneDeep(l),function(d){const u=a.get(d,o);return u===void 0?i.has(d,o):l===void 0?u===void 0:e.isMatch(u,l)}}t.matchesProperty=s})(fl)),fl}var tm;function VS(){return tm||(tm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=mv(),r=DS(),n=US(),a=KS();function i(s){if(s==null)return e.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}t.iteratee=i})(Qo)),Qo}var rm;function HS(){return rm||(rm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ES(),r=mv(),n=IS(),a=VS();function i(s,o=r.identity){return n.isArrayLikeObject(s)?e.uniqBy(Array.from(s),a.iteratee(o)):[]}t.uniqBy=i})(Vo)),Vo}var bl,nm;function GS(){return nm||(nm=1,bl=HS().uniqBy),bl}var YS=GS();const am=ar(YS);function _v(t,e,r){return e===!0?am(t,r):typeof e=="function"?am(t,e):t}var xl={exports:{}},wl={},_l={exports:{}},jl={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var im;function JS(){if(im)return jl;im=1;var t=Ps();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,a=t.useEffect,i=t.useLayoutEffect,s=t.useDebugValue;function o(h,f){var m=f(),g=n({inst:{value:m,getSnapshot:f}}),p=g[0].inst,y=g[1];return i(function(){p.value=m,p.getSnapshot=f,l(p)&&y({inst:p})},[h,m,f]),a(function(){return l(p)&&y({inst:p}),h(function(){l(p)&&y({inst:p})})},[h]),s(m),m}function l(h){var f=h.getSnapshot;h=h.value;try{var m=f();return!r(h,m)}catch{return!0}}function d(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:o;return jl.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,jl}var sm;function XS(){return sm||(sm=1,_l.exports=JS()),_l.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var om;function ZS(){if(om)return wl;om=1;var t=Ps(),e=XS();function r(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var n=typeof Object.is=="function"?Object.is:r,a=e.useSyncExternalStore,i=t.useRef,s=t.useEffect,o=t.useMemo,l=t.useDebugValue;return wl.useSyncExternalStoreWithSelector=function(d,u,h,f,m){var g=i(null);if(g.current===null){var p={hasValue:!1,value:null};g.current=p}else p=g.current;g=o(function(){function b(j){if(!x){if(x=!0,w=j,j=f(j),m!==void 0&&p.hasValue){var N=p.value;if(m(N,j))return _=N}return _=j}if(N=_,n(w,j))return N;var M=f(j);return m!==void 0&&m(N,M)?(w=j,N):(w=j,_=M)}var x=!1,w,_,S=h===void 0?null:h;return[function(){return b(u())},S===null?void 0:function(){return b(S())}]},[u,h,f,m]);var y=a(d,g[0],g[1]);return s(function(){p.hasValue=!0,p.value=y},[y]),l(y),y},wl}var lm;function QS(){return lm||(lm=1,xl.exports=ZS()),xl.exports}var eN=QS(),qu=v.createContext(null),tN=t=>t,be=()=>{var t=v.useContext(qu);return t?t.store.dispatch:tN},Ti=()=>{},rN=()=>Ti,nN=(t,e)=>t===e;function F(t){var e=v.useContext(qu);return eN.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:rN,e?e.store.getState:Ti,e?e.store.getState:Ti,e?t:Ti,nN)}function aN(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function iN(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function sN(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var cm=t=>Array.isArray(t)?t:[t];function oN(t){const e=Array.isArray(t[0])?t[0]:t;return sN(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function lN(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var cN=class{constructor(t){this.value=t}deref(){return this.value}},uN=typeof WeakRef<"u"?WeakRef:cN,dN=0,um=1;function pi(){return{s:dN,v:void 0,o:null,p:null}}function jv(t,e={}){let r=pi();const{resultEqualityCheck:n}=e;let a,i=0;function s(){let o=r;const{length:l}=arguments;for(let h=0,f=l;h<f;h++){const m=arguments[h];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const p=g.get(m);p===void 0?(o=pi(),g.set(m,o)):o=p}else{let g=o.p;g===null&&(o.p=g=new Map);const p=g.get(m);p===void 0?(o=pi(),g.set(m,o)):o=p}}const d=o;let u;if(o.s===um)u=o.v;else if(u=t.apply(null,arguments),i++,n){const h=a?.deref?.()??a;h!=null&&n(h,u)&&(u=h,i!==0&&i--),a=typeof u=="object"&&u!==null||typeof u=="function"?new uN(u):u}return d.s=um,d.v=u,u}return s.clearCache=()=>{r=pi(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function hN(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let i=0,s=0,o,l={},d=a.pop();typeof d=="object"&&(l=d,d=a.pop()),aN(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...l},{memoize:h,memoizeOptions:f=[],argsMemoize:m=jv,argsMemoizeOptions:g=[]}=u,p=cm(f),y=cm(g),b=oN(a),x=h(function(){return i++,d.apply(null,arguments)},...p),w=m(function(){s++;const S=lN(b,arguments);return o=x.apply(null,S),o},...y);return Object.assign(w,{resultFunc:d,memoizedResultFunc:x,dependencies:b,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var A=hN(jv),fN=Object.assign((t,e=A)=>{iN(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(i=>t[i]);return e(n,(...i)=>i.reduce((s,o,l)=>(s[r[l]]=o,s),{}))},{withTypes:()=>fN}),Sl={},Nl={},Pl={},dm;function mN(){return dm||(dm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=e(n),o=e(a);if(s===o&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?o-s:s-o}return 0};t.compareValues=r})(Pl)),Pl}var kl={},Ml={},hm;function Sv(){return hm||(hm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Ml)),Ml}var fm;function pN(){return fm||(fm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Sv(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||e.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}t.isKey=a})(kl)),kl}var mm;function gN(){return mm||(mm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=mN(),r=pN(),n=Eu();function a(i,s,o,l){if(i==null)return[];o=l?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(m=>String(m));const d=(m,g)=>{let p=m;for(let y=0;y<g.length&&p!=null;++y)p=p[g[y]];return p},u=(m,g)=>g==null||m==null?g:typeof m=="object"&&"key"in m?Object.hasOwn(g,m.key)?g[m.key]:d(g,m.path):typeof m=="function"?m(g):Array.isArray(m)?d(g,m):typeof g=="object"?g[m]:g,h=s.map(m=>(Array.isArray(m)&&m.length===1&&(m=m[0]),m==null||typeof m=="function"||Array.isArray(m)||r.isKey(m)?m:{key:m,path:n.toPath(m)}));return i.map(m=>({original:m,criteria:h.map(g=>u(g,m))})).slice().sort((m,g)=>{for(let p=0;p<h.length;p++){const y=e.compareValues(m.criteria[p],g.criteria[p],o[p]);if(y!==0)return y}return 0}).map(m=>m.original)}t.orderBy=a})(Nl)),Nl}var Ol={},pm;function vN(){return pm||(pm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],i=Math.floor(n),s=(o,l)=>{for(let d=0;d<o.length;d++){const u=o[d];Array.isArray(u)&&l<i?s(u,l+1):a.push(u)}};return s(r,0),a}t.flatten=e})(Ol)),Ol}var Al={},gm;function Nv(){return gm||(gm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wv(),r=Fu(),n=pv(),a=vv();function i(s,o,l){return n.isObject(l)&&(typeof o=="number"&&r.isArrayLike(l)&&e.isIndex(o)&&o<l.length||typeof o=="string"&&o in l)?a.eq(l[o],s):!1}t.isIterateeCall=i})(Al)),Al}var vm;function yN(){return vm||(vm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=gN(),r=vN(),n=Nv();function a(i,...s){const o=s.length;return o>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),e.orderBy(i,r.flatten(s),["asc"])}t.sortBy=a})(Sl)),Sl}var El,ym;function bN(){return ym||(ym=1,El=yN().sortBy),El}var xN=bN();const Ds=ar(xN);var Pv=t=>t.legend.settings,wN=t=>t.legend.size,_N=t=>t.legend.payload,jN=A([_N,Pv],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?Ds(n,r):n});function SN(){return F(jN)}var gi=1;function kv(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=v.useState({height:0,left:0,top:0,width:0}),n=v.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-e.height)>gi||Math.abs(s.left-e.left)>gi||Math.abs(s.top-e.top)>gi||Math.abs(s.width-e.width)>gi)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function We(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var NN=typeof Symbol=="function"&&Symbol.observable||"@@observable",bm=NN,Cl=()=>Math.random().toString(36).substring(7).split("").join("."),PN={INIT:`@@redux/INIT${Cl()}`,REPLACE:`@@redux/REPLACE${Cl()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Cl()}`},Ki=PN;function Wu(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Mv(t,e,r){if(typeof t!="function")throw new Error(We(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(We(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(We(1));return r(Mv)(t,e)}let n=t,a=e,i=new Map,s=i,o=0,l=!1;function d(){s===i&&(s=new Map,i.forEach((y,b)=>{s.set(b,y)}))}function u(){if(l)throw new Error(We(3));return a}function h(y){if(typeof y!="function")throw new Error(We(4));if(l)throw new Error(We(5));let b=!0;d();const x=o++;return s.set(x,y),function(){if(b){if(l)throw new Error(We(6));b=!1,d(),s.delete(x),i=null}}}function f(y){if(!Wu(y))throw new Error(We(7));if(typeof y.type>"u")throw new Error(We(8));if(typeof y.type!="string")throw new Error(We(17));if(l)throw new Error(We(9));try{l=!0,a=n(a,y)}finally{l=!1}return(i=s).forEach(x=>{x()}),y}function m(y){if(typeof y!="function")throw new Error(We(10));n=y,f({type:Ki.REPLACE})}function g(){const y=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(We(11));function x(){const _=b;_.next&&_.next(u())}return x(),{unsubscribe:y(x)}},[bm](){return this}}}return f({type:Ki.INIT}),{dispatch:f,subscribe:h,getState:u,replaceReducer:m,[bm]:g}}function kN(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Ki.INIT})>"u")throw new Error(We(12));if(typeof r(void 0,{type:Ki.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(We(13))})}function Ov(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const s=e[i];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let a;try{kN(r)}catch(i){a=i}return function(s={},o){if(a)throw a;let l=!1;const d={};for(let u=0;u<n.length;u++){const h=n[u],f=r[h],m=s[h],g=f(m,o);if(typeof g>"u")throw o&&o.type,new Error(We(14));d[h]=g,l=l||g!==m}return l=l||n.length!==Object.keys(s).length,l?d:s}}function Vi(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function MN(...t){return e=>(r,n)=>{const a=e(r,n);let i=()=>{throw new Error(We(15))};const s={getState:a.getState,dispatch:(l,...d)=>i(l,...d)},o=t.map(l=>l(s));return i=Vi(...o)(a.dispatch),{...a,dispatch:i}}}function Av(t){return Wu(t)&&"type"in t&&typeof t.type=="string"}var Ev=Symbol.for("immer-nothing"),xm=Symbol.for("immer-draftable"),dt=Symbol.for("immer-state");function Mt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var $n=Object.getPrototypeOf;function nn(t){return!!t&&!!t[dt]}function Qt(t){return t?Cv(t)||Array.isArray(t)||!!t[xm]||!!t.constructor?.[xm]||qa(t)||Rs(t):!1}var ON=Object.prototype.constructor.toString();function Cv(t){if(!t||typeof t!="object")return!1;const e=$n(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===ON}function Hi(t,e){$s(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function $s(t){const e=t[dt];return e?e.type_:Array.isArray(t)?1:qa(t)?2:Rs(t)?3:0}function Dc(t,e){return $s(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Tv(t,e,r){const n=$s(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function AN(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function qa(t){return t instanceof Map}function Rs(t){return t instanceof Set}function qr(t){return t.copy_||t.base_}function $c(t,e){if(qa(t))return new Map(t);if(Rs(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Cv(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[dt];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create($n(t),n)}else{const n=$n(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function Ku(t,e=!1){return Ls(t)||nn(t)||!Qt(t)||($s(t)>1&&Object.defineProperties(t,{set:{value:vi},add:{value:vi},clear:{value:vi},delete:{value:vi}}),Object.freeze(t),e&&Object.values(t).forEach(r=>Ku(r,!0))),t}function vi(){Mt(2)}function Ls(t){return Object.isFrozen(t)}var EN={};function an(t){const e=EN[t];return e||Mt(0,t),e}var Ea;function Iv(){return Ea}function CN(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function wm(t,e){e&&(an("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Rc(t){Lc(t),t.drafts_.forEach(TN),t.drafts_=null}function Lc(t){t===Ea&&(Ea=t.parent_)}function _m(t){return Ea=CN(Ea,t)}function TN(t){const e=t[dt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function jm(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[dt].modified_&&(Rc(e),Mt(4)),Qt(t)&&(t=Gi(e,t),e.parent_||Yi(e,t)),e.patches_&&an("Patches").generateReplacementPatches_(r[dt].base_,t,e.patches_,e.inversePatches_)):t=Gi(e,r,[]),Rc(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Ev?t:void 0}function Gi(t,e,r){if(Ls(e))return e;const n=e[dt];if(!n)return Hi(e,(a,i)=>Sm(t,n,e,a,i,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return Yi(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),Hi(i,(o,l)=>Sm(t,n,a,o,l,r,s)),Yi(t,a,!1),r&&t.patches_&&an("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function Sm(t,e,r,n,a,i,s){if(nn(a)){const o=i&&e&&e.type_!==3&&!Dc(e.assigned_,n)?i.concat(n):void 0,l=Gi(t,a,o);if(Tv(r,n,l),nn(l))t.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Qt(a)&&!Ls(a)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Gi(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(qa(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&Yi(t,a)}}function Yi(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ku(e,r)}function IN(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:Iv(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=Vu;r&&(a=[n],i=Ca);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var Vu={get(t,e){if(e===dt)return t;const r=qr(t);if(!Dc(r,e))return DN(t,r,e);const n=r[e];return t.finalized_||!Qt(n)?n:n===Tl(t.base_,e)?(Il(t),t.copy_[e]=Uc(n,t)):n},has(t,e){return e in qr(t)},ownKeys(t){return Reflect.ownKeys(qr(t))},set(t,e,r){const n=Dv(qr(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=Tl(qr(t),e),i=a?.[dt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(AN(r,a)&&(r!==void 0||Dc(t.base_,e)))return!0;Il(t),Bc(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Tl(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Il(t),Bc(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=qr(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Mt(11)},getPrototypeOf(t){return $n(t.base_)},setPrototypeOf(){Mt(12)}},Ca={};Hi(Vu,(t,e)=>{Ca[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ca.deleteProperty=function(t,e){return Ca.set.call(this,t,e,void 0)};Ca.set=function(t,e,r){return Vu.set.call(this,t[0],e,r,t[0])};function Tl(t,e){const r=t[dt];return(r?qr(r):t)[e]}function DN(t,e,r){const n=Dv(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function Dv(t,e){if(!(e in t))return;let r=$n(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=$n(r)}}function Bc(t){t.modified_||(t.modified_=!0,t.parent_&&Bc(t.parent_))}function Il(t){t.copy_||(t.copy_=$c(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var $N=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const s=this;return function(l=i,...d){return s.produce(l,u=>r.call(this,u,...d))}}typeof r!="function"&&Mt(6),n!==void 0&&typeof n!="function"&&Mt(7);let a;if(Qt(e)){const i=_m(this),s=Uc(e,void 0);let o=!0;try{a=r(s),o=!1}finally{o?Rc(i):Lc(i)}return wm(i,n),jm(a,i)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===Ev&&(a=void 0),this.autoFreeze_&&Ku(a,!0),n){const i=[],s=[];an("Patches").generateReplacementPatches_(e,a,i,s),n(i,s)}return a}else Mt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,l=>e(l,...o));let n,a;return[this.produce(e,r,(s,o)=>{n=s,a=o}),n,a]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Qt(t)||Mt(8),nn(t)&&(t=Yt(t));const e=_m(this),r=Uc(t,void 0);return r[dt].isManual_=!0,Lc(e),r}finishDraft(t,e){const r=t&&t[dt];(!r||!r.isManual_)&&Mt(9);const{scope_:n}=r;return wm(n,e),jm(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=an("Patches").applyPatches_;return nn(t)?n(t,e):this.produce(t,a=>n(a,e))}};function Uc(t,e){const r=qa(t)?an("MapSet").proxyMap_(t,e):Rs(t)?an("MapSet").proxySet_(t,e):IN(t,e);return(e?e.scope_:Iv()).drafts_.push(r),r}function Yt(t){return nn(t)||Mt(10,t),$v(t)}function $v(t){if(!Qt(t)||Ls(t))return t;const e=t[dt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=$c(t,e.scope_.immer_.useStrictShallowCopy_)}else r=$c(t,!0);return Hi(r,(n,a)=>{Tv(r,n,$v(a))}),e&&(e.finalized_=!1),r}var RN=new $N,Rv=RN.produce;function Lv(t){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,t):a(i)}var LN=Lv(),BN=Lv,UN=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Vi:Vi.apply(null,arguments)};function wt(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(ct(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Av(n)&&n.type===t,r}var Bv=class ga extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ga.prototype)}static get[Symbol.species](){return ga}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ga(...e[0].concat(this)):new ga(...e.concat(this))}};function Nm(t){return Qt(t)?Rv(t,()=>{}):t}function yi(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function FN(t){return typeof t=="boolean"}var zN=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=e??{};let s=new Bv;return r&&(FN(r)?s.push(LN):s.push(BN(r.extraArgument))),s},qN="RTK_autoBatch",Pm=t=>e=>{setTimeout(e,t)},WN=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,i=!1,s=!1;const o=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Pm(10):t.type==="callback"?t.queueNotification:Pm(t.timeout),d=()=>{s=!1,i&&(i=!1,o.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>a&&u(),f=n.subscribe(h);return o.add(u),()=>{f(),o.delete(u)}},dispatch(u){try{return a=!u?.meta?.[qN],i=!a,i&&(s||(s=!0,l(d))),n.dispatch(u)}finally{a=!0}}})},KN=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new Bv(t);return n&&a.push(WN(typeof n=="object"?n:void 0)),a};function VN(t){const e=zN(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(Wu(r))o=Ov(r);else throw new Error(ct(1));let l;typeof n=="function"?l=n(e):l=e();let d=Vi;a&&(d=UN({trace:!1,...typeof a=="object"&&a}));const u=MN(...l),h=KN(u);let f=typeof s=="function"?s(h):h();const m=d(...f);return Mv(o,i,m)}function Uv(t){const e={},r=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(ct(28));if(o in e)throw new Error(ct(29));return e[o]=s,a},addAsyncThunk(i,s){return s.pending&&(e[i.pending.type]=s.pending),s.rejected&&(e[i.rejected.type]=s.rejected),s.fulfilled&&(e[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return t(a),[e,r,n]}function HN(t){return typeof t=="function"}function GN(t,e){let[r,n,a]=Uv(e),i;if(HN(t))i=()=>Nm(t());else{const o=Nm(t);i=()=>o}function s(o=i(),l){let d=[r[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,h)=>{if(h)if(nn(u)){const m=h(u,l);return m===void 0?u:m}else{if(Qt(u))return Rv(u,f=>h(f,l));{const f=h(u,l);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},o)}return s.getInitialState=i,s}var YN="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",JN=(t=21)=>{let e="",r=t;for(;r--;)e+=YN[Math.random()*64|0];return e},XN=Symbol.for("rtk-slice-createasyncthunk");function ZN(t,e){return`${t}/${e}`}function QN({creators:t}={}){const e=t?.asyncThunk?.[XN];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(ct(11));const s=(typeof n.reducers=="function"?n.reducers(tP()):n.reducers)||{},o=Object.keys(s),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,_){const S=typeof w=="string"?w:w.type;if(!S)throw new Error(ct(12));if(S in l.sliceCaseReducersByType)throw new Error(ct(13));return l.sliceCaseReducersByType[S]=_,d},addMatcher(w,_){return l.sliceMatchers.push({matcher:w,reducer:_}),d},exposeAction(w,_){return l.actionCreators[w]=_,d},exposeCaseReducer(w,_){return l.sliceCaseReducersByName[w]=_,d}};o.forEach(w=>{const _=s[w],S={reducerName:w,type:ZN(a,w),createNotation:typeof n.reducers=="function"};nP(_)?iP(S,_,d,e):rP(S,_,d)});function u(){const[w={},_=[],S=void 0]=typeof n.extraReducers=="function"?Uv(n.extraReducers):[n.extraReducers],j={...w,...l.sliceCaseReducersByType};return GN(n.initialState,N=>{for(let M in j)N.addCase(M,j[M]);for(let M of l.sliceMatchers)N.addMatcher(M.matcher,M.reducer);for(let M of _)N.addMatcher(M.matcher,M.reducer);S&&N.addDefaultCase(S)})}const h=w=>w,f=new Map,m=new WeakMap;let g;function p(w,_){return g||(g=u()),g(w,_)}function y(){return g||(g=u()),g.getInitialState()}function b(w,_=!1){function S(N){let M=N[w];return typeof M>"u"&&_&&(M=yi(m,S,y)),M}function j(N=h){const M=yi(f,_,()=>new WeakMap);return yi(M,N,()=>{const O={};for(const[C,P]of Object.entries(n.selectors??{}))O[C]=eP(P,N,()=>yi(m,N,y),_);return O})}return{reducerPath:w,getSelectors:j,get selectors(){return j(S)},selectSlice:S}}const x={name:a,reducer:p,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:y,...b(i),injectInto(w,{reducerPath:_,...S}={}){const j=_??i;return w.inject({reducerPath:j,reducer:p},S),{...x,...b(j,!0)}}};return x}}function eP(t,e,r,n){function a(i,...s){let o=e(i);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return a.unwrapped=t,a}var ft=QN();function tP(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function rP({type:t,reducerName:e,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!aP(n))throw new Error(ct(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,s?wt(t,s):wt(t))}function nP(t){return t._reducerDefinitionType==="asyncThunk"}function aP(t){return t._reducerDefinitionType==="reducerWithPrepare"}function iP({type:t,reducerName:e},r,n,a){if(!a)throw new Error(ct(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:l,settled:d,options:u}=r,h=a(t,i,u);n.exposeAction(e,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),l&&n.addCase(h.rejected,l),d&&n.addMatcher(h.settled,d),n.exposeCaseReducer(e,{fulfilled:s||bi,pending:o||bi,rejected:l||bi,settled:d||bi})}function bi(){}var sP="task",Fv="listener",zv="completed",Hu="cancelled",oP=`task-${Hu}`,lP=`task-${zv}`,Fc=`${Fv}-${Hu}`,cP=`${Fv}-${zv}`,Bs=class{constructor(t){this.code=t,this.message=`${sP} ${Hu} (reason: ${t})`}name="TaskAbortError";message},Gu=(t,e)=>{if(typeof t!="function")throw new TypeError(ct(32))},Ji=()=>{},qv=(t,e=Ji)=>(t.catch(e),t),Wv=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Xr=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Zr=t=>{if(t.aborted){const{reason:e}=t;throw new Bs(e)}};function Kv(t,e){let r=Ji;return new Promise((n,a)=>{const i=()=>a(new Bs(t.reason));if(t.aborted){i();return}r=Wv(t,i),e.finally(()=>r()).then(n,a)}).finally(()=>{r=Ji})}var uP=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Bs?"cancelled":"rejected",error:r}}finally{e?.()}},Xi=t=>e=>qv(Kv(t,e).then(r=>(Zr(t),r))),Vv=t=>{const e=Xi(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:Cn}=Object,km={},Us="listenerMiddleware",dP=(t,e)=>{const r=n=>Wv(t,()=>Xr(n,t.reason));return(n,a)=>{Gu(n);const i=new AbortController;r(i);const s=uP(async()=>{Zr(t),Zr(i.signal);const o=await n({pause:Xi(i.signal),delay:Vv(i.signal),signal:i.signal});return Zr(i.signal),o},()=>Xr(i,lP));return a?.autoJoin&&e.push(s.catch(Ji)),{result:Xi(t)(s),cancel(){Xr(i,oP)}}}},hP=(t,e)=>{const r=async(n,a)=>{Zr(e);let i=()=>{};const o=[new Promise((l,d)=>{let u=t({predicate:n,effect:(h,f)=>{f.unsubscribe(),l([h,f.getState(),f.getOriginalState()])}});i=()=>{u(),d()}})];a!=null&&o.push(new Promise(l=>setTimeout(l,a,null)));try{const l=await Kv(e,Promise.race(o));return Zr(e),l}finally{i()}};return(n,a)=>qv(r(n,a))},Hv=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:i}=t;if(e)a=wt(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(ct(21));return Gu(i),{predicate:a,type:e,effect:i}},Gv=Cn(t=>{const{type:e,predicate:r,effect:n}=Hv(t);return{id:JN(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ct(22))}}},{withTypes:()=>Gv}),Mm=(t,e)=>{const{type:r,effect:n,predicate:a}=Hv(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},zc=t=>{t.pending.forEach(e=>{Xr(e,Fc)})},fP=t=>()=>{t.forEach(zc),t.clear()},Om=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},Yv=Cn(wt(`${Us}/add`),{withTypes:()=>Yv}),mP=wt(`${Us}/removeAll`),Jv=Cn(wt(`${Us}/remove`),{withTypes:()=>Jv}),pP=(...t)=>{console.error(`${Us}/error`,...t)},Wa=(t={})=>{const e=new Map,{extra:r,onError:n=pP}=t;Gu(n);const a=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&zc(u)}),i=u=>{const h=Mm(e,u)??Gv(u);return a(h)};Cn(i,{withTypes:()=>i});const s=u=>{const h=Mm(e,u);return h&&(h.unsubscribe(),u.cancelActive&&zc(h)),!!h};Cn(s,{withTypes:()=>s});const o=async(u,h,f,m)=>{const g=new AbortController,p=hP(i,g.signal),y=[];try{u.pending.add(g),await Promise.resolve(u.effect(h,Cn({},f,{getOriginalState:m,condition:(b,x)=>p(b,x).then(Boolean),take:p,delay:Vv(g.signal),pause:Xi(g.signal),extra:r,signal:g.signal,fork:dP(g.signal,y),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((b,x,w)=>{b!==g&&(Xr(b,Fc),w.delete(b))})},cancel:()=>{Xr(g,Fc),u.pending.delete(g)},throwIfCancelled:()=>{Zr(g.signal)}})))}catch(b){b instanceof Bs||Om(n,b,{raisedBy:"effect"})}finally{await Promise.all(y),Xr(g,cP),u.pending.delete(g)}},l=fP(e);return{middleware:u=>h=>f=>{if(!Av(f))return h(f);if(Yv.match(f))return i(f.payload);if(mP.match(f)){l();return}if(Jv.match(f))return s(f.payload);let m=u.getState();const g=()=>{if(m===km)throw new Error(ct(23));return m};let p;try{if(p=h(f),e.size>0){const y=u.getState(),b=Array.from(e.values());for(const x of b){let w=!1;try{w=x.predicate(f,y,m)}catch(_){w=!1,Om(n,_,{raisedBy:"predicate"})}w&&o(x,f,u,g)}}}finally{m=km}return p},startListening:i,stopListening:s,clearListeners:l}};function ct(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var gP={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Xv=ft({name:"chartLayout",initialState:gP,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,i;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(i=e.payload.left)!==null&&i!==void 0?i:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:vP,setLayout:yP,setChartSize:bP,setScale:xP}=Xv.actions,wP=Xv.reducer;function Am(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Em(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Am(Object(r),!0).forEach(function(n){_P(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Am(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _P(t,e,r){return(e=jP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jP(t){var e=SP(t,"string");return typeof e=="symbol"?e:e+""}function SP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Zi=Math.PI/180,NP=t=>t*180/Math.PI,ke=(t,e,r,n)=>({x:t+Math.cos(-Zi*n)*r,y:e+Math.sin(-Zi*n)*r}),Zv=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},PP=(t,e)=>{var{x:r,y:n}=t,{x:a,y:i}=e;return Math.sqrt((r-a)**2+(n-i)**2)},kP=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:i}=e,s=PP({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var o=(r-a)/s,l=Math.acos(o);return n>i&&(l=2*Math.PI-l),{radius:s,angle:NP(l),angleInRadian:l}},MP=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:e-i*360,endAngle:r-i*360}},OP=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return t+s*360},AP=(t,e)=>{var{x:r,y:n}=t,{radius:a,angle:i}=kP({x:r,y:n},e),{innerRadius:s,outerRadius:o}=e;if(a<s||a>o||a===0)return null;var{startAngle:l,endAngle:d}=MP(e),u=i,h;if(l<=d){for(;u>d;)u-=360;for(;u<l;)u+=360;h=u>=l&&u<=d}else{for(;u>l;)u-=360;for(;u<d;)u+=360;h=u>=d&&u<=l}return h?Em(Em({},e),{},{radius:a,angle:OP(u,e)}):null};function Qv(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Cm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cm(Object(r),!0).forEach(function(n){EP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EP(t,e,r){return(e=CP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CP(t){var e=TP(t,"string");return typeof e=="symbol"?e:e+""}function TP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ie(t,e,r){return le(t)||le(e)?r:Dt(e)?rn(t,e,r):typeof e=="function"?e(t):r}var IP=(t,e,r,n,a)=>{var i,s=-1,o=(i=e?.length)!==null&&i!==void 0?i:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var d=l>0?r[l-1].coordinate:r[o-1].coordinate,u=r[l].coordinate,h=l>=o-1?r[0].coordinate:r[l+1].coordinate,f=void 0;if(Ue(u-d)!==Ue(h-u)){var m=[];if(Ue(h-u)===Ue(a[1]-a[0])){f=h;var g=u+a[1]-a[0];m[0]=Math.min(g,(g+d)/2),m[1]=Math.max(g,(g+d)/2)}else{f=d;var p=h+a[1]-a[0];m[0]=Math.min(u,(p+u)/2),m[1]=Math.max(u,(p+u)/2)}var y=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(t>y[0]&&t<=y[1]||t>=m[0]&&t<=m[1]){({index:s}=r[l]);break}}else{var b=Math.min(d,h),x=Math.max(d,h);if(t>(b+u)/2&&t<=(x+u)/2){({index:s}=r[l]);break}}}else if(e){for(var w=0;w<o;w++)if(w===0&&t<=(e[w].coordinate+e[w+1].coordinate)/2||w>0&&w<o-1&&t>(e[w].coordinate+e[w-1].coordinate)/2&&t<=(e[w].coordinate+e[w+1].coordinate)/2||w===o-1&&t>(e[w].coordinate+e[w-1].coordinate)/2){({index:s}=e[w]);break}}return s},DP=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:o}=e;if((o==="vertical"||o==="horizontal"&&s==="middle")&&i!=="center"&&q(t[i]))return bt(bt({},t),{},{[i]:t[i]+(n||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&s!=="middle"&&q(t[s]))return bt(bt({},t),{},{[s]:t[s]+(a||0)})}return t},Er=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",ey=(t,e,r,n)=>{if(n)return t.map(o=>o.coordinate);var a,i,s=t.map(o=>(o.coordinate===e&&(a=!0),o.coordinate===r&&(i=!0),o.coordinate));return a||s.push(e),i||s.push(r),s},ty=(t,e,r)=>{if(!t)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:o,isCategorical:l,categoricalDomain:d,tickCount:u,ticks:h,niceTicks:f,axisType:m}=t;if(!s)return null;var g=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,p=a==="category"&&s.bandwidth?s.bandwidth()/g:0;if(p=m==="angleAxis"&&i&&i.length>=2?Ue(i[0]-i[1])*2*p:p,h||f){var y=(h||f||[]).map((b,x)=>{var w=n?n.indexOf(b):b;return{coordinate:s(w)+p,value:b,offset:p,index:x}});return y.filter(b=>!ut(b.coordinate))}return l&&d?d.map((b,x)=>({coordinate:s(b)+p,value:b,index:x,offset:p})):s.ticks&&u!=null?s.ticks(u).map((b,x)=>({coordinate:s(b)+p,value:b,offset:p,index:x})):s.domain().map((b,x)=>({coordinate:s(b)+p,value:n?n[b]:b,index:x,offset:p}))},Tm=1e-4,$P=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-Tm,i=Math.max(n[0],n[1])+Tm,s=t(e[0]),o=t(e[r-1]);(s<a||s>i||o<a||o>i)&&t.domain([e[0],e[r-1]])}},RP=(t,e)=>{if(!e||e.length!==2||!q(e[0])||!q(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!q(t[0])||t[0]<r)&&(a[0]=r),(!q(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},LP=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var a=0,i=0,s=0;s<e;++s){var o=ut(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1]):(t[s][r][0]=i,t[s][r][1]=i+o,i=t[s][r][1])}},BP=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var a=0,i=0;i<e;++i){var s=ut(t[i][r][1])?t[i][r][0]:t[i][r][1];s>=0?(t[i][r][0]=a,t[i][r][1]=a+s,a=t[i][r][1]):(t[i][r][0]=0,t[i][r][1]=0)}},UP={sign:LP,expand:pS,none:Dn,silhouette:gS,wiggle:vS,positive:BP},FP=(t,e,r)=>{var n=UP[r],a=mS().keys(e).value((i,s)=>+ie(i,s,0)).order(Cc).offset(n);return a(t)};function zP(t){return t==null?void 0:String(t)}function Qi(t){var{axis:e,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!le(a[e.dataKey])){var o=Kg(r,"value",a[e.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var l=ie(a,le(s)?e.dataKey:s);return le(l)?null:e.scale(l)}var Im=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:i,index:s}=t;if(e.type==="category")return r[s]?r[s].coordinate+n:null;var o=ie(i,e.dataKey,e.scale.domain()[s]);return le(o)?null:e.scale(o)-a/2+n},qP=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},WP=t=>{var e=t.flat(2).filter(q);return[Math.min(...e),Math.max(...e)]},KP=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],VP=(t,e,r)=>{if(t!=null)return KP(Object.keys(t).reduce((n,a)=>{var i=t[a],{stackedData:s}=i,o=s.reduce((l,d)=>{var u=Qv(d,e,r),h=WP(u);return[Math.min(l[0],h[0]),Math.max(l[1],h[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Dm=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,$m=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ta=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=Ds(e,u=>u.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var l=a[s],d=a[s-1];i=Math.min((l.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Rm(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:i}=t;return bt(bt({},e),{},{dataKey:r,payload:n,value:a,name:i})}function Cr(t,e){if(t)return String(t);if(typeof e=="string")return e}function HP(t,e,r,n,a){if(r==="horizontal"||r==="vertical"){var i=t>=a.left&&t<=a.left+a.width&&e>=a.top&&e<=a.top+a.height;return i?{x:t,y:e}:null}return n?AP({x:t,y:e},n):null}var GP=(t,e,r,n)=>{var a=e.find(d=>d&&d.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.y};if(t==="vertical")return{x:n.x,y:a.coordinate};if(t==="centric"){var i=a.coordinate,{radius:s}=n;return bt(bt(bt({},n),ke(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:l}=n;return bt(bt(bt({},n),ke(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}},YP=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,ir=t=>t.layout.width,sr=t=>t.layout.height,JP=t=>t.layout.scale,ry=t=>t.layout.margin,Fs=A(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),zs=A(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),Yu="data-recharts-item-index",Ju="data-recharts-item-data-key",Ka=60;function Lm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function xi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lm(Object(r),!0).forEach(function(n){XP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XP(t,e,r){return(e=ZP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZP(t){var e=QP(t,"string");return typeof e=="symbol"?e:e+""}function QP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ek=t=>t.brush.height;function tk(t){var e=zs(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Ka;return r+a}return r},0)}function rk(t){var e=zs(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Ka;return r+a}return r},0)}function nk(t){var e=Fs(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function ak(t){var e=Fs(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ce=A([ir,sr,ry,ek,tk,rk,nk,ak,Pv,wN],(t,e,r,n,a,i,s,o,l,d)=>{var u={left:(r.left||0)+a,right:(r.right||0)+i},h={top:(r.top||0)+s,bottom:(r.bottom||0)+o},f=xi(xi({},h),u),m=f.bottom;f.bottom+=n,f=DP(f,l,d);var g=t-f.left-f.right,p=e-f.top-f.bottom;return xi(xi({brushBottom:m},f),{},{width:Math.max(g,0),height:Math.max(p,0)})}),ik=A(Ce,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),Xu=A(ir,sr,(t,e)=>({x:0,y:0,width:t,height:e})),sk=v.createContext(null),Je=()=>v.useContext(sk)!=null,qs=t=>t.brush,Ws=A([qs,Ce,ry],(t,e,r)=>({height:t.height,x:q(t.x)?t.x:e.left,y:q(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:q(t.width)?t.width:e.width})),Ks=()=>{var t,e=Je(),r=F(ik),n=F(Ws),a=(t=F(qs))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},ok={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},ny=()=>{var t;return(t=F(Ce))!==null&&t!==void 0?t:ok},Zu=()=>F(ir),Qu=()=>F(sr),lk=()=>F(t=>t.layout.margin),Q=t=>t.layout.layoutType,Vs=()=>F(Q),ck={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},ay=ft({name:"legend",initialState:ck,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var r=Yt(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)}}}),{setLegendSize:Bm,setLegendSettings:uk,addLegendPayload:iy,removeLegendPayload:sy}=ay.actions,dk=ay.reducer,hk=["contextPayload"];function qc(){return qc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qc.apply(null,arguments)}function Um(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Rn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Um(Object(r),!0).forEach(function(n){ed(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Um(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ed(t,e,r){return(e=fk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fk(t){var e=mk(t,"string");return typeof e=="symbol"?e:e+""}function mk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pk(t,e){if(t==null)return{};var r,n,a=gk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function gk(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function vk(t){return t.value}function yk(t){var{contextPayload:e}=t,r=pk(t,hk),n=_v(e,t.payloadUniqBy,vk),a=Rn(Rn({},r),{},{payload:n});return v.isValidElement(t.content)?v.cloneElement(t.content,a):typeof t.content=="function"?v.createElement(t.content,a):v.createElement(Uu,a)}function bk(t,e,r,n,a,i){var{layout:s,align:o,verticalAlign:l}=e,d,u;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(o==="center"&&s==="vertical"?d={left:((n||0)-i.width)/2}:d=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(l==="middle"?u={top:((a||0)-i.height)/2}:u=l==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Rn(Rn({},d),u)}function xk(t){var e=be();return v.useEffect(()=>{e(uk(t))},[e,t]),null}function wk(t){var e=be();return v.useEffect(()=>(e(Bm(t)),()=>{e(Bm({width:0,height:0}))}),[e,t]),null}function _k(t){var e=SN(),r=Lj(),n=lk(),{width:a,height:i,wrapperStyle:s,portal:o}=t,[l,d]=kv([e]),u=Zu(),h=Qu();if(u==null||h==null)return null;var f=u-(n.left||0)-(n.right||0),m=Hs.getWidthOrHeight(t.layout,i,a,f),g=o?s:Rn(Rn({position:"absolute",width:m?.width||a||"auto",height:m?.height||i||"auto"},bk(s,t,n,u,h,l)),s),p=o??r;if(p==null)return null;var y=v.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},v.createElement(xk,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),v.createElement(wk,{width:l.width,height:l.height}),v.createElement(yk,qc({},t,m,{margin:n,chartWidth:u,chartHeight:h,contextPayload:e})));return Yg.createPortal(y,p)}class Hs extends v.PureComponent{static getWidthOrHeight(e,r,n,a){return e==="vertical"&&q(r)?{height:r}:e==="horizontal"?{width:n||a}:null}render(){return v.createElement(_k,this.props)}}ed(Hs,"displayName","Legend");ed(Hs,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Wc(){return Wc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wc.apply(null,arguments)}function Fm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Dl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fm(Object(r),!0).forEach(function(n){jk(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jk(t,e,r){return(e=Sk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sk(t){var e=Nk(t,"string");return typeof e=="symbol"?e:e+""}function Nk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pk(t){return Array.isArray(t)&&Dt(t[0])&&Dt(t[1])?t.join(" ~ "):t}var kk=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:l,labelClassName:d,label:u,labelFormatter:h,accessibilityLayer:f=!1}=t,m=()=>{if(i&&i.length){var S={padding:0,margin:0},j=(o?Ds(i,o):i).map((N,M)=>{if(N.type==="none")return null;var O=N.formatter||s||Pk,{value:C,name:P}=N,k=C,D=P;if(O){var I=O(C,P,N,M,i);if(Array.isArray(I))[k,D]=I;else if(I!=null)k=I;else return null}var W=Dl({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},n);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:W},Dt(D)?v.createElement("span",{className:"recharts-tooltip-item-name"},D):null,Dt(D)?v.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,v.createElement("span",{className:"recharts-tooltip-item-value"},k),v.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:S},j)}return null},g=Dl({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=Dl({margin:0},a),y=!le(u),b=y?u:"",x=ee("recharts-default-tooltip",l),w=ee("recharts-tooltip-label",d);y&&h&&i!==void 0&&i!==null&&(b=h(u,i));var _=f?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",Wc({className:x,style:g},_),v.createElement("p",{className:w,style:p},v.isValidElement(b)?b:"".concat(b)),m())},oa="recharts-tooltip-wrapper",Mk={visibility:"hidden"};function Ok(t){var{coordinate:e,translateX:r,translateY:n}=t;return ee(oa,{["".concat(oa,"-right")]:q(r)&&e&&q(e.x)&&r>=e.x,["".concat(oa,"-left")]:q(r)&&e&&q(e.x)&&r<e.x,["".concat(oa,"-bottom")]:q(n)&&e&&q(e.y)&&n>=e.y,["".concat(oa,"-top")]:q(n)&&e&&q(e.y)&&n<e.y})}function zm(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:l,viewBoxDimension:d}=t;if(i&&q(i[n]))return i[n];var u=r[n]-o-(a>0?a:0),h=r[n]+a;if(e[n])return s[n]?u:h;var f=l[n];if(f==null)return 0;if(s[n]){var m=u,g=f;return m<g?Math.max(h,f):Math.max(u,f)}if(d==null)return 0;var p=h+o,y=f+d;return p>y?Math.max(u,f):Math.max(h,f)}function Ak(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function Ek(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:o,viewBox:l}=t,d,u,h;return s.height>0&&s.width>0&&r?(u=zm({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),h=zm({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),d=Ak({translateX:u,translateY:h,useTranslate3d:o})):d=Mk,{cssProperties:d,cssClasses:Ok({translateX:u,translateY:h,coordinate:r})}}function qm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qm(Object(r),!0).forEach(function(n){Kc(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kc(t,e,r){return(e=Ck(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ck(t){var e=Tk(t,"string");return typeof e=="symbol"?e:e+""}function Tk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ik extends v.PureComponent{constructor(){super(...arguments),Kc(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Kc(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:o,isAnimationActive:l,offset:d,position:u,reverseDirection:h,useTranslate3d:f,viewBox:m,wrapperStyle:g,lastBoundingBox:p,innerRef:y,hasPortalFromProps:b}=this.props,{cssClasses:x,cssProperties:w}=Ek({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:d,position:u,reverseDirection:h,tooltipBox:{height:p.height,width:p.width},useTranslate3d:f,viewBox:m}),_=b?{}:wi(wi({transition:l&&e?"transform ".concat(n,"ms ").concat(a):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),S=wi(wi({},_),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},g);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:x,style:S,ref:y},i)}}var Dk=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),or={devToolsEnabled:!1,isSsr:Dk()},oy=()=>F(t=>t.rootProps.accessibilityLayer);function ht(t){return Number.isFinite(t)}function Ln(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function Vc(){return Vc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vc.apply(null,arguments)}function Wm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Km(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wm(Object(r),!0).forEach(function(n){$k(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $k(t,e,r){return(e=Rk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rk(t){var e=Lk(t,"string");return typeof e=="symbol"?e:e+""}function Lk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vm={curveBasisClosed:nS,curveBasisOpen:aS,curveBasis:rS,curveBumpX:zj,curveBumpY:qj,curveLinearClosed:iS,curveLinear:Cs,curveMonotoneX:sS,curveMonotoneY:oS,curveNatural:lS,curveStep:cS,curveStepAfter:dS,curveStepBefore:uS},_i=t=>ht(t.x)&&ht(t.y),la=t=>t.x,ca=t=>t.y,Bk=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(za(t));return(r==="curveMonotone"||r==="curveBump")&&e?Vm["".concat(r).concat(e==="vertical"?"Y":"X")]:Vm[r]||Cs},Uk=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=t,s=Bk(e,a),o=i?r.filter(_i):r,l;if(Array.isArray(n)){var d=i?n.filter(h=>_i(h)):n,u=o.map((h,f)=>Km(Km({},h),{},{base:d[f]}));return a==="vertical"?l=mi().y(ca).x1(la).x0(h=>h.base.x):l=mi().x(la).y1(ca).y0(h=>h.base.y),l.defined(_i).curve(s),l(u)}return a==="vertical"&&q(n)?l=mi().y(ca).x1(la).x0(n):q(n)?l=mi().x(la).y1(ca).y0(n):l=rv().x(la).y(ca),l.defined(_i).curve(s),l(o)},Gs=t=>{var{className:e,points:r,path:n,pathRef:a}=t;if((!r||!r.length)&&!n)return null;var i=r&&r.length?Uk(t):n;return v.createElement("path",Vc({},jt(t),Iu(t),{className:ee("recharts-curve",e),d:i===null?void 0:i,ref:a}))},Fk=["x","y","top","left","width","height","className"];function Hc(){return Hc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hc.apply(null,arguments)}function Hm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hm(Object(r),!0).forEach(function(n){qk(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Hm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qk(t,e,r){return(e=Wk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wk(t){var e=Kk(t,"string");return typeof e=="symbol"?e:e+""}function Kk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vk(t,e){if(t==null)return{};var r,n,a=Hk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Hk(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Gk=(t,e,r,n,a,i)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(i,",").concat(e,"h").concat(r),Yk=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:o}=t,l=Vk(t,Fk),d=zk({x:e,y:r,top:n,left:a,width:i,height:s},l);return!q(e)||!q(r)||!q(i)||!q(s)||!q(n)||!q(a)?null:v.createElement("path",Hc({},ye(d,!0),{className:ee("recharts-cross",o),d:Gk(e,r,i,s,n,a)}))};function Jk(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function Gm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Xk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gm(Object(r),!0).forEach(function(n){Zk(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zk(t,e,r){return(e=Qk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qk(t){var e=eM(t,"string");return typeof e=="symbol"?e:e+""}function eM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Te(t,e){var r=Xk({},t),n=e,a=Object.keys(e),i=a.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return i}function tM(){}function Ym(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ym(Object(r),!0).forEach(function(n){rM(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ym(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rM(t,e,r){return(e=nM(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nM(t){var e=aM(t,"string");return typeof e=="symbol"?e:e+""}function aM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var iM=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),ly=(t,e,r)=>t.map(n=>"".concat(iM(n)," ").concat(e,"ms ").concat(r)).join(","),sM=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),Ia=(t,e)=>Object.keys(e).reduce((r,n)=>Jm(Jm({},r),{},{[n]:t(n,e[n])}),{});function Xm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ke(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xm(Object(r),!0).forEach(function(n){oM(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oM(t,e,r){return(e=lM(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lM(t){var e=cM(t,"string");return typeof e=="symbol"?e:e+""}function cM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var es=(t,e,r)=>t+(e-t)*r,Gc=t=>{var{from:e,to:r}=t;return e!==r},cy=(t,e,r)=>{var n=Ia((a,i)=>{if(Gc(i)){var[s,o]=t(i.from,i.to,i.velocity);return Ke(Ke({},i),{},{from:s,velocity:o})}return i},e);return r<1?Ia((a,i)=>Gc(i)?Ke(Ke({},i),{},{velocity:es(i.velocity,n[a].velocity,r),from:es(i.from,n[a].from,r)}):i,e):cy(t,n,r-1)};function uM(t,e,r,n,a,i){var s,o=n.reduce((f,m)=>Ke(Ke({},f),{},{[m]:{from:t[m],velocity:0,to:e[m]}}),{}),l=()=>Ia((f,m)=>m.from,o),d=()=>!Object.values(o).filter(Gc).length,u=null,h=f=>{s||(s=f);var m=f-s,g=m/r.dt;o=cy(r,o,g),a(Ke(Ke(Ke({},t),e),l())),s=f,d()||(u=i.setTimeout(h))};return()=>(u=i.setTimeout(h),()=>{u()})}function dM(t,e,r,n,a,i,s){var o=null,l=a.reduce((h,f)=>Ke(Ke({},h),{},{[f]:[t[f],e[f]]}),{}),d,u=h=>{d||(d=h);var f=(h-d)/n,m=Ia((p,y)=>es(...y,r(f)),l);if(i(Ke(Ke(Ke({},t),e),m)),f<1)o=s.setTimeout(u);else{var g=Ia((p,y)=>es(...y,r(1)),l);i(Ke(Ke(Ke({},t),e),g))}};return()=>(o=s.setTimeout(u),()=>{o()})}const hM=(t,e,r,n,a,i)=>{var s=sM(t,e);return r.isStepper===!0?uM(t,e,r,s,a,i):dM(t,e,r,n,s,a,i)};var ts=1e-4,uy=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],dy=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),Zm=(t,e)=>r=>{var n=uy(t,e);return dy(n,r)},fM=(t,e)=>r=>{var n=uy(t,e),a=[...n.map((i,s)=>i*s).slice(1),0];return dy(a,r)},Qm=function(){for(var e,r,n,a,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[e,n,r,a]=[0,0,1,1];break;case"ease":[e,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[e,n,r,a]=[.42,0,1,1];break;case"ease-out":[e,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[e,n,r,a]=[0,0,.58,1];break;default:{var l=s[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([e,n,r,a]=l[1].split(")")[0].split(",").map(g=>parseFloat(g)))}}else s.length===4&&([e,n,r,a]=s);var d=Zm(e,r),u=Zm(n,a),h=fM(e,r),f=g=>g>1?1:g<0?0:g,m=g=>{for(var p=g>1?1:g,y=p,b=0;b<8;++b){var x=d(y)-p,w=h(y);if(Math.abs(x-p)<ts||w<ts)return u(y);y=f(y-x/w)}return u(y)};return m.isStepper=!1,m},mM=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,i=(s,o,l)=>{var d=-(s-o)*r,u=l*n,h=l+(d-u)*a/1e3,f=l*a/1e3+s;return Math.abs(f-o)<ts&&Math.abs(h)<ts?[o,0]:[f,h]};return i.isStepper=!0,i.dt=a,i},pM=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Qm(t);case"spring":return mM();default:if(t.split("(")[0]==="cubic-bezier")return Qm(t)}return typeof t=="function"?t:null};function gM(t){var e,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[l,...d]=o;if(typeof l=="number"){a=t.setTimeout(i.bind(null,d),l);return}i(l),a=t.setTimeout(i.bind(null,d));return}typeof s=="string"&&(e=s,r(e)),typeof s=="object"&&(e=s,r(e)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>t}}class vM{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?e(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function yM(){return gM(new vM)}var bM=v.createContext(yM);function xM(t,e){var r=v.useContext(bM);return v.useMemo(()=>e??r(t),[t,e,r])}var wM={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},ep={t:0},$l={t:1};function Hn(t){var e=Te(t,wM),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:l,children:d}=e,u=xM(e.animationId,e.animationManager),[h,f]=v.useState(r?ep:$l),m=v.useRef(null);return v.useEffect(()=>{r||f($l)},[r]),v.useEffect(()=>{if(!r||!n)return tM;var g=hM(ep,$l,pM(i),a,f,u.getTimeoutController()),p=()=>{m.current=g()};return u.start([l,s,p,a,o]),()=>{u.stop(),m.current&&m.current(),o()}},[r,n,a,i,s,l,o,u]),d(h.t)}function Gn(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(Aa(e)),n=v.useRef(t);return n.current!==t&&(r.current=Aa(e),n.current=t),r.current}function tp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tp(Object(r),!0).forEach(function(n){_M(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tp(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _M(t,e,r){return(e=jM(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jM(t){var e=SM(t,"string");return typeof e=="symbol"?e:e+""}function SM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rs(){return rs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rs.apply(null,arguments)}var np=(t,e,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var u=[0,0,0,0],h=0,f=4;h<f;h++)u[h]=a[h]>i?i:a[h];d="M".concat(t,",").concat(e+s*u[0]),u[0]>0&&(d+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(l,",").concat(t+o*u[0],",").concat(e)),d+="L ".concat(t+r-o*u[1],",").concat(e),u[1]>0&&(d+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(l,`,
        `).concat(t+r,",").concat(e+s*u[1])),d+="L ".concat(t+r,",").concat(e+n-s*u[2]),u[2]>0&&(d+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(l,`,
        `).concat(t+r-o*u[2],",").concat(e+n)),d+="L ".concat(t+o*u[3],",").concat(e+n),u[3]>0&&(d+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(l,`,
        `).concat(t,",").concat(e+n-s*u[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var m=Math.min(i,a);d="M ".concat(t,",").concat(e+s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t+o*m,",").concat(e,`
            L `).concat(t+r-o*m,",").concat(e,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t+r,",").concat(e+s*m,`
            L `).concat(t+r,",").concat(e+n-s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t+r-o*m,",").concat(e+n,`
            L `).concat(t+o*m,",").concat(e+n,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t,",").concat(e+n-s*m," Z")}else d="M ".concat(t,",").concat(e," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},NM={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hy=t=>{var e=Te(t,NM),r=v.useRef(null),[n,a]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var I=r.current.getTotalLength();I&&a(I)}catch{}},[]);var{x:i,y:s,width:o,height:l,radius:d,className:u}=e,{animationEasing:h,animationDuration:f,animationBegin:m,isAnimationActive:g,isUpdateAnimationActive:p}=e,y=v.useRef(o),b=v.useRef(l),x=v.useRef(i),w=v.useRef(s),_=v.useMemo(()=>({x:i,y:s,width:o,height:l,radius:d}),[i,s,o,l,d]),S=Gn(_,"rectangle-");if(i!==+i||s!==+s||o!==+o||l!==+l||o===0||l===0)return null;var j=ee("recharts-rectangle",u);if(!p)return v.createElement("path",rs({},ye(e,!0),{className:j,d:np(i,s,o,l,d)}));var N=y.current,M=b.current,O=x.current,C=w.current,P="0px ".concat(n===-1?1:n,"px"),k="".concat(n,"px 0px"),D=ly(["strokeDasharray"],f,typeof h=="string"?h:void 0);return v.createElement(Hn,{animationId:S,key:S,canBegin:n>0,duration:f,easing:h,isActive:p,begin:m},I=>{var W=we(N,o,I),V=we(M,l,I),K=we(O,i,I),X=we(C,s,I);r.current&&(y.current=W,b.current=V,x.current=K,w.current=X);var B;return g?I>0?B={transition:D,strokeDasharray:k}:B={strokeDasharray:P}:B={strokeDasharray:k},v.createElement("path",rs({},ye(e,!0),{className:j,d:np(K,X,W,V,d),ref:r,style:rp(rp({},B),e.style)}))})};function fy(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:i}=t,s=ke(e,r,n,a),o=ke(e,r,n,i);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:a,endAngle:i}}function Yc(){return Yc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yc.apply(null,arguments)}var PM=(t,e)=>{var r=Ue(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},ji=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:l}=t,d=o*(s?1:-1)+n,u=Math.asin(o/d)/Zi,h=l?a:a+i*u,f=ke(e,r,d,h),m=ke(e,r,n,h),g=l?a-i*u:a,p=ke(e,r,d*Math.cos(u*Zi),g);return{center:f,circleTangency:m,lineTangency:p,theta:u}},my=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=t,o=PM(i,s),l=i+o,d=ke(e,r,a,i),u=ke(e,r,a,l),h="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>l),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var f=ke(e,r,n,i),m=ke(e,r,n,l);h+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=l),`,
            `).concat(f.x,",").concat(f.y," Z")}else h+="L ".concat(e,",").concat(r," Z");return h},kM=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:l,endAngle:d}=t,u=Ue(d-l),{circleTangency:h,lineTangency:f,theta:m}=ji({cx:e,cy:r,radius:a,angle:l,sign:u,cornerRadius:i,cornerIsExternal:o}),{circleTangency:g,lineTangency:p,theta:y}=ji({cx:e,cy:r,radius:a,angle:d,sign:-u,cornerRadius:i,cornerIsExternal:o}),b=o?Math.abs(l-d):Math.abs(l-d)-m-y;if(b<0)return s?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):my({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:l,endAngle:d});var x="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(u<0),",").concat(g.x,",").concat(g.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
  `);if(n>0){var{circleTangency:w,lineTangency:_,theta:S}=ji({cx:e,cy:r,radius:n,angle:l,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:j,lineTangency:N,theta:M}=ji({cx:e,cy:r,radius:n,angle:d,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),O=o?Math.abs(l-d):Math.abs(l-d)-S-M;if(O<0&&i===0)return"".concat(x,"L").concat(e,",").concat(r,"Z");x+="L".concat(N.x,",").concat(N.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(j.x,",").concat(j.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(O>180),",").concat(+(u>0),",").concat(w.x,",").concat(w.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(_.x,",").concat(_.y,"Z")}else x+="L".concat(e,",").concat(r,"Z");return x},MM={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},py=t=>{var e=Te(t,MM),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:d,endAngle:u,className:h}=e;if(i<a||d===u)return null;var f=ee("recharts-sector",h),m=i-a,g=Ye(s,m,0,!0),p;return g>0&&Math.abs(d-u)<360?p=kM({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(g,m/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:d,endAngle:u}):p=my({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u}),v.createElement("path",Yc({},ye(e,!0),{className:f,d:p}))};function OM(t,e,r){var n,a,i,s;if(t==="horizontal")n=e.x,i=n,a=r.top,s=r.top+r.height;else if(t==="vertical")a=e.y,s=a,n=r.left,i=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:o,cy:l,innerRadius:d,outerRadius:u,angle:h}=e,f=ke(o,l,d,h),m=ke(o,l,u,h);n=f.x,a=f.y,i=m.x,s=m.y}else return fy(e);return[{x:n,y:a},{x:i,y:s}]}var Rl={},Ll={},Bl={},ap;function AM(){return ap||(ap=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Sv();function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(Bl)),Bl}var ip;function EM(){return ip||(ip=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=AM();function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(Ll)),Ll}var sp;function CM(){return sp||(sp=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nv(),r=EM();function n(a,i,s){s&&typeof s!="number"&&e.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((i-a)/(s||1)),0),l=new Array(o);for(let d=0;d<o;d++)l[d]=a,a+=s;return l}t.range=n})(Rl)),Rl}var Ul,op;function TM(){return op||(op=1,Ul=CM().range),Ul}var IM=TM();const gy=ar(IM);function kr(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function DM(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function td(t){let e,r,n;t.length!==2?(e=kr,r=(o,l)=>kr(t(o),l),n=(o,l)=>t(o)-l):(e=t===kr||t===DM?t:$M,r=t,n=t);function a(o,l,d=0,u=o.length){if(d<u){if(e(l,l)!==0)return u;do{const h=d+u>>>1;r(o[h],l)<0?d=h+1:u=h}while(d<u)}return d}function i(o,l,d=0,u=o.length){if(d<u){if(e(l,l)!==0)return u;do{const h=d+u>>>1;r(o[h],l)<=0?d=h+1:u=h}while(d<u)}return d}function s(o,l,d=0,u=o.length){const h=a(o,l,d,u-1);return h>d&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:a,center:s,right:i}}function $M(){return 0}function vy(t){return t===null?NaN:+t}function*RM(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const LM=td(kr),Va=LM.right;td(vy).center;class lp extends Map{constructor(e,r=FM){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(cp(this,e))}has(e){return super.has(cp(this,e))}set(e,r){return super.set(BM(this,e),r)}delete(e){return super.delete(UM(this,e))}}function cp({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function BM({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function UM({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function FM(t){return t!==null&&typeof t=="object"?t.valueOf():t}function zM(t=kr){if(t===kr)return yy;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function yy(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const qM=Math.sqrt(50),WM=Math.sqrt(10),KM=Math.sqrt(2);function ns(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=qM?10:i>=WM?5:i>=KM?2:1;let o,l,d;return a<0?(d=Math.pow(10,-a)/s,o=Math.round(t*d),l=Math.round(e*d),o/d<t&&++o,l/d>e&&--l,d=-d):(d=Math.pow(10,a)*s,o=Math.round(t/d),l=Math.round(e/d),o*d<t&&++o,l*d>e&&--l),l<o&&.5<=r&&r<2?ns(t,e,r*2):[o,l,d]}function Jc(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,i,s]=n?ns(e,t,r):ns(t,e,r);if(!(i>=a))return[];const o=i-a+1,l=new Array(o);if(n)if(s<0)for(let d=0;d<o;++d)l[d]=(i-d)/-s;else for(let d=0;d<o;++d)l[d]=(i-d)*s;else if(s<0)for(let d=0;d<o;++d)l[d]=(a+d)/-s;else for(let d=0;d<o;++d)l[d]=(a+d)*s;return l}function Xc(t,e,r){return e=+e,t=+t,r=+r,ns(t,e,r)[2]}function Zc(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?Xc(e,t,r):Xc(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function up(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function dp(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function by(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?yy:zM(a);n>r;){if(n-r>600){const l=n-r+1,d=e-r+1,u=Math.log(l),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(l-h)/l)*(d-l/2<0?-1:1),m=Math.max(r,Math.floor(e-d*h/l+f)),g=Math.min(n,Math.floor(e+(l-d)*h/l+f));by(t,e,m,g,a)}const i=t[e];let s=r,o=n;for(ua(t,r,e),a(t[n],i)>0&&ua(t,r,n);s<o;){for(ua(t,s,o),++s,--o;a(t[s],i)<0;)++s;for(;a(t[o],i)>0;)--o}a(t[r],i)===0?ua(t,r,o):(++o,ua(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function ua(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function VM(t,e,r){if(t=Float64Array.from(RM(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return dp(t);if(e>=1)return up(t);var n,a=(n-1)*e,i=Math.floor(a),s=up(by(t,i).subarray(0,i+1)),o=dp(t.subarray(i+1));return s+(o-s)*(a-i)}}function HM(t,e,r=vy){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,i=Math.floor(a),s=+r(t[i],i,t),o=+r(t[i+1],i+1,t);return s+(o-s)*(a-i)}}function GM(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,i=new Array(a);++n<a;)i[n]=t+n*r;return i}function St(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function lr(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Qc=Symbol("implicit");function rd(){var t=new lp,e=[],r=[],n=Qc;function a(i){let s=t.get(i);if(s===void 0){if(n!==Qc)return n;t.set(i,s=e.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new lp;for(const s of i)t.has(s)||t.set(s,e.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return rd(e,r).unknown(n)},St.apply(a,arguments),a}function nd(){var t=rd().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,i,s,o=!1,l=0,d=0,u=.5;delete t.unknown;function h(){var f=e().length,m=a<n,g=m?a:n,p=m?n:a;i=(p-g)/Math.max(1,f-l+d*2),o&&(i=Math.floor(i)),g+=(p-g-i*(f-l))*u,s=i*(1-l),o&&(g=Math.round(g),s=Math.round(s));var y=GM(f).map(function(b){return g+i*b});return r(m?y.reverse():y)}return t.domain=function(f){return arguments.length?(e(f),h()):e()},t.range=function(f){return arguments.length?([n,a]=f,n=+n,a=+a,h()):[n,a]},t.rangeRound=function(f){return[n,a]=f,n=+n,a=+a,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(f){return arguments.length?(o=!!f,h()):o},t.padding=function(f){return arguments.length?(l=Math.min(1,d=+f),h()):l},t.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),h()):l},t.paddingOuter=function(f){return arguments.length?(d=+f,h()):d},t.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),h()):u},t.copy=function(){return nd(e(),[n,a]).round(o).paddingInner(l).paddingOuter(d).align(u)},St.apply(h(),arguments)}function xy(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return xy(e())},t}function YM(){return xy(nd.apply(null,arguments).paddingInner(1))}function ad(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function wy(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Ha(){}var Da=.7,as=1/Da,Tn="\\s*([+-]?\\d+)\\s*",$a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",It="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",JM=/^#([0-9a-f]{3,8})$/,XM=new RegExp(`^rgb\\(${Tn},${Tn},${Tn}\\)$`),ZM=new RegExp(`^rgb\\(${It},${It},${It}\\)$`),QM=new RegExp(`^rgba\\(${Tn},${Tn},${Tn},${$a}\\)$`),eO=new RegExp(`^rgba\\(${It},${It},${It},${$a}\\)$`),tO=new RegExp(`^hsl\\(${$a},${It},${It}\\)$`),rO=new RegExp(`^hsla\\(${$a},${It},${It},${$a}\\)$`),hp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ad(Ha,Ra,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fp,formatHex:fp,formatHex8:nO,formatHsl:aO,formatRgb:mp,toString:mp});function fp(){return this.rgb().formatHex()}function nO(){return this.rgb().formatHex8()}function aO(){return _y(this).formatHsl()}function mp(){return this.rgb().formatRgb()}function Ra(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=JM.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?pp(e):r===3?new nt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Si(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Si(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=XM.exec(t))?new nt(e[1],e[2],e[3],1):(e=ZM.exec(t))?new nt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=QM.exec(t))?Si(e[1],e[2],e[3],e[4]):(e=eO.exec(t))?Si(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=tO.exec(t))?yp(e[1],e[2]/100,e[3]/100,1):(e=rO.exec(t))?yp(e[1],e[2]/100,e[3]/100,e[4]):hp.hasOwnProperty(t)?pp(hp[t]):t==="transparent"?new nt(NaN,NaN,NaN,0):null}function pp(t){return new nt(t>>16&255,t>>8&255,t&255,1)}function Si(t,e,r,n){return n<=0&&(t=e=r=NaN),new nt(t,e,r,n)}function iO(t){return t instanceof Ha||(t=Ra(t)),t?(t=t.rgb(),new nt(t.r,t.g,t.b,t.opacity)):new nt}function eu(t,e,r,n){return arguments.length===1?iO(t):new nt(t,e,r,n??1)}function nt(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}ad(nt,eu,wy(Ha,{brighter(t){return t=t==null?as:Math.pow(as,t),new nt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Da:Math.pow(Da,t),new nt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new nt(Qr(this.r),Qr(this.g),Qr(this.b),is(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gp,formatHex:gp,formatHex8:sO,formatRgb:vp,toString:vp}));function gp(){return`#${Gr(this.r)}${Gr(this.g)}${Gr(this.b)}`}function sO(){return`#${Gr(this.r)}${Gr(this.g)}${Gr(this.b)}${Gr((isNaN(this.opacity)?1:this.opacity)*255)}`}function vp(){const t=is(this.opacity);return`${t===1?"rgb(":"rgba("}${Qr(this.r)}, ${Qr(this.g)}, ${Qr(this.b)}${t===1?")":`, ${t})`}`}function is(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Qr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Gr(t){return t=Qr(t),(t<16?"0":"")+t.toString(16)}function yp(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Ot(t,e,r,n)}function _y(t){if(t instanceof Ot)return new Ot(t.h,t.s,t.l,t.opacity);if(t instanceof Ha||(t=Ra(t)),!t)return new Ot;if(t instanceof Ot)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),i=Math.max(e,r,n),s=NaN,o=i-a,l=(i+a)/2;return o?(e===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-e)/o+2:s=(e-r)/o+4,o/=l<.5?i+a:2-i-a,s*=60):o=l>0&&l<1?0:s,new Ot(s,o,l,t.opacity)}function oO(t,e,r,n){return arguments.length===1?_y(t):new Ot(t,e,r,n??1)}function Ot(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}ad(Ot,oO,wy(Ha,{brighter(t){return t=t==null?as:Math.pow(as,t),new Ot(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Da:Math.pow(Da,t),new Ot(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new nt(Fl(t>=240?t-240:t+120,a,n),Fl(t,a,n),Fl(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new Ot(bp(this.h),Ni(this.s),Ni(this.l),is(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=is(this.opacity);return`${t===1?"hsl(":"hsla("}${bp(this.h)}, ${Ni(this.s)*100}%, ${Ni(this.l)*100}%${t===1?")":`, ${t})`}`}}));function bp(t){return t=(t||0)%360,t<0?t+360:t}function Ni(t){return Math.max(0,Math.min(1,t||0))}function Fl(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const id=t=>()=>t;function lO(t,e){return function(r){return t+r*e}}function cO(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function uO(t){return(t=+t)==1?jy:function(e,r){return r-e?cO(e,r,t):id(isNaN(e)?r:e)}}function jy(t,e){var r=e-t;return r?lO(t,r):id(isNaN(t)?e:t)}const xp=(function t(e){var r=uO(e);function n(a,i){var s=r((a=eu(a)).r,(i=eu(i)).r),o=r(a.g,i.g),l=r(a.b,i.b),d=jy(a.opacity,i.opacity);return function(u){return a.r=s(u),a.g=o(u),a.b=l(u),a.opacity=d(u),a+""}}return n.gamma=t,n})(1);function dO(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=t[a]*(1-i)+e[a]*i;return n}}function hO(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fO(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Yn(t[s],e[s]);for(;s<r;++s)i[s]=e[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function mO(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function ss(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function pO(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=Yn(t[a],e[a]):n[a]=e[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var tu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zl=new RegExp(tu.source,"g");function gO(t){return function(){return t}}function vO(t){return function(e){return t(e)+""}}function yO(t,e){var r=tu.lastIndex=zl.lastIndex=0,n,a,i,s=-1,o=[],l=[];for(t=t+"",e=e+"";(n=tu.exec(t))&&(a=zl.exec(e));)(i=a.index)>r&&(i=e.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,l.push({i:s,x:ss(n,a)})),r=zl.lastIndex;return r<e.length&&(i=e.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?vO(l[0].x):gO(e):(e=l.length,function(d){for(var u=0,h;u<e;++u)o[(h=l[u]).i]=h.x(d);return o.join("")})}function Yn(t,e){var r=typeof e,n;return e==null||r==="boolean"?id(e):(r==="number"?ss:r==="string"?(n=Ra(e))?(e=n,xp):yO:e instanceof Ra?xp:e instanceof Date?mO:hO(e)?dO:Array.isArray(e)?fO:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?pO:ss)(t,e)}function sd(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function bO(t,e){e===void 0&&(e=t,t=Yn);for(var r=0,n=e.length-1,a=e[0],i=new Array(n<0?0:n);r<n;)i[r]=t(a,a=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function xO(t){return function(){return t}}function os(t){return+t}var wp=[0,1];function tt(t){return t}function ru(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:xO(isNaN(e)?NaN:.5)}function wO(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function _O(t,e,r){var n=t[0],a=t[1],i=e[0],s=e[1];return a<n?(n=ru(a,n),i=r(s,i)):(n=ru(n,a),i=r(i,s)),function(o){return i(n(o))}}function jO(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),i=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)a[s]=ru(t[s],t[s+1]),i[s]=r(e[s],e[s+1]);return function(o){var l=Va(t,o,1,n)-1;return i[l](a[l](o))}}function Ga(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ys(){var t=wp,e=wp,r=Yn,n,a,i,s=tt,o,l,d;function u(){var f=Math.min(t.length,e.length);return s!==tt&&(s=wO(t[0],t[f-1])),o=f>2?jO:_O,l=d=null,h}function h(f){return f==null||isNaN(f=+f)?i:(l||(l=o(t.map(n),e,r)))(n(s(f)))}return h.invert=function(f){return s(a((d||(d=o(e,t.map(n),ss)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,os),u()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),r=sd,u()},h.clamp=function(f){return arguments.length?(s=f?!0:tt,u()):s!==tt},h.interpolate=function(f){return arguments.length?(r=f,u()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return n=f,a=m,u()}}function od(){return Ys()(tt,tt)}function SO(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ls(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Bn(t){return t=ls(Math.abs(t)),t?t[1]:NaN}function NO(t,e){return function(r,n){for(var a=r.length,i=[],s=0,o=t[0],l=0;a>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),i.push(r.substring(a-=o,a+o)),!((l+=o+1)>n));)o=t[s=(s+1)%t.length];return i.reverse().join(e)}}function PO(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var kO=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function La(t){if(!(e=kO.exec(t)))throw new Error("invalid format: "+t);var e;return new ld({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}La.prototype=ld.prototype;function ld(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ld.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function MO(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var Sy;function OO(t,e){var r=ls(t,e);if(!r)return t+"";var n=r[0],a=r[1],i=a-(Sy=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ls(t,Math.max(0,e+i-1))[0]}function _p(t,e){var r=ls(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const jp={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:SO,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>_p(t*100,e),r:_p,s:OO,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Sp(t){return t}var Np=Array.prototype.map,Pp=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function AO(t){var e=t.grouping===void 0||t.thousands===void 0?Sp:NO(Np.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?Sp:PO(Np.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function d(h){h=La(h);var f=h.fill,m=h.align,g=h.sign,p=h.symbol,y=h.zero,b=h.width,x=h.comma,w=h.precision,_=h.trim,S=h.type;S==="n"?(x=!0,S="g"):jp[S]||(w===void 0&&(w=12),_=!0,S="g"),(y||f==="0"&&m==="=")&&(y=!0,f="0",m="=");var j=p==="$"?r:p==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",N=p==="$"?n:/[%p]/.test(S)?s:"",M=jp[S],O=/[defgprs%]/.test(S);w=w===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function C(P){var k=j,D=N,I,W,V;if(S==="c")D=M(P)+D,P="";else{P=+P;var K=P<0||1/P<0;if(P=isNaN(P)?l:M(Math.abs(P),w),_&&(P=MO(P)),K&&+P==0&&g!=="+"&&(K=!1),k=(K?g==="("?g:o:g==="-"||g==="("?"":g)+k,D=(S==="s"?Pp[8+Sy/3]:"")+D+(K&&g==="("?")":""),O){for(I=-1,W=P.length;++I<W;)if(V=P.charCodeAt(I),48>V||V>57){D=(V===46?a+P.slice(I+1):P.slice(I))+D,P=P.slice(0,I);break}}}x&&!y&&(P=e(P,1/0));var X=k.length+P.length+D.length,B=X<b?new Array(b-X+1).join(f):"";switch(x&&y&&(P=e(B+P,B.length?b-D.length:1/0),B=""),m){case"<":P=k+P+D+B;break;case"=":P=k+B+P+D;break;case"^":P=B.slice(0,X=B.length>>1)+k+P+D+B.slice(X);break;default:P=B+k+P+D;break}return i(P)}return C.toString=function(){return h+""},C}function u(h,f){var m=d((h=La(h),h.type="f",h)),g=Math.max(-8,Math.min(8,Math.floor(Bn(f)/3)))*3,p=Math.pow(10,-g),y=Pp[8+g/3];return function(b){return m(p*b)+y}}return{format:d,formatPrefix:u}}var Pi,cd,Ny;EO({thousands:",",grouping:[3],currency:["$",""]});function EO(t){return Pi=AO(t),cd=Pi.format,Ny=Pi.formatPrefix,Pi}function CO(t){return Math.max(0,-Bn(Math.abs(t)))}function TO(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bn(e)/3)))*3-Bn(Math.abs(t)))}function IO(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Bn(e)-Bn(t))+1}function Py(t,e,r,n){var a=Zc(t,e,r),i;switch(n=La(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=TO(a,s))&&(n.precision=i),Ny(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=IO(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=CO(a))&&(n.precision=i-(n.type==="%")*2);break}}return cd(n)}function Tr(t){var e=t.domain;return t.ticks=function(r){var n=e();return Jc(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return Py(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,i=n.length-1,s=n[a],o=n[i],l,d,u=10;for(o<s&&(d=s,s=o,o=d,d=a,a=i,i=d);u-- >0;){if(d=Xc(s,o,r),d===l)return n[a]=s,n[i]=o,e(n);if(d>0)s=Math.floor(s/d)*d,o=Math.ceil(o/d)*d;else if(d<0)s=Math.ceil(s*d)/d,o=Math.floor(o*d)/d;else break;l=d}return t},t}function ky(){var t=od();return t.copy=function(){return Ga(t,ky())},St.apply(t,arguments),Tr(t)}function My(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,os),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return My(t).unknown(e)},t=arguments.length?Array.from(t,os):[0,1],Tr(r)}function Oy(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],i=t[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),t[r]=e.floor(a),t[n]=e.ceil(i),t}function kp(t){return Math.log(t)}function Mp(t){return Math.exp(t)}function DO(t){return-Math.log(-t)}function $O(t){return-Math.exp(-t)}function RO(t){return isFinite(t)?+("1e"+t):t<0?0:t}function LO(t){return t===10?RO:t===Math.E?Math.exp:e=>Math.pow(t,e)}function BO(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Op(t){return(e,r)=>-t(-e,r)}function ud(t){const e=t(kp,Mp),r=e.domain;let n=10,a,i;function s(){return a=BO(n),i=LO(n),r()[0]<0?(a=Op(a),i=Op(i),t(DO,$O)):t(kp,Mp),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const l=r();let d=l[0],u=l[l.length-1];const h=u<d;h&&([d,u]=[u,d]);let f=a(d),m=a(u),g,p;const y=o==null?10:+o;let b=[];if(!(n%1)&&m-f<y){if(f=Math.floor(f),m=Math.ceil(m),d>0){for(;f<=m;++f)for(g=1;g<n;++g)if(p=f<0?g/i(-f):g*i(f),!(p<d)){if(p>u)break;b.push(p)}}else for(;f<=m;++f)for(g=n-1;g>=1;--g)if(p=f>0?g/i(-f):g*i(f),!(p<d)){if(p>u)break;b.push(p)}b.length*2<y&&(b=Jc(d,u,y))}else b=Jc(f,m,Math.min(m-f,y)).map(i);return h?b.reverse():b},e.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=La(l)).precision==null&&(l.trim=!0),l=cd(l)),o===1/0)return l;const d=Math.max(1,n*o/e.ticks().length);return u=>{let h=u/i(Math.round(a(u)));return h*n<n-.5&&(h*=n),h<=d?l(u):""}},e.nice=()=>r(Oy(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),e}function Ay(){const t=ud(Ys()).domain([1,10]);return t.copy=()=>Ga(t,Ay()).base(t.base()),St.apply(t,arguments),t}function Ap(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Ep(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function dd(t){var e=1,r=t(Ap(e),Ep(e));return r.constant=function(n){return arguments.length?t(Ap(e=+n),Ep(e)):e},Tr(r)}function Ey(){var t=dd(Ys());return t.copy=function(){return Ga(t,Ey()).constant(t.constant())},St.apply(t,arguments)}function Cp(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function UO(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function FO(t){return t<0?-t*t:t*t}function hd(t){var e=t(tt,tt),r=1;function n(){return r===1?t(tt,tt):r===.5?t(UO,FO):t(Cp(r),Cp(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},Tr(e)}function fd(){var t=hd(Ys());return t.copy=function(){return Ga(t,fd()).exponent(t.exponent())},St.apply(t,arguments),t}function zO(){return fd.apply(null,arguments).exponent(.5)}function Tp(t){return Math.sign(t)*t*t}function qO(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Cy(){var t=od(),e=[0,1],r=!1,n;function a(i){var s=qO(t(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return t.invert(Tp(i))},a.domain=function(i){return arguments.length?(t.domain(i),a):t.domain()},a.range=function(i){return arguments.length?(t.range((e=Array.from(i,os)).map(Tp)),a):e.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(t.clamp(i),a):t.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Cy(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},St.apply(a,arguments),Tr(a)}function Ty(){var t=[],e=[],r=[],n;function a(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=HM(t,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:e[Va(r,s)]}return i.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},i.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(kr),a()},i.range=function(s){return arguments.length?(e=Array.from(s),a()):e.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return Ty().domain(t).range(e).unknown(n)},St.apply(i,arguments)}function Iy(){var t=0,e=1,r=1,n=[.5],a=[0,1],i;function s(l){return l!=null&&l<=l?a[Va(n,l,0,r)]:i}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*e-(l-r)*t)/(r+1);return s}return s.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,o()):[t,e]},s.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,o()):a.slice()},s.invertExtent=function(l){var d=a.indexOf(l);return d<0?[NaN,NaN]:d<1?[t,n[0]]:d>=r?[n[r-1],e]:[n[d-1],n[d]]},s.unknown=function(l){return arguments.length&&(i=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return Iy().domain([t,e]).range(a).unknown(i)},St.apply(Tr(s),arguments)}function Dy(){var t=[.5],e=[0,1],r,n=1;function a(i){return i!=null&&i<=i?e[Va(t,i,0,n)]:r}return a.domain=function(i){return arguments.length?(t=Array.from(i),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(i){return arguments.length?(e=Array.from(i),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(i){var s=e.indexOf(i);return[t[s-1],t[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return Dy().domain(t).range(e).unknown(r)},St.apply(a,arguments)}const ql=new Date,Wl=new Date;function Ie(t,e,r,n){function a(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(t(i=new Date(+i)),i),a.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(e(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const l=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return l;let d;do l.push(d=new Date(+i)),e(i,o),t(i);while(d<i&&i<s);return l},a.filter=i=>Ie(s=>{if(s>=s)for(;t(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!i(s););else for(;--o>=0;)for(;e(s,1),!i(s););}),r&&(a.count=(i,s)=>(ql.setTime(+i),Wl.setTime(+s),t(ql),t(Wl),Math.floor(r(ql,Wl))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const cs=Ie(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);cs.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Ie(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):cs);cs.range;const Ht=1e3,xt=Ht*60,Gt=xt*60,er=Gt*24,md=er*7,Ip=er*30,Kl=er*365,Yr=Ie(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Ht)},(t,e)=>(e-t)/Ht,t=>t.getUTCSeconds());Yr.range;const pd=Ie(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ht)},(t,e)=>{t.setTime(+t+e*xt)},(t,e)=>(e-t)/xt,t=>t.getMinutes());pd.range;const gd=Ie(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*xt)},(t,e)=>(e-t)/xt,t=>t.getUTCMinutes());gd.range;const vd=Ie(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ht-t.getMinutes()*xt)},(t,e)=>{t.setTime(+t+e*Gt)},(t,e)=>(e-t)/Gt,t=>t.getHours());vd.range;const yd=Ie(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Gt)},(t,e)=>(e-t)/Gt,t=>t.getUTCHours());yd.range;const Ya=Ie(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*xt)/er,t=>t.getDate()-1);Ya.range;const Js=Ie(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/er,t=>t.getUTCDate()-1);Js.range;const $y=Ie(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/er,t=>Math.floor(t/er));$y.range;function dn(t){return Ie(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*xt)/md)}const Xs=dn(0),us=dn(1),WO=dn(2),KO=dn(3),Un=dn(4),VO=dn(5),HO=dn(6);Xs.range;us.range;WO.range;KO.range;Un.range;VO.range;HO.range;function hn(t){return Ie(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/md)}const Zs=hn(0),ds=hn(1),GO=hn(2),YO=hn(3),Fn=hn(4),JO=hn(5),XO=hn(6);Zs.range;ds.range;GO.range;YO.range;Fn.range;JO.range;XO.range;const bd=Ie(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());bd.range;const xd=Ie(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());xd.range;const tr=Ie(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());tr.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Ie(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});tr.range;const rr=Ie(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());rr.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Ie(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});rr.range;function Ry(t,e,r,n,a,i){const s=[[Yr,1,Ht],[Yr,5,5*Ht],[Yr,15,15*Ht],[Yr,30,30*Ht],[i,1,xt],[i,5,5*xt],[i,15,15*xt],[i,30,30*xt],[a,1,Gt],[a,3,3*Gt],[a,6,6*Gt],[a,12,12*Gt],[n,1,er],[n,2,2*er],[r,1,md],[e,1,Ip],[e,3,3*Ip],[t,1,Kl]];function o(d,u,h){const f=u<d;f&&([d,u]=[u,d]);const m=h&&typeof h.range=="function"?h:l(d,u,h),g=m?m.range(d,+u+1):[];return f?g.reverse():g}function l(d,u,h){const f=Math.abs(u-d)/h,m=td(([,,y])=>y).right(s,f);if(m===s.length)return t.every(Zc(d/Kl,u/Kl,h));if(m===0)return cs.every(Math.max(Zc(d,u,h),1));const[g,p]=s[f/s[m-1][2]<s[m][2]/f?m-1:m];return g.every(p)}return[o,l]}const[ZO,QO]=Ry(rr,xd,Zs,$y,yd,gd),[eA,tA]=Ry(tr,bd,Xs,Ya,vd,pd);function Vl(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Hl(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function da(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function rA(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,i=t.days,s=t.shortDays,o=t.months,l=t.shortMonths,d=ha(a),u=fa(a),h=ha(i),f=fa(i),m=ha(s),g=fa(s),p=ha(o),y=fa(o),b=ha(l),x=fa(l),w={a:K,A:X,b:B,B:R,c:null,d:Up,e:Up,f:NA,g:DA,G:RA,H:_A,I:jA,j:SA,L:Ly,m:PA,M:kA,p:Y,q:$,Q:qp,s:Wp,S:MA,u:OA,U:AA,V:EA,w:CA,W:TA,x:null,X:null,y:IA,Y:$A,Z:LA,"%":zp},_={a:qe,A:hr,b:te,B:Bt,c:null,d:Fp,e:Fp,f:zA,g:ZA,G:eE,H:BA,I:UA,j:FA,L:Uy,m:qA,M:WA,p:$r,q:aa,Q:qp,s:Wp,S:KA,u:VA,U:HA,V:GA,w:YA,W:JA,x:null,X:null,y:XA,Y:QA,Z:tE,"%":zp},S={a:C,A:P,b:k,B:D,c:I,d:Lp,e:Lp,f:yA,g:Rp,G:$p,H:Bp,I:Bp,j:mA,L:vA,m:fA,M:pA,p:O,q:hA,Q:xA,s:wA,S:gA,u:oA,U:lA,V:cA,w:sA,W:uA,x:W,X:V,y:Rp,Y:$p,Z:dA,"%":bA};w.x=j(r,w),w.X=j(n,w),w.c=j(e,w),_.x=j(r,_),_.X=j(n,_),_.c=j(e,_);function j(L,H){return function(Z){var T=[],$e=-1,ce=0,Xe=L.length,Ze,Ut,fr;for(Z instanceof Date||(Z=new Date(+Z));++$e<Xe;)L.charCodeAt($e)===37&&(T.push(L.slice(ce,$e)),(Ut=Dp[Ze=L.charAt(++$e)])!=null?Ze=L.charAt(++$e):Ut=Ze==="e"?" ":"0",(fr=H[Ze])&&(Ze=fr(Z,Ut)),T.push(Ze),ce=$e+1);return T.push(L.slice(ce,$e)),T.join("")}}function N(L,H){return function(Z){var T=da(1900,void 0,1),$e=M(T,L,Z+="",0),ce,Xe;if($e!=Z.length)return null;if("Q"in T)return new Date(T.Q);if("s"in T)return new Date(T.s*1e3+("L"in T?T.L:0));if(H&&!("Z"in T)&&(T.Z=0),"p"in T&&(T.H=T.H%12+T.p*12),T.m===void 0&&(T.m="q"in T?T.q:0),"V"in T){if(T.V<1||T.V>53)return null;"w"in T||(T.w=1),"Z"in T?(ce=Hl(da(T.y,0,1)),Xe=ce.getUTCDay(),ce=Xe>4||Xe===0?ds.ceil(ce):ds(ce),ce=Js.offset(ce,(T.V-1)*7),T.y=ce.getUTCFullYear(),T.m=ce.getUTCMonth(),T.d=ce.getUTCDate()+(T.w+6)%7):(ce=Vl(da(T.y,0,1)),Xe=ce.getDay(),ce=Xe>4||Xe===0?us.ceil(ce):us(ce),ce=Ya.offset(ce,(T.V-1)*7),T.y=ce.getFullYear(),T.m=ce.getMonth(),T.d=ce.getDate()+(T.w+6)%7)}else("W"in T||"U"in T)&&("w"in T||(T.w="u"in T?T.u%7:"W"in T?1:0),Xe="Z"in T?Hl(da(T.y,0,1)).getUTCDay():Vl(da(T.y,0,1)).getDay(),T.m=0,T.d="W"in T?(T.w+6)%7+T.W*7-(Xe+5)%7:T.w+T.U*7-(Xe+6)%7);return"Z"in T?(T.H+=T.Z/100|0,T.M+=T.Z%100,Hl(T)):Vl(T)}}function M(L,H,Z,T){for(var $e=0,ce=H.length,Xe=Z.length,Ze,Ut;$e<ce;){if(T>=Xe)return-1;if(Ze=H.charCodeAt($e++),Ze===37){if(Ze=H.charAt($e++),Ut=S[Ze in Dp?H.charAt($e++):Ze],!Ut||(T=Ut(L,Z,T))<0)return-1}else if(Ze!=Z.charCodeAt(T++))return-1}return T}function O(L,H,Z){var T=d.exec(H.slice(Z));return T?(L.p=u.get(T[0].toLowerCase()),Z+T[0].length):-1}function C(L,H,Z){var T=m.exec(H.slice(Z));return T?(L.w=g.get(T[0].toLowerCase()),Z+T[0].length):-1}function P(L,H,Z){var T=h.exec(H.slice(Z));return T?(L.w=f.get(T[0].toLowerCase()),Z+T[0].length):-1}function k(L,H,Z){var T=b.exec(H.slice(Z));return T?(L.m=x.get(T[0].toLowerCase()),Z+T[0].length):-1}function D(L,H,Z){var T=p.exec(H.slice(Z));return T?(L.m=y.get(T[0].toLowerCase()),Z+T[0].length):-1}function I(L,H,Z){return M(L,e,H,Z)}function W(L,H,Z){return M(L,r,H,Z)}function V(L,H,Z){return M(L,n,H,Z)}function K(L){return s[L.getDay()]}function X(L){return i[L.getDay()]}function B(L){return l[L.getMonth()]}function R(L){return o[L.getMonth()]}function Y(L){return a[+(L.getHours()>=12)]}function $(L){return 1+~~(L.getMonth()/3)}function qe(L){return s[L.getUTCDay()]}function hr(L){return i[L.getUTCDay()]}function te(L){return l[L.getUTCMonth()]}function Bt(L){return o[L.getUTCMonth()]}function $r(L){return a[+(L.getUTCHours()>=12)]}function aa(L){return 1+~~(L.getUTCMonth()/3)}return{format:function(L){var H=j(L+="",w);return H.toString=function(){return L},H},parse:function(L){var H=N(L+="",!1);return H.toString=function(){return L},H},utcFormat:function(L){var H=j(L+="",_);return H.toString=function(){return L},H},utcParse:function(L){var H=N(L+="",!0);return H.toString=function(){return L},H}}}var Dp={"-":"",_:" ",0:"0"},Fe=/^\s*\d+/,nA=/^%/,aA=/[\\^$*+?|[\]().{}]/g;function ne(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(e)+a:a)}function iA(t){return t.replace(aA,"\\$&")}function ha(t){return new RegExp("^(?:"+t.map(iA).join("|")+")","i")}function fa(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function sA(t,e,r){var n=Fe.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function oA(t,e,r){var n=Fe.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function lA(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function cA(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function uA(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function $p(t,e,r){var n=Fe.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Rp(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function dA(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function hA(t,e,r){var n=Fe.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function fA(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Lp(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function mA(t,e,r){var n=Fe.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Bp(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function pA(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function gA(t,e,r){var n=Fe.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function vA(t,e,r){var n=Fe.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function yA(t,e,r){var n=Fe.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function bA(t,e,r){var n=nA.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function xA(t,e,r){var n=Fe.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function wA(t,e,r){var n=Fe.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Up(t,e){return ne(t.getDate(),e,2)}function _A(t,e){return ne(t.getHours(),e,2)}function jA(t,e){return ne(t.getHours()%12||12,e,2)}function SA(t,e){return ne(1+Ya.count(tr(t),t),e,3)}function Ly(t,e){return ne(t.getMilliseconds(),e,3)}function NA(t,e){return Ly(t,e)+"000"}function PA(t,e){return ne(t.getMonth()+1,e,2)}function kA(t,e){return ne(t.getMinutes(),e,2)}function MA(t,e){return ne(t.getSeconds(),e,2)}function OA(t){var e=t.getDay();return e===0?7:e}function AA(t,e){return ne(Xs.count(tr(t)-1,t),e,2)}function By(t){var e=t.getDay();return e>=4||e===0?Un(t):Un.ceil(t)}function EA(t,e){return t=By(t),ne(Un.count(tr(t),t)+(tr(t).getDay()===4),e,2)}function CA(t){return t.getDay()}function TA(t,e){return ne(us.count(tr(t)-1,t),e,2)}function IA(t,e){return ne(t.getFullYear()%100,e,2)}function DA(t,e){return t=By(t),ne(t.getFullYear()%100,e,2)}function $A(t,e){return ne(t.getFullYear()%1e4,e,4)}function RA(t,e){var r=t.getDay();return t=r>=4||r===0?Un(t):Un.ceil(t),ne(t.getFullYear()%1e4,e,4)}function LA(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ne(e/60|0,"0",2)+ne(e%60,"0",2)}function Fp(t,e){return ne(t.getUTCDate(),e,2)}function BA(t,e){return ne(t.getUTCHours(),e,2)}function UA(t,e){return ne(t.getUTCHours()%12||12,e,2)}function FA(t,e){return ne(1+Js.count(rr(t),t),e,3)}function Uy(t,e){return ne(t.getUTCMilliseconds(),e,3)}function zA(t,e){return Uy(t,e)+"000"}function qA(t,e){return ne(t.getUTCMonth()+1,e,2)}function WA(t,e){return ne(t.getUTCMinutes(),e,2)}function KA(t,e){return ne(t.getUTCSeconds(),e,2)}function VA(t){var e=t.getUTCDay();return e===0?7:e}function HA(t,e){return ne(Zs.count(rr(t)-1,t),e,2)}function Fy(t){var e=t.getUTCDay();return e>=4||e===0?Fn(t):Fn.ceil(t)}function GA(t,e){return t=Fy(t),ne(Fn.count(rr(t),t)+(rr(t).getUTCDay()===4),e,2)}function YA(t){return t.getUTCDay()}function JA(t,e){return ne(ds.count(rr(t)-1,t),e,2)}function XA(t,e){return ne(t.getUTCFullYear()%100,e,2)}function ZA(t,e){return t=Fy(t),ne(t.getUTCFullYear()%100,e,2)}function QA(t,e){return ne(t.getUTCFullYear()%1e4,e,4)}function eE(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Fn(t):Fn.ceil(t),ne(t.getUTCFullYear()%1e4,e,4)}function tE(){return"+0000"}function zp(){return"%"}function qp(t){return+t}function Wp(t){return Math.floor(+t/1e3)}var Nn,zy,qy;rE({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function rE(t){return Nn=rA(t),zy=Nn.format,Nn.parse,qy=Nn.utcFormat,Nn.utcParse,Nn}function nE(t){return new Date(t)}function aE(t){return t instanceof Date?+t:+new Date(+t)}function wd(t,e,r,n,a,i,s,o,l,d){var u=od(),h=u.invert,f=u.domain,m=d(".%L"),g=d(":%S"),p=d("%I:%M"),y=d("%I %p"),b=d("%a %d"),x=d("%b %d"),w=d("%B"),_=d("%Y");function S(j){return(l(j)<j?m:o(j)<j?g:s(j)<j?p:i(j)<j?y:n(j)<j?a(j)<j?b:x:r(j)<j?w:_)(j)}return u.invert=function(j){return new Date(h(j))},u.domain=function(j){return arguments.length?f(Array.from(j,aE)):f().map(nE)},u.ticks=function(j){var N=f();return t(N[0],N[N.length-1],j??10)},u.tickFormat=function(j,N){return N==null?S:d(N)},u.nice=function(j){var N=f();return(!j||typeof j.range!="function")&&(j=e(N[0],N[N.length-1],j??10)),j?f(Oy(N,j)):u},u.copy=function(){return Ga(u,wd(t,e,r,n,a,i,s,o,l,d))},u}function iE(){return St.apply(wd(eA,tA,tr,bd,Xs,Ya,vd,pd,Yr,zy).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function sE(){return St.apply(wd(ZO,QO,rr,xd,Zs,Js,yd,gd,Yr,qy).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Qs(){var t=0,e=1,r,n,a,i,s=tt,o=!1,l;function d(h){return h==null||isNaN(h=+h)?l:s(a===0?.5:(h=(i(h)-r)*a,o?Math.max(0,Math.min(1,h)):h))}d.domain=function(h){return arguments.length?([t,e]=h,r=i(t=+t),n=i(e=+e),a=r===n?0:1/(n-r),d):[t,e]},d.clamp=function(h){return arguments.length?(o=!!h,d):o},d.interpolator=function(h){return arguments.length?(s=h,d):s};function u(h){return function(f){var m,g;return arguments.length?([m,g]=f,s=h(m,g),d):[s(0),s(1)]}}return d.range=u(Yn),d.rangeRound=u(sd),d.unknown=function(h){return arguments.length?(l=h,d):l},function(h){return i=h,r=h(t),n=h(e),a=r===n?0:1/(n-r),d}}function Ir(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Wy(){var t=Tr(Qs()(tt));return t.copy=function(){return Ir(t,Wy())},lr.apply(t,arguments)}function Ky(){var t=ud(Qs()).domain([1,10]);return t.copy=function(){return Ir(t,Ky()).base(t.base())},lr.apply(t,arguments)}function Vy(){var t=dd(Qs());return t.copy=function(){return Ir(t,Vy()).constant(t.constant())},lr.apply(t,arguments)}function _d(){var t=hd(Qs());return t.copy=function(){return Ir(t,_d()).exponent(t.exponent())},lr.apply(t,arguments)}function oE(){return _d.apply(null,arguments).exponent(.5)}function Hy(){var t=[],e=tt;function r(n){if(n!=null&&!isNaN(n=+n))return e((Va(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(kr),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>VM(t,i/n))},r.copy=function(){return Hy(e).domain(t)},lr.apply(r,arguments)}function eo(){var t=0,e=.5,r=1,n=1,a,i,s,o,l,d=tt,u,h=!1,f;function m(p){return isNaN(p=+p)?f:(p=.5+((p=+u(p))-i)*(n*p<n*i?o:l),d(h?Math.max(0,Math.min(1,p)):p))}m.domain=function(p){return arguments.length?([t,e,r]=p,a=u(t=+t),i=u(e=+e),s=u(r=+r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,m):[t,e,r]},m.clamp=function(p){return arguments.length?(h=!!p,m):h},m.interpolator=function(p){return arguments.length?(d=p,m):d};function g(p){return function(y){var b,x,w;return arguments.length?([b,x,w]=y,d=bO(p,[b,x,w]),m):[d(0),d(.5),d(1)]}}return m.range=g(Yn),m.rangeRound=g(sd),m.unknown=function(p){return arguments.length?(f=p,m):f},function(p){return u=p,a=p(t),i=p(e),s=p(r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,m}}function Gy(){var t=Tr(eo()(tt));return t.copy=function(){return Ir(t,Gy())},lr.apply(t,arguments)}function Yy(){var t=ud(eo()).domain([.1,1,10]);return t.copy=function(){return Ir(t,Yy()).base(t.base())},lr.apply(t,arguments)}function Jy(){var t=dd(eo());return t.copy=function(){return Ir(t,Jy()).constant(t.constant())},lr.apply(t,arguments)}function jd(){var t=hd(eo());return t.copy=function(){return Ir(t,jd()).exponent(t.exponent())},lr.apply(t,arguments)}function lE(){return jd.apply(null,arguments).exponent(.5)}const va=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:nd,scaleDiverging:Gy,scaleDivergingLog:Yy,scaleDivergingPow:jd,scaleDivergingSqrt:lE,scaleDivergingSymlog:Jy,scaleIdentity:My,scaleImplicit:Qc,scaleLinear:ky,scaleLog:Ay,scaleOrdinal:rd,scalePoint:YM,scalePow:fd,scaleQuantile:Ty,scaleQuantize:Iy,scaleRadial:Cy,scaleSequential:Wy,scaleSequentialLog:Ky,scaleSequentialPow:_d,scaleSequentialQuantile:Hy,scaleSequentialSqrt:oE,scaleSequentialSymlog:Vy,scaleSqrt:zO,scaleSymlog:Ey,scaleThreshold:Dy,scaleTime:iE,scaleUtc:sE,tickFormat:Py},Symbol.toStringTag,{value:"Module"}));var Dr=t=>t.chartData,Sd=A([Dr],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),Ja=(t,e,r,n)=>n?Sd(t):Dr(t);function zn(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(ht(e)&&ht(r))return!0}return!1}function Kp(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function cE(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,i;if(ht(r))a=r;else if(typeof r=="function")return;if(ht(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(zn(s))return s}}function uE(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(zn(n))return Kp(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,i]=t,s,o;if(a==="auto")e!=null&&(s=Math.min(...e));else if(q(a))s=a;else if(typeof a=="function")try{e!=null&&(s=a(e?.[0]))}catch{}else if(typeof a=="string"&&Dm.test(a)){var l=Dm.exec(a);if(l==null||e==null)s=void 0;else{var d=+l[1];s=e[0]-d}}else s=e?.[0];if(i==="auto")e!=null&&(o=Math.max(...e));else if(q(i))o=i;else if(typeof i=="function")try{e!=null&&(o=i(e?.[1]))}catch{}else if(typeof i=="string"&&$m.test(i)){var u=$m.exec(i);if(u==null||e==null)o=void 0;else{var h=+u[1];o=e[1]+h}}else o=e?.[1];var f=[s,o];if(zn(f))return e==null?f:Kp(f,e,r)}}}var Jn=1e9,dE={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Pd,ve=!0,_t="[DecimalError] ",en=_t+"Invalid argument: ",Nd=_t+"Exponent out of range: ",Xn=Math.floor,Wr=Math.pow,hE=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,lt,Le=1e7,pe=7,Xy=9007199254740991,hs=Xn(Xy/pe),U={};U.absoluteValue=U.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};U.comparedTo=U.cmp=function(t){var e,r,n,a,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(n=i.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(i.d[e]!==t.d[e])return i.d[e]>t.d[e]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};U.decimalPlaces=U.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*pe;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};U.dividedBy=U.div=function(t){return Jt(this,new this.constructor(t))};U.dividedToIntegerBy=U.idiv=function(t){var e=this,r=e.constructor;return he(Jt(e,new r(t),0,1),r.precision)};U.equals=U.eq=function(t){return!this.cmp(t)};U.exponent=function(){return Me(this)};U.greaterThan=U.gt=function(t){return this.cmp(t)>0};U.greaterThanOrEqualTo=U.gte=function(t){return this.cmp(t)>=0};U.isInteger=U.isint=function(){return this.e>this.d.length-2};U.isNegative=U.isneg=function(){return this.s<0};U.isPositive=U.ispos=function(){return this.s>0};U.isZero=function(){return this.s===0};U.lessThan=U.lt=function(t){return this.cmp(t)<0};U.lessThanOrEqualTo=U.lte=function(t){return this.cmp(t)<1};U.logarithm=U.log=function(t){var e,r=this,n=r.constructor,a=n.precision,i=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(lt))throw Error(_t+"NaN");if(r.s<1)throw Error(_t+(r.s?"NaN":"-Infinity"));return r.eq(lt)?new n(0):(ve=!1,e=Jt(Ba(r,i),Ba(t,i),i),ve=!0,he(e,a))};U.minus=U.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?eb(e,t):Zy(e,(t.s=-t.s,t))};U.modulo=U.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(_t+"NaN");return r.s?(ve=!1,e=Jt(r,t,0,1).times(t),ve=!0,r.minus(e)):he(new n(r),a)};U.naturalExponential=U.exp=function(){return Qy(this)};U.naturalLogarithm=U.ln=function(){return Ba(this)};U.negated=U.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};U.plus=U.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Zy(e,t):eb(e,(t.s=-t.s,t))};U.precision=U.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(en+t);if(e=Me(a)+1,n=a.d.length-1,r=n*pe+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};U.squareRoot=U.sqrt=function(){var t,e,r,n,a,i,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(_t+"NaN")}for(t=Me(o),ve=!1,a=Math.sqrt(+o),a==0||a==1/0?(e=Tt(o.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=Xn((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new l(e)):n=new l(a.toString()),r=l.precision,a=s=r+3;;)if(i=n,n=i.plus(Jt(o,i,s+2)).times(.5),Tt(i.d).slice(0,s)===(e=Tt(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),a==s&&e=="4999"){if(he(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(e!="9999")break;s+=4}return ve=!0,he(n,r)};U.times=U.mul=function(t){var e,r,n,a,i,s,o,l,d,u=this,h=u.constructor,f=u.d,m=(t=new h(t)).d;if(!u.s||!t.s)return new h(0);for(t.s*=u.s,r=u.e+t.e,l=f.length,d=m.length,l<d&&(i=f,f=m,m=i,s=l,l=d,d=s),i=[],s=l+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(e=0,a=l+n;a>n;)o=i[a]+m[n]*f[a-n-1]+e,i[a--]=o%Le|0,e=o/Le|0;i[a]=(i[a]+e)%Le|0}for(;!i[--s];)i.pop();return e?++r:i.shift(),t.d=i,t.e=r,ve?he(t,h.precision):t};U.toDecimalPlaces=U.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:($t(t,0,Jn),e===void 0?e=n.rounding:$t(e,0,8),he(r,t+Me(r)+1,e))};U.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=sn(n,!0):($t(t,0,Jn),e===void 0?e=a.rounding:$t(e,0,8),n=he(new a(n),t+1,e),r=sn(n,!0,t+1)),r};U.toFixed=function(t,e){var r,n,a=this,i=a.constructor;return t===void 0?sn(a):($t(t,0,Jn),e===void 0?e=i.rounding:$t(e,0,8),n=he(new i(a),t+Me(a)+1,e),r=sn(n.abs(),!1,t+Me(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};U.toInteger=U.toint=function(){var t=this,e=t.constructor;return he(new e(t),Me(t)+1,e.rounding)};U.toNumber=function(){return+this};U.toPower=U.pow=function(t){var e,r,n,a,i,s,o=this,l=o.constructor,d=12,u=+(t=new l(t));if(!t.s)return new l(lt);if(o=new l(o),!o.s){if(t.s<1)throw Error(_t+"Infinity");return o}if(o.eq(lt))return o;if(n=l.precision,t.eq(lt))return he(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,i=o.s,s){if((r=u<0?-u:u)<=Xy){for(a=new l(lt),e=Math.ceil(n/pe+4),ve=!1;r%2&&(a=a.times(o),Hp(a.d,e)),r=Xn(r/2),r!==0;)o=o.times(o),Hp(o.d,e);return ve=!0,t.s<0?new l(lt).div(a):he(a,n)}}else if(i<0)throw Error(_t+"NaN");return i=i<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,ve=!1,a=t.times(Ba(o,n+d)),ve=!0,a=Qy(a),a.s=i,a};U.toPrecision=function(t,e){var r,n,a=this,i=a.constructor;return t===void 0?(r=Me(a),n=sn(a,r<=i.toExpNeg||r>=i.toExpPos)):($t(t,1,Jn),e===void 0?e=i.rounding:$t(e,0,8),a=he(new i(a),t,e),r=Me(a),n=sn(a,t<=r||r<=i.toExpNeg,t)),n};U.toSignificantDigits=U.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):($t(t,1,Jn),e===void 0?e=n.rounding:$t(e,0,8)),he(new n(r),t,e)};U.toString=U.valueOf=U.val=U.toJSON=U[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Me(t),r=t.constructor;return sn(t,e<=r.toExpNeg||e>=r.toExpPos)};function Zy(t,e){var r,n,a,i,s,o,l,d,u=t.constructor,h=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),ve?he(e,h):e;if(l=t.d,d=e.d,s=t.e,a=e.e,l=l.slice(),i=s-a,i){for(i<0?(n=l,i=-i,o=d.length):(n=d,a=s,o=l.length),s=Math.ceil(h/pe),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=l.length,i=d.length,o-i<0&&(i=o,n=d,d=l,l=n),r=0;i;)r=(l[--i]=l[i]+d[i]+r)/Le|0,l[i]%=Le;for(r&&(l.unshift(r),++a),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=a,ve?he(e,h):e}function $t(t,e,r){if(t!==~~t||t<e||t>r)throw Error(en+t)}function Tt(t){var e,r,n,a=t.length-1,i="",s=t[0];if(a>0){for(i+=s,e=1;e<a;e++)n=t[e]+"",r=pe-n.length,r&&(i+=gr(r)),i+=n;s=t[e],n=s+"",r=pe-n.length,r&&(i+=gr(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Jt=(function(){function t(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%Le|0,s=i/Le|0;return s&&n.unshift(s),n}function e(n,a,i,s){var o,l;if(i!=s)l=i>s?1:-1;else for(o=l=0;o<i;o++)if(n[o]!=a[o]){l=n[o]>a[o]?1:-1;break}return l}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Le+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,l,d,u,h,f,m,g,p,y,b,x,w,_,S,j,N,M,O=n.constructor,C=n.s==a.s?1:-1,P=n.d,k=a.d;if(!n.s)return new O(n);if(!a.s)throw Error(_t+"Division by zero");for(l=n.e-a.e,N=k.length,S=P.length,m=new O(C),g=m.d=[],d=0;k[d]==(P[d]||0);)++d;if(k[d]>(P[d]||0)&&--l,i==null?x=i=O.precision:s?x=i+(Me(n)-Me(a))+1:x=i,x<0)return new O(0);if(x=x/pe+2|0,d=0,N==1)for(u=0,k=k[0],x++;(d<S||u)&&x--;d++)w=u*Le+(P[d]||0),g[d]=w/k|0,u=w%k|0;else{for(u=Le/(k[0]+1)|0,u>1&&(k=t(k,u),P=t(P,u),N=k.length,S=P.length),_=N,p=P.slice(0,N),y=p.length;y<N;)p[y++]=0;M=k.slice(),M.unshift(0),j=k[0],k[1]>=Le/2&&++j;do u=0,o=e(k,p,N,y),o<0?(b=p[0],N!=y&&(b=b*Le+(p[1]||0)),u=b/j|0,u>1?(u>=Le&&(u=Le-1),h=t(k,u),f=h.length,y=p.length,o=e(h,p,f,y),o==1&&(u--,r(h,N<f?M:k,f))):(u==0&&(o=u=1),h=k.slice()),f=h.length,f<y&&h.unshift(0),r(p,h,y),o==-1&&(y=p.length,o=e(k,p,N,y),o<1&&(u++,r(p,N<y?M:k,y))),y=p.length):o===0&&(u++,p=[0]),g[d++]=u,o&&p[0]?p[y++]=P[_]||0:(p=[P[_]],y=1);while((_++<S||p[0]!==void 0)&&x--)}return g[0]||g.shift(),m.e=l,he(m,s?i+Me(m)+1:i)}})();function Qy(t,e){var r,n,a,i,s,o,l=0,d=0,u=t.constructor,h=u.precision;if(Me(t)>16)throw Error(Nd+Me(t));if(!t.s)return new u(lt);for(ve=!1,o=h,s=new u(.03125);t.abs().gte(.1);)t=t.times(s),d+=5;for(n=Math.log(Wr(2,d))/Math.LN10*2+5|0,o+=n,r=a=i=new u(lt),u.precision=o;;){if(a=he(a.times(t),o),r=r.times(++l),s=i.plus(Jt(a,r,o)),Tt(s.d).slice(0,o)===Tt(i.d).slice(0,o)){for(;d--;)i=he(i.times(i),o);return u.precision=h,e==null?(ve=!0,he(i,h)):i}i=s}}function Me(t){for(var e=t.e*pe,r=t.d[0];r>=10;r/=10)e++;return e}function Gl(t,e,r){if(e>t.LN10.sd())throw ve=!0,r&&(t.precision=r),Error(_t+"LN10 precision limit exceeded");return he(new t(t.LN10),e)}function gr(t){for(var e="";t--;)e+="0";return e}function Ba(t,e){var r,n,a,i,s,o,l,d,u,h=1,f=10,m=t,g=m.d,p=m.constructor,y=p.precision;if(m.s<1)throw Error(_t+(m.s?"NaN":"-Infinity"));if(m.eq(lt))return new p(0);if(e==null?(ve=!1,d=y):d=e,m.eq(10))return e==null&&(ve=!0),Gl(p,d);if(d+=f,p.precision=d,r=Tt(g),n=r.charAt(0),i=Me(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(t),r=Tt(m.d),n=r.charAt(0),h++;i=Me(m),n>1?(m=new p("0."+r),i++):m=new p(n+"."+r.slice(1))}else return l=Gl(p,d+2,y).times(i+""),m=Ba(new p(n+"."+r.slice(1)),d-f).plus(l),p.precision=y,e==null?(ve=!0,he(m,y)):m;for(o=s=m=Jt(m.minus(lt),m.plus(lt),d),u=he(m.times(m),d),a=3;;){if(s=he(s.times(u),d),l=o.plus(Jt(s,new p(a),d)),Tt(l.d).slice(0,d)===Tt(o.d).slice(0,d))return o=o.times(2),i!==0&&(o=o.plus(Gl(p,d+2,y).times(i+""))),o=Jt(o,new p(h),d),p.precision=y,e==null?(ve=!0,he(o,y)):o;o=l,a+=2}}function Vp(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=Xn(r/pe),t.d=[],n=(r+1)%pe,r<0&&(n+=pe),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=pe;n<a;)t.d.push(+e.slice(n,n+=pe));e=e.slice(n),n=pe-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),ve&&(t.e>hs||t.e<-hs))throw Error(Nd+r)}else t.s=0,t.e=0,t.d=[0];return t}function he(t,e,r){var n,a,i,s,o,l,d,u,h=t.d;for(s=1,i=h[0];i>=10;i/=10)s++;if(n=e-s,n<0)n+=pe,a=e,d=h[u=0];else{if(u=Math.ceil((n+1)/pe),i=h.length,u>=i)return t;for(d=i=h[u],s=1;i>=10;i/=10)s++;n%=pe,a=n-pe+s}if(r!==void 0&&(i=Wr(10,s-a-1),o=d/i%10|0,l=e<0||h[u+1]!==void 0||d%i,l=r<4?(o||l)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?a>0?d/Wr(10,s-a):0:h[u-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return l?(i=Me(t),h.length=1,e=e-i-1,h[0]=Wr(10,(pe-e%pe)%pe),t.e=Xn(-e/pe)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=u,i=1,u--):(h.length=u+1,i=Wr(10,pe-n),h[u]=a>0?(d/Wr(10,s-a)%Wr(10,a)|0)*i:0),l)for(;;)if(u==0){(h[0]+=i)==Le&&(h[0]=1,++t.e);break}else{if(h[u]+=i,h[u]!=Le)break;h[u--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(ve&&(t.e>hs||t.e<-hs))throw Error(Nd+Me(t));return t}function eb(t,e){var r,n,a,i,s,o,l,d,u,h,f=t.constructor,m=f.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new f(t),ve?he(e,m):e;if(l=t.d,h=e.d,n=e.e,d=t.e,l=l.slice(),s=d-n,s){for(u=s<0,u?(r=l,s=-s,o=h.length):(r=h,n=d,o=l.length),a=Math.max(Math.ceil(m/pe),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=l.length,o=h.length,u=a<o,u&&(o=a),a=0;a<o;a++)if(l[a]!=h[a]){u=l[a]<h[a];break}s=0}for(u&&(r=l,l=h,h=r,e.s=-e.s),o=l.length,a=h.length-o;a>0;--a)l[o++]=0;for(a=h.length;a>s;){if(l[--a]<h[a]){for(i=a;i&&l[--i]===0;)l[i]=Le-1;--l[i],l[a]+=Le}l[a]-=h[a]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(e.d=l,e.e=n,ve?he(e,m):e):new f(0)}function sn(t,e,r){var n,a=Me(t),i=Tt(t.d),s=i.length;return e?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+gr(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+gr(-a-1)+i,r&&(n=r-s)>0&&(i+=gr(n))):a>=s?(i+=gr(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+gr(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=gr(n))),t.s<0?"-"+i:i}function Hp(t,e){if(t.length>e)return t.length=e,!0}function tb(t){var e,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(en+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return Vp(s,i.toString())}else if(typeof i!="string")throw Error(en+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,hE.test(i))Vp(s,i);else throw Error(en+i)}if(a.prototype=U,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=tb,a.config=a.set=fE,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function fE(t){if(!t||typeof t!="object")throw Error(_t+"Object expected");var e,r,n,a=["precision",1,Jn,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(Xn(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(en+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(en+r+": "+n);return this}var Pd=tb(dE);lt=new Pd(1);const oe=Pd;var mE=t=>t,rb={},nb=t=>t===rb,Gp=t=>function e(){return arguments.length===0||arguments.length===1&&nb(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},ab=(t,e)=>t===1?e:Gp(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==rb).length;return i>=t?e(...n):ab(t-i,Gp(function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];var d=n.map(u=>nb(u)?o.shift():u);return e(...d,...o)}))}),to=t=>ab(t.length,t),nu=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},pE=to((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),gE=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return mE;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((o,l)=>l(o),i(...arguments))}},au=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),ib=t=>{var e=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e&&a.every((s,o)=>{var l;return s===((l=e)===null||l===void 0?void 0:l[o])})||(e=a,r=t(...a)),r}};function sb(t){var e;return t===0?e=1:e=Math.floor(new oe(t).abs().log(10).toNumber())+1,e}function ob(t,e,r){for(var n=new oe(t),a=0,i=[];n.lt(e)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}to((t,e,r)=>{var n=+t,a=+e;return n+r*(a-n)});to((t,e,r)=>{var n=e-+t;return n=n||1/0,(r-t)/n});to((t,e,r)=>{var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});var lb=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},cb=(t,e,r)=>{if(t.lte(0))return new oe(0);var n=sb(t.toNumber()),a=new oe(10).pow(n),i=t.div(a),s=n!==1?.05:.1,o=new oe(Math.ceil(i.div(s).toNumber())).add(r).mul(s),l=o.mul(a);return e?new oe(l.toNumber()):new oe(Math.ceil(l.toNumber()))},vE=(t,e,r)=>{var n=new oe(1),a=new oe(t);if(!a.isint()&&r){var i=Math.abs(t);i<1?(n=new oe(10).pow(sb(t)-1),a=new oe(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new oe(Math.floor(t)))}else t===0?a=new oe(Math.floor((e-1)/2)):r||(a=new oe(Math.floor(t)));var s=Math.floor((e-1)/2),o=gE(pE(l=>a.add(new oe(l-s).mul(n)).toNumber()),nu);return o(0,e)},ub=function(e,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new oe(0),tickMin:new oe(0),tickMax:new oe(0)};var s=cb(new oe(r).sub(e).div(n-1),a,i),o;e<=0&&r>=0?o=new oe(0):(o=new oe(e).add(r).div(2),o=o.sub(new oe(o).mod(s)));var l=Math.ceil(o.sub(e).div(s).toNumber()),d=Math.ceil(new oe(r).sub(o).div(s).toNumber()),u=l+d+1;return u>n?ub(e,r,n,a,i+1):(u<n&&(d=r>0?d+(n-u):d,l=r>0?l:l+(n-u)),{step:s,tickMin:o.sub(new oe(l).mul(s)),tickMax:o.add(new oe(d).mul(s))})};function yE(t){var[e,r]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,o]=lb([e,r]);if(s===-1/0||o===1/0){var l=o===1/0?[s,...nu(0,n-1).map(()=>1/0)]:[...nu(0,n-1).map(()=>-1/0),o];return e>r?au(l):l}if(s===o)return vE(s,n,a);var{step:d,tickMin:u,tickMax:h}=ub(s,o,i,a,0),f=ob(u,h.add(new oe(.1).mul(d)),d);return e>r?au(f):f}function bE(t,e){var[r,n]=t,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=lb([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var o=Math.max(e,2),l=cb(new oe(s).sub(i).div(o-1),a,0),d=[...ob(new oe(i),new oe(s),l),s];return a===!1&&(d=d.map(u=>Math.round(u))),r>n?au(d):d}var xE=ib(yE),wE=ib(bE),db=t=>t.rootProps.maxBarSize,_E=t=>t.rootProps.barGap,hb=t=>t.rootProps.barCategoryGap,jE=t=>t.rootProps.barSize,Xa=t=>t.rootProps.stackOffset,kd=t=>t.options.chartName,Md=t=>t.rootProps.syncId,fb=t=>t.rootProps.syncMethod,Od=t=>t.options.eventEmitter,Kt={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},st={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},ro=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},SE={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Kt.angleAxisId,includeHidden:!1,name:void 0,reversed:Kt.reversed,scale:Kt.scale,tick:Kt.tick,tickCount:void 0,ticks:void 0,type:Kt.type,unit:void 0},NE={allowDataOverflow:st.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:st.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:st.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:st.scale,tick:st.tick,tickCount:st.tickCount,ticks:void 0,type:st.type,unit:void 0},PE={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Kt.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Kt.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Kt.scale,tick:Kt.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},kE={allowDataOverflow:st.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:st.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:st.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:st.scale,tick:st.tick,tickCount:st.tickCount,ticks:void 0,type:"category",unit:void 0},Ad=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?PE:SE,Ed=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?kE:NE,no=t=>t.polarOptions,Cd=A([ir,sr,Ce],Zv),mb=A([no,Cd],(t,e)=>{if(t!=null)return Ye(t.innerRadius,e,0)}),pb=A([no,Cd],(t,e)=>{if(t!=null)return Ye(t.outerRadius,e,e*.8)}),ME=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},gb=A([no],ME);A([Ad,gb],ro);var vb=A([Cd,mb,pb],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});A([Ed,vb],ro);var yb=A([Q,no,mb,pb,ir,sr],(t,e,r,n,a,i)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:s,cy:o,startAngle:l,endAngle:d}=e;return{cx:Ye(s,a,a/2),cy:Ye(o,i,i/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:d,clockWise:!1}}}),xe=(t,e)=>e,Za=(t,e,r)=>r;function Td(t){return t?.id}var De=t=>{var e=Q(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Zn=t=>t.tooltip.settings.axisId,ze=t=>{var e=De(t),r=Zn(t);return Qa(t,e,r)},bb=A([ze],t=>t?.dataKey);function xb(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return t.forEach(o=>{var l,d=(l=o.data)!==null&&l!==void 0?l:n;if(!(d==null||d.length===0)){var u=Td(o);d.forEach((h,f)=>{var m=i==null||a?f:String(ie(h,i,null)),g=ie(h,o.dataKey,0),p;s.has(m)?p=s.get(m):p={},Object.assign(p,{[u]:g}),s.set(m,p)})}}),Array.from(s.values())}function ao(t){return t.stackId!=null&&t.dataKey!=null}function Yp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function fs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yp(Object(r),!0).forEach(function(n){OE(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yp(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OE(t,e,r){return(e=AE(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AE(t){var e=EE(t,"string");return typeof e=="symbol"?e:e+""}function EE(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var iu=[0,"auto"],at={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},wb=(t,e)=>t.cartesianAxis.xAxis[e],cr=(t,e)=>{var r=wb(t,e);return r??at},it={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:iu,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Ka},_b=(t,e)=>t.cartesianAxis.yAxis[e],ur=(t,e)=>{var r=_b(t,e);return r??it},_r={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Id=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??_r},Pe=(t,e,r)=>{switch(e){case"xAxis":return cr(t,r);case"yAxis":return ur(t,r);case"zAxis":return Id(t,r);case"angleAxis":return Ad(t,r);case"radiusAxis":return Ed(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},CE=(t,e,r)=>{switch(e){case"xAxis":return cr(t,r);case"yAxis":return ur(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Qa=(t,e,r)=>{switch(e){case"xAxis":return cr(t,r);case"yAxis":return ur(t,r);case"angleAxis":return Ad(t,r);case"radiusAxis":return Ed(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},jb=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function Dd(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var ei=t=>t.graphicalItems.cartesianItems,TE=A([xe,Za],Dd),$d=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),ti=A([ei,Pe,TE],$d),Sb=A([ti],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(ao)),Nb=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),Pb=A([ti],Nb),Rd=t=>t.map(e=>e.data).filter(Boolean).flat(1),IE=A([ti],Rd),Ld=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},Bd=A([IE,Ja],Ld),Ud=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:ie(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:ie(a,n)}))):t.map(n=>({value:n})),io=A([Bd,Pe,ti],Ud);function kb(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function fn(t){return t.filter(e=>Dt(e)||e instanceof Date).map(Number).filter(e=>ut(e)===!1)}function DE(t,e,r){return!r||typeof e!="number"||ut(e)?[]:r.length?fn(r.flatMap(n=>{var a=ie(t,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!ht(i)||!ht(s)))return[e-i,e+s]})):[]}var $E=A([Sb,Ja,ze],xb),Mb=(t,e,r)=>{var n={},a=e.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,o]=i,l=o.map(Td);return[s,{stackedData:FP(t,l,r),graphicalItems:o}]}))},su=A([$E,Sb,Xa],Mb),Ob=(t,e,r)=>{var{dataStartIndex:n,dataEndIndex:a}=e;if(r!=="zAxis"){var i=VP(t,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},RE=A([su,Dr,xe],Ob),Ab=(t,e,r,n,a)=>r.length>0?t.flatMap(i=>r.flatMap(s=>{var o,l,d=(o=n[s.id])===null||o===void 0?void 0:o.filter(h=>kb(a,h)),u=ie(i,(l=e.dataKey)!==null&&l!==void 0?l:s.dataKey);return{value:u,errorDomain:DE(i,u,d)}})).filter(Boolean):e?.dataKey!=null?t.map(i=>({value:ie(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),so=t=>t.errorBars,Eb=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>kb(r,n));A([Pb,so,xe],Eb);var LE=A([Bd,Pe,Pb,so,xe],Ab);function BE(t){var{value:e}=t;if(Dt(e)||e instanceof Date)return e}var Jp=t=>{var e=t.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=fn(e);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},UE=(t,e,r)=>{var n=t.map(BE).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&Wg(n))?gy(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Fd=t=>{var e;if(t==null||!("domain"in t))return iu;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=fn(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:iu},ms=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),o=Math.max(...i);return[s,o]}},Cb=t=>t.referenceElements.dots,Qn=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),FE=A([Cb,xe,Za],Qn),Tb=t=>t.referenceElements.areas,zE=A([Tb,xe,Za],Qn),Ib=t=>t.referenceElements.lines,qE=A([Ib,xe,Za],Qn),Db=(t,e)=>{var r=fn(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},WE=A(FE,xe,Db),$b=(t,e)=>{var r=fn(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},KE=A([zE,xe],$b),Rb=(t,e)=>{var r=fn(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},VE=A(qE,xe,Rb),HE=A(WE,VE,KE,(t,e,r)=>ms(t,r,e)),Lb=A([Pe],Fd),zd=(t,e,r,n,a,i,s)=>{var o=cE(e,t.allowDataOverflow);if(o!=null)return o;var l=i==="vertical"&&s==="xAxis"||i==="horizontal"&&s==="yAxis",d=l?ms(r,a,Jp(n)):ms(a,Jp(n));return uE(e,d,t.allowDataOverflow)},GE=A([Pe,Lb,RE,LE,HE,Q,xe],zd),YE=[0,1],qd=(t,e,r,n,a,i,s)=>{if(!((t==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:l}=t,d=Er(e,i);return d&&o==null?gy(0,r.length):l==="category"?UE(n,t,d):a==="expand"?YE:s}},Wd=A([Pe,Q,Bd,io,Xa,xe,GE],qd),Bb=(t,e,r,n,a)=>{if(t!=null){var{scale:i,type:s}=t;if(i==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(za(i));return o in va?o:"point"}}},ea=A([Pe,Q,jb,kd,xe],Bb);function JE(t){if(t!=null){if(t in va)return va[t]();var e="scale".concat(za(t));if(e in va)return va[e]()}}function Kd(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=JE(e);if(a!=null){var i=a.domain(r).range(n);return $P(i),i}}}var Vd=(t,e,r)=>{var n=Fd(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&zn(t))return xE(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&zn(t))return wE(t,e.tickCount,e.allowDecimals)}},Hd=A([Wd,Qa,ea],Vd),Gd=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&zn(e)&&Array.isArray(r)&&r.length>0){var a=e[0],i=r[0],s=e[1],o=r[r.length-1];return[Math.min(a,i),Math.max(s,o)]}return e},XE=A([Pe,Wd,Hd,xe],Gd),ZE=A(io,Pe,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(fn(t.map(o=>o.value))).sort((o,l)=>o-l);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),Ub=A(ZE,Q,hb,Ce,(t,e,r,n)=>n,(t,e,r,n,a)=>{if(!ht(t))return 0;var i=e==="vertical"?n.height:n.width;if(a==="gap")return t*i/2;if(a==="no-gap"){var s=Ye(r,t*i),o=t*i/2;return o-s-(o-s)/i*s}return 0}),QE=(t,e)=>{var r=cr(t,e);return r==null||typeof r.padding!="string"?0:Ub(t,"xAxis",e,r.padding)},e2=(t,e)=>{var r=ur(t,e);return r==null||typeof r.padding!="string"?0:Ub(t,"yAxis",e,r.padding)},t2=A(cr,QE,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),r2=A(ur,e2,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),n2=A([Ce,t2,Ws,qs,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[t.left+e.left,t.left+t.width-e.right]}),a2=A([Ce,Q,r2,Ws,qs,(t,e,r)=>r],(t,e,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),ri=(t,e,r,n)=>{var a;switch(e){case"xAxis":return n2(t,r,n);case"yAxis":return a2(t,r,n);case"zAxis":return(a=Id(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return gb(t);case"radiusAxis":return vb(t,r);default:return}},Fb=A([Pe,ri],ro),ta=A([Pe,ea,XE,Fb],Kd);A([ti,so,xe],Eb);function zb(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var oo=(t,e)=>e,lo=(t,e,r)=>r,i2=A(Fs,oo,lo,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(zb)),s2=A(zs,oo,lo,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(zb)),qb=(t,e)=>({width:t.width,height:e.height}),o2=(t,e)=>{var r=typeof e.width=="number"?e.width:Ka;return{width:r,height:t.height}},Wb=A(Ce,cr,qb),l2=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},c2=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},u2=A(sr,Ce,i2,oo,lo,(t,e,r,n,a)=>{var i={},s;return r.forEach(o=>{var l=qb(e,o);s==null&&(s=l2(e,n,t));var d=n==="top"&&!a||n==="bottom"&&a;i[o.id]=s-Number(d)*l.height,s+=(d?-1:1)*l.height}),i}),d2=A(ir,Ce,s2,oo,lo,(t,e,r,n,a)=>{var i={},s;return r.forEach(o=>{var l=o2(e,o);s==null&&(s=c2(e,n,t));var d=n==="left"&&!a||n==="right"&&a;i[o.id]=s-Number(d)*l.width,s+=(d?-1:1)*l.width}),i}),h2=(t,e)=>{var r=cr(t,e);if(r!=null)return u2(t,r.orientation,r.mirror)},f2=A([Ce,cr,h2,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r?.[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),m2=(t,e)=>{var r=ur(t,e);if(r!=null)return d2(t,r.orientation,r.mirror)},p2=A([Ce,ur,m2,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r?.[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),Kb=A(Ce,ur,(t,e)=>{var r=typeof e.width=="number"?e.width:Ka;return{width:r,height:t.height}}),Xp=(t,e,r)=>{switch(e){case"xAxis":return Wb(t,r).width;case"yAxis":return Kb(t,r).height;default:return}},Vb=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,o=Er(t,n),l=e.map(d=>d.value);if(s&&o&&i==="category"&&a&&Wg(l))return l}},Yd=A([Q,io,Pe,xe],Vb),Hb=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Er(t,n);if(s&&(a==="number"||i!=="auto"))return e.map(o=>o.value)}},Jd=A([Q,io,Qa,xe],Hb),Zp=A([Q,CE,ea,ta,Yd,Jd,ri,Hd,xe],(t,e,r,n,a,i,s,o,l)=>{if(e==null)return null;var d=Er(t,l);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:l,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:o,range:s,realScaleType:r,scale:n}}),g2=(t,e,r,n,a,i,s,o,l)=>{if(!(e==null||n==null)){var d=Er(t,l),{type:u,ticks:h,tickCount:f}=e,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,g=u==="category"&&n.bandwidth?n.bandwidth()/m:0;g=l==="angleAxis"&&i!=null&&i.length>=2?Ue(i[0]-i[1])*2*g:g;var p=h||a;if(p){var y=p.map((b,x)=>{var w=s?s.indexOf(b):b;return{index:x,coordinate:n(w)+g,value:b,offset:g}});return y.filter(b=>!ut(b.coordinate))}return d&&o?o.map((b,x)=>({coordinate:n(b)+g,value:b,index:x,offset:g})):n.ticks?n.ticks(f).map(b=>({coordinate:n(b)+g,value:b,offset:g})):n.domain().map((b,x)=>({coordinate:n(b)+g,value:s?s[b]:b,index:x,offset:g}))}},Gb=A([Q,Qa,ea,ta,Hd,ri,Yd,Jd,xe],g2),v2=(t,e,r,n,a,i,s)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var o=Er(t,s),{tickCount:l}=e,d=0;return d=s==="angleAxis"&&n?.length>=2?Ue(n[0]-n[1])*2*d:d,o&&i?i.map((u,h)=>({coordinate:r(u)+d,value:u,index:h,offset:d})):r.ticks?r.ticks(l).map(u=>({coordinate:r(u)+d,value:u,offset:d})):r.domain().map((u,h)=>({coordinate:r(u)+d,value:a?a[u]:u,index:h,offset:d}))}},Rt=A([Q,Qa,ta,ri,Yd,Jd,xe],v2),Lt=A(Pe,ta,(t,e)=>{if(!(t==null||e==null))return fs(fs({},t),{},{scale:e})}),y2=A([Pe,ea,Wd,Fb],Kd),b2=A((t,e,r)=>Id(t,r),y2,(t,e)=>{if(!(t==null||e==null))return fs(fs({},t),{},{scale:e})}),x2=A([Q,Fs,zs],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Yb=t=>t.options.defaultTooltipEventType,Jb=t=>t.options.validateTooltipEventTypes;function Xb(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function Xd(t,e){var r=Yb(t),n=Jb(t);return Xb(e,r,n)}function w2(t){return F(e=>Xd(e,t))}var Zb=(t,e)=>{var r,n=Number(e);if(!(ut(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},_2=t=>t.tooltip.settings,br={active:!1,index:null,dataKey:void 0,coordinate:void 0},j2={itemInteraction:{click:br,hover:br},axisInteraction:{click:br,hover:br},keyboardInteraction:br,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Qb=ft({name:"tooltip",initialState:j2,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var r=Yt(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:S2,removeTooltipEntrySettings:N2,setTooltipSettingsState:P2,setActiveMouseOverItemIndex:ex,mouseLeaveItem:k2,mouseLeaveChart:tx,setActiveClickItemIndex:M2,setMouseOverAxisIndex:rx,setMouseClickAxisIndex:O2,setSyncInteraction:ou,setKeyboardInteraction:lu}=Qb.actions,A2=Qb.reducer;function Qp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ki(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qp(Object(r),!0).forEach(function(n){E2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qp(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function E2(t,e,r){return(e=C2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C2(t){var e=T2(t,"string");return typeof e=="symbol"?e:e+""}function T2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I2(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function D2(t){return t.index!=null}var nx=(t,e,r,n)=>{if(e==null)return br;var a=I2(t,e,r);if(a==null)return br;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var i=t.settings.active===!0;if(D2(a)){if(i)return ki(ki({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return ki(ki({},br),{},{coordinate:a.coordinate})},Zd=(t,e)=>{var r=t?.index;if(r==null)return null;var n=Number(r);if(!ht(n))return r;var a=0,i=1/0;return e.length>0&&(i=e.length-1),String(Math.max(a,Math.min(n,i)))},ax=(t,e,r,n,a,i,s,o)=>{if(!(i==null||o==null)){var l=s[0],d=l==null?void 0:o(l.positions,i);if(d!=null)return d;var u=a?.[Number(i)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:u.coordinate}}}},ix=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=t.itemInteraction.hover.dataKey:a=t.itemInteraction.click.dataKey,a==null&&n!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},ni=t=>t.options.tooltipPayloadSearcher,ra=t=>t.tooltip;function e0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function t0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?e0(Object(r),!0).forEach(function(n){$2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $2(t,e,r){return(e=R2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R2(t){var e=L2(t,"string");return typeof e=="symbol"?e:e+""}function L2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B2(t,e){return t??e}var sx=(t,e,r,n,a,i,s)=>{if(!(e==null||i==null)){var{chartData:o,computedData:l,dataStartIndex:d,dataEndIndex:u}=r,h=[];return t.reduce((f,m)=>{var g,{dataDefinedOnItem:p,settings:y}=m,b=B2(p,o),x=Array.isArray(b)?Qv(b,d,u):b,w=(g=y?.dataKey)!==null&&g!==void 0?g:n,_=y?.nameKey,S;if(n&&Array.isArray(x)&&!Array.isArray(x[0])&&s==="axis"?S=Kg(x,n,a):S=i(x,e,l,_),Array.isArray(S))S.forEach(N=>{var M=t0(t0({},y),{},{name:N.name,unit:N.unit,color:void 0,fill:void 0});f.push(Rm({tooltipEntrySettings:M,dataKey:N.dataKey,payload:N.payload,value:ie(N.payload,N.dataKey),name:N.name}))});else{var j;f.push(Rm({tooltipEntrySettings:y,dataKey:w,payload:S,value:ie(S,w),name:(j=ie(S,_))!==null&&j!==void 0?j:y?.name}))}return f},h)}},Qd=A([ze,Q,jb,kd,De],Bb),U2=A([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),F2=A([De,Zn],Dd),ai=A([U2,ze,F2],$d),z2=A([ai],t=>t.filter(ao)),q2=A([ai],Rd),na=A([q2,Dr],Ld),W2=A([z2,Dr,ze],xb),eh=A([na,ze,ai],Ud),K2=A([ze],Fd),V2=A([ai],t=>t.filter(ao)),H2=A([W2,V2,Xa],Mb),G2=A([H2,Dr,De],Ob),Y2=A([ai],Nb),J2=A([na,ze,Y2,so,De],Ab),X2=A([Cb,De,Zn],Qn),Z2=A([X2,De],Db),Q2=A([Tb,De,Zn],Qn),eC=A([Q2,De],$b),tC=A([Ib,De,Zn],Qn),rC=A([tC,De],Rb),nC=A([Z2,rC,eC],ms),aC=A([ze,K2,G2,J2,nC,Q,De],zd),ox=A([ze,Q,na,eh,Xa,De,aC],qd),iC=A([ox,ze,Qd],Vd),sC=A([ze,ox,iC,De],Gd),lx=t=>{var e=De(t),r=Zn(t),n=!1;return ri(t,e,r,n)},cx=A([ze,lx],ro),ux=A([ze,Qd,sC,cx],Kd),oC=A([Q,eh,ze,De],Vb),lC=A([Q,eh,ze,De],Hb),cC=(t,e,r,n,a,i,s,o)=>{if(e){var{type:l}=e,d=Er(t,o);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=l==="category"&&n.bandwidth?n.bandwidth()/u:0;return h=o==="angleAxis"&&a!=null&&a?.length>=2?Ue(a[0]-a[1])*2*h:h,d&&s?s.map((f,m)=>({coordinate:n(f)+h,value:f,index:m,offset:h})):n.domain().map((f,m)=>({coordinate:n(f)+h,value:i?i[f]:f,index:m,offset:h}))}}},dr=A([Q,ze,Qd,ux,lx,oC,lC,De],cC),th=A([Yb,Jb,_2],(t,e,r)=>Xb(r.shared,t,e)),dx=t=>t.tooltip.settings.trigger,rh=t=>t.tooltip.settings.defaultIndex,co=A([ra,th,dx,rh],nx),nr=A([co,na],Zd),hx=A([dr,nr],Zb),fx=A([co],t=>{if(t)return t.dataKey}),mx=A([ra,th,dx,rh],ix),uC=A([ir,sr,Q,Ce,dr,rh,mx,ni],ax),dC=A([co,uC],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),hC=A([co],t=>t.active),fC=A([mx,nr,Dr,bb,hx,ni,th],sx),mC=A([fC],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function r0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function n0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?r0(Object(r),!0).forEach(function(n){pC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):r0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pC(t,e,r){return(e=gC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gC(t){var e=vC(t,"string");return typeof e=="symbol"?e:e+""}function vC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yC=()=>F(ze),bC=()=>{var t=yC(),e=F(dr),r=F(ux);return Ta(n0(n0({},t),{},{scale:r}),e)},xC=()=>F(kd),nh=(t,e)=>e,px=(t,e,r)=>r,ah=(t,e,r,n)=>n,wC=A(dr,t=>Ds(t,e=>e.coordinate)),ih=A([ra,nh,px,ah],nx),gx=A([ih,na],Zd),_C=(t,e,r)=>{if(e!=null){var n=ra(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},vx=A([ra,nh,px,ah],ix),ps=A([ir,sr,Q,Ce,dr,ah,vx,ni],ax),jC=A([ih,ps],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),yx=A(dr,gx,Zb),SC=A([vx,gx,Dr,bb,yx,ni,nh],sx),NC=A([ih],t=>({isActive:t.active,activeIndex:t.index})),PC=(t,e,r,n,a,i,s,o)=>{if(!(!t||!e||!n||!a||!i)){var l=HP(t.chartX,t.chartY,e,r,o);if(l){var d=YP(l,e),u=IP(d,s,i,n,a),h=GP(e,i,u,l);return{activeIndex:String(u),activeCoordinate:h}}}};function cu(){return cu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},cu.apply(null,arguments)}function a0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Mi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?a0(Object(r),!0).forEach(function(n){kC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kC(t,e,r){return(e=MC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MC(t){var e=OC(t,"string");return typeof e=="symbol"?e:e+""}function OC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AC(t){var{coordinate:e,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:o,tooltipEventType:l,chartName:d}=t,u=e,h=r,f=n;if(!o||!u||d!=="ScatterChart"&&l!=="axis")return null;var m,g;if(d==="ScatterChart")m=u,g=Yk;else if(d==="BarChart")m=Jk(s,u,a,i),g=hy;else if(s==="radial"){var{cx:p,cy:y,radius:b,startAngle:x,endAngle:w}=fy(u);m={cx:p,cy:y,startAngle:x,endAngle:w,innerRadius:b,outerRadius:b},g=py}else m={points:OM(s,u,a)},g=Gs;var _=typeof o=="object"&&"className"in o?o.className:void 0,S=Mi(Mi(Mi(Mi({stroke:"#ccc",pointerEvents:"none"},a),m),ye(o,!1)),{},{payload:h,payloadIndex:f,className:ee("recharts-tooltip-cursor",_)});return v.isValidElement(o)?v.cloneElement(o,S):v.createElement(g,S)}function EC(t){var e=bC(),r=ny(),n=Vs(),a=xC();return v.createElement(AC,cu({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var bx=v.createContext(null),CC=()=>v.useContext(bx),Yl={exports:{}},i0;function TC(){return i0||(i0=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,d,u){this.fn=l,this.context=d,this.once=u||!1}function i(l,d,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new a(u,h||l,f),g=r?r+d:d;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],m]:l._events[g].push(m):(l._events[g]=m,l._eventsCount++),l}function s(l,d){--l._eventsCount===0?l._events=new n:delete l._events[d]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var d=[],u,h;if(this._eventsCount===0)return d;for(h in u=this._events)e.call(u,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},o.prototype.listeners=function(d){var u=r?r+d:d,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,g=new Array(m);f<m;f++)g[f]=h[f].fn;return g},o.prototype.listenerCount=function(d){var u=r?r+d:d,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(d,u,h,f,m,g){var p=r?r+d:d;if(!this._events[p])return!1;var y=this._events[p],b=arguments.length,x,w;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,h),!0;case 4:return y.fn.call(y.context,u,h,f),!0;case 5:return y.fn.call(y.context,u,h,f,m),!0;case 6:return y.fn.call(y.context,u,h,f,m,g),!0}for(w=1,x=new Array(b-1);w<b;w++)x[w-1]=arguments[w];y.fn.apply(y.context,x)}else{var _=y.length,S;for(w=0;w<_;w++)switch(y[w].once&&this.removeListener(d,y[w].fn,void 0,!0),b){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,u);break;case 3:y[w].fn.call(y[w].context,u,h);break;case 4:y[w].fn.call(y[w].context,u,h,f);break;default:if(!x)for(S=1,x=new Array(b-1);S<b;S++)x[S-1]=arguments[S];y[w].fn.apply(y[w].context,x)}}return!0},o.prototype.on=function(d,u,h){return i(this,d,u,h,!1)},o.prototype.once=function(d,u,h){return i(this,d,u,h,!0)},o.prototype.removeListener=function(d,u,h,f){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return s(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!f||g.once)&&(!h||g.context===h)&&s(this,m);else{for(var p=0,y=[],b=g.length;p<b;p++)(g[p].fn!==u||f&&!g[p].once||h&&g[p].context!==h)&&y.push(g[p]);y.length?this._events[m]=y.length===1?y[0]:y:s(this,m)}return this},o.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(Yl)),Yl.exports}var IC=TC();const DC=ar(IC);var Ua=new DC,uu="recharts.syncEvent.tooltip",s0="recharts.syncEvent.brush";function uo(t,e){if(e){var r=Number.parseInt(e,10);if(!ut(r))return t?.[r]}}var $C={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},xx=ft({name:"options",initialState:$C,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),RC=xx.reducer,{createEventEmitter:LC}=xx.actions;function BC(t){return t.tooltip.syncInteraction}var UC={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},wx=ft({name:"chartData",initialState:UC,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:o0,setDataStartEndIndexes:FC,setComputedData:Z4}=wx.actions,zC=wx.reducer,qC=["x","y"];function l0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ur(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?l0(Object(r),!0).forEach(function(n){WC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WC(t,e,r){return(e=KC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KC(t){var e=VC(t,"string");return typeof e=="symbol"?e:e+""}function VC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HC(t,e){if(t==null)return{};var r,n,a=GC(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function GC(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _x=()=>{};function YC(){var t=F(Md),e=F(Od),r=be(),n=F(fb),a=F(dr),i=Vs(),s=Ks(),o=F(l=>l.rootProps.className);v.useEffect(()=>{if(t==null)return _x;var l=(d,u,h)=>{if(e!==h&&t===d){if(n==="index"){var f;if(s&&u!==null&&u!==void 0&&(f=u.payload)!==null&&f!==void 0&&f.coordinate){var m=u.payload.coordinate,{x:g,y:p}=m,y=HC(m,qC),b=Ur(Ur(Ur({},y),typeof g=="number"&&{x:Math.max(s.x,Math.min(g,s.x+s.width))}),typeof p=="number"&&{y:Math.max(s.y,Math.min(p,s.y+s.height))}),x=Ur(Ur({},u),{},{payload:Ur(Ur({},u.payload),{},{coordinate:b})});r(x)}else r(u);return}if(a!=null){var w;if(typeof n=="function"){var _={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},S=n(a,_);w=a[S]}else n==="value"&&(w=a.find(D=>String(D.value)===u.payload.label));var{coordinate:j}=u.payload;if(w==null||u.payload.active===!1||j==null||s==null){r(ou({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:N,y:M}=j,O=Math.min(N,s.x+s.width),C=Math.min(M,s.y+s.height),P={x:i==="horizontal"?w.coordinate:O,y:i==="horizontal"?C:w.coordinate},k=ou({active:u.payload.active,coordinate:P,dataKey:u.payload.dataKey,index:String(w.index),label:u.payload.label});r(k)}}};return Ua.on(uu,l),()=>{Ua.off(uu,l)}},[o,r,e,t,n,a,i,s])}function JC(){var t=F(Md),e=F(Od),r=be();v.useEffect(()=>{if(t==null)return _x;var n=(a,i,s)=>{e!==s&&t===a&&r(FC(i))};return Ua.on(s0,n),()=>{Ua.off(s0,n)}},[r,e,t])}function XC(){var t=be();v.useEffect(()=>{t(LC())},[t]),YC(),JC()}function ZC(t,e,r,n,a,i){var s=F(f=>_C(f,t,e)),o=F(Od),l=F(Md),d=F(fb),u=F(BC),h=u?.active;v.useEffect(()=>{if(!h&&l!=null&&o!=null){var f=ou({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});Ua.emit(uu,l,f,o)}},[h,r,s,a,n,o,l,d,i])}function c0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function u0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c0(Object(r),!0).forEach(function(n){QC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QC(t,e,r){return(e=eT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eT(t){var e=tT(t,"string");return typeof e=="symbol"?e:e+""}function tT(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rT(t){return t.dataKey}function nT(t,e){return v.isValidElement(t)?v.cloneElement(t,e):typeof t=="function"?v.createElement(t,e):v.createElement(kk,e)}var d0=[],aT={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!or.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function xr(t){var e=Te(t,aT),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:o,isAnimationActive:l,offset:d,payloadUniqBy:u,position:h,reverseDirection:f,useTranslate3d:m,wrapperStyle:g,cursor:p,shared:y,trigger:b,defaultIndex:x,portal:w,axisId:_}=e,S=be(),j=typeof x=="number"?String(x):x;v.useEffect(()=>{S(P2({shared:y,trigger:b,axisId:_,active:r,defaultIndex:j}))},[S,y,b,_,r,j]);var N=Ks(),M=oy(),O=w2(y),{activeIndex:C,isActive:P}=F(te=>NC(te,O,b,j)),k=F(te=>SC(te,O,b,j)),D=F(te=>yx(te,O,b,j)),I=F(te=>jC(te,O,b,j)),W=k,V=CC(),K=r??P,[X,B]=kv([W,K]),R=O==="axis"?D:void 0;ZC(O,b,I,R,C,K);var Y=w??V;if(Y==null)return null;var $=W??d0;K||($=d0),o&&$.length&&($=_v(W.filter(te=>te.value!=null&&(te.hide!==!0||e.includeHidden)),u,rT));var qe=$.length>0,hr=v.createElement(Ik,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:l,active:K,coordinate:I,hasPayload:qe,offset:d,position:h,reverseDirection:f,useTranslate3d:m,viewBox:N,wrapperStyle:g,lastBoundingBox:X,innerRef:B,hasPortalFromProps:!!w},nT(s,u0(u0({},e),{},{payload:$,label:R,active:K,coordinate:I,accessibilityLayer:M})));return v.createElement(v.Fragment,null,Yg.createPortal(hr,Y),K&&v.createElement(EC,{cursor:p,tooltipEventType:O,coordinate:I,payload:W,index:C}))}var Jl={},Xl={},Zl={},h0;function iT(){return h0||(h0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:i}={}){let s,o=null;const l=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),u=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},h=()=>{d&&u(),p()};let f=null;const m=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,h()},n)},g=()=>{f!==null&&(clearTimeout(f),f=null)},p=()=>{g(),s=void 0,o=null},y=()=>{u()},b=function(...x){if(a?.aborted)return;s=this,o=x;const w=f==null;m(),l&&w&&u()};return b.schedule=m,b.cancel=p,b.flush=y,a?.addEventListener("abort",p,{once:!0}),b}t.debounce=e})(Zl)),Zl}var f0;function sT(){return f0||(f0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iT();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:o=!0,maxWait:l}=i,d=Array(2);s&&(d[0]="leading"),o&&(d[1]="trailing");let u,h=null;const f=e.debounce(function(...p){u=n.apply(this,p),h=null},a,{edges:d}),m=function(...p){return l!=null&&(h===null&&(h=Date.now()),Date.now()-h>=l)?(u=n.apply(this,p),h=Date.now(),f.cancel(),f.schedule(),u):(f.apply(this,p),u)},g=()=>(f.flush(),u);return m.cancel=f.cancel,m.flush=g,m}t.debounce=r})(Xl)),Xl}var m0;function oT(){return m0||(m0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sT();function r(n,a=0,i={}){const{leading:s=!0,trailing:o=!0}=i;return e.debounce(n,a,{leading:s,maxWait:a,trailing:o})}t.throttle=r})(Jl)),Jl}var Ql,p0;function lT(){return p0||(p0=1,Ql=oT().throttle),Ql}var cT=lT();const uT=ar(cT);var ja=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function g0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ec(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?g0(Object(r),!0).forEach(function(n){dT(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dT(t,e,r){return(e=hT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hT(t){var e=fT(t,"string");return typeof e=="symbol"?e:e+""}function fT(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wr=v.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:o,maxHeight:l,children:d,debounce:u=0,id:h,className:f,onResize:m,style:g={}}=t,p=v.useRef(null),y=v.useRef();y.current=m,v.useImperativeHandle(e,()=>p.current);var[b,x]=v.useState({containerWidth:n.width,containerHeight:n.height}),w=v.useCallback((S,j)=>{x(N=>{var M=Math.round(S),O=Math.round(j);return N.containerWidth===M&&N.containerHeight===O?N:{containerWidth:M,containerHeight:O}})},[]);v.useEffect(()=>{var S=O=>{var C,{width:P,height:k}=O[0].contentRect;w(P,k),(C=y.current)===null||C===void 0||C.call(y,P,k)};u>0&&(S=uT(S,u,{trailing:!0,leading:!1}));var j=new ResizeObserver(S),{width:N,height:M}=p.current.getBoundingClientRect();return w(N,M),j.observe(p.current),()=>{j.disconnect()}},[w,u]);var _=v.useMemo(()=>{var{containerWidth:S,containerHeight:j}=b;if(S<0||j<0)return null;ja(Hr(a)||Hr(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),ja(!r||r>0,"The aspect(%s) must be greater than zero.",r);var N=Hr(a)?S:a,M=Hr(i)?j:i;return r&&r>0&&(N?M=N/r:M&&(N=M*r),l&&M>l&&(M=l)),ja(N>0||M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,N,M,a,i,s,o,r),v.Children.map(d,O=>v.cloneElement(O,{width:N,height:M,style:ec({width:N,height:M},O.props.style)}))},[r,d,i,l,o,s,b,a]);return v.createElement("div",{id:h?"".concat(h):void 0,className:ee("recharts-responsive-container",f),style:ec(ec({},g),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:l}),ref:p},v.createElement("div",{style:{width:0,height:0,overflow:"visible"}},_))}),mn=t=>null;mn.displayName="Cell";function mT(t,e,r){return(e=pT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pT(t){var e=gT(t,"string");return typeof e=="symbol"?e:e+""}function gT(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vT{constructor(e){mT(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function v0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?v0(Object(r),!0).forEach(function(n){bT(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bT(t,e,r){return(e=xT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xT(t){var e=wT(t,"string");return typeof e=="symbol"?e:e+""}function wT(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _T={cacheSize:2e3,enableCache:!0},jx=yT({},_T),y0=new vT(jx.cacheSize),jT={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},b0="recharts_measurement_span";function ST(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",i=e.fontStyle||"",s=e.letterSpacing||"",o=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}var x0=(t,e)=>{try{var r=document.getElementById(b0);r||(r=document.createElement("span"),r.setAttribute("id",b0),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,jT,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Sa=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||or.isSsr)return{width:0,height:0};if(!jx.enableCache)return x0(e,r);var n=ST(e,r),a=y0.get(n);if(a)return a;var i=x0(e,r);return y0.set(n,i),i},w0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,NT=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,PT=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Sx={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},kT=Object.keys(Sx),On="NaN";function MT(t,e){return t*Sx[e]}class rt{static parse(e){var r,[,n,a]=(r=PT.exec(e))!==null&&r!==void 0?r:[];return new rt(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,ut(e)&&(this.unit=""),r!==""&&!NT.test(r)&&(this.num=NaN,this.unit=""),kT.includes(r)&&(this.num=MT(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new rt(NaN,""):new rt(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new rt(NaN,""):new rt(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new rt(NaN,""):new rt(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new rt(NaN,""):new rt(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ut(this.num)}}function Nx(t){if(t.includes(On))return On;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,i]=(r=w0.exec(e))!==null&&r!==void 0?r:[],s=rt.parse(n??""),o=rt.parse(i??""),l=a==="*"?s.multiply(o):s.divide(o);if(l.isNaN())return On;e=e.replace(w0,l.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,[,u,h,f]=(d=_0.exec(e))!==null&&d!==void 0?d:[],m=rt.parse(u??""),g=rt.parse(f??""),p=h==="+"?m.add(g):m.subtract(g);if(p.isNaN())return On;e=e.replace(_0,p.toString())}return e}var j0=/\(([^()]*)\)/;function OT(t){for(var e=t,r;(r=j0.exec(e))!=null;){var[,n]=r;e=e.replace(j0,Nx(n))}return e}function AT(t){var e=t.replace(/\s+/g,"");return e=OT(e),e=Nx(e),e}function ET(t){try{return AT(t)}catch{return On}}function tc(t){var e=ET(t.slice(5,-1));return e===On?"":e}var CT=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],TT=["dx","dy","angle","className","breakAll"];function du(){return du=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},du.apply(null,arguments)}function S0(t,e){if(t==null)return{};var r,n,a=IT(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function IT(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Px=/[ \f\n\r\t\v\u2028\u2029]+/,kx=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];le(e)||(r?a=e.toString().split(""):a=e.toString().split(Px));var i=a.map(o=>({word:o,width:Sa(o,n).width})),s=r?0:Sa(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},DT=(t,e,r,n,a)=>{var{maxLines:i,children:s,style:o,breakAll:l}=t,d=q(i),u=s,h=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return P.reduce((k,D)=>{var{word:I,width:W}=D,V=k[k.length-1];if(V&&(n==null||a||V.width+W+r<Number(n)))V.words.push(I),V.width+=W+r;else{var K={words:[I],width:W};k.push(K)}return k},[])},f=h(e),m=C=>C.reduce((P,k)=>P.width>k.width?P:k);if(!d||a)return f;var g=f.length>i||m(f).width>Number(n);if(!g)return f;for(var p="…",y=C=>{var P=u.slice(0,C),k=kx({breakAll:l,style:o,children:P+p}).wordsWithComputedWidth,D=h(k),I=D.length>i||m(D).width>Number(n);return[I,D]},b=0,x=u.length-1,w=0,_;b<=x&&w<=u.length-1;){var S=Math.floor((b+x)/2),j=S-1,[N,M]=y(j),[O]=y(S);if(!N&&!O&&(b=S+1),N&&O&&(x=S-1),!N&&O){_=M;break}w++}return _||f},N0=t=>{var e=le(t)?[]:t.toString().split(Px);return[{words:e}]},$T=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=t;if((e||r)&&!or.isSsr){var o,l,d=kx({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:u,spaceWidth:h}=d;o=u,l=h}else return N0(n);return DT({breakAll:i,children:n,maxLines:s,style:a},o,l,e,r)}return N0(n)},P0="#808080",ho=v.forwardRef((t,e)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:l="end",fill:d=P0}=t,u=S0(t,CT),h=v.useMemo(()=>$T({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:s,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,s,u.style,u.width]),{dx:f,dy:m,angle:g,className:p,breakAll:y}=u,b=S0(u,TT);if(!Dt(r)||!Dt(n)||h.length===0)return null;var x=r+(q(f)?f:0),w=n+(q(m)?m:0),_;switch(l){case"start":_=tc("calc(".concat(i,")"));break;case"middle":_=tc("calc(".concat((h.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:_=tc("calc(".concat(h.length-1," * -").concat(a,")"));break}var S=[];if(s){var j=h[0].width,{width:N}=u;S.push("scale(".concat(q(N)?N/j:1,")"))}return g&&S.push("rotate(".concat(g,", ").concat(x,", ").concat(w,")")),S.length&&(b.transform=S.join(" ")),v.createElement("text",du({},ye(b,!0),{ref:e,x,y:w,className:ee("recharts-text",p),textAnchor:o,fill:d.includes("url")?P0:d}),h.map((M,O)=>{var C=M.words.join(y?"":" ");return v.createElement("tspan",{x,dy:O===0?_:a,key:"".concat(C,"-").concat(O)},C)}))});ho.displayName="Text";var RT=["labelRef"];function LT(t,e){if(t==null)return{};var r,n,a=BT(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function BT(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function k0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Se(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?k0(Object(r),!0).forEach(function(n){UT(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UT(t,e,r){return(e=FT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FT(t){var e=zT(t,"string");return typeof e=="symbol"?e:e+""}function zT(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vt(){return Vt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vt.apply(null,arguments)}var Mx=v.createContext(null),qT=t=>{var{x:e,y:r,width:n,height:a,children:i}=t,s=v.useMemo(()=>({x:e,y:r,width:n,height:a}),[e,r,n,a]);return v.createElement(Mx.Provider,{value:s},i)},Ox=()=>{var t=v.useContext(Mx),e=Ks();return t||e},WT=v.createContext(null),KT=()=>{var t=v.useContext(WT),e=F(yb);return t||e},VT=t=>{var{value:e,formatter:r}=t,n=le(t.children)?e:t.children;return typeof r=="function"?r(n):n},sh=t=>t!=null&&typeof t=="function",HT=(t,e)=>{var r=Ue(e-t),n=Math.min(Math.abs(e-t),360);return r*n},GT=(t,e,r,n,a)=>{var{offset:i,className:s}=t,{cx:o,cy:l,innerRadius:d,outerRadius:u,startAngle:h,endAngle:f,clockWise:m}=a,g=(d+u)/2,p=HT(h,f),y=p>=0?1:-1,b,x;switch(e){case"insideStart":b=h+y*i,x=m;break;case"insideEnd":b=f-y*i,x=!m;break;case"end":b=f+y*i,x=m;break;default:throw new Error("Unsupported position ".concat(e))}x=p<=0?x:!x;var w=ke(o,l,g,b),_=ke(o,l,g,b+(x?1:-1)*359),S="M".concat(w.x,",").concat(w.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(x?0:1,`,
    `).concat(_.x,",").concat(_.y),j=le(t.id)?Aa("recharts-radial-line-"):t.id;return v.createElement("text",Vt({},n,{dominantBaseline:"central",className:ee("recharts-radial-bar-label",s)}),v.createElement("defs",null,v.createElement("path",{id:j,d:S})),v.createElement("textPath",{xlinkHref:"#".concat(j)},r))},YT=(t,e,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:o,endAngle:l}=t,d=(o+l)/2;if(r==="outside"){var{x:u,y:h}=ke(n,a,s+e,d);return{x:u,y:h,textAnchor:u>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var f=(i+s)/2,{x:m,y:g}=ke(n,a,f,d);return{x:m,y:g,textAnchor:"middle",verticalAnchor:"middle"}},Ax=t=>"cx"in t&&q(t.cx),JT=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,i;r!=null&&!Ax(r)&&(i=r);var{x:s,y:o,width:l,height:d}=e,u=d>=0?1:-1,h=u*n,f=u>0?"end":"start",m=u>0?"start":"end",g=l>=0?1:-1,p=g*n,y=g>0?"end":"start",b=g>0?"start":"end";if(a==="top"){var x={x:s+l/2,y:o-u*n,textAnchor:"middle",verticalAnchor:f};return Se(Se({},x),i?{height:Math.max(o-i.y,0),width:l}:{})}if(a==="bottom"){var w={x:s+l/2,y:o+d+h,textAnchor:"middle",verticalAnchor:m};return Se(Se({},w),i?{height:Math.max(i.y+i.height-(o+d),0),width:l}:{})}if(a==="left"){var _={x:s-p,y:o+d/2,textAnchor:y,verticalAnchor:"middle"};return Se(Se({},_),i?{width:Math.max(_.x-i.x,0),height:d}:{})}if(a==="right"){var S={x:s+l+p,y:o+d/2,textAnchor:b,verticalAnchor:"middle"};return Se(Se({},S),i?{width:Math.max(i.x+i.width-S.x,0),height:d}:{})}var j=i?{width:l,height:d}:{};return a==="insideLeft"?Se({x:s+p,y:o+d/2,textAnchor:b,verticalAnchor:"middle"},j):a==="insideRight"?Se({x:s+l-p,y:o+d/2,textAnchor:y,verticalAnchor:"middle"},j):a==="insideTop"?Se({x:s+l/2,y:o+h,textAnchor:"middle",verticalAnchor:m},j):a==="insideBottom"?Se({x:s+l/2,y:o+d-h,textAnchor:"middle",verticalAnchor:f},j):a==="insideTopLeft"?Se({x:s+p,y:o+h,textAnchor:b,verticalAnchor:m},j):a==="insideTopRight"?Se({x:s+l-p,y:o+h,textAnchor:y,verticalAnchor:m},j):a==="insideBottomLeft"?Se({x:s+p,y:o+d-h,textAnchor:b,verticalAnchor:f},j):a==="insideBottomRight"?Se({x:s+l-p,y:o+d-h,textAnchor:y,verticalAnchor:f},j):a&&typeof a=="object"&&(q(a.x)||Hr(a.x))&&(q(a.y)||Hr(a.y))?Se({x:s+Ye(a.x,l),y:o+Ye(a.y,d),textAnchor:"end",verticalAnchor:"end"},j):Se({x:s+l/2,y:o+d/2,textAnchor:"middle",verticalAnchor:"middle"},j)},XT={offset:5};function vr(t){var e=Te(t,XT),{viewBox:r,position:n,value:a,children:i,content:s,className:o="",textBreakAll:l,labelRef:d}=e,u=KT(),h=Ox(),f=n==="center"?h:u??h,m=r||f;if(!m||le(a)&&le(i)&&!v.isValidElement(s)&&typeof s!="function")return null;var g=Se(Se({},e),{},{viewBox:m});if(v.isValidElement(s)){var{labelRef:p}=g,y=LT(g,RT);return v.cloneElement(s,y)}var b;if(typeof s=="function"){if(b=v.createElement(s,g),v.isValidElement(b))return b}else b=VT(e);var x=Ax(m),w=ye(e,!0);if(x&&(n==="insideStart"||n==="insideEnd"||n==="end"))return GT(e,n,b,w,m);var _=x?YT(m,e.offset,e.position):JT(e,m);return v.createElement(ho,Vt({ref:d,className:ee("recharts-label",o)},w,_,{breakAll:l}),b)}vr.displayName="Label";var ZT=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?v.createElement(vr,Vt({key:"label-implicit"},n)):Dt(t)?v.createElement(vr,Vt({key:"label-implicit",value:t},n)):v.isValidElement(t)?t.type===vr?v.cloneElement(t,Se({key:"label-implicit"},n)):v.createElement(vr,Vt({key:"label-implicit",content:t},n)):sh(t)?v.createElement(vr,Vt({key:"label-implicit",content:t},n)):t&&typeof t=="object"?v.createElement(vr,Vt({},t,{key:"label-implicit"},n)):null};function QT(t){var{label:e}=t,r=Ox();return ZT(e,r)||null}var rc={},nc={},M0;function eI(){return M0||(M0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(nc)),nc}var ac={},O0;function tI(){return O0||(O0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(ac)),ac}var A0;function rI(){return A0||(A0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eI(),r=tI(),n=Fu();function a(i){if(n.isArrayLike(i))return e.last(r.toArray(i))}t.last=a})(rc)),rc}var ic,E0;function nI(){return E0||(E0=1,ic=rI().last),ic}var aI=nI();const iI=ar(aI);var sI=["valueAccessor"],oI=["dataKey","clockWise","id","textBreakAll"];function gs(){return gs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gs.apply(null,arguments)}function C0(t,e){if(t==null)return{};var r,n,a=lI(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function lI(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var cI=t=>Array.isArray(t.value)?iI(t.value):t.value,Ex=v.createContext(void 0),oh=Ex.Provider,Cx=v.createContext(void 0),uI=Cx.Provider;function dI(){return v.useContext(Ex)}function hI(){return v.useContext(Cx)}function Ii(t){var{valueAccessor:e=cI}=t,r=C0(t,sI),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,o=C0(r,oI),l=dI(),d=hI(),u=l||d;return!u||!u.length?null:v.createElement(_e,{className:"recharts-label-list"},u.map((h,f)=>{var m,g=le(n)?e(h,f):ie(h&&h.payload,n),p=le(i)?{}:{id:"".concat(i,"-").concat(f)};return v.createElement(vr,gs({},ye(h,!0),o,p,{fill:(m=r.fill)!==null&&m!==void 0?m:h.fill,parentViewBox:h.parentViewBox,value:g,textBreakAll:s,viewBox:h.viewBox,key:"label-".concat(f),index:f}))}))}Ii.displayName="LabelList";function fo(t){var{label:e}=t;return e?e===!0?v.createElement(Ii,{key:"labelList-implicit"}):v.isValidElement(e)||sh(e)?v.createElement(Ii,{key:"labelList-implicit",content:e}):typeof e=="object"?v.createElement(Ii,gs({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}function hu(){return hu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},hu.apply(null,arguments)}var Tx=t=>{var{cx:e,cy:r,r:n,className:a}=t,i=ee("recharts-dot",a);return e===+e&&r===+r&&n===+n?v.createElement("circle",hu({},jt(t),Iu(t),{className:i,cx:e,cy:r,r:n})):null},Ix=t=>t.graphicalItems.polarItems,fI=A([xe,Za],Dd),lh=A([Ix,Pe,fI],$d),mI=A([lh],Rd),ch=A([mI,Sd],Ld),pI=A([ch,Pe,lh],Ud),gI=A([ch,Pe,lh],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var i,s=ie(n,(i=e.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):e?.dataKey!=null?t.map(n=>({value:ie(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]}))),T0=()=>{},vI=A([Pe,Lb,T0,gI,T0,Q,xe],zd),Dx=A([Pe,Q,ch,pI,Xa,xe,vI],qd),yI=A([Dx,Pe,ea],Vd);A([Pe,Dx,yI,xe],Gd);var bI={radiusAxis:{},angleAxis:{}},$x=ft({name:"polarAxis",initialState:bI,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:Q4,removeRadiusAxis:e6,addAngleAxis:t6,removeAngleAxis:r6}=$x.actions,xI=$x.reducer;function I0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function D0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?I0(Object(r),!0).forEach(function(n){wI(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wI(t,e,r){return(e=_I(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _I(t){var e=jI(t,"string");return typeof e=="symbol"?e:e+""}function jI(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SI=(t,e)=>e,uh=A([Ix,SI],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),NI=[],dh=(t,e,r)=>r?.length===0?NI:r,Rx=A([Sd,uh,dh],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if(e?.data!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>D0(D0({},e.presentationProps),i.props))),a!=null)return a}}),PI=A([Rx,uh,dh],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var i,s=ie(n,e.nameKey,e.name),o;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=e.fill,{value:Cr(s,e.dataKey),color:o,payload:n,type:e.legendType}})}),kI=A([Rx,uh,dh,Ce],(t,e,r,n)=>{if(!(e==null||t==null))return SD({offset:n,pieSettings:e,displayedData:t,cells:r})}),sc={},$0;function MI(){return $0||($0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(sc)),sc}var oc,R0;function OI(){return R0||(R0=1,oc=MI().isPlainObject),oc}var AI=OI();const EI=ar(AI);function L0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function B0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?L0(Object(r),!0).forEach(function(n){CI(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):L0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CI(t,e,r){return(e=TI(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TI(t){var e=II(t,"string");return typeof e=="symbol"?e:e+""}function II(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vs(){return vs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vs.apply(null,arguments)}var U0=(t,e,r,n,a)=>{var i=r-n,s;return s="M ".concat(t,",").concat(e),s+="L ".concat(t+r,",").concat(e),s+="L ".concat(t+r-i/2,",").concat(e+a),s+="L ".concat(t+r-i/2-n,",").concat(e+a),s+="L ".concat(t,",").concat(e," Z"),s},DI={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},$I=t=>{var e=Te(t,DI),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:o}=e,{animationEasing:l,animationDuration:d,animationBegin:u,isUpdateAnimationActive:h}=e,f=v.useRef(),[m,g]=v.useState(-1),p=v.useRef(a),y=v.useRef(i),b=v.useRef(s),x=v.useRef(r),w=v.useRef(n),_=Gn(t,"trapezoid-");if(v.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var I=f.current.getTotalLength();I&&g(I)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var S=ee("recharts-trapezoid",o);if(!h)return v.createElement("g",null,v.createElement("path",vs({},ye(e,!0),{className:S,d:U0(r,n,a,i,s)})));var j=p.current,N=y.current,M=b.current,O=x.current,C=w.current,P="0px ".concat(m===-1?1:m,"px"),k="".concat(m,"px 0px"),D=ly(["strokeDasharray"],d,l);return v.createElement(Hn,{animationId:_,key:_,canBegin:m>0,duration:d,easing:l,isActive:h,begin:u},I=>{var W=we(j,a,I),V=we(N,i,I),K=we(M,s,I),X=we(O,r,I),B=we(C,n,I);f.current&&(p.current=W,y.current=V,b.current=K,x.current=X,w.current=B);var R=I>0?{transition:D,strokeDasharray:k}:{strokeDasharray:P};return v.createElement("path",vs({},ye(e,!0),{className:S,d:U0(X,B,W,V,K),ref:f,style:B0(B0({},R),e.style)}))})},RI=["option","shapeType","propTransformer","activeClassName","isActive"];function LI(t,e){if(t==null)return{};var r,n,a=BI(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function BI(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function F0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F0(Object(r),!0).forEach(function(n){UI(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UI(t,e,r){return(e=FI(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FI(t){var e=zI(t,"string");return typeof e=="symbol"?e:e+""}function zI(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qI(t,e){return ys(ys({},e),t)}function WI(t,e){return t==="symbols"}function z0(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return v.createElement(hy,r);case"trapezoid":return v.createElement($I,r);case"sector":return v.createElement(py,r);case"symbols":if(WI(e))return v.createElement(Is,r);break;default:return null}}function KI(t){return v.isValidElement(t)?t.props:t}function bs(t){var{option:e,shapeType:r,propTransformer:n=qI,activeClassName:a="recharts-active-shape",isActive:i}=t,s=LI(t,RI),o;if(v.isValidElement(e))o=v.cloneElement(e,ys(ys({},s),KI(e)));else if(typeof e=="function")o=e(s);else if(EI(e)&&typeof e!="boolean"){var l=n(e,s);o=v.createElement(z0,{shapeType:r,elementProps:l})}else{var d=s;o=v.createElement(z0,{shapeType:r,elementProps:d})}return i?v.createElement(_e,{className:a},o):o}var mo=(t,e)=>{var r=be();return(n,a)=>i=>{t?.(n,a,i),r(ex({activeIndex:String(a),activeDataKey:e,activeCoordinate:n.tooltipPosition}))}},po=t=>{var e=be();return(r,n)=>a=>{t?.(r,n,a),e(k2())}},go=(t,e)=>{var r=be();return(n,a)=>i=>{t?.(n,a,i),r(M2({activeIndex:String(a),activeDataKey:e,activeCoordinate:n.tooltipPosition}))}};function vo(t){var{fn:e,args:r}=t,n=be(),a=Je();return v.useEffect(()=>{if(!a){var i=e(r);return n(S2(i)),()=>{n(N2(i))}}},[e,r,n,a]),null}var Lx=()=>{};function hh(t){var{legendPayload:e}=t,r=be(),n=Je();return v.useEffect(()=>n?Lx:(r(iy(e)),()=>{r(sy(e))}),[r,n,e]),null}function VI(t){var{legendPayload:e}=t,r=be(),n=F(Q);return v.useEffect(()=>n!=="centric"&&n!=="radial"?Lx:(r(iy(e)),()=>{r(sy(e))}),[r,n,e]),null}var lc,HI=()=>{var[t]=v.useState(()=>Aa("uid-"));return t},GI=(lc=Sw.useId)!==null&&lc!==void 0?lc:HI;function YI(t,e){var r=GI();return e||(t?"".concat(t,"-").concat(r):r)}var JI=v.createContext(void 0),yo=t=>{var{id:e,type:r,children:n}=t,a=YI("recharts-".concat(r),e);return v.createElement(JI.Provider,{value:a},n(a))},XI={cartesianItems:[],polarItems:[]},Bx=ft({name:"graphicalItems",initialState:XI,reducers:{addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:r,next:n}=e.payload,a=Yt(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},removeCartesianGraphicalItem(t,e){var r=Yt(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var r=Yt(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:ZI,replaceCartesianGraphicalItem:QI,removeCartesianGraphicalItem:eD,addPolarGraphicalItem:tD,removePolarGraphicalItem:rD}=Bx.actions,nD=Bx.reducer;function fh(t){var e=be(),r=v.useRef(null);return v.useEffect(()=>{r.current===null?e(ZI(t)):r.current!==t&&e(QI({prev:r.current,next:t})),r.current=t},[e,t]),v.useEffect(()=>()=>{r.current&&(e(eD(r.current)),r.current=null)},[e]),null}function aD(t){var e=be();return v.useEffect(()=>(e(tD(t)),()=>{e(rD(t))}),[e,t]),null}var iD=["onMouseEnter","onClick","onMouseLeave"],sD=["id"],oD=["id"];function mh(t,e){if(t==null)return{};var r,n,a=lD(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function lD(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function q0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ge(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?q0(Object(r),!0).forEach(function(n){cD(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):q0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cD(t,e,r){return(e=uD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uD(t){var e=dD(t,"string");return typeof e=="symbol"?e:e+""}function dD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mr(){return Mr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mr.apply(null,arguments)}function hD(t){var e=v.useMemo(()=>As(t.children,mn),[t.children]),r=F(n=>PI(n,t.id,e));return r==null?null:v.createElement(VI,{legendPayload:r})}function fD(t){var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:l,tooltipType:d}=t;return{dataDefinedOnItem:n.map(u=>u.tooltipPayload),positions:n.map(u=>u.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:e,nameKey:r,name:Cr(o,e),hide:l,type:d,color:s,unit:""}}}var mD=(t,e)=>t>e?"start":t<e?"end":"middle",pD=(t,e,r)=>Ye(typeof e=="function"?e(t):e,r,r*.8),gD=(t,e,r)=>{var{top:n,left:a,width:i,height:s}=e,o=Zv(i,s),l=a+Ye(t.cx,i,i/2),d=n+Ye(t.cy,s,s/2),u=Ye(t.innerRadius,o,0),h=pD(r,t.outerRadius,o),f=t.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:l,cy:d,innerRadius:u,outerRadius:h,maxRadius:f}},vD=(t,e)=>{var r=Ue(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function yD(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var bD=(t,e)=>{if(v.isValidElement(t))return v.cloneElement(t,e);if(typeof t=="function")return t(e);var r=ee("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return v.createElement(Gs,Mr({},e,{type:"linear",className:r}))},xD=(t,e,r)=>{if(v.isValidElement(t))return v.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),v.isValidElement(n)))return n;var a=ee("recharts-pie-label-text",yD(t));return v.createElement(ho,Mr({},e,{alignmentBaseline:"middle",className:a}),n)};function wD(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!e)return null;var o=jt(r),l=ye(a,!1),d=ye(i,!1),u=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,h=e.map((f,m)=>{var g=(f.startAngle+f.endAngle)/2,p=ke(f.cx,f.cy,f.outerRadius+u,g),y=ge(ge(ge(ge({},o),f),{},{stroke:"none"},l),{},{index:m,textAnchor:mD(p.x,f.cx)},p),b=ge(ge(ge(ge({},o),f),{},{fill:"none",stroke:f.fill},d),{},{index:m,points:[ke(f.cx,f.cy,f.outerRadius,g),p],key:"line"});return v.createElement(_e,{key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(m)},i&&bD(i,b),xD(a,y,ie(f,s)))});return v.createElement(_e,{className:"recharts-pie-labels"},h)}function _D(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?v.createElement(fo,{label:a}):v.createElement(wD,{sectors:e,props:r,showLabels:n})}function jD(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a}=t,i=F(nr),{onMouseEnter:s,onClick:o,onMouseLeave:l}=a,d=mh(a,iD),u=mo(s,a.dataKey),h=po(l),f=go(o,a.dataKey);return e==null||e.length===0?null:v.createElement(v.Fragment,null,e.map((m,g)=>{if(m?.startAngle===0&&m?.endAngle===0&&e.length!==1)return null;var p=r&&String(g)===i,y=i?n:null,b=p?r:y,x=ge(ge({},m),{},{stroke:m.stroke,tabIndex:-1,[Yu]:g,[Ju]:a.dataKey});return v.createElement(_e,Mr({tabIndex:-1,className:"recharts-pie-sector"},Vn(d,m,g),{onMouseEnter:u(m,g),onMouseLeave:h(m,g),onClick:f(m,g),key:"sector-".concat(m?.startAngle,"-").concat(m?.endAngle,"-").concat(m.midAngle,"-").concat(g)}),v.createElement(bs,Mr({option:b,isActive:p,shapeType:"sector"},x)))}))}function SD(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:i}=t,{cornerRadius:s,startAngle:o,endAngle:l,dataKey:d,nameKey:u,tooltipType:h}=r,f=Math.abs(r.minAngle),m=vD(o,l),g=Math.abs(m),p=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,y=n.filter(j=>ie(j,d,0)!==0).length,b=(g>=360?y:y-1)*p,x=g-y*f-b,w=n.reduce((j,N)=>{var M=ie(N,d,0);return j+(q(M)?M:0)},0),_;if(w>0){var S;_=n.map((j,N)=>{var M=ie(j,d,0),O=ie(j,u,N),C=gD(r,i,j),P=(q(M)?M:0)/w,k,D=ge(ge({},j),a&&a[N]&&a[N].props);N?k=S.endAngle+Ue(m)*p*(M!==0?1:0):k=o;var I=k+Ue(m)*((M!==0?f:0)+P*x),W=(k+I)/2,V=(C.innerRadius+C.outerRadius)/2,K=[{name:O,value:M,payload:D,dataKey:d,type:h}],X=ke(C.cx,C.cy,V,W);return S=ge(ge(ge(ge({},r.presentationProps),{},{percent:P,cornerRadius:s,name:O,tooltipPayload:K,midAngle:W,middleRadius:V,tooltipPosition:X},D),C),{},{value:M,startAngle:k,endAngle:I,payload:D,paddingAngle:Ue(m)*p}),S})}return _}function ND(t){var{showLabels:e,sectors:r,children:n}=t,a=v.useMemo(()=>!e||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,e]);return v.createElement(uI,{value:e?a:void 0},n)}function PD(t){var{props:e,previousSectorsRef:r}=t,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o,activeShape:l,inactiveShape:d,onAnimationStart:u,onAnimationEnd:h}=e,f=Gn(e,"recharts-pie-"),m=r.current,[g,p]=v.useState(!1),y=v.useCallback(()=>{typeof h=="function"&&h(),p(!1)},[h]),b=v.useCallback(()=>{typeof u=="function"&&u(),p(!0)},[u]);return v.createElement(ND,{showLabels:!g,sectors:n},v.createElement(Hn,{animationId:f,begin:i,duration:s,isActive:a,easing:o,onAnimationStart:b,onAnimationEnd:y,key:f},x=>{var w=[],_=n&&n[0],S=_?.startAngle;return n?.forEach((j,N)=>{var M=m&&m[N],O=N>0?rn(j,"paddingAngle",0):0;if(M){var C=we(M.endAngle-M.startAngle,j.endAngle-j.startAngle,x),P=ge(ge({},j),{},{startAngle:S+O,endAngle:S+C+O});w.push(P),S=P.endAngle}else{var{endAngle:k,startAngle:D}=j,I=we(0,k-D,x),W=ge(ge({},j),{},{startAngle:S+O,endAngle:S+I+O});w.push(W),S=W.endAngle}}),r.current=w,v.createElement(_e,null,v.createElement(jD,{sectors:w,activeShape:l,inactiveShape:d,allOtherPieProps:e}))}),v.createElement(_D,{showLabels:!g,sectors:n,props:e}),e.children)}var kD={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!or.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function MD(t){var{id:e}=t,r=mh(t,sD),{hide:n,className:a,rootTabIndex:i}=t,s=v.useMemo(()=>As(t.children,mn),[t.children]),o=F(u=>kI(u,e,s)),l=v.useRef(null),d=ee("recharts-pie",a);return n||o==null?(l.current=null,v.createElement(_e,{tabIndex:i,className:d})):v.createElement(v.Fragment,null,v.createElement(vo,{fn:fD,args:ge(ge({},t),{},{sectors:o})}),v.createElement(_e,{tabIndex:i,className:d},v.createElement(PD,{props:ge(ge({},r),{},{sectors:o}),previousSectorsRef:l})))}function Ux(t){var e=Te(t,kD),{id:r}=e,n=mh(e,oD),a=jt(n);return v.createElement(yo,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(aD,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),v.createElement(hD,Mr({},n,{id:i})),v.createElement(MD,Mr({},n,{id:i}))))}Ux.displayName="Pie";function W0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function K0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?W0(Object(r),!0).forEach(function(n){OD(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OD(t,e,r){return(e=AD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AD(t){var e=ED(t,"string");return typeof e=="symbol"?e:e+""}function ED(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CD={xAxis:{},yAxis:{},zAxis:{}},Fx=ft({name:"cartesianAxis",initialState:CD,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload;t.yAxis[r]&&(t.yAxis[r]=K0(K0({},t.yAxis[r]),{},{width:n}))}}}),{addXAxis:TD,removeXAxis:ID,addYAxis:DD,removeYAxis:$D,addZAxis:RD,removeZAxis:LD,updateYAxisWidth:BD}=Fx.actions,UD=Fx.reducer,FD=A([Ce],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),zD=A([FD,ir,sr],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),ph=()=>F(zD),qD=()=>F(mC);function V0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function H0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?V0(Object(r),!0).forEach(function(n){WD(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):V0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WD(t,e,r){return(e=KD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KD(t){var e=VD(t,"string");return typeof e=="symbol"?e:e+""}function VD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HD=t=>{var{point:e,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=t;if(a===!1||e.x==null||e.y==null)return null;var s=H0(H0({index:r,dataKey:i,cx:e.x,cy:e.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},ye(a,!1)),Iu(a)),o;return v.isValidElement(a)?o=v.cloneElement(a,s):typeof a=="function"?o=a(s):o=v.createElement(Tx,s),v.createElement(_e,{className:"recharts-active-dot"},o)};function GD(t){var{points:e,mainColor:r,activeDot:n,itemDataKey:a}=t,i=F(nr),s=qD();if(e==null||s==null)return null;var o=e.find(l=>s.includes(l.payload));return le(o)?null:HD({point:o,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var YD="Invariant failed";function JD(t,e){throw new Error(YD)}var XD=["x","y"];function fu(){return fu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fu.apply(null,arguments)}function G0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ma(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G0(Object(r),!0).forEach(function(n){ZD(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZD(t,e,r){return(e=QD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QD(t){var e=e$(t,"string");return typeof e=="symbol"?e:e+""}function e$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t$(t,e){if(t==null)return{};var r,n,a=r$(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function r$(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function n$(t,e){var{x:r,y:n}=t,a=t$(t,XD),i="".concat(r),s=parseInt(i,10),o="".concat(n),l=parseInt(o,10),d="".concat(e.height||a.height),u=parseInt(d,10),h="".concat(e.width||a.width),f=parseInt(h,10);return ma(ma(ma(ma(ma({},e),a),s?{x:s}:{}),l?{y:l}:{}),{},{height:u,width:f,name:e.name,radius:e.radius})}function gh(t){return v.createElement(bs,fu({shapeType:"rectangle",propTransformer:n$,activeClassName:"recharts-active-bar"},t))}var a$=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(q(e))return e;var i=q(n)||le(n);return i?e(n,a):(i||JD(),r)}},i$={},zx=ft({name:"errorBars",initialState:i$,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:n6,replaceErrorBar:a6,removeErrorBar:i6}=zx.actions,s$=zx.reducer,o$=["children"];function l$(t,e){if(t==null)return{};var r,n,a=c$(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function c$(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var u$={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},d$=v.createContext(u$);function vh(t){var{children:e}=t,r=l$(t,o$);return v.createElement(d$.Provider,{value:r},e)}function bo(t,e){var r,n,a=F(d=>cr(d,t)),i=F(d=>ur(d,e)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:at.allowDataOverflow,o=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:it.allowDataOverflow,l=s||o;return{needClip:l,needClipX:s,needClipY:o}}function yh(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=ph(),{needClipX:i,needClipY:s,needClip:o}=bo(e,r);if(!o)return null;var{x:l,y:d,width:u,height:h}=a;return v.createElement("clipPath",{id:"clipPath-".concat(n)},v.createElement("rect",{x:i?l:l-u/2,y:s?d:d-h/2,width:i?u:u*2,height:s?h:h*2}))}var h$=["onMouseEnter","onMouseLeave","onClick"],f$=["value","background","tooltipPosition"],m$=["id"],p$=["onMouseEnter","onClick","onMouseLeave"];function Or(){return Or=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Or.apply(null,arguments)}function Y0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function et(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Y0(Object(r),!0).forEach(function(n){g$(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Y0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g$(t,e,r){return(e=v$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v$(t){var e=y$(t,"string");return typeof e=="symbol"?e:e+""}function y$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xs(t,e){if(t==null)return{};var r,n,a=b$(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function b$(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var x$=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:i}=t;return[{inactive:i,dataKey:e,type:a,color:n,value:Cr(r,e),payload:t}]};function w$(t){var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:o}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:Cr(i,e),hide:s,type:t.tooltipType,color:t.fill,unit:o}}}function _$(t){var e=F(nr),{data:r,dataKey:n,background:a,allOtherBarProps:i}=t,{onMouseEnter:s,onMouseLeave:o,onClick:l}=i,d=xs(i,h$),u=mo(s,n),h=po(o),f=go(l,n);if(!a||r==null)return null;var m=ye(a,!1);return v.createElement(v.Fragment,null,r.map((g,p)=>{var{value:y,background:b,tooltipPosition:x}=g,w=xs(g,f$);if(!b)return null;var _=u(g,p),S=h(g,p),j=f(g,p),N=et(et(et(et(et({option:a,isActive:String(p)===e},w),{},{fill:"#eee"},b),m),Vn(d,g,p)),{},{onMouseEnter:_,onMouseLeave:S,onClick:j,dataKey:n,index:p,className:"recharts-bar-background-rectangle"});return v.createElement(gh,Or({key:"background-bar-".concat(N.index)},N))}))}function j$(t){var{showLabels:e,children:r,rects:n}=t,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return et(et({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return v.createElement(oh,{value:e?a:void 0},r)}function S$(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=t,o=F(nr),l=F(fx),d=r&&String(i)===o&&(l==null||s===l),u=d?r:e;return v.createElement(gh,Or({},n,a,{isActive:d,option:u,index:i,dataKey:s}))}function N$(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:i}=t;return v.createElement(gh,Or({},r,n,{isActive:!1,option:e,index:a,dataKey:i}))}function P$(t){var{data:e,props:r}=t,n=jt(r),{id:a}=n,i=xs(n,m$),{shape:s,dataKey:o,activeBar:l}=r,{onMouseEnter:d,onClick:u,onMouseLeave:h}=r,f=xs(r,p$),m=mo(d,o),g=po(h),p=go(u,o);return e?v.createElement(v.Fragment,null,e.map((y,b)=>v.createElement(_e,Or({className:"recharts-bar-rectangle"},Vn(f,y,b),{onMouseEnter:m(y,b),onMouseLeave:g(y,b),onClick:p(y,b),key:"rectangle-".concat(y?.x,"-").concat(y?.y,"-").concat(y?.value,"-").concat(b)}),l?v.createElement(S$,{shape:s,activeBar:l,baseProps:i,entry:y,index:b,dataKey:o}):v.createElement(N$,{shape:s,baseProps:i,entry:y,index:b,dataKey:o})))):null}function k$(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l,onAnimationEnd:d,onAnimationStart:u}=e,h=r.current,f=Gn(e,"recharts-bar-"),[m,g]=v.useState(!1),p=!m,y=v.useCallback(()=>{typeof d=="function"&&d(),g(!1)},[d]),b=v.useCallback(()=>{typeof u=="function"&&u(),g(!0)},[u]);return v.createElement(j$,{showLabels:p,rects:n},v.createElement(Hn,{animationId:f,begin:s,duration:o,isActive:i,easing:l,onAnimationEnd:y,onAnimationStart:b,key:f},x=>{var w=x===1?n:n?.map((_,S)=>{var j=h&&h[S];if(j)return et(et({},_),{},{x:we(j.x,_.x,x),y:we(j.y,_.y,x),width:we(j.width,_.width,x),height:we(j.height,_.height,x)});if(a==="horizontal"){var N=we(0,_.height,x);return et(et({},_),{},{y:_.y+_.height-N,height:N})}var M=we(0,_.width,x);return et(et({},_),{},{width:M})});return x>0&&(r.current=w??null),w==null?null:v.createElement(_e,null,v.createElement(P$,{props:e,data:w}))}),v.createElement(fo,{label:e.label}),e.children)}function M$(t){var e=v.useRef(null);return v.createElement(k$,{previousRectanglesRef:e,props:t})}var qx=0,O$=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:ie(t,e)}};class A$ extends v.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:o,background:l,id:d}=this.props;if(e||r==null)return null;var u=ee("recharts-bar",a),h=d;return v.createElement(_e,{className:u,id:d},o&&v.createElement("defs",null,v.createElement(yh,{clipPathId:h,xAxisId:i,yAxisId:s})),v.createElement(_e,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(h,")"):void 0},v.createElement(_$,{data:r,dataKey:n,background:l,allOtherBarProps:this.props}),v.createElement(M$,this.props)))}}var E$={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!or.isSsr,legendType:"rect",minPointSize:qx,xAxisId:0,yAxisId:0};function C$(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:l,animationEasing:d,isAnimationActive:u}=t,{needClip:h}=bo(e,r),f=Vs(),m=Je(),g=As(t.children,mn),p=F(x=>s5(x,e,r,m,t.id,g));if(f!=="vertical"&&f!=="horizontal")return null;var y,b=p?.[0];return b==null||b.height==null||b.width==null?y=0:y=f==="vertical"?b.height/2:b.width/2,v.createElement(vh,{xAxisId:e,yAxisId:r,data:p,dataPointFormatter:O$,errorBarOffset:y},v.createElement(A$,Or({},t,{layout:f,needClip:h,data:p,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:l,animationEasing:d,isAnimationActive:u})))}function T$(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:o,xAxisTicks:l,yAxisTicks:d,stackedData:u,displayedData:h,offset:f,cells:m,parentViewBox:g}=t,p=e==="horizontal"?o:s,y=u?p.scale.domain():null,b=qP({numericAxis:p});return h.map((x,w)=>{var _,S,j,N,M,O;u?_=RP(u[w],y):(_=ie(x,r),Array.isArray(_)||(_=[b,_]));var C=a$(n,qx)(_[1],w);if(e==="horizontal"){var P,[k,D]=[o.scale(_[0]),o.scale(_[1])];S=Im({axis:s,ticks:l,bandSize:i,offset:a.offset,entry:x,index:w}),j=(P=D??k)!==null&&P!==void 0?P:void 0,N=a.size;var I=k-D;if(M=ut(I)?0:I,O={x:S,y:f.top,width:N,height:f.height},Math.abs(C)>0&&Math.abs(M)<Math.abs(C)){var W=Ue(M||C)*(Math.abs(C)-Math.abs(M));j-=W,M+=W}}else{var[V,K]=[s.scale(_[0]),s.scale(_[1])];if(S=V,j=Im({axis:o,ticks:d,bandSize:i,offset:a.offset,entry:x,index:w}),N=K-V,M=a.size,O={x:f.left,y:j,width:f.width,height:M},Math.abs(C)>0&&Math.abs(N)<Math.abs(C)){var X=Ue(N||C)*(Math.abs(C)-Math.abs(N));N+=X}}if(S==null||j==null||N==null||M==null)return null;var B=et(et({},x),{},{x:S,y:j,width:N,height:M,value:u?_:_[1],payload:x,background:O,tooltipPosition:{x:S+N/2,y:j+M/2},parentViewBox:g},m&&m[w]&&m[w].props);return B}).filter(Boolean)}function I$(t){var e=Te(t,E$),r=Je();return v.createElement(yo,{id:e.id,type:"bar"},n=>v.createElement(v.Fragment,null,v.createElement(hh,{legendPayload:x$(e)}),v.createElement(vo,{fn:w$,args:e}),v.createElement(fh,{type:"bar",id:n,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:zP(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:r}),v.createElement(C$,Or({},e,{id:n}))))}var An=v.memo(I$);An.displayName="Bar";function J0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Oi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?J0(Object(r),!0).forEach(function(n){D$(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function D$(t,e,r){return(e=$$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $$(t){var e=R$(t,"string");return typeof e=="symbol"?e:e+""}function R$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var L$=(t,e)=>e,B$=(t,e,r)=>r,U$=(t,e,r,n)=>n,F$=(t,e,r,n,a)=>a,ii=A([ei,F$],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),z$=A([ii],t=>t?.maxBarSize),q$=(t,e,r,n,a,i)=>i,X0=(t,e,r)=>{var n=r??t;if(!le(n))return Ye(n,e,0)},W$=A([Q,ei,L$,B$,U$],(t,e,r,n,a)=>e.filter(i=>t==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),K$=(t,e,r,n)=>{var a=Q(t);return a==="horizontal"?su(t,"yAxis",r,n):su(t,"xAxis",e,n)},V$=(t,e,r)=>{var n=Q(t);return n==="horizontal"?Xp(t,"xAxis",e):Xp(t,"yAxis",r)},H$=(t,e,r)=>{var n={},a=t.filter(ao),i=t.filter(d=>d.stackId==null),s=a.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),n),o=Object.entries(s).map(d=>{var[u,h]=d,f=h.map(g=>g.dataKey),m=X0(e,r,h[0].barSize);return{stackId:u,dataKeys:f,barSize:m}}),l=i.map(d=>{var u=[d.dataKey].filter(f=>f!=null),h=X0(e,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:h}});return[...o,...l]},G$=A([W$,jE,V$],H$),Y$=(t,e,r,n,a)=>{var i,s,o=ii(t,e,r,n,a);if(o!=null){var l=Q(t),d=db(t),{maxBarSize:u}=o,h=le(u)?d:u,f,m;return l==="horizontal"?(f=Lt(t,"xAxis",e,n),m=Rt(t,"xAxis",e,n)):(f=Lt(t,"yAxis",r,n),m=Rt(t,"yAxis",r,n)),(i=(s=Ta(f,m,!0))!==null&&s!==void 0?s:h)!==null&&i!==void 0?i:0}},Wx=(t,e,r,n)=>{var a=Q(t),i,s;return a==="horizontal"?(i=Lt(t,"xAxis",e,n),s=Rt(t,"xAxis",e,n)):(i=Lt(t,"yAxis",r,n),s=Rt(t,"yAxis",r,n)),Ta(i,s)};function J$(t,e,r,n,a){var i=n.length;if(!(i<1)){var s=Ye(t,r,0,!0),o,l=[];if(ht(n[0].barSize)){var d=!1,u=r/i,h=n.reduce((b,x)=>b+(x.barSize||0),0);h+=(i-1)*s,h>=r&&(h-=(i-1)*s,s=0),h>=r&&u>0&&(d=!0,u*=.9,h=i*u);var f=(r-h)/2>>0,m={offset:f-s,size:0};o=n.reduce((b,x)=>{var w,_={stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:m.offset+m.size+s,size:d?u:(w=x.barSize)!==null&&w!==void 0?w:0}},S=[...b,_];return m=S[S.length-1].position,S},l)}else{var g=Ye(e,r,0,!0);r-2*g-(i-1)*s<=0&&(s=0);var p=(r-2*g-(i-1)*s)/i;p>1&&(p>>=0);var y=ht(a)?Math.min(p,a):p;o=n.reduce((b,x,w)=>[...b,{stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:g+(p+s)*w+(p-y)/2,size:y}}],l)}return o}}var X$=(t,e,r,n,a,i,s)=>{var o=le(s)?e:s,l=J$(r,n,a!==i?a:i,t,o);return a!==i&&l!=null&&(l=l.map(d=>Oi(Oi({},d),{},{position:Oi(Oi({},d.position),{},{offset:d.position.offset-a/2})}))),l},Z$=A([G$,db,_E,hb,Y$,Wx,z$],X$),Q$=(t,e,r,n)=>Lt(t,"xAxis",e,n),e5=(t,e,r,n)=>Lt(t,"yAxis",r,n),t5=(t,e,r,n)=>Rt(t,"xAxis",e,n),r5=(t,e,r,n)=>Rt(t,"yAxis",r,n),n5=A([Z$,ii],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),a5=(t,e)=>{var r=Td(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},i5=A([K$,ii],a5),s5=A([Ce,Xu,Q$,e5,t5,r5,n5,Q,Ja,Wx,i5,ii,q$],(t,e,r,n,a,i,s,o,l,d,u,h,f)=>{var{chartData:m,dataStartIndex:g,dataEndIndex:p}=l;if(!(h==null||s==null||e==null||o!=="horizontal"&&o!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:y}=h,b;if(y!=null&&y.length>0?b=y:b=m?.slice(g,p+1),b!=null)return T$({layout:o,barSettings:h,pos:s,parentViewBox:e,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:u,displayedData:b,offset:t,cells:f})}}),Kx=t=>{var{chartData:e}=t,r=be(),n=Je();return v.useEffect(()=>n?()=>{}:(r(o0(e)),()=>{r(o0(void 0))}),[e,r,n]),null},Z0={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Vx=ft({name:"brush",initialState:Z0,reducers:{setBrushSettings(t,e){return e.payload==null?Z0:e.payload}}}),{setBrushSettings:s6}=Vx.actions,o5=Vx.reducer;function l5(t,e,r){return(e=c5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c5(t){var e=u5(t,"string");return typeof e=="symbol"?e:e+""}function u5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bh{static create(e){return new bh(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(e)+i}default:return this.scale(e)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}l5(bh,"EPS",1e-4);function d5(t){return(t%180+180)%180}var h5=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=d5(a),s=i*Math.PI/180,o=Math.atan(n/r),l=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(l)},f5={dots:[],areas:[],lines:[]},Hx=ft({name:"referenceElements",initialState:f5,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Yt(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Yt(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Yt(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:o6,removeDot:l6,addArea:c6,removeArea:u6,addLine:d6,removeLine:h6}=Hx.actions,m5=Hx.reducer,p5=v.createContext(void 0),g5=t=>{var{children:e}=t,[r]=v.useState("".concat(Aa("recharts"),"-clip")),n=ph();if(n==null)return null;var{x:a,y:i,width:s,height:o}=n;return v.createElement(p5.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:a,y:i,height:o,width:s}))),e)};function qn(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function Gx(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],a=0;a<t.length;a+=e)n.push(t[a]);return n}function v5(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return h5(n,r)}function y5(t,e,r){var n=r==="width",{x:a,y:i,width:s,height:o}=t;return e===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function ws(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var i=r();return t*(e-t*i/2-n)>=0&&t*(e+t*i/2-a)<=0}function b5(t,e){return Gx(t,e+1)}function x5(t,e,r,n,a){for(var i=(n||[]).slice(),{start:s,end:o}=e,l=0,d=1,u=s,h=function(){var g=n?.[l];if(g===void 0)return{v:Gx(n,d)};var p=l,y,b=()=>(y===void 0&&(y=r(g,p)),y),x=g.coordinate,w=l===0||ws(t,x,b,u,o);w||(l=0,u=s,d+=1),w&&(u=x+t*(b()/2+a),l+=d)},f;d<=i.length;)if(f=h(),f)return f.v;return[]}function Q0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ve(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Q0(Object(r),!0).forEach(function(n){w5(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function w5(t,e,r){return(e=_5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _5(t){var e=j5(t,"string");return typeof e=="symbol"?e:e+""}function j5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S5(t,e,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:o}=e,{end:l}=e,d=function(f){var m=i[f],g,p=()=>(g===void 0&&(g=r(m,f)),g);if(f===s-1){var y=t*(m.coordinate+t*p()/2-l);i[f]=m=Ve(Ve({},m),{},{tickCoord:y>0?m.coordinate-y*t:m.coordinate})}else i[f]=m=Ve(Ve({},m),{},{tickCoord:m.coordinate});var b=ws(t,m.tickCoord,p,o,l);b&&(l=m.tickCoord-t*(p()/2+a),i[f]=Ve(Ve({},m),{},{isShow:!0}))},u=s-1;u>=0;u--)d(u);return i}function N5(t,e,r,n,a,i){var s=(n||[]).slice(),o=s.length,{start:l,end:d}=e;if(i){var u=n[o-1],h=r(u,o-1),f=t*(u.coordinate+t*h/2-d);s[o-1]=u=Ve(Ve({},u),{},{tickCoord:f>0?u.coordinate-f*t:u.coordinate});var m=ws(t,u.tickCoord,()=>h,l,d);m&&(d=u.tickCoord-t*(h/2+a),s[o-1]=Ve(Ve({},u),{},{isShow:!0}))}for(var g=i?o-1:o,p=function(x){var w=s[x],_,S=()=>(_===void 0&&(_=r(w,x)),_);if(x===0){var j=t*(w.coordinate-t*S()/2-l);s[x]=w=Ve(Ve({},w),{},{tickCoord:j<0?w.coordinate-j*t:w.coordinate})}else s[x]=w=Ve(Ve({},w),{},{tickCoord:w.coordinate});var N=ws(t,w.tickCoord,S,l,d);N&&(l=w.tickCoord+t*(S()/2+a),s[x]=Ve(Ve({},w),{},{isShow:!0}))},y=0;y<g;y++)p(y);return s}function xh(t,e,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:o,interval:l,tickFormatter:d,unit:u,angle:h}=t;if(!a||!a.length||!n)return[];if(q(l)||or.isSsr){var f;return(f=b5(a,q(l)?l:0))!==null&&f!==void 0?f:[]}var m=[],g=o==="top"||o==="bottom"?"width":"height",p=u&&g==="width"?Sa(u,{fontSize:e,letterSpacing:r}):{width:0,height:0},y=(w,_)=>{var S=typeof d=="function"?d(w.value,_):w.value;return g==="width"?v5(Sa(S,{fontSize:e,letterSpacing:r}),p,h):Sa(S,{fontSize:e,letterSpacing:r})[g]},b=a.length>=2?Ue(a[1].coordinate-a[0].coordinate):1,x=y5(i,b,g);return l==="equidistantPreserveStart"?x5(b,x,y,a,s):(l==="preserveStart"||l==="preserveStartEnd"?m=N5(b,x,y,a,s,l==="preserveStartEnd"):m=S5(b,x,y,a,s),m.filter(w=>w.isShow))}var P5=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=t,s=0;if(e){e.forEach(u=>{if(u){var h=u.getBoundingClientRect();h.width>s&&(s=h.width)}});var o=r?r.getBoundingClientRect().width:0,l=a+i,d=s+l+o+(r?n:0);return Math.round(d)}return 0},k5=["axisLine","width","height","className","hide","ticks"],M5=["viewBox"],O5=["viewBox"];function mu(t,e){if(t==null)return{};var r,n,a=A5(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function A5(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function on(){return on=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},on.apply(null,arguments)}function eg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ee(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eg(Object(r),!0).forEach(function(n){E5(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function E5(t,e,r){return(e=C5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C5(t){var e=T5(t,"string");return typeof e=="symbol"?e:e+""}function T5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wh={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function I5(t){var{x:e,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:o,otherSvgProps:l}=t;if(!o)return null;var d=Ee(Ee(Ee({},l),ye(o,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!s||i==="bottom"&&s);d=Ee(Ee({},d),{},{x1:e,y1:r+u*a,x2:e+n,y2:r+u*a})}else{var h=+(i==="left"&&!s||i==="right"&&s);d=Ee(Ee({},d),{},{x1:e+h*n,y1:r,x2:e+h*n,y2:r+a})}return v.createElement("line",on({},d,{className:ee("recharts-cartesian-axis-line",rn(o,"className"))}))}function D5(t,e,r,n,a,i,s,o,l){var d,u,h,f,m,g,p=o?-1:1,y=t.tickSize||s,b=q(t.tickCoord)?t.tickCoord:t.coordinate;switch(i){case"top":d=u=t.coordinate,f=r+ +!o*a,h=f-p*y,g=h-p*l,m=b;break;case"left":h=f=t.coordinate,u=e+ +!o*n,d=u-p*y,m=d-p*l,g=b;break;case"right":h=f=t.coordinate,u=e+ +o*n,d=u+p*y,m=d+p*l,g=b;break;default:d=u=t.coordinate,f=r+ +o*a,h=f+p*y,g=h+p*l,m=b;break}return{line:{x1:d,y1:h,x2:u,y2:f},tick:{x:m,y:g}}}function $5(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function R5(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function L5(t){var{option:e,tickProps:r,value:n}=t,a,i=ee(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(e))a=v.cloneElement(e,Ee(Ee({},r),{},{className:i}));else if(typeof e=="function")a=e(Ee(Ee({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(s=ee(s,e?.className)),a=v.createElement(ho,on({},r,{className:s}),n)}return a}function B5(t){var{ticks:e=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:o,tickTextProps:l,orientation:d,mirror:u,x:h,y:f,width:m,height:g,tickSize:p,tickMargin:y,fontSize:b,letterSpacing:x,getTicksConfig:w,events:_}=t,S=xh(Ee(Ee({},w),{},{ticks:e}),b,x),j=$5(d,u),N=R5(d,u),M=jt(w),O=ye(r,!1),C=Ee(Ee({},M),{},{fill:"none"},ye(n,!1)),P=S.map((k,D)=>{var{line:I,tick:W}=D5(k,h,f,m,g,d,p,u,y),V=Ee(Ee(Ee(Ee({textAnchor:j,verticalAnchor:N},M),{},{stroke:"none",fill:a},O),W),{},{index:D,payload:k,visibleTicksCount:S.length,tickFormatter:i,padding:o},l);return v.createElement(_e,on({className:"recharts-cartesian-axis-tick",key:"tick-".concat(k.value,"-").concat(k.coordinate,"-").concat(k.tickCoord)},Vn(_,k,D)),n&&v.createElement("line",on({},C,I,{className:ee("recharts-cartesian-axis-tick-line",rn(n,"className"))})),r&&v.createElement(L5,{option:r,tickProps:V,value:"".concat(typeof i=="function"?i(k.value,D):k.value).concat(s||"")}))});return P.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},P):null}var U5=v.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:o}=t,l=mu(t,k5),[d,u]=v.useState(""),[h,f]=v.useState(""),m=v.useRef([]);v.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var p;return P5({ticks:m.current,label:(p=t.labelRef)===null||p===void 0?void 0:p.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var g=v.useCallback(p=>{if(p){var y=p.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=Array.from(y);var b=y[0];if(b){var x=window.getComputedStyle(b),w=x.fontSize,_=x.letterSpacing;(w!==d||_!==h)&&(u(w),f(_))}}},[d,h]);return s||n!=null&&n<=0||a!=null&&a<=0?null:v.createElement(_e,{className:ee("recharts-cartesian-axis",i),ref:g},v.createElement(I5,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:jt(t)}),v.createElement(B5,{ticks:o,tick:t.tick,tickLine:t.tickLine,stroke:t.stroke,tickFormatter:t.tickFormatter,unit:t.unit,padding:t.padding,tickTextProps:t.tickTextProps,orientation:t.orientation,mirror:t.mirror,x:t.x,y:t.y,width:t.width,height:t.height,tickSize:t.tickSize,tickMargin:t.tickMargin,fontSize:d,letterSpacing:h,getTicksConfig:t,events:l}),v.createElement(qT,{x:t.x,y:t.y,width:t.width,height:t.height},v.createElement(QT,{label:t.label}),t.children))}),F5=v.memo(U5,(t,e)=>{var{viewBox:r}=t,n=mu(t,M5),{viewBox:a}=e,i=mu(e,O5);return qn(r,a)&&qn(n,i)}),_h=v.forwardRef((t,e)=>{var r=Te(t,wh);return v.createElement(F5,on({},r,{ref:e}))});_h.displayName="CartesianAxis";var z5=["x1","y1","x2","y2","key"],q5=["offset"],W5=["xAxisId","yAxisId"],K5=["xAxisId","yAxisId"];function tg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function He(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tg(Object(r),!0).forEach(function(n){V5(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function V5(t,e,r){return(e=H5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H5(t){var e=G5(t,"string");return typeof e=="symbol"?e:e+""}function G5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jr(){return Jr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jr.apply(null,arguments)}function _s(t,e){if(t==null)return{};var r,n,a=Y5(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Y5(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var J5=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:o}=t;return v.createElement("rect",{x:n,y:a,ry:o,width:i,height:s,stroke:"none",fill:e,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function Yx(t,e){var r;if(v.isValidElement(t))r=v.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var{x1:n,y1:a,x2:i,y2:s,key:o}=e,l=_s(e,z5),d=jt(l),{offset:u}=d,h=_s(d,q5);r=v.createElement("line",Jr({},h,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:o}))}return r}function X5(t){var{x:e,width:r,horizontal:n=!0,horizontalPoints:a}=t;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=t,o=_s(t,W5),l=a.map((d,u)=>{var h=He(He({},o),{},{x1:e,y1:d,x2:e+r,y2:d,key:"line-".concat(u),index:u});return Yx(n,h)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function Z5(t){var{y:e,height:r,vertical:n=!0,verticalPoints:a}=t;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=t,o=_s(t,K5),l=a.map((d,u)=>{var h=He(He({},o),{},{x1:d,y1:e,x2:d,y2:e+r,key:"line-".concat(u),index:u});return Yx(n,h)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function Q5(t){var{horizontalFill:e,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:o,horizontal:l=!0}=t;if(!l||!e||!e.length)return null;var d=o.map(h=>Math.round(h+a-a)).sort((h,f)=>h-f);a!==d[0]&&d.unshift(0);var u=d.map((h,f)=>{var m=!d[f+1],g=m?a+s-h:d[f+1]-h;if(g<=0)return null;var p=f%e.length;return v.createElement("rect",{key:"react-".concat(f),y:h,x:n,height:g,width:i,stroke:"none",fill:e[p],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function e3(t){var{vertical:e=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:o,verticalPoints:l}=t;if(!e||!r||!r.length)return null;var d=l.map(h=>Math.round(h+a-a)).sort((h,f)=>h-f);a!==d[0]&&d.unshift(0);var u=d.map((h,f)=>{var m=!d[f+1],g=m?a+s-h:d[f+1]-h;if(g<=0)return null;var p=f%r.length;return v.createElement("rect",{key:"react-".concat(f),x:h,y:i,width:g,height:o,stroke:"none",fill:r[p],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var t3=(t,e)=>{var{xAxis:r,width:n,height:a,offset:i}=t;return ey(xh(He(He(He({},wh),r),{},{ticks:ty(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,e)},r3=(t,e)=>{var{yAxis:r,width:n,height:a,offset:i}=t;return ey(xh(He(He(He({},wh),r),{},{ticks:ty(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,e)},n3={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function jr(t){var e=Zu(),r=Qu(),n=ny(),a=He(He({},Te(t,n3)),{},{x:q(t.x)?t.x:n.left,y:q(t.y)?t.y:n.top,width:q(t.width)?t.width:n.width,height:q(t.height)?t.height:n.height}),{xAxisId:i,yAxisId:s,x:o,y:l,width:d,height:u,syncWithTicks:h,horizontalValues:f,verticalValues:m}=a,g=Je(),p=F(O=>Zp(O,"xAxis",i,g)),y=F(O=>Zp(O,"yAxis",s,g));if(!q(d)||d<=0||!q(u)||u<=0||!q(o)||o!==+o||!q(l)||l!==+l)return null;var b=a.verticalCoordinatesGenerator||t3,x=a.horizontalCoordinatesGenerator||r3,{horizontalPoints:w,verticalPoints:_}=a;if((!w||!w.length)&&typeof x=="function"){var S=f&&f.length,j=x({yAxis:y?He(He({},y),{},{ticks:S?f:y.ticks}):void 0,width:e,height:r,offset:n},S?!0:h);ja(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(w=j)}if((!_||!_.length)&&typeof b=="function"){var N=m&&m.length,M=b({xAxis:p?He(He({},p),{},{ticks:N?m:p.ticks}):void 0,width:e,height:r,offset:n},N?!0:h);ja(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof M,"]")),Array.isArray(M)&&(_=M)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(J5,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),v.createElement(Q5,Jr({},a,{horizontalPoints:w})),v.createElement(e3,Jr({},a,{verticalPoints:_})),v.createElement(X5,Jr({},a,{offset:n,horizontalPoints:w,xAxis:p,yAxis:y})),v.createElement(Z5,Jr({},a,{offset:n,verticalPoints:_,xAxis:p,yAxis:y})))}jr.displayName="CartesianGrid";var Jx=(t,e,r,n)=>Lt(t,"xAxis",e,n),Xx=(t,e,r,n)=>Rt(t,"xAxis",e,n),Zx=(t,e,r,n)=>Lt(t,"yAxis",r,n),Qx=(t,e,r,n)=>Rt(t,"yAxis",r,n),a3=A([Q,Jx,Zx,Xx,Qx],(t,e,r,n,a)=>Er(t,"xAxis")?Ta(e,n,!1):Ta(r,a,!1)),i3=(t,e,r,n,a)=>a;function s3(t){return t.type==="line"}var o3=A([ei,i3],(t,e)=>t.filter(s3).find(r=>r.id===e)),l3=A([Q,Jx,Zx,Xx,Qx,o3,a3,Ja],(t,e,r,n,a,i,s,o)=>{var{chartData:l,dataStartIndex:d,dataEndIndex:u}=o;if(!(i==null||e==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:h,data:f}=i,m;if(f!=null&&f.length>0?m=f:m=l?.slice(d,u+1),m!=null)return A3({layout:t,xAxis:e,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:h,bandSize:s,displayedData:m})}}),c3=["id"],u3=["type","layout","connectNulls","needClip"],d3=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function rg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ot(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rg(Object(r),!0).forEach(function(n){h3(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function h3(t,e,r){return(e=f3(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f3(t){var e=m3(t,"string");return typeof e=="symbol"?e:e+""}function m3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jh(t,e){if(t==null)return{};var r,n,a=p3(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function p3(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function ln(){return ln=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ln.apply(null,arguments)}var g3=t=>{var{dataKey:e,name:r,stroke:n,legendType:a,hide:i}=t;return[{inactive:i,dataKey:e,type:a,color:n,value:Cr(r,e),payload:t}]};function v3(t){var{dataKey:e,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:o,unit:l}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:e,nameKey:void 0,name:Cr(s,e),hide:o,type:t.tooltipType,color:t.stroke,unit:l}}}var ew=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function y3(t,e){for(var r=t.length%2!==0?[...t,0]:t,n=[],a=0;a<e;++a)n=[...n,...r];return n}var b3=(t,e,r)=>{var n=r.reduce((h,f)=>h+f);if(!n)return ew(e,t);for(var a=Math.floor(t/n),i=t%n,s=e-t,o=[],l=0,d=0;l<r.length;d+=r[l],++l)if(d+r[l]>i){o=[...r.slice(0,l),i-d];break}var u=o.length%2===0?[0,s]:[s];return[...y3(r,a),...o,...u].map(h=>"".concat(h,"px")).join(", ")};function x3(t,e){var r;if(v.isValidElement(t))r=v.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var n=ee("recharts-line-dot",typeof t!="boolean"?t.className:"");r=v.createElement(Tx,ln({},e,{className:n}))}return r}function w3(t,e){return t==null?!1:e?!0:t.length===1}function _3(t){var{clipPathId:e,points:r,props:n}=t,{dot:a,dataKey:i,needClip:s}=n;if(!w3(r,a))return null;var{id:o}=n,l=jh(n,c3),d=Gg(a),u=jt(l),h=ye(a,!0),f=r.map((g,p)=>{var y=ot(ot(ot({key:"dot-".concat(p),r:3},u),h),{},{index:p,cx:g.x,cy:g.y,dataKey:i,value:g.value,payload:g.payload,points:r});return x3(a,y)}),m={clipPath:s?"url(#clipPath-".concat(d?"":"dots-").concat(e,")"):void 0};return v.createElement(_e,ln({className:"recharts-line-dots",key:"dots"},m),f)}function j3(t){var{showLabels:e,children:r,points:n}=t,a=v.useMemo(()=>n?.map(i=>{var s={x:i.x,y:i.y,width:0,height:0};return ot(ot({},s),{},{value:i.value,payload:i.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return v.createElement(oh,{value:e?a:null},r)}function ng(t){var{clipPathId:e,pathRef:r,points:n,strokeDasharray:a,props:i}=t,{type:s,layout:o,connectNulls:l,needClip:d}=i,u=jh(i,u3),h=ot(ot({},ye(u,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(e,")"):void 0,points:n,type:s,layout:o,connectNulls:l,strokeDasharray:a??i.strokeDasharray});return v.createElement(v.Fragment,null,n?.length>1&&v.createElement(Gs,ln({},h,{pathRef:r})),v.createElement(_3,{points:n,clipPathId:e,props:i}))}function S3(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function N3(t){var{clipPathId:e,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=t,{points:s,strokeDasharray:o,isAnimationActive:l,animationBegin:d,animationDuration:u,animationEasing:h,animateNewValues:f,width:m,height:g,onAnimationEnd:p,onAnimationStart:y}=r,b=a.current,x=Gn(r,"recharts-line-"),[w,_]=v.useState(!1),S=!w,j=v.useCallback(()=>{typeof p=="function"&&p(),_(!1)},[p]),N=v.useCallback(()=>{typeof y=="function"&&y(),_(!0)},[y]),M=S3(n.current),O=i.current;return v.createElement(j3,{points:s,showLabels:S},r.children,v.createElement(Hn,{animationId:x,begin:d,duration:u,isActive:l,easing:h,onAnimationEnd:j,onAnimationStart:N,key:x},C=>{var P=we(O,M+O,C),k=Math.min(P,M),D;if(l)if(o){var I="".concat(o).split(/[,\s]+/gim).map(K=>parseFloat(K));D=b3(k,M,I)}else D=ew(M,k);else D=o==null?void 0:String(o);if(b){var W=b.length/s.length,V=C===1?s:s.map((K,X)=>{var B=Math.floor(X*W);if(b[B]){var R=b[B];return ot(ot({},K),{},{x:we(R.x,K.x,C),y:we(R.y,K.y,C)})}return f?ot(ot({},K),{},{x:we(m*2,K.x,C),y:we(g/2,K.y,C)}):ot(ot({},K),{},{x:K.x,y:K.y})});return a.current=V,v.createElement(ng,{props:r,points:V,clipPathId:e,pathRef:n,strokeDasharray:D})}return C>0&&M>0&&(a.current=s,i.current=k),v.createElement(ng,{props:r,points:s,clipPathId:e,pathRef:n,strokeDasharray:D})}),v.createElement(fo,{label:r.label}))}function P3(t){var{clipPathId:e,props:r}=t,n=v.useRef(null),a=v.useRef(0),i=v.useRef(null);return v.createElement(N3,{props:r,clipPathId:e,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var k3=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:ie(t.payload,e)});class M3 extends v.Component{render(){var e,{hide:r,dot:n,points:a,className:i,xAxisId:s,yAxisId:o,top:l,left:d,width:u,height:h,id:f,needClip:m}=this.props;if(r)return null;var g=ee("recharts-line",i),p=f,{r:y=3,strokeWidth:b=2}=(e=ye(n,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},x=Gg(n),w=y*2+b;return v.createElement(v.Fragment,null,v.createElement(_e,{className:g},m&&v.createElement("defs",null,v.createElement(yh,{clipPathId:p,xAxisId:s,yAxisId:o}),!x&&v.createElement("clipPath",{id:"clipPath-dots-".concat(p)},v.createElement("rect",{x:d-w/2,y:l-w/2,width:u+w,height:h+w}))),v.createElement(vh,{xAxisId:s,yAxisId:o,data:a,dataPointFormatter:k3,errorBarOffset:0},v.createElement(P3,{props:this.props,clipPathId:p}))),v.createElement(GD,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var tw={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!or.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function O3(t){var e=Te(t,tw),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:o,dot:l,hide:d,isAnimationActive:u,label:h,legendType:f,xAxisId:m,yAxisId:g,id:p}=e,y=jh(e,d3),{needClip:b}=bo(m,g),x=ph(),w=Vs(),_=Je(),S=F(C=>l3(C,m,g,_,p));if(w!=="horizontal"&&w!=="vertical"||S==null||x==null)return null;var{height:j,width:N,x:M,y:O}=x;return v.createElement(M3,ln({},y,{id:p,connectNulls:o,dot:l,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:u,hide:d,label:h,legendType:f,xAxisId:m,yAxisId:g,points:S,layout:w,height:j,width:N,left:M,top:O,needClip:b}))}function A3(t){var{layout:e,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:o,displayedData:l}=t;return l.map((d,u)=>{var h=ie(d,s);if(e==="horizontal"){var f=Qi({axis:r,ticks:a,bandSize:o,entry:d,index:u}),m=le(h)?null:n.scale(h);return{x:f,y:m,value:h,payload:d}}var g=le(h)?null:r.scale(h),p=Qi({axis:n,ticks:i,bandSize:o,entry:d,index:u});return g==null||p==null?null:{x:g,y:p,value:h,payload:d}}).filter(Boolean)}function E3(t){var e=Te(t,tw),r=Je();return v.createElement(yo,{id:e.id,type:"line"},n=>v.createElement(v.Fragment,null,v.createElement(hh,{legendPayload:g3(e)}),v.createElement(vo,{fn:v3,args:e}),v.createElement(fh,{type:"line",id:n,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,hide:e.hide,isPanorama:r}),v.createElement(O3,ln({},e,{id:n}))))}var pu=v.memo(E3);pu.displayName="Line";function rw(t,e,r){return(e=C3(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C3(t){var e=T3(t,"string");return typeof e=="symbol"?e:e+""}function T3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I3(t){var e=be();return v.useEffect(()=>(e(RD(t)),()=>{e(LD(t))}),[t,e]),null}class xo extends v.Component{render(){return v.createElement(I3,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:_r.allowDuplicatedCategory,allowDataOverflow:_r.allowDataOverflow,reversed:_r.reversed,includeHidden:_r.includeHidden})}}rw(xo,"displayName","ZAxis");rw(xo,"defaultProps",{zAxisId:0,range:_r.range,scale:_r.scale,type:_r.type});var D3=["option","isActive"];function Na(){return Na=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Na.apply(null,arguments)}function $3(t,e){if(t==null)return{};var r,n,a=R3(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function R3(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function L3(t){var{option:e,isActive:r}=t,n=$3(t,D3);return typeof e=="string"?v.createElement(bs,Na({option:v.createElement(Is,Na({type:e},n)),isActive:r,shapeType:"symbols"},n)):v.createElement(bs,Na({option:e,isActive:r,shapeType:"symbols"},n))}var B3=(t,e,r,n,a,i,s)=>Lt(t,"xAxis",e,s),U3=(t,e,r,n,a,i,s)=>Rt(t,"xAxis",e,s),F3=(t,e,r,n,a,i,s)=>Lt(t,"yAxis",r,s),z3=(t,e,r,n,a,i,s)=>Rt(t,"yAxis",r,s),q3=(t,e,r,n)=>b2(t,"zAxis",n,!1),W3=(t,e,r,n,a)=>a,K3=(t,e,r,n,a,i)=>i,V3=(t,e,r,n,a,i,s)=>Ja(t,e,r,s),H3=A([ei,W3],(t,e)=>t.filter(r=>r.type==="scatter").find(r=>r.id===e)),G3=A([V3,B3,U3,F3,z3,q3,H3,K3],(t,e,r,n,a,i,s,o)=>{var{chartData:l,dataStartIndex:d,dataEndIndex:u}=t;if(s!=null){var h;if(s?.data!=null&&s.data.length>0?h=s.data:h=l?.slice(d,u+1),!(h==null||e==null||n==null||r==null||a==null||r?.length===0||a?.length===0))return lR({displayedData:h,xAxis:e,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:r,yAxisTicks:a,cells:o})}}),Y3=["onMouseEnter","onClick","onMouseLeave"],J3=["id"],X3=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function gu(t,e){if(t==null)return{};var r,n,a=Z3(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Z3(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function cn(){return cn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},cn.apply(null,arguments)}function ag(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ge(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ag(Object(r),!0).forEach(function(n){Q3(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ag(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Q3(t,e,r){return(e=eR(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eR(t){var e=tR(t,"string");return typeof e=="symbol"?e:e+""}function tR(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rR=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:i}=t;return[{inactive:i,dataKey:e,type:a,color:n,value:Cr(r,e),payload:t}]};function nR(t){var{points:e,props:r}=t,{line:n,lineType:a,lineJointType:i}=r;if(!n)return null;var s=jt(r),o=ye(n,!1),l,d;if(a==="joint")l=e.map(y=>({x:y.cx,y:y.cy}));else if(a==="fitting"){var{xmin:u,xmax:h,a:f,b:m}=Pj(e),g=y=>f*y+m;l=[{x:u,y:g(u)},{x:h,y:g(h)}]}var p=Ge(Ge(Ge({},s),{},{fill:"none",stroke:s&&s.fill},o),{},{points:l});return v.isValidElement(n)?d=v.cloneElement(n,p):typeof n=="function"?d=n(p):d=v.createElement(Gs,cn({},p,{type:i})),v.createElement(_e,{className:"recharts-scatter-line",key:"recharts-scatter-line"},d)}function aR(t){var{showLabels:e,points:r,children:n}=t,a=Ks(),i=v.useMemo(()=>r?.map(s=>{var o={x:s.x,y:s.y,width:s.width,height:s.height};return Ge(Ge({},o),{},{value:void 0,payload:s.payload,viewBox:o,parentViewBox:a,fill:void 0})}),[a,r]);return v.createElement(oh,{value:e?i:null},n)}function iR(t){var{points:e,allOtherScatterProps:r}=t,{shape:n,activeShape:a,dataKey:i}=r,s=F(nr),{onMouseEnter:o,onClick:l,onMouseLeave:d}=r,u=gu(r,Y3),h=mo(o,r.dataKey),f=po(d),m=go(l,r.dataKey);if(e==null)return null;var{id:g}=r,p=gu(r,J3),y=jt(p);return v.createElement(v.Fragment,null,v.createElement(nR,{points:e,props:p}),e.map((b,x)=>{var w=a&&s===String(x),_=w?a:n,S=Ge(Ge(Ge({key:"symbol-".concat(x)},y),b),{},{[Yu]:x,[Ju]:String(i)});return v.createElement(_e,cn({className:"recharts-scatter-symbol"},Vn(u,b,x),{onMouseEnter:h(b,x),onMouseLeave:f(b,x),onClick:m(b,x),key:"symbol-".concat(b?.cx,"-").concat(b?.cy,"-").concat(b?.size,"-").concat(x)}),v.createElement(L3,cn({option:_,isActive:w},S)))}))}function sR(t){var{previousPointsRef:e,props:r}=t,{points:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o}=r,l=e.current,d=Gn(r,"recharts-scatter-"),[u,h]=v.useState(!1),f=v.useCallback(()=>{h(!1)},[]),m=v.useCallback(()=>{h(!0)},[]),g=!u;return v.createElement(aR,{showLabels:g,points:n},r.children,v.createElement(Hn,{animationId:d,begin:i,duration:s,isActive:a,easing:o,onAnimationEnd:f,onAnimationStart:m,key:d},p=>{var y=p===1?n:n?.map((b,x)=>{var w=l&&l[x];if(w){var _=fi(w.cx,b.cx),S=fi(w.cy,b.cy),j=fi(w.size,b.size);return Ge(Ge({},b),{},{cx:_(p),cy:S(p),size:j(p)})}var N=fi(0,b.size);return Ge(Ge({},b),{},{size:N(p)})});return p>0&&(e.current=y),v.createElement(_e,null,v.createElement(iR,{points:y,allOtherScatterProps:r,showLabels:g}))}),v.createElement(fo,{label:r.label}))}function oR(t){var{dataKey:e,points:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:o,tooltipType:l}=t;return{dataDefinedOnItem:r?.map(d=>d.tooltipPayload),positions:r?.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:a,fill:i,nameKey:void 0,dataKey:e,name:Cr(s,e),hide:o,type:l,color:i,unit:""}}}function lR(t){var{displayedData:e,xAxis:r,yAxis:n,zAxis:a,scatterSettings:i,xAxisTicks:s,yAxisTicks:o,cells:l}=t,d=le(r.dataKey)?i.dataKey:r.dataKey,u=le(n.dataKey)?i.dataKey:n.dataKey,h=a&&a.dataKey,f=a?a.range:xo.defaultProps.range,m=f&&f[0],g=r.scale.bandwidth?r.scale.bandwidth():0,p=n.scale.bandwidth?n.scale.bandwidth():0;return e.map((y,b)=>{var x=ie(y,d),w=ie(y,u),_=!le(h)&&ie(y,h)||"-",S=[{name:le(r.dataKey)?i.name:r.name||r.dataKey,unit:r.unit||"",value:x,payload:y,dataKey:d,type:i.tooltipType},{name:le(n.dataKey)?i.name:n.name||n.dataKey,unit:n.unit||"",value:w,payload:y,dataKey:u,type:i.tooltipType}];_!=="-"&&S.push({name:a.name||a.dataKey,unit:a.unit||"",value:_,payload:y,dataKey:h,type:i.tooltipType});var j=Qi({axis:r,ticks:s,bandSize:g,entry:y,index:b,dataKey:d}),N=Qi({axis:n,ticks:o,bandSize:p,entry:y,index:b,dataKey:u}),M=_!=="-"?a.scale(_):m,O=Math.sqrt(Math.max(M,0)/Math.PI);return Ge(Ge({},y),{},{cx:j,cy:N,x:j-O,y:N-O,width:2*O,height:2*O,size:M,node:{x,y:w,z:_},tooltipPayload:S,tooltipPosition:{x:j,y:N},payload:y},l&&l[b]&&l[b].props)})}var cR=(t,e,r)=>({x:t.cx,y:t.cy,value:r==="x"?+t.node.x:+t.node.y,errorVal:ie(t,e)});function uR(t){var{hide:e,points:r,className:n,needClip:a,xAxisId:i,yAxisId:s,id:o}=t,l=v.useRef(null);if(e)return null;var d=ee("recharts-scatter",n),u=o;return v.createElement(_e,{className:d,clipPath:a?"url(#clipPath-".concat(u,")"):null,id:o},a&&v.createElement("defs",null,v.createElement(yh,{clipPathId:u,xAxisId:i,yAxisId:s})),v.createElement(vh,{xAxisId:i,yAxisId:s,data:r,dataPointFormatter:cR,errorBarOffset:0},v.createElement(_e,{key:"recharts-scatter-symbols"},v.createElement(sR,{props:t,previousPointsRef:l}))))}var nw={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!or.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function dR(t){var e=Te(t,nw),{animationBegin:r,animationDuration:n,animationEasing:a,hide:i,isAnimationActive:s,legendType:o,lineJointType:l,lineType:d,shape:u,xAxisId:h,yAxisId:f,zAxisId:m}=e,g=gu(e,X3),{needClip:p}=bo(h,f),y=v.useMemo(()=>As(t.children,mn),[t.children]),b=Je(),x=F(w=>G3(w,h,f,m,t.id,y,b));return p==null||x==null?null:v.createElement(v.Fragment,null,v.createElement(vo,{fn:oR,args:Ge(Ge({},t),{},{points:x})}),v.createElement(uR,cn({},g,{xAxisId:h,yAxisId:f,zAxisId:m,lineType:d,lineJointType:l,legendType:o,shape:u,hide:i,isAnimationActive:s,animationBegin:r,animationDuration:n,animationEasing:a,points:x,needClip:p})))}function hR(t){var e=Te(t,nw),r=Je();return v.createElement(yo,{id:e.id,type:"scatter"},n=>v.createElement(v.Fragment,null,v.createElement(hh,{legendPayload:rR(e)}),v.createElement(fh,{type:"scatter",id:n,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:e.zAxisId,dataKey:e.dataKey,hide:e.hide,name:e.name,tooltipType:e.tooltipType,isPanorama:r}),v.createElement(dR,cn({},e,{id:n}))))}var vu=v.memo(hR);vu.displayName="Scatter";var fR=["dangerouslySetInnerHTML","ticks"],mR=["id"],pR=["domain"],gR=["domain"];function yu(){return yu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yu.apply(null,arguments)}function js(t,e){if(t==null)return{};var r,n,a=vR(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vR(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function yR(t){var e=be();return v.useEffect(()=>(e(TD(t)),()=>{e(ID(t))}),[t,e]),null}var bR=t=>{var{xAxisId:e,className:r}=t,n=F(Xu),a=Je(),i="xAxis",s=F(y=>ta(y,i,e,a)),o=F(y=>Gb(y,i,e,a)),l=F(y=>Wb(y,e)),d=F(y=>f2(y,e)),u=F(y=>wb(y,e));if(l==null||d==null||u==null)return null;var{dangerouslySetInnerHTML:h,ticks:f}=t,m=js(t,fR),{id:g}=u,p=js(u,mR);return v.createElement(_h,yu({},m,p,{scale:s,x:d.x,y:d.y,width:l.width,height:l.height,className:ee("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:o}))},xR={allowDataOverflow:at.allowDataOverflow,allowDecimals:at.allowDecimals,allowDuplicatedCategory:at.allowDuplicatedCategory,height:at.height,hide:!1,mirror:at.mirror,orientation:at.orientation,padding:at.padding,reversed:at.reversed,scale:at.scale,tickCount:at.tickCount,type:at.type,xAxisId:0},wR=t=>{var e,r,n,a,i,s=Te(t,xR);return v.createElement(v.Fragment,null,v.createElement(yR,{interval:(e=s.interval)!==null&&e!==void 0?e:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(bR,s))},_R=(t,e)=>{var{domain:r}=t,n=js(t,pR),{domain:a}=e,i=js(e,gR);return qn(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:qn({domain:r},{domain:a}):!1},Sr=v.memo(wR,_R);Sr.displayName="XAxis";var jR=["dangerouslySetInnerHTML","ticks"],SR=["id"],NR=["domain"],PR=["domain"];function bu(){return bu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bu.apply(null,arguments)}function Ss(t,e){if(t==null)return{};var r,n,a=kR(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function kR(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function MR(t){var e=be();return v.useEffect(()=>(e(DD(t)),()=>{e($D(t))}),[t,e]),null}var OR=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,i=v.useRef(null),s=v.useRef(null),o=F(Xu),l=Je(),d=be(),u="yAxis",h=F(S=>ta(S,u,e,l)),f=F(S=>Kb(S,e)),m=F(S=>p2(S,e)),g=F(S=>Gb(S,u,e,l)),p=F(S=>_b(S,e));if(v.useLayoutEffect(()=>{if(!(n!=="auto"||!f||sh(a)||v.isValidElement(a)||p==null)){var S=i.current;if(S){var j=S.getCalculatedWidth();Math.round(f.width)!==Math.round(j)&&d(BD({id:e,width:j}))}}},[g,f,d,a,e,n,p]),f==null||m==null||p==null)return null;var{dangerouslySetInnerHTML:y,ticks:b}=t,x=Ss(t,jR),{id:w}=p,_=Ss(p,SR);return v.createElement(_h,bu({},x,_,{ref:i,labelRef:s,scale:h,x:m.x,y:m.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:ee("recharts-".concat(u," ").concat(u),r),viewBox:o,ticks:g}))},AR={allowDataOverflow:it.allowDataOverflow,allowDecimals:it.allowDecimals,allowDuplicatedCategory:it.allowDuplicatedCategory,hide:!1,mirror:it.mirror,orientation:it.orientation,padding:it.padding,reversed:it.reversed,scale:it.scale,tickCount:it.tickCount,type:it.type,width:it.width,yAxisId:0},ER=t=>{var e,r,n,a,i,s=Te(t,AR);return v.createElement(v.Fragment,null,v.createElement(MR,{interval:(e=s.interval)!==null&&e!==void 0?e:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(OR,s))},CR=(t,e)=>{var{domain:r}=t,n=Ss(t,NR),{domain:a}=e,i=Ss(e,PR);return qn(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:qn({domain:r},{domain:a}):!1},Nr=v.memo(ER,CR);Nr.displayName="YAxis";var cc={exports:{}},uc={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ig;function TR(){if(ig)return uc;ig=1;var t=Ps();function e(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,a=t.useRef,i=t.useEffect,s=t.useMemo,o=t.useDebugValue;return uc.useSyncExternalStoreWithSelector=function(l,d,u,h,f){var m=a(null);if(m.current===null){var g={hasValue:!1,value:null};m.current=g}else g=m.current;m=s(function(){function y(S){if(!b){if(b=!0,x=S,S=h(S),f!==void 0&&g.hasValue){var j=g.value;if(f(j,S))return w=j}return w=S}if(j=w,r(x,S))return j;var N=h(S);return f!==void 0&&f(j,N)?(x=S,j):(x=S,w=N)}var b=!1,x,w,_=u===void 0?null:u;return[function(){return y(d())},_===null?void 0:function(){return y(_())}]},[d,u,h,f]);var p=n(l,m[0],m[1]);return i(function(){g.hasValue=!0,g.value=p},[p]),o(p),p},uc}var sg;function IR(){return sg||(sg=1,cc.exports=TR()),cc.exports}IR();function DR(t){t()}function $R(){let t=null,e=null;return{clear(){t=null,e=null},notify(){DR(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var og={notify(){},get:()=>[]};function RR(t,e){let r,n=og,a=0,i=!1;function s(p){u();const y=n.subscribe(p);let b=!1;return()=>{b||(b=!0,y(),h())}}function o(){n.notify()}function l(){g.onStateChange&&g.onStateChange()}function d(){return i}function u(){a++,r||(r=t.subscribe(l),n=$R())}function h(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=og)}function f(){i||(i=!0,u())}function m(){i&&(i=!1,h())}const g={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:d,trySubscribe:f,tryUnsubscribe:m,getListeners:()=>n};return g}var LR=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BR=LR(),UR=()=>typeof navigator<"u"&&navigator.product==="ReactNative",FR=UR(),zR=()=>BR||FR?v.useLayoutEffect:v.useEffect,qR=zR(),WR=Symbol.for("react-redux-context"),KR=typeof globalThis<"u"?globalThis:{};function VR(){if(!v.createContext)return{};const t=KR[WR]??=new Map;let e=t.get(v.createContext);return e||(e=v.createContext(null),t.set(v.createContext,e)),e}var HR=VR();function GR(t){const{children:e,context:r,serverState:n,store:a}=t,i=v.useMemo(()=>{const l=RR(a);return{store:a,subscription:l,getServerState:n?()=>n:void 0}},[a,n]),s=v.useMemo(()=>a.getState(),[a]);qR(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==a.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,s]);const o=r||HR;return v.createElement(o.Provider,{value:i},e)}var YR=GR,JR=(t,e)=>e,Sh=A([JR,Q,yb,De,cx,dr,wC,Ce],PC),Nh=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},aw=wt("mouseClick"),iw=Wa();iw.startListening({actionCreator:aw,effect:(t,e)=>{var r=t.payload,n=Sh(e.getState(),Nh(r));n?.activeIndex!=null&&e.dispatch(O2({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var xu=wt("mouseMove"),sw=Wa();sw.startListening({actionCreator:xu,effect:(t,e)=>{var r=t.payload,n=e.getState(),a=Xd(n,n.tooltip.settings.shared),i=Sh(n,Nh(r));a==="axis"&&(i?.activeIndex!=null?e.dispatch(rx({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):e.dispatch(tx()))}});var lg={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},ow=ft({name:"rootProps",initialState:lg,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:lg.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),XR=ow.reducer,{updateOptions:ZR}=ow.actions,lw=ft({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:QR}=lw.actions,eL=lw.reducer,cw=wt("keyDown"),uw=wt("focus"),Ph=Wa();Ph.startListening({actionCreator:cw,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=t.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Zd(a,na(r))),o=dr(r);if(i==="Enter"){var l=ps(r,"axis","hover",String(a.index));e.dispatch(lu({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:l}));return}var d=x2(r),u=d==="left-to-right"?1:-1,h=i==="ArrowRight"?1:-1,f=s+h*u;if(!(o==null||f>=o.length||f<0)){var m=ps(r,"axis","hover",String(f));e.dispatch(lu({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:m}))}}}}});Ph.startListening({actionCreator:uw,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=ps(r,"axis","hover",String(i));e.dispatch(lu({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var yt=wt("externalEvent"),dw=Wa();dw.startListening({actionCreator:yt,effect:(t,e)=>{if(t.payload.handler!=null){var r=e.getState(),n={activeCoordinate:dC(r),activeDataKey:fx(r),activeIndex:nr(r),activeLabel:hx(r),activeTooltipIndex:nr(r),isTooltipActive:hC(r)};t.payload.handler(n,t.payload.reactEvent)}}});var tL=A([ra],t=>t.tooltipItemPayloads),rL=A([tL,ni,(t,e,r)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(o=>o.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=e(i,r);return s}}}),hw=wt("touchMove"),fw=Wa();fw.startListening({actionCreator:hw,effect:(t,e)=>{var r=t.payload,n=e.getState(),a=Xd(n,n.tooltip.settings.shared);if(a==="axis"){var i=Sh(n,Nh({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&e.dispatch(rx({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,o=r.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var d=l.getAttribute(Yu),u=(s=l.getAttribute(Ju))!==null&&s!==void 0?s:void 0,h=rL(e.getState(),d,u);e.dispatch(ex({activeDataKey:u,activeIndex:d,activeCoordinate:h}))}}});var nL=Ov({brush:o5,cartesianAxis:UD,chartData:zC,errorBars:s$,graphicalItems:nD,layout:wP,legend:dk,options:RC,polarAxis:xI,polarOptions:eL,referenceElements:m5,rootProps:XR,tooltip:A2}),aL=function(e){return VN({reducer:nL,preloadedState:e,middleware:r=>r({serializableCheck:!1}).concat([iw.middleware,sw.middleware,Ph.middleware,dw.middleware,fw.middleware]),devTools:or.devToolsEnabled})};function mw(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=Je(),i=v.useRef(null);if(a)return r;i.current==null&&(i.current=aL(e));var s=qu;return v.createElement(YR,{context:s,store:i.current},r)}function pw(t){var{layout:e,width:r,height:n,margin:a}=t,i=be(),s=Je();return v.useEffect(()=>{s||(i(yP(e)),i(bP({width:r,height:n})),i(vP(a)))},[i,s,e,r,n,a]),null}function gw(t){var e=be();return v.useEffect(()=>{e(ZR(t))},[e,t]),null}var iL=["children"];function sL(t,e){if(t==null)return{};var r,n,a=oL(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function oL(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Ns(){return Ns=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ns.apply(null,arguments)}var lL={width:"100%",height:"100%"},cL=v.forwardRef((t,e)=>{var r=Zu(),n=Qu(),a=oy();if(!Ln(r)||!Ln(n))return null;var{children:i,otherAttributes:s,title:o,desc:l}=t,d,u;return typeof s.tabIndex=="number"?d=s.tabIndex:d=a?0:void 0,typeof s.role=="string"?u=s.role:u=a?"application":void 0,v.createElement(Du,Ns({},s,{title:o,desc:l,role:u,tabIndex:d,width:r,height:n,style:lL,ref:e}),i)}),uL=t=>{var{children:e}=t,r=F(Ws);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return v.createElement(Du,{width:n,height:a,x:s,y:i},e)},cg=v.forwardRef((t,e)=>{var{children:r}=t,n=sL(t,iL),a=Je();return a?v.createElement(uL,null,r):v.createElement(cL,Ns({ref:e},n),r)});function dL(){var t=be(),[e,r]=v.useState(null),n=F(JP);return v.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),i=a.width/e.offsetWidth;ht(i)&&i!==n&&t(xP(i))}},[e,t,n]),r}function ug(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function hL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ug(Object(r),!0).forEach(function(n){fL(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ug(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fL(t,e,r){return(e=mL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mL(t){var e=pL(t,"string");return typeof e=="symbol"?e:e+""}function pL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gL=v.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:l,onMouseEnter:d,onMouseLeave:u,onMouseMove:h,onMouseUp:f,onTouchEnd:m,onTouchMove:g,onTouchStart:p,style:y,width:b}=t,x=be(),[w,_]=v.useState(null),[S,j]=v.useState(null);XC();var N=dL(),M=v.useCallback($=>{N($),typeof e=="function"&&e($),_($),j($)},[N,e,_,j]),O=v.useCallback($=>{x(aw($)),x(yt({handler:i,reactEvent:$}))},[x,i]),C=v.useCallback($=>{x(xu($)),x(yt({handler:d,reactEvent:$}))},[x,d]),P=v.useCallback($=>{x(tx()),x(yt({handler:u,reactEvent:$}))},[x,u]),k=v.useCallback($=>{x(xu($)),x(yt({handler:h,reactEvent:$}))},[x,h]),D=v.useCallback(()=>{x(uw())},[x]),I=v.useCallback($=>{x(cw($.key))},[x]),W=v.useCallback($=>{x(yt({handler:s,reactEvent:$}))},[x,s]),V=v.useCallback($=>{x(yt({handler:o,reactEvent:$}))},[x,o]),K=v.useCallback($=>{x(yt({handler:l,reactEvent:$}))},[x,l]),X=v.useCallback($=>{x(yt({handler:f,reactEvent:$}))},[x,f]),B=v.useCallback($=>{x(yt({handler:p,reactEvent:$}))},[x,p]),R=v.useCallback($=>{x(hw($)),x(yt({handler:g,reactEvent:$}))},[x,g]),Y=v.useCallback($=>{x(yt({handler:m,reactEvent:$}))},[x,m]);return v.createElement(bx.Provider,{value:w},v.createElement(Jg.Provider,{value:S},v.createElement("div",{className:ee("recharts-wrapper",n),style:hL({position:"relative",cursor:"default",width:b,height:a},y),onClick:O,onContextMenu:W,onDoubleClick:V,onFocus:D,onKeyDown:I,onMouseDown:K,onMouseEnter:C,onMouseLeave:P,onMouseMove:k,onMouseUp:X,onTouchEnd:Y,onTouchMove:R,onTouchStart:B,ref:M},r)))}),vL=["children","className","width","height","style","compact","title","desc"];function yL(t,e){if(t==null)return{};var r,n,a=bL(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function bL(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var vw=v.forwardRef((t,e)=>{var{children:r,className:n,width:a,height:i,style:s,compact:o,title:l,desc:d}=t,u=yL(t,vL),h=jt(u);return o?v.createElement(cg,{otherAttributes:h,title:l,desc:d},r):v.createElement(gL,{className:n,style:s,width:a,height:i,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},v.createElement(cg,{otherAttributes:h,title:l,desc:d,ref:e},v.createElement(g5,null,r)))}),xL=["width","height"];function wu(){return wu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wu.apply(null,arguments)}function wL(t,e){if(t==null)return{};var r,n,a=_L(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function _L(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var jL={top:5,right:5,bottom:5,left:5},SL={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:jL,reverseStackOrder:!1,syncMethod:"index"},kh=v.forwardRef(function(e,r){var n,a=Te(e.categoricalChartProps,SL),{width:i,height:s}=a,o=wL(a,xL);if(!Ln(i)||!Ln(s))return null;var{chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,categoricalChartProps:f}=e,m={chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return v.createElement(mw,{preloadedState:{options:m},reduxStoreName:(n=f.id)!==null&&n!==void 0?n:l},v.createElement(Kx,{chartData:f.data}),v.createElement(pw,{width:i,height:s,layout:a.layout,margin:a.margin}),v.createElement(gw,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(vw,wu({},o,{width:i,height:s,ref:r})))}),NL=["axis"],PL=v.forwardRef((t,e)=>v.createElement(kh,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:NL,tooltipPayloadSearcher:uo,categoricalChartProps:t,ref:e})),kL=["axis","item"],ya=v.forwardRef((t,e)=>v.createElement(kh,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:kL,tooltipPayloadSearcher:uo,categoricalChartProps:t,ref:e}));function ML(t){var e=be();return v.useEffect(()=>{e(QR(t))},[e,t]),null}var OL=["width","height","layout"];function _u(){return _u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_u.apply(null,arguments)}function AL(t,e){if(t==null)return{};var r,n,a=EL(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function EL(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var CL={top:5,right:5,bottom:5,left:5},TL={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:CL,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},IL=v.forwardRef(function(e,r){var n,a=Te(e.categoricalChartProps,TL),{width:i,height:s,layout:o}=a,l=AL(a,OL);if(!Ln(i)||!Ln(s))return null;var{chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:f}=e,m={chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(mw,{preloadedState:{options:m},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},v.createElement(Kx,{chartData:a.data}),v.createElement(pw,{width:i,height:s,layout:o,margin:a.margin}),v.createElement(gw,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(ML,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),v.createElement(vw,_u({width:i,height:s},l,{ref:r})))}),DL=["item"],$L={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},RL=v.forwardRef((t,e)=>{var r=Te(t,$L);return v.createElement(IL,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:DL,tooltipPayloadSearcher:uo,categoricalChartProps:r,ref:e})}),LL=["item"],BL=v.forwardRef((t,e)=>v.createElement(kh,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:LL,tooltipPayloadSearcher:uo,categoricalChartProps:t,ref:e}));const dg=["#1e40af","#dc2626","#059669","#d97706","#7c3aed","#db2777","#1e3a8a","#3b82f6"];function UL({dataset:t}){const e=vj(t),r=t.classes&&t.classes.length>0,n=a=>{const i=Array.from(new Set(a.map(o=>typeof o=="number"?Number(o):String(o))));if(i.length<=12)return!0;const s=a.filter(o=>typeof o=="number");return!!(s.length===a.length&&s.every(l=>Math.abs(l-Math.round(l))<1e-6)&&i.length<=24)};return c.jsxs("div",{className:"space-y-6",children:[r&&e.length>0&&c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(wo,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),c.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"クラス分布"})]}),c.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["各クラスのデータ数と割合を確認できます。",c.jsx("br",{}),c.jsx("span",{className:"text-xs text-gray-600",children:"💡 バランスが良いと機械学習の精度が向上しやすくなります"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("div",{children:c.jsx(wr,{width:"100%",height:250,children:c.jsxs(ya,{data:e,children:[c.jsx(jr,{strokeDasharray:"3 3"}),c.jsx(Sr,{dataKey:"class"}),c.jsx(Nr,{}),c.jsx(xr,{}),c.jsx(An,{dataKey:"count",fill:"#1e40af"})]})})}),c.jsx("div",{children:c.jsx(wr,{width:"100%",height:250,children:c.jsxs(RL,{children:[c.jsx(Ux,{data:e,dataKey:"count",nameKey:"class",cx:"50%",cy:"50%",outerRadius:80,label:a=>`${a.class}: ${a.count}`,children:e.map((a,i)=>c.jsx(mn,{fill:dg[i%dg.length]},`cell-${i}`))}),c.jsx(xr,{}),c.jsx(Hs,{})]})})})]}),c.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-3",children:e.map((a,i)=>c.jsxs("div",{className:"bg-blue-50 p-3 rounded border text-center",style:{borderColor:"var(--gold)"},children:[c.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:a.class}),c.jsx("div",{className:"text-2xl font-bold",style:{color:"var(--accent-strong)"},children:a.count}),c.jsxs("div",{className:"text-xs",style:{color:"var(--gold)"},children:[(a.count/t.train.length*100).toFixed(1),"%"]})]},i))})]}),!r&&c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(wo,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),c.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"目的変数の分布"})]}),c.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["予測したい値（目的変数）の分布を確認できます。",c.jsx("br",{}),c.jsx("span",{className:"text-xs text-gray-600",children:"💡 正規分布に近い形だと回帰モデルの精度が向上しやすくなります"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:[t.labelName,"の分布"]}),c.jsx(wr,{width:"100%",height:250,children:c.jsxs(ya,{data:(()=>{const i=(t.raw?.train?.map(o=>o.label)??t.train.map(o=>o.label)).filter(o=>typeof o=="number");return i.length===0?[]:df(i,15)})(),children:[c.jsx(jr,{strokeDasharray:"3 3"}),c.jsx(Sr,{dataKey:"bin",angle:-45,textAnchor:"end",height:80,tick:{fontSize:10},tickFormatter:a=>{const i=t.raw?.featureUnits?.[t.featureNames.length]||"";return i?`${Math.round(a)}${i}`:Ne(a)}}),c.jsx(Nr,{}),c.jsx(xr,{formatter:a=>Ne(a),labelFormatter:a=>{const i=t.raw?.featureUnits?.[t.featureNames.length]||"";return i?`${t.labelName}: ${Math.round(a)}${i}`:`${t.labelName}: ${Ne(a)}`}}),c.jsx(An,{dataKey:"count",fill:"#1e40af"})]})})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:"基本統計"}),c.jsx("div",{className:"space-y-3",children:(()=>{const i=(t.raw?.train?.map(m=>m.label)??t.train.map(m=>m.label)).filter(m=>typeof m=="number");if(i.length===0)return null;const s=i.sort((m,g)=>m-g),o=s.reduce((m,g)=>m+g,0)/s.length,l=s[Math.floor(s.length/2)],d=s[0],u=s[s.length-1],h=t.raw?.featureUnits?.[t.featureNames.length]||"",f=m=>h?`${Math.round(m*10)/10}${h}`:Ne(m);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-blue-50 p-3 rounded border",style:{borderColor:"var(--gold)"},children:[c.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:"平均値"}),c.jsx("div",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:f(o)})]}),c.jsxs("div",{className:"bg-blue-50 p-3 rounded border",style:{borderColor:"var(--gold)"},children:[c.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:"中央値"}),c.jsx("div",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:f(l)})]}),c.jsxs("div",{className:"bg-blue-50 p-3 rounded border",style:{borderColor:"var(--gold)"},children:[c.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:"範囲"}),c.jsxs("div",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:[f(d)," - ",f(u)]})]})]})})()})]})]})]}),c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(wo,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),c.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"特徴量の分布"})]}),c.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["各特徴量の値の分布を確認できます。カテゴリ変数は棒グラフ、連続変数はヒストグラムで表示されます。",c.jsx("br",{}),c.jsx("span",{className:"text-xs text-gray-600",children:"💡 正規分布に近い形だと機械学習の精度が向上しやすくなります"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.featureNames.map((a,i)=>{const s=t.raw?.train?.map(u=>u.features[i])??t.train.map(u=>u.features[i]);if(n(s)){const u=new Map;for(const f of s){const m=typeof f=="number"?String(f):f;u.set(m,(u.get(m)||0)+1)}const h=Array.from(u.entries()).sort((f,m)=>f[0].localeCompare(m[0])).map(([f,m])=>({category:f,count:m}));return c.jsxs("div",{className:"bg-blue-50 p-4 rounded border",style:{borderColor:"var(--gold)"},children:[c.jsxs("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:[a,"（カテゴリ）"]}),c.jsx(wr,{width:"100%",height:220,children:c.jsxs(ya,{data:h,children:[c.jsx(jr,{strokeDasharray:"3 3"}),c.jsx(Sr,{dataKey:"category",angle:-45,textAnchor:"end",height:80,tick:{fontSize:10}}),c.jsx(Nr,{}),c.jsx(xr,{formatter:f=>Ne(f)}),c.jsx(An,{dataKey:"count",fill:"#d4af37"})]})})]},i)}const d=df(s,15);return c.jsxs("div",{className:"bg-blue-50 p-4 rounded border",style:{borderColor:"var(--gold)"},children:[c.jsx("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:a}),c.jsx(wr,{width:"100%",height:200,children:c.jsxs(ya,{data:d,children:[c.jsx(jr,{strokeDasharray:"3 3"}),c.jsx(Sr,{dataKey:"bin",angle:-45,textAnchor:"end",height:80,tick:{fontSize:10}}),c.jsx(Nr,{}),c.jsx(xr,{formatter:u=>Ne(u)}),c.jsx(An,{dataKey:"count",fill:"#d4af37"})]})})]},i)})})]})]})}function FL({dataset:t}){const e=gj(t),r=a=>a>.7?"bg-red-600":a>.5?"bg-red-500":a>.3?"bg-orange-400":a>.1?"bg-yellow-300":a>-.1?"bg-gray-200":a>-.3?"bg-blue-300":a>-.5?"bg-blue-400":a>-.7?"bg-blue-500":"bg-blue-600",n=a=>Math.abs(a)>.5?"text-white":"text-gray-900";return c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-teal-600",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(Di,{className:"w-5 h-5 text-teal-900"}),c.jsx("h3",{className:"text-lg font-bold text-teal-900",children:"相関行列"})]}),c.jsxs("div",{className:"mb-4 text-sm text-teal-800",children:[c.jsx("p",{children:"特徴量間の相関係数を表示しています。色が濃いほど強い関係があることを表します。"}),c.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1 text-xs",children:[c.jsx("li",{children:"0.7以上は強い正の相関：一方が大きいともう一方も大きくなりやすい"}),c.jsx("li",{children:"-0.7以下は強い負の相関：一方が大きいともう一方は小さくなりやすい"}),c.jsx("li",{children:"-0.1〜0.1はほぼ相関なし：関係は弱い（例外もあります）"})]}),c.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-4 h-4 bg-red-600 rounded"}),c.jsx("span",{className:"text-xs",children:"強い正の相関 (0.7~1.0)"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"}),c.jsx("span",{className:"text-xs",children:"相関なし (-0.1~0.1)"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded"}),c.jsx("span",{className:"text-xs",children:"強い負の相関 (-1.0~-0.7)"})]})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border-collapse",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{className:"border-2 border-teal-300 bg-teal-50 p-2"}),t.featureNames.map((a,i)=>c.jsx("th",{className:"border-2 border-teal-300 bg-teal-50 p-2 text-xs font-bold text-teal-900",children:a.slice(0,6)},i))]})}),c.jsx("tbody",{children:e.map((a,i)=>c.jsxs("tr",{children:[c.jsx("td",{className:"border-2 border-teal-300 bg-teal-50 p-2 text-xs font-bold text-teal-900",children:t.featureNames[i].slice(0,6)}),a.map((s,o)=>c.jsx("td",{className:`border-2 border-teal-300 p-2 text-center ${r(s)} ${n(s)}`,children:c.jsx("span",{className:"text-xs font-bold",children:s.toFixed(2)})},o))]},i))})]})}),c.jsxs("div",{className:"mt-4 bg-teal-50 p-4 rounded border border-teal-300",children:[c.jsx("h4",{className:"text-sm font-bold text-teal-900 mb-2",children:"相関係数の解釈"}),c.jsxs("ul",{className:"text-xs text-teal-800 space-y-1",children:[c.jsxs("li",{children:["• ",c.jsx("strong",{children:"1.0"}),": 完全な正の相関（一方が増えれば他方も増える）"]}),c.jsxs("li",{children:["• ",c.jsx("strong",{children:"0.0"}),": 相関なし（関係性がない）"]}),c.jsxs("li",{children:["• ",c.jsx("strong",{children:"-1.0"}),": 完全な負の相関（一方が増えれば他方は減る）"]}),c.jsx("li",{children:"• 対角線上の1.0は自分自身との相関を示します"})]})]})]})}const zL=(t,e)=>{if(t==="classification"&&e){if(e.includes("中国")||e.includes("南蛮")||e.includes("朝鮮")||e.includes("日本"))return["#DC143C","#228B22","#DAA520","#4B0082"];if(e.includes("槍兵")||e.includes("弓兵")||e.includes("鉄砲隊")||e.includes("騎馬隊"))return["#8B4513","#DC143C","#228B22","#DAA520"];if(e.includes("敗北")||e.includes("勝利"))return["#DC143C","#228B22"];if(e.includes("低い")||e.includes("中程度")||e.includes("高い"))return["#8B4513","#DAA520","#228B22"];if(e.includes("危険")||e.includes("注意")||e.includes("安全"))return["#DC143C","#DAA520","#228B22"]}return["#8B4513","#DC143C","#228B22","#DAA520","#4B0082","#B22222","#2F4F4F","#CD853F"]};function qL({dataset:t}){const e=t.raw?.train?.length?t.raw.train:t.train,r=Math.min(e.length,200),n=e.slice(0,r),a=t.classes&&t.classes.length>0;if(!t||!n||n.length===0)return c.jsx("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:c.jsx("div",{className:"text-center text-gray-500",children:"データが読み込まれていません"})});const i=zL(a?"classification":"regression",t.classes),s=[];for(let l=0;l<t.featureNames.length;l++)for(let d=l+1;d<t.featureNames.length;d++)s.push([l,d]);const o=s.slice(0,6);return c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(hc,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),c.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"散布図行列（主要な特徴量ペア）"})]}),c.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["特徴量間の関係性を視覚的に確認できます。",a?"色分けはクラスを表しています。":"色の濃さは目的変数の値を表しています。",c.jsx("br",{}),c.jsxs("span",{className:"text-xs text-gray-600",children:["💡 ",a?"直線的な関係があれば線形モデル、曲線的な関係があれば非線形モデルが適しています":"特徴量と目的変数の関係を確認し、予測に有効な特徴量を見つけましょう"]}),c.jsx("br",{}),c.jsxs("span",{className:"text-xs text-gray-500",children:["🎨 戦国時代テーマの色で表示：",a?"各クラスが異なる色で表示されます":"回帰問題は茶色系で表示されます"]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(([l,d],u)=>{const h=n.map(P=>{const k=(t.raw,P.features[l]),D=(t.raw,P.features[d]);let I;return a&&typeof P.label=="string"?I=t.classes?.indexOf(P.label)??0:I=Number(P.label),{x:k,y:D,label:I,value:I}});if(h.length===0)return c.jsxs("div",{className:"p-3 rounded border",style:{background:"linear-gradient(135deg, #f8f4e6 0%, #f0e6d2 100%)",borderColor:"var(--gold)",borderWidth:"2px"},children:[c.jsxs("h4",{className:"text-xs font-bold mb-2 text-center",style:{color:"var(--accent-strong)"},children:[t.featureNames[l]," vs ",t.featureNames[d]]}),c.jsx("div",{className:"text-center text-gray-500 text-xs",children:"データがありません"})]},u);const f=h.map(P=>P.x),m=h.map(P=>P.y),g=[...new Set(f)],p=[...new Set(m)];if(g.length===1&&p.length===1)return c.jsxs("div",{className:"p-3 rounded border",style:{background:"linear-gradient(135deg, #f8f4e6 0%, #f0e6d2 100%)",borderColor:"var(--gold)",borderWidth:"2px"},children:[c.jsxs("h4",{className:"text-xs font-bold mb-2 text-center",style:{color:"var(--accent-strong)"},children:[t.featureNames[l]," vs ",t.featureNames[d]]}),c.jsx("div",{className:"text-center text-gray-500 text-xs",children:"データの変化がありません"})]},u);const y=f.length>0?Math.min(...f):0,b=f.length>0?Math.max(...f):1,x=m.length>0?Math.min(...m):0,w=m.length>0?Math.max(...m):1,_=b-y,S=w-x,j=_>0?_*.1:.1,N=S>0?S*.1:.1,M=_===0?[y-.1,y+.1]:[Math.max(0,y-j),b+j],O=S===0?[x-.1,x+.1]:[Math.max(0,x-N),w+N],C=a?[...new Set(h.map(P=>P.label))].sort():[0];return c.jsxs("div",{className:"p-3 rounded border",style:{background:"linear-gradient(135deg, #f8f4e6 0%, #f0e6d2 100%)",borderColor:"var(--gold)",borderWidth:"2px"},children:[c.jsxs("h4",{className:"text-xs font-bold mb-2 text-center",style:{color:"var(--accent-strong)"},children:[t.featureNames[l]," vs ",t.featureNames[d]]}),c.jsx(wr,{width:"100%",height:180,children:c.jsxs(BL,{margin:{top:5,right:5,bottom:5,left:5},children:[c.jsx(jr,{strokeDasharray:"3 3",stroke:"#8B4513",strokeOpacity:.3}),c.jsx(Sr,{type:"number",dataKey:"x",name:t.featureNames[l],domain:M,tick:{fontSize:10,fill:"#8B4513"},axisLine:{stroke:"#8B4513"},tickLine:{stroke:"#8B4513"},tickFormatter:P=>{const k=t.raw?.featureUnits?.[l]||"";return k?k==="m/s"?`${Math.round(P*10)/10}${k}`:k==="m"?`${Math.round(P*10)/10}${k}`:k==="隻"?`${Math.round(P)}${k}`:k==="点"?`${Math.round(P)}${k}`:k==="段階"?`${Math.round(P)}${k}`:k==="文"?`${Math.round(P)}${k}`:k==="年"?`${Math.round(P)}${k}`:k==="歳"?`${Math.round(P)}${k}`:k==="℃"?`${Math.round(P)}${k}`:k==="mm"?`${Math.round(P)}${k}`:k==="時間"?`${Math.round(P)}h`:k==="kg"?`${Math.round(P)}${k}`:k==="両"?`${Math.round(P)}${k}`:k==="石"?`${Math.round(P)}${k}`:`${Math.round(P)}${k}`:Ne(P).toString()}}),c.jsx(Nr,{type:"number",dataKey:"y",name:t.featureNames[d],domain:O,tick:{fontSize:10,fill:"#8B4513"},axisLine:{stroke:"#8B4513"},tickLine:{stroke:"#8B4513"},tickFormatter:P=>{const k=t.raw?.featureUnits?.[d]||"";return k?k==="m/s"?`${Math.round(P*10)/10}${k}`:k==="m"?`${Math.round(P*10)/10}${k}`:k==="隻"?`${Math.round(P)}${k}`:k==="点"?`${Math.round(P)}${k}`:k==="段階"?`${Math.round(P)}${k}`:k==="文"?`${Math.round(P)}${k}`:k==="年"?`${Math.round(P)}${k}`:k==="歳"?`${Math.round(P)}${k}`:k==="℃"?`${Math.round(P)}${k}`:k==="mm"?`${Math.round(P)}${k}`:k==="時間"?`${Math.round(P)}h`:k==="kg"?`${Math.round(P)}${k}`:k==="両"?`${Math.round(P)}${k}`:k==="石"?`${Math.round(P)}${k}`:`${Math.round(P)}${k}`:Ne(P).toString()}}),c.jsx(xo,{range:[50,50]}),c.jsx(xr,{cursor:{strokeDasharray:"3 3"},content:({active:P,payload:k})=>{if(P&&k&&k.length){const D=k[0].payload;return c.jsxs("div",{className:"bg-white p-3 border rounded shadow-lg text-xs",style:{borderColor:"var(--gold)"},children:[c.jsxs("p",{className:"font-medium",style:{color:"var(--accent-strong)"},children:[t.featureNames[l],": ",(()=>{const I=t.raw?.featureUnits?.[l]||"";return I?`${Math.round(D.x)}${I}`:Ne(D.x)})()]}),c.jsxs("p",{className:"font-medium",style:{color:"var(--accent-strong)"},children:[t.featureNames[d],": ",(()=>{const I=t.raw?.featureUnits?.[d]||"";return I?`${Math.round(D.y)}${I}`:Ne(D.y)})()]}),a?c.jsxs("p",{className:"font-bold",style:{color:"var(--gold)"},children:["クラス: ",t.classes[D.label]]}):c.jsxs("p",{className:"font-bold",style:{color:"var(--gold)"},children:[t.labelName,": ",(()=>{const I=t.raw?.featureUnits?.[t.featureNames.length]||"";return I?`${Math.round(D.value)}${I}`:Ne(D.value)})()]})]})}return null}}),a?C.map((P,k)=>{const D=h.filter(I=>I.label===P);return D.length>0?c.jsx(vu,{name:t.classes?t.classes[P]:`グループ ${P}`,data:D,fill:i[k%i.length],stroke:i[k%i.length],strokeWidth:2,fillOpacity:.8,r:4},P):null}):h.length>0?c.jsx(vu,{data:h,fill:i[0],fillOpacity:.8,stroke:i[1]||i[0],strokeWidth:2,r:4}):null]})})]},u)})}),s.length>6&&c.jsxs("div",{className:"mt-4 text-center text-sm",style:{color:"var(--accent-strong)"},children:["主要な",o.length,"組の特徴量ペアを表示しています （全",s.length,"組）"]})]})}function WL(t){const e=[...t.train,...t.test],r=t.featureNames.length,n=Array.from({length:r},(s,o)=>{const l=e.map(m=>m.features[o]),u=l.reduce((m,g)=>m+g,0)/l.length,h=l.reduce((m,g)=>m+Math.pow(g-u,2),0)/l.length,f=Math.sqrt(h);return{min:Math.min(...l),max:Math.max(...l),mean:u,std:f}}),a=[];e.forEach((s,o)=>{s.features.forEach((l,d)=>{const{mean:u,std:h}=n[d];Math.abs((l-u)/h)>3&&a.push({index:o,featureIndex:d,value:l})})});let i;return t.classes&&(i={},e.forEach(s=>{const o=typeof s.label=="number"&&t.classes?t.classes[s.label]:String(s.label);i[o]=(i[o]||0)+1})),{outliers:a.slice(0,20),missingValues:0,classBalance:i,featureRanges:n}}function KL(t){const e=[],r=[...t.train,...t.test],n=t.featureNames.map((a,i)=>{const s=r.map(h=>h.features[i]),l=s.reduce((h,f)=>h+f,0)/s.length,d=s.reduce((h,f)=>h+Math.pow(f-l,2),0)/s.length,u=Math.sqrt(d);return{mean:l,std:u}});return r.forEach((a,i)=>{let s=0;a.features.forEach((o,l)=>{const{mean:d,std:u}=n[l];Math.abs((o-d)/u)>2.5&&s++}),s>=2&&e.push(i)}),e}function VL(t,e){const r=[];if(t.outliers.length>0&&r.push(`外れ値が${t.outliers.length}個検出されました。これらのデータポイントを確認し、削除または補正を検討してください。`),t.classBalance){const i=Object.values(t.classBalance),s=Math.max(...i),o=Math.min(...i),l=s/o;l>3&&r.push(`クラスの不均衡が検出されました（最大比率: ${l.toFixed(1)}:1）。サンプリング手法の適用を検討してください。`)}t.featureRanges.forEach((i,s)=>{i.std<.01&&r.push(`特徴量「${e.featureNames[s]}」の分散が非常に小さいです。この特徴量は予測にあまり寄与しない可能性があります。`)});const a=HL(e).filter(i=>Math.abs(i.correlation)>.9&&i.feature1!==i.feature2);return a.length>0&&r.push(`高い相関を持つ特徴量のペアが${a.length}個見つかりました。多重共線性の可能性があります。`),r.length===0&&r.push("データの品質は良好です。このままモデルの学習を進めましょう。"),r}function HL(t){const e=[],r=[...t.train,...t.test],n=t.featureNames.length;for(let a=0;a<n;a++)for(let i=a+1;i<n;i++){const s=r.map(g=>g.features[a]),o=r.map(g=>g.features[i]),l=s.reduce((g,p)=>g+p,0)/s.length,d=o.reduce((g,p)=>g+p,0)/o.length;let u=0,h=0,f=0;for(let g=0;g<s.length;g++){const p=s[g]-l,y=o[g]-d;u+=p*y,h+=p*p,f+=y*y}const m=u/Math.sqrt(h*f);e.push({feature1:a,feature2:i,correlation:m})}return e}function yw({dataset:t}){const[e,r]=v.useState("overview"),n=v.useMemo(()=>WL(t),[t]),a=v.useMemo(()=>KL(t),[t]),i=v.useMemo(()=>VL(n,t),[n,t]),s=[{id:"overview",label:"データの中身",icon:_o,description:"実際のデータを見てみよう"},{id:"statistics",label:"数値の特徴",icon:tn,description:"平均・最大・ばらつきを確認"},{id:"distribution",label:"値の広がり",icon:Ei,description:"どの値が多いかヒストグラムで確認"},{id:"correlation",label:"関係性",icon:Di,description:"特徴同士の相関を見る"},{id:"scatter",label:"散らばり具合",icon:hc,description:"2つの特徴の関係を見る"},{id:"insights",label:"AIの洞察",icon:En,description:"データから分かること"}];return c.jsxs("div",{className:"rounded-xl shadow-lg border-2 overflow-hidden",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"p-4 rounded-t-xl",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(_o,{className:"w-5 h-5 text-yellow-400"}),c.jsx("h3",{className:"text-lg font-bold text-white",children:"データを調べよう"})]}),c.jsx("p",{className:"text-sm text-yellow-200",children:"データをよく観察して、パターンや特徴を見つけよう！"})]}),c.jsx("div",{className:"border-b bg-slate-50",style:{borderColor:"var(--gold)"},children:c.jsx("div",{className:"flex space-x-2 p-3 overflow-x-auto",children:s.map(o=>{const l=o.icon;return c.jsxs("button",{onClick:()=>r(o.id),className:`flex flex-col items-center space-y-1 px-4 py-3 rounded-lg transition-all whitespace-nowrap min-w-[120px] border-2 ${e===o.id?"shadow-md scale-105 font-bold bg-yellow-400 text-blue-900 border-yellow-500":"hover:bg-blue-100 text-slate-600 border-slate-300"}`,children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(l,{className:"w-4 h-4"}),c.jsx("span",{className:"text-sm font-medium",children:o.label})]}),c.jsx("span",{className:"text-xs opacity-80",children:o.description})]},o.id)})})}),c.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-slate-50 to-gray-50 border-b",style:{borderColor:"var(--gold)"},children:[e==="overview"&&c.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[c.jsx(ju,{className:"w-5 h-5 mt-1 text-yellow-500"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-lg",children:"見方のコツ"}),c.jsx("div",{className:"text-base",children:"単位や桁を確認し、常識的な値かをチェック。生データ（raw）があれば比較して理解を深めよう。"})]})]}),e==="distribution"&&c.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[c.jsx(Ei,{className:"w-5 h-5 mt-1 text-yellow-500"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),c.jsx("div",{className:"text-base",children:t.classes&&t.classes.length>0?"山型＝自然な分布。片寄りや二峰性のときは前処理（正規化/標準化）を検討しよう。":"目的変数が正規分布に近いと回帰モデルの精度が向上しやすくなります。"}),c.jsxs("div",{className:"text-sm text-blue-700 mt-2",children:["💡 ",t.classes&&t.classes.length>0?"新問題例：毛利氏の風速は正規分布、加賀の信者数は偏りがある、長宗我部氏の戦果は3つのクラスに分かれる":"回帰問題例：甲斐の産出量、越後の収穫量、出羽の輸送効率など、目的変数の分布を確認しよう"]})]})]}),e==="correlation"&&c.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[c.jsx(Di,{className:"w-5 h-5 mt-1 text-yellow-500"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),c.jsx("div",{className:"text-base",children:"相関の高い特徴は有力候補。同じ情報の重複は減らしてシンプルに。"})]})]}),e==="scatter"&&c.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[c.jsx(hc,{className:"w-5 h-5 mt-1 text-yellow-500"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),c.jsx("div",{className:"text-base",children:t.classes&&t.classes.length>0?"直線/曲線の形が見えたら、それに合うモデル（線形/非線形）を選ぼう。":"特徴量と目的変数の関係を確認し、予測に有効な特徴量を見つけよう。"}),c.jsxs("div",{className:"text-sm text-blue-700 mt-2",children:["💡 ",t.classes&&t.classes.length>0?"新問題例：毛利氏の海戦では風速と船数、加賀の布教では人口密度と経済状況、長宗我部氏の戦略では兵力と装備の関係を確認しよう":"回帰問題例：甲斐の産出量では労働者数と気温、越後の収穫量では降水量と日照時間、出羽の輸送効率では距離と標高の関係を確認しよう"]})]})]}),e==="statistics"&&c.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[c.jsx(tn,{className:"w-5 h-5 mt-1 text-yellow-500"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),c.jsx("div",{className:"text-base",children:"平均±標準偏差の範囲が常識的か、外れ値が多すぎないかを確認しよう。"})]})]}),e==="insights"&&c.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[c.jsx(En,{className:"w-5 h-5 mt-1 text-yellow-500"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-lg",children:"次の一手"}),c.jsx("div",{className:"text-base",children:"必要に応じて前処理タブで正規化/標準化を試し、相関の高い特徴を中心に選んでみよう。"})]})]})]}),c.jsxs("div",{className:"p-6",children:[e==="overview"&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-300 shadow-sm",children:[c.jsx("div",{className:"text-lg font-bold text-blue-900 mb-2",children:"データ数"}),c.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:["訓練: ",t.train.length," / テスト: ",t.test.length]})]}),c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-300 shadow-sm",children:[c.jsx("div",{className:"text-lg font-bold text-blue-900 mb-3",children:"特徴量"}),c.jsx("div",{className:"space-y-2",children:t.featureNames.map((o,l)=>c.jsxs("div",{className:"text-base text-blue-800 flex items-center",children:[c.jsx("span",{className:"w-3 h-3 bg-blue-600 rounded-full mr-3"}),o]},l))})]}),t.classes&&c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-300 shadow-sm",children:[c.jsx("div",{className:"text-lg font-bold text-blue-900 mb-3",children:"クラス"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:t.classes.map((o,l)=>c.jsx("span",{className:"px-3 py-2 bg-blue-200 text-blue-900 text-base rounded-lg font-bold",children:o},l))})]}),t.raw&&c.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border-2 border-slate-300 shadow-sm",children:[c.jsx("div",{className:"text-lg font-bold text-slate-900 mb-3",children:"生データ（前処理前）"}),c.jsx("div",{className:"overflow-x-auto bg-white rounded-lg border-2 border-slate-200",children:c.jsxs("table",{className:"w-full text-base",children:[c.jsx("thead",{className:"bg-slate-100",children:c.jsxs("tr",{className:"border-b-2 border-slate-300",children:[t.featureNames.map((o,l)=>c.jsxs("th",{className:"px-3 py-3 text-left text-slate-900 font-bold",children:[o,t.raw?.featureUnits?.[l]&&c.jsxs("span",{className:"text-slate-600 ml-1",children:["(",t.raw.featureUnits[l],")"]})]},l)),c.jsx("th",{className:"px-3 py-3 text-left text-slate-900 font-bold",children:"ラベル"})]})}),c.jsx("tbody",{className:"bg-white",children:t.raw.train.slice(0,5).map((o,l)=>c.jsxs("tr",{className:"border-b border-slate-200 hover:bg-slate-50",children:[o.features.map((d,u)=>c.jsx("td",{className:"px-3 py-3 text-slate-900",children:typeof d=="number"?Ne(d):d},u)),c.jsx("td",{className:"px-3 py-3 text-slate-900 font-bold",children:Array.isArray(t.classes)&&typeof o.label=="number"?t.classes[o.label]??o.label:o.label})]},l))})]})})]})]}),e==="statistics"&&c.jsx(yj,{dataset:t}),e==="distribution"&&c.jsx(UL,{dataset:t}),e==="correlation"&&c.jsx(FL,{dataset:t}),e==="scatter"&&c.jsx(qL,{dataset:t}),e==="insights"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border-2 border-amber-400",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(En,{className:"w-5 h-5 text-amber-700"}),c.jsx("h4",{className:"text-lg font-bold text-amber-900",children:"データ改善の提案"})]}),c.jsx("div",{className:"space-y-2",children:i.map((o,l)=>c.jsxs("div",{className:"flex items-start space-x-2 text-sm text-amber-800",children:[c.jsx(Xt,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),c.jsx("span",{children:o})]},l))})]}),n.classBalance&&c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-400",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(Ei,{className:"w-5 h-5 text-blue-700"}),c.jsx("h4",{className:"text-lg font-bold text-blue-900",children:"クラスバランス"})]}),c.jsx("div",{className:"space-y-2",children:Object.entries(n.classBalance).map(([o,l])=>{const d=Object.values(n.classBalance).reduce((h,f)=>h+f,0),u=(l/d*100).toFixed(1);return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"font-medium text-blue-900",children:o}),c.jsxs("span",{className:"text-blue-700",children:[l,"件 (",u,"%)"]})]}),c.jsx("div",{className:"h-3 bg-blue-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all",style:{width:`${u}%`}})})]},o)})})]}),n.outliers.length>0&&c.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border-2 border-red-400",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(fc,{className:"w-5 h-5 text-red-700"}),c.jsx("h4",{className:"text-lg font-bold text-red-900",children:"外れ値の検出"})]}),c.jsxs("p",{className:"text-sm text-red-800 mb-3",children:[n.outliers.length,"個の外れ値が検出されました（表示上限20個）。これらは通常のパターンから大きく外れたデータポイントです。"]}),c.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:n.outliers.slice(0,10).map((o,l)=>c.jsxs("div",{className:"bg-white p-2 rounded border border-red-300 text-xs",children:[c.jsxs("span",{className:"font-medium text-red-900",children:["データ#",o.index+1]}),c.jsxs("span",{className:"text-red-700 ml-2",children:[t.featureNames[o.featureIndex],": ",o.value.toFixed(3)]})]},l))})]}),a.length>0&&c.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border-2 border-orange-400",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(fc,{className:"w-5 h-5 text-orange-700"}),c.jsx("h4",{className:"text-lg font-bold text-orange-900",children:"異常データの検出"})]}),c.jsxs("p",{className:"text-sm text-orange-800",children:[a.length,"個の異常なデータポイントが検出されました。複数の特徴量で同時に異常な値を持つデータです。"]})]}),c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border-2 border-green-400",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(_o,{className:"w-5 h-5 text-green-700"}),c.jsx("h4",{className:"text-lg font-bold text-green-900",children:"データ品質スコア"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-green-800",children:"完全性"}),c.jsx("span",{className:"font-bold text-green-900",children:"100%"})]}),c.jsx("div",{className:"h-2 bg-green-200 rounded-full",children:c.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:"100%"}})})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-green-800",children:"バランス"}),c.jsx("span",{className:"font-bold text-green-900",children:n.classBalance?(()=>{const o=Object.values(n.classBalance),l=Math.max(...o);return`${(Math.min(...o)/l*100).toFixed(0)}%`})():"100%"})]}),c.jsx("div",{className:"h-2 bg-green-200 rounded-full",children:c.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:n.classBalance?(()=>{const o=Object.values(n.classBalance),l=Math.max(...o);return`${(Math.min(...o)/l*100).toFixed(0)}%`})():"100%"}})})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-green-800",children:"異常値の少なさ"}),c.jsxs("span",{className:"font-bold text-green-900",children:[((t.train.length+t.test.length-n.outliers.length)/(t.train.length+t.test.length)*100).toFixed(0),"%"]})]}),c.jsx("div",{className:"h-2 bg-green-200 rounded-full",children:c.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:`${((t.train.length+t.test.length-n.outliers.length)/(t.train.length+t.test.length)*100).toFixed(0)}%`}})})]})]})]}),c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-400",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(Xt,{className:"w-5 h-5 text-blue-700"}),c.jsx("h4",{className:"text-lg font-bold text-blue-900",children:"データの特徴分析"})]}),c.jsx("div",{className:"space-y-2",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"データサイズ:"})," ",t.train.length+t.test.length,"件"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"特徴量数:"})," ",t.featureNames.length,"個"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"問題タイプ:"})," ",t.classes?"分類問題":"回帰問題"]}),t.classes&&c.jsxs("p",{children:[c.jsx("strong",{children:"クラス数:"})," ",t.classes.length,"個"]})]})})]})]})]})]})}function GL(t){const e=t.featureNames.length,r=Array(e).fill(1/0),n=Array(e).fill(-1/0),a=t.raw?.train?.length?t.raw:{train:t.train,test:t.test};a.train.forEach(s=>{for(let o=0;o<e;o++){const l=s.features[o];r[o]=Math.min(r[o],l),n[o]=Math.max(n[o],l)}});const i=s=>({features:s.features.map((o,l)=>{const d=n[l]-r[l];return!isFinite(d)||d===0?0:(o-r[l])/d}),label:s.label});return{train:a.train.map(i),test:a.test.map(i),featureNames:t.featureNames,labelName:t.labelName,classes:t.classes,raw:t.raw}}function bw({dataset:t,onPreprocess:e}){const[r,n]=v.useState("none"),[a,i]=v.useState([]);function s(u,h){const f={},m=h.filter(p=>{const y=u.train.slice(0,20).map(w=>w.features[p]),b=new Set(y.map(w=>String(w))),x=b.size<=5&&y.every(w=>{const _=String(w);return isNaN(Number(_))||Number.isInteger(Number(_))});return console.log(`特徴量 ${p}: ユニーク値数=${b.size}, カテゴリ判定=${x}`),x});console.log("カテゴリ変数として処理される特徴量:",m),u.train.forEach(p=>{p.features.forEach((y,b)=>{if(!m.includes(b))return;const x=String(y);f[b]||(f[b]=new Map),f[b].has(x)||f[b].set(x,f[b].size)})}),u.test.forEach(p=>{p.features.forEach((y,b)=>{if(!m.includes(b))return;const x=String(y);f[b]||(f[b]=new Map),f[b].has(x)||f[b].set(x,f[b].size)})});const g=p=>({features:p.features.map((y,b)=>{if(!m.includes(b))return y;const x=String(y);return f[b].get(x)??0}),label:p.label});return{...u,train:u.train.map(g),test:u.test.map(g)}}const o=v.useMemo(()=>r==="encode"?s(t,a):r==="normalize"?GL(t):t,[r,t,a]),d=v.useMemo(()=>r==="none"?t.raw||t:o,[r,t,o])||t;return c.jsxs("div",{className:"rounded-xl shadow-lg border-2 overflow-hidden",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"p-4 rounded-t-xl",style:{background:"linear-gradient(to right, var(--accent-strong), var(--accent))"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(ks,{className:"w-5 h-5",style:{color:"var(--gold)"}}),c.jsx("h3",{className:"text-lg font-bold text-white",children:"データの前処理"})]}),c.jsx("p",{className:"text-sm text-white/85",children:"生データを機械学習に適した形に整えよう（EDAで生データも確認できます）"})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("button",{onClick:()=>n("none"),className:`flex items-center justify-between p-4 rounded-lg border-2 ${r==="none"?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(jo,{className:"w-5 h-5 text-gray-800"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-gray-900",children:"前処理なし"}),c.jsx("div",{className:"text-xs text-gray-600",children:"元のスケールのまま使う"})]})]}),r==="none"&&c.jsx(So,{className:"w-5 h-5 text-yellow-600"})]}),c.jsxs("button",{onClick:()=>n("encode"),className:`flex items-center justify-between p-4 rounded-lg border-2 ${r==="encode"?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(jo,{className:"w-5 h-5 text-gray-800"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-gray-900",children:"カテゴリ数値化"}),c.jsx("div",{className:"text-xs text-gray-600",children:"カテゴリを整数IDに符号化（ラベルエンコード）"})]})]}),r==="encode"&&c.jsx(So,{className:"w-5 h-5 text-yellow-600"})]}),c.jsxs("button",{onClick:()=>n("normalize"),className:`flex items-center justify-between p-4 rounded-lg border-2 ${r==="normalize"?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(jo,{className:"w-5 h-5 text-gray-800"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-gray-900",children:"正規化（0-1）"}),c.jsx("div",{className:"text-xs text-gray-600",children:"各特徴量を0〜1に揃える"})]})]}),r==="normalize"&&c.jsx(So,{className:"w-5 h-5 text-yellow-600"})]})]}),r==="encode"&&c.jsxs("div",{className:"text-sm text-gray-700",children:[c.jsx("div",{className:"font-semibold mb-2",children:"数値化する特徴量を選択（カテゴリ → 整数）"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:t.featureNames.map((u,h)=>c.jsx("button",{onClick:()=>i(f=>f.includes(h)?f.filter(m=>m!==h):[...f,h]),className:`px-3 py-1 rounded border ${a.includes(h)?"bg-emerald-100 border-emerald-400 text-emerald-800":"bg-white border-gray-300 text-gray-700"}`,children:u},h))})]}),c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-semibold mb-2 text-gray-900",children:"プレビュー（先頭5件）"}),d&&d.train&&d.train.length>0?c.jsx("div",{className:"overflow-x-auto rounded bg-white border-2 border-gray-200 shadow-sm",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{className:"border-b border-gray-200",children:[d.featureNames.map((u,h)=>c.jsx("th",{className:"px-3 py-3 text-left font-semibold text-gray-900",children:u},h)),c.jsx("th",{className:"px-3 py-3 text-left font-semibold text-gray-900",children:"ラベル"})]})}),c.jsx("tbody",{className:"bg-white",children:d.train.slice(0,5).map((u,h)=>c.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[u.features.map((f,m)=>c.jsx("td",{className:"px-3 py-3 text-gray-800",children:typeof f=="number"?f.toFixed(3):f},m)),c.jsx("td",{className:"px-3 py-3 font-medium text-gray-900",children:typeof u.label=="number"?u.label.toFixed(3):u.label})]},h))})]})}):c.jsxs("div",{className:"p-4 bg-gray-100 rounded border-2 border-gray-200 text-center text-gray-600",children:[c.jsx("div",{className:"mb-2",children:"データを読み込み中..."}),c.jsx("div",{className:"text-xs text-gray-500",children:"データの読み込みに時間がかかっています。しばらくお待ちください。"})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{onClick:()=>e(o),className:"text-white px-8 py-3 rounded-lg font-bold shadow-lg transition-all",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))"},children:"前処理を適用して次へ"})})]})]})}function xw({dataset:t,selectedFeatures:e,onFeaturesChange:r}){const n=s=>{e.includes(s)?r(e.filter(o=>o!==s)):r([...e,s].sort((o,l)=>o-l))},a=()=>{r(t.featureNames.map((s,o)=>o))},i=s=>{const o=t.train.map(f=>f.features[s]),d=o.reduce((f,m)=>f+m,0)/o.length,u=o.reduce((f,m)=>f+Math.pow(m-d,2),0)/o.length,h=Math.sqrt(u);return{mean:d,std:h,min:Math.min(...o),max:Math.max(...o)}};return c.jsxs("div",{className:"rounded-xl shadow-lg border-2 overflow-hidden",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"p-6",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%)"},children:[c.jsx("h3",{className:"text-2xl font-bold text-white",children:"使う特徴を選ぼう"}),c.jsx("p",{className:"text-lg mt-2 text-yellow-200",children:"予測に役立ちそうな特徴を選びます。最低1つは選んでください。"})]}),c.jsxs("div",{className:"p-8",children:[c.jsx("div",{className:"mb-8 p-6 rounded-lg border-2 bg-slate-50",style:{borderColor:"var(--gold)"},children:c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx(En,{className:"w-6 h-6 flex-shrink-0 mt-1 text-yellow-500"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-lg leading-relaxed mb-3 text-blue-900",children:c.jsx("span",{className:"font-bold",children:"特徴選択のポイント："})}),c.jsxs("ul",{className:"text-base space-y-2 text-blue-800",children:[c.jsx("li",{children:"• 値のばらつき（標準偏差）が大きい特徴は予測に役立つことが多い"}),c.jsx("li",{children:"• すべての特徴を使うと、逆に精度が下がることもある"}),c.jsx("li",{children:"• まずは全部使ってみて、少しずつ減らして試してみよう"})]})]})]})}),c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{className:"text-lg text-blue-900",children:["選択中: ",c.jsx("span",{className:"font-bold text-blue-700",children:e.length})," / ",t.featureNames.length]}),c.jsx("button",{onClick:a,className:"text-lg font-bold transition-colors text-blue-600 hover:text-blue-800 px-4 py-2 rounded-lg border-2 border-blue-300 hover:border-blue-500",children:"すべて選択"})]}),c.jsx("div",{className:"space-y-4",children:t.featureNames.map((s,o)=>{const l=e.includes(o),d=i(o);return c.jsx("button",{onClick:()=>n(o),className:`w-full text-left p-6 rounded-lg border-2 transition-all ${l?"bg-yellow-50 shadow-lg border-yellow-400":"bg-slate-50 hover:bg-blue-50 border-slate-300"}`,children:c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx("div",{className:"flex-shrink-0 mt-1",children:l?c.jsx(pg,{className:"w-8 h-8 text-yellow-500"}):c.jsx(Nw,{className:"w-8 h-8 text-slate-400"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h4",{className:`text-xl font-bold ${l?"text-blue-900":"text-slate-600"}`,children:s}),l&&c.jsx("span",{className:"text-sm px-3 py-1 rounded-full font-bold bg-blue-600 text-white",children:"使用中"})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-base",children:[c.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[c.jsx("span",{className:"font-bold",children:"平均:"})," ",Ne(d.mean)]}),c.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[c.jsx("span",{className:"font-bold",children:"ばらつき:"})," ",Ne(d.std)]}),c.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[c.jsx("span",{className:"font-bold",children:"最小:"})," ",Ne(d.min)]}),c.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[c.jsx("span",{className:"font-bold",children:"最大:"})," ",Ne(d.max)]})]})]})]})},o)})}),e.length===0&&c.jsx("div",{className:"mt-6 bg-red-50 p-6 rounded-lg border-2 border-red-200",children:c.jsx("p",{className:"text-lg text-red-800 text-center font-bold",children:"少なくとも1つの特徴を選んでください"})})]})]})}function ww({progress:t}){return t?c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-green-600 animate-pulse",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(Mh,{className:"w-5 h-5 text-green-900"}),c.jsx("h3",{className:"text-lg font-bold text-green-900",children:"訓練中..."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-300",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-green-900",children:"進捗"}),c.jsxs("span",{className:"text-lg font-bold text-green-800",children:[t.epoch||0," / ",t.total||100,t.progress&&` (${t.progress}%)`]})]}),c.jsx("div",{className:"w-full bg-green-200 rounded-full h-3 overflow-hidden",children:c.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-full transition-all duration-300",style:{width:`${t.progress||Math.min((t.epoch||0)/(t.total||100)*100,100)}%`}})}),t.message&&c.jsx("div",{className:"mt-2 text-sm text-green-700 text-center",children:t.message})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-300",children:[c.jsx("div",{className:"text-xs font-medium text-green-900 mb-1",children:"損失"}),c.jsx("div",{className:"text-xl font-bold text-green-800",children:t.loss?.toFixed(4)||"0.0000"})]}),(t.accuracy||0)>0&&c.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-300",children:[c.jsx("div",{className:"text-xs font-medium text-green-900 mb-1",children:"精度"}),c.jsxs("div",{className:"text-xl font-bold text-green-800",children:[((t.accuracy||0)*100).toFixed(1),"%"]})]})]}),(t.elapsed||t.eta)&&c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-300",children:[c.jsx("div",{className:"text-xs font-medium text-blue-900 mb-1",children:"経過時間"}),c.jsx("div",{className:"text-lg font-bold text-blue-800",children:t.elapsed?`${(t.elapsed/1e3).toFixed(1)}s`:"N/A"})]}),c.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-300",children:[c.jsx("div",{className:"text-xs font-medium text-blue-900 mb-1",children:"残り時間"}),c.jsx("div",{className:"text-lg font-bold text-blue-800",children:t.eta?`${(t.eta/1e3).toFixed(1)}s`:"N/A"})]})]})]})]}):c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-green-600 animate-pulse",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(Mh,{className:"w-5 h-5 text-green-900"}),c.jsx("h3",{className:"text-lg font-bold text-green-900",children:"訓練中..."})]}),c.jsx("div",{className:"text-center text-green-700",children:"学習を開始しています..."})]})}function YL({modelType:t,parameters:e,onParametersChange:r,onClose:n}){const[a,i]=v.useState(e),s=b=>{switch(b){case"logistic_regression":return{learning_rate:.01,max_iterations:1e3,regularization:.1,solver:"lbfgs"};case"linear_regression":return{learning_rate:.01,max_iterations:1e3,regularization:.1};case"neural_network":return{learning_rate:.01,max_iterations:100,hidden_layers:2,hidden_units:16,dropout_rate:.2,activation:"relu",optimizer:"adam"};case"knn":return{k:5,distance_metric:"euclidean",weights:"uniform"};case"random_forest":return{n_estimators:100,max_depth:10,min_samples_split:2,min_samples_leaf:1,max_features:"sqrt"};case"svm":return{C:1,kernel:"rbf",gamma:"scale",degree:3};default:return{}}},o=(b,x)=>({logistic_regression:{learning_rate:"学習率: モデルの学習速度を制御します（0.001-1.0）",max_iterations:"最大反復回数: 学習の最大回数（100-10000）",regularization:"正則化: 過学習を防ぐ強度（0.0-1.0）",solver:"ソルバー: 最適化アルゴリズム"},linear_regression:{learning_rate:"学習率: モデルの学習速度を制御します（0.001-1.0）",max_iterations:"最大反復回数: 学習の最大回数（100-10000）",regularization:"正則化: 過学習を防ぐ強度（0.0-1.0）"},neural_network:{learning_rate:"学習率: モデルの学習速度を制御します（0.001-1.0）",max_iterations:"エポック数: 学習の回数（10-1000）",hidden_layers:"隠れ層数: ニューラルネットワークの層数（1-5）",hidden_units:"隠れユニット数: 各層のニューロン数（4-128）",dropout_rate:"ドロップアウト率: 過学習防止の強度（0.0-0.8）",activation:"活性化関数: ニューロンの活性化方法",optimizer:"オプティマイザー: 最適化アルゴリズム"},knn:{k:"近傍数: 予測に使用する近いデータの数（1-20）",distance_metric:"距離指標: データ間の距離計算方法",weights:"重み付け: 近傍データの重み付け方法"},random_forest:{n_estimators:"決定木数: 使用する決定木の数（10-500）",max_depth:"最大深度: 各決定木の最大の深さ（1-20）",min_samples_split:"分割最小サンプル数: ノード分割に必要な最小サンプル数（2-20）",min_samples_leaf:"葉最小サンプル数: 葉ノードの最小サンプル数（1-10）",max_features:"最大特徴数: 各分割で考慮する特徴数"},svm:{C:"正則化パラメータ: 誤分類の許容度（0.1-100）",kernel:"カーネル: データの変換方法",gamma:"ガンマ: カーネルの影響範囲（scale, auto, 数値）",degree:"次数: 多項式カーネルの次数（1-10）"}})[x]?.[b]||"",l=(b,x)=>{const w=["learning_rate","max_iterations","regularization","k","n_estimators","max_depth","min_samples_split","min_samples_leaf","C","degree","hidden_layers","hidden_units","dropout_rate"],_=["solver","activation","optimizer","distance_metric","weights","kernel","gamma","max_features"];return w.includes(b)?"number":_.includes(b)?"select":"text"},d=(b,x)=>({logistic_regression:{solver:["lbfgs","liblinear","newton-cg","sag","saga"]},neural_network:{activation:["relu","sigmoid","tanh","linear"],optimizer:["adam","sgd","rmsprop","adagrad"]},knn:{distance_metric:["euclidean","manhattan","minkowski"],weights:["uniform","distance"]},random_forest:{max_features:["sqrt","log2","auto","0.5","0.8"]},svm:{kernel:["rbf","linear","poly","sigmoid"],gamma:["scale","auto","0.001","0.01","0.1","1.0"]}})[x]?.[b]||[],u=(b,x)=>({logistic_regression:{learning_rate:{min:.001,max:1,step:.001},max_iterations:{min:100,max:1e4,step:100},regularization:{min:0,max:1,step:.01}},linear_regression:{learning_rate:{min:.001,max:1,step:.001},max_iterations:{min:100,max:1e4,step:100},regularization:{min:0,max:1,step:.01}},neural_network:{learning_rate:{min:.001,max:1,step:.001},max_iterations:{min:10,max:1e3,step:10},hidden_layers:{min:1,max:5,step:1},hidden_units:{min:4,max:128,step:4},dropout_rate:{min:0,max:.8,step:.1}},knn:{k:{min:1,max:20,step:1}},random_forest:{n_estimators:{min:10,max:500,step:10},max_depth:{min:1,max:20,step:1},min_samples_split:{min:2,max:20,step:1},min_samples_leaf:{min:1,max:10,step:1}},svm:{C:{min:.1,max:100,step:.1},degree:{min:1,max:10,step:1}}})[x]?.[b]||{min:0,max:100,step:1};v.useEffect(()=>{const b=s(t);i({...b,...e})},[t,e]);const h=(b,x)=>{const w={...a,[b]:x};i(w)},f=()=>{r(a),n()},m=()=>{const b=s(t);i(b)},g={logistic_regression:"ロジスティック回帰",linear_regression:"線形回帰",neural_network:"ニューラルネットワーク",knn:"k近傍法",random_forest:"ランダムフォレスト",svm:"サポートベクターマシン"}[t]||t,p=s(t),y=Object.entries(p);return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(ks,{className:"w-6 h-6"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold",children:"ハイパーパラメータ設定"}),c.jsx("p",{className:"text-blue-100",children:g})]})]}),c.jsx("button",{onClick:n,className:"text-white hover:text-gray-200 transition-colors",children:c.jsx(Pw,{className:"w-6 h-6"})})]})}),c.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(([b,x])=>{const w=l(b),_=o(b,t),S=a[b]??x;return c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[c.jsxs("div",{className:"mb-3",children:[c.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-1",children:b.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),c.jsx("p",{className:"text-xs text-gray-600 mb-2",children:_})]}),w==="number"?c.jsxs("div",{children:[c.jsx("input",{type:"number",value:S,onChange:j=>h(b,parseFloat(j.target.value)||0),min:u(b,t).min,max:u(b,t).max,step:u(b,t).step,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[c.jsx("span",{children:u(b,t).min}),c.jsx("span",{children:u(b,t).max})]})]}):w==="select"?c.jsx("select",{value:S,onChange:j=>h(b,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:d(b,t).map(j=>c.jsx("option",{value:j,children:j},j))}):c.jsx("input",{type:"text",value:S,onChange:j=>h(b,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]},b)})})}),c.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-between items-center border-t border-gray-200",children:[c.jsxs("button",{onClick:m,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[c.jsx(kw,{className:"w-4 h-4"}),c.jsx("span",{children:"デフォルトに戻す"})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:n,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"キャンセル"}),c.jsx("button",{onClick:f,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"保存"})]})]})]})})}function JL({problemId:t,problemTitle:e,problemDescription:r,dataset:n,difficulty:a,timeLimit:i,onBack:s,isMultiplayer:o=!1,participants:l=[],roomId:d="default-room",username:u}){const h=Ct.getCurrentUser(),f=u||h?.username||"プレイヤー",[m,g]=v.useState(null),[p,y]=v.useState(null),[b,x]=v.useState([]),w=[{id:"logistic_regression",name:"ロジスティック回帰"},{id:"linear_regression",name:"線形回帰"},{id:"neural_network",name:"ニューラルネットワーク"}],[_,S]=v.useState("logistic_regression"),[j,N]=v.useState({}),[M,O]=v.useState(!1),[C,P]=v.useState(!1),[k,D]=v.useState(null),[I,W]=v.useState(null),[V,K]=v.useState("data"),[X,B]=v.useState(null),[R,Y]=v.useState(!1),[$,qe]=v.useState(null),[hr,te]=v.useState(null),[Bt,$r]=v.useState(null),[aa,L]=v.useState(!1),[H,Z]=v.useState(["accuracy"]),[T,$e]=v.useState({trainRatio:.7,validationRatio:.2,testRatio:.1,randomSeed:42,stratified:!0});v.useEffect(()=>{if(g(n),y(n),n.featureNames&&n.featureNames.length>0){const z=n.featureNames.slice(0,Math.min(3,n.featureNames.length)).map((ue,mt)=>mt);x(z)}B({id:t,title:e,description:r||"",problemType:n.classes&&n.classes.length>2?"multiclass_classification":n.classes&&n.classes.length===2?"binary_classification":"regression",difficulty:a||"medium",timeLimit:i||3600,dataset:{data:[...n.train,...n.test],train:n.train,test:n.test,validation:n.test,featureNames:n.featureNames,labelName:n.labelName,classes:n.classes||[],problemType:n.classes&&n.classes.length>0?"classification":"regression",defaultMetric:n.classes&&n.classes.length>0?"accuracy":"mae",description:r||"",metric:n.classes&&n.classes.length>0?"accuracy":"mae"},metric:n.classes&&n.classes.length>0?"accuracy":"mae",constraints:{maxFeatures:n.featureNames.length,maxTrainingTime:i||3600,maxSubmissions:100,allowedModels:["logistic_regression","linear_regression","neural_network"]},startTime:new Date,endTime:new Date(Date.now()+10080*60*1e3),participantCount:0,submissionCount:0})},[n,t,e,r,a,i]);const ce=async()=>{if(console.log("=== 学習開始 ==="),console.log("データセット:",!!p),console.log("特徴量:",b),console.log("モデル:",_),console.log("パラメータ:",j),!p){te("前処理データがありません");return}if(b.length===0){te("特徴量が選択されていません");return}try{P(!0),te(null),D(null);const ue=Rh.getRecommendedParameters(_,1),mt=Object.keys(j).length>0?j:ue;console.log("最終パラメータ:",mt);const Nt={modelType:_,parameters:mt,selectedFeatures:b,evaluationMetrics:H,dataSplit:{trainRatio:T.trainRatio,validationRatio:T.validationRatio,testRatio:T.testRatio,randomSeed:T.randomSeed,stratified:T.stratified}};console.log("学習設定:",Nt);const ae=await $h.trainModel(p,Nt,Ft=>{console.log("学習進捗:",{epoch:Ft.epoch,total:Ft.total,message:Ft.message,loss:Ft.loss,accuracy:Ft.accuracy,progress:Ft.progress}),D(Ft)});console.log("学習結果:",ae),W(ae.result),$r(ae.model),K("evaluation"),console.log("学習完了 - 評価ステップに移動")}catch(z){console.error("学習エラー:",z),te(`学習に失敗しました: ${z.message}`)}finally{P(!1)}},Xe=async()=>{if(console.log("=== 評価開始 ==="),console.log("コンペティション問題:",!!X),console.log("前処理データ:",!!p),console.log("特徴量:",b),console.log("モデル:",_),!p){te("前処理データがありません");return}if(b.length===0){te("特徴量が選択されていません");return}try{te(null),L(!0);const ue=Rh.getRecommendedParameters(_,1),mt=Object.keys(j).length>0?j:ue,Nt={modelType:_,parameters:mt,selectedFeatures:b,evaluationMetrics:H,dataSplit:{trainRatio:T.trainRatio,validationRatio:T.validationRatio,testRatio:T.testRatio,randomSeed:T.randomSeed,stratified:T.stratified}};console.log("評価設定:",Nt);const ae=await $h.trainModel(p,Nt);console.log("評価結果:",ae);const Ft={validationScore:ae.result.accuracy,testScore:ae.result.accuracy,metrics:{accuracy:ae.result.accuracy,precision:ae.result.precision||0,recall:ae.result.recall||0,f1_score:ae.result.f1_score||0,mae:ae.result.mae||0,mse:ae.result.mse||0,rmse:ae.result.rmse||0},predictions:ae.result.predictions.map(Rr=>typeof Rr=="string"?parseFloat(Rr):Rr),actual:ae.result.actual.map(Rr=>typeof Rr=="string"?parseFloat(Rr):Rr),trainingTime:ae.trainingTime/1e3,modelComplexity:ae.result.accuracy,config:Nt};qe(Ft),W({accuracy:ae.result.accuracy,training_time:ae.trainingTime/1e3,precision:ae.result.precision,recall:ae.result.recall,f1_score:ae.result.f1_score,predictions:ae.result.predictions,actual:ae.result.actual}),$r(ae.model),K("submission"),console.log("評価完了 - 提出ステップに移動")}catch(z){console.error("評価エラー:",z),te(`評価に失敗しました: ${z.message}`)}finally{L(!1)}},Ze=async()=>{if(console.log("=== 提出開始 ==="),console.log("評価結果:",!!$),console.log("学習済みモデル:",!!Bt),!$){te("評価結果がありません。先に評価を実行してください。");return}if(!Bt){te("学習済みモデルがありません。先に学習を実行してください。");return}try{Y(!0),te(null);const z=Ct.getCurrentUser();if(!z)throw new Error("ユーザーがログインしていません");console.log("提出ユーザー:",z.username);const ue={problemId:X?.id||t,userId:z.id,username:z.username,selectedFeatures:b,modelType:_,parameters:j,preprocessing:{},teamId:void 0,teamMembers:void 0,evaluationResult:$,score:Math.round($.validationScore*100)};console.log("提出データ:",ue);const mt=await dj.submitResult(ue.problemId,ue.userId,ue.username,ue.selectedFeatures,ue.modelType,ue.parameters,ue.preprocessing,ue.teamId,ue.teamMembers,ue.evaluationResult,ue.score);console.log("提出完了:",mt);try{const ae=await _a.getLeaderboard(t);console.log("リーダーボードを更新しました:",ae)}catch(ae){console.error("リーダーボード更新エラー:",ae)}const Nt={won:$.validationScore>=.7,score:Math.round($.validationScore*100),modelType:_,problemType:X?.problemType||"unknown"};Ct.updateBattleResult(Nt.won,Nt.score),console.log("提出完了 - リーダーボードに反映")}catch(z){console.error("提出エラー:",z),te(`提出に失敗しました: ${z.message}`)}finally{Y(!1)}},Ut=()=>{const z=["data","preprocessing","features","model","evaluation","submission"];return(z.indexOf(V)+1)/z.length*100},fr=()=>{const z=["data","preprocessing","features","model","evaluation","submission"],ue=z.indexOf(V);ue<z.length-1&&K(z[ue+1])},ia=()=>{const z=["data","preprocessing","features","model","evaluation","submission"],ue=z.indexOf(V);ue>0&&K(z[ue-1])};return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900",children:[c.jsx("div",{className:"bg-black bg-opacity-20 backdrop-blur-sm border-b border-white border-opacity-20",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:s,className:"p-2 rounded-lg bg-white bg-opacity-10 hover:bg-opacity-20 transition-colors",children:c.jsx(Kr,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:e}),c.jsx("p",{className:"text-white text-opacity-80",children:"オンライン対戦"})]})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-white",children:[Math.round(Ut()),"%"]}),c.jsx("div",{className:"text-sm text-yellow-200",children:"進捗"})]}),o&&c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-white",children:l.length}),c.jsx("div",{className:"text-sm text-yellow-200",children:"参加者"})]})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[c.jsx("div",{className:"lg:col-span-1",children:c.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20",children:[c.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"ステップ"}),c.jsx("div",{className:"space-y-2",children:[{id:"data",name:"データ探索",icon:ju},{id:"preprocessing",name:"前処理",icon:ks},{id:"features",name:"特徴量選択",icon:Xt},{id:"model",name:"モデル学習",icon:mc},{id:"evaluation",name:"評価",icon:Zt},{id:"submission",name:"提出",icon:Mw}].map(z=>{const ue=z.icon,mt=V===z.id,Nt=["data","preprocessing","features","model","evaluation","submission"].indexOf(V)>["data","preprocessing","features","model","evaluation","submission"].indexOf(z.id);return c.jsxs("button",{onClick:()=>K(z.id),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${mt?"bg-yellow-500 text-black":Nt?"bg-green-500 text-white":"bg-white bg-opacity-10 text-white hover:bg-opacity-20"}`,children:[c.jsx(ue,{className:"w-5 h-5"}),c.jsx("span",{className:"font-medium",children:z.name})]},z.id)})})]})}),c.jsx("div",{className:"lg:col-span-3",children:c.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-8 border border-white border-opacity-20",children:[hr&&c.jsx("div",{className:"mb-6 p-4 bg-red-500 bg-opacity-20 border border-red-500 rounded-lg",children:c.jsx("p",{className:"text-red-200",children:hr})}),V==="data"&&m&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"データ探索"}),c.jsx(yw,{dataset:m}),c.jsx("div",{className:"mt-6 flex justify-end",children:c.jsxs("button",{onClick:fr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",c.jsx(Wt,{className:"w-5 h-5 inline ml-2"})]})})]}),V==="preprocessing"&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"前処理"}),c.jsx(bw,{dataset:m,onPreprocess:y}),c.jsxs("div",{className:"mt-6 flex justify-between",children:[c.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),c.jsxs("button",{onClick:fr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",c.jsx(Wt,{className:"w-5 h-5 inline ml-2"})]})]})]}),V==="features"&&p&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"特徴量選択"}),c.jsx(xw,{dataset:p,selectedFeatures:b,onFeaturesChange:x}),c.jsxs("div",{className:"mt-6 flex justify-between",children:[c.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),c.jsxs("button",{onClick:fr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",c.jsx(Wt,{className:"w-5 h-5 inline ml-2"})]})]})]}),V==="model"&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"モデル学習"}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-white font-medium mb-2",children:"モデルタイプ"}),c.jsx("select",{value:_,onChange:z=>S(z.target.value),className:"w-full p-3 bg-white bg-opacity-10 border border-white border-opacity-20 rounded-lg text-white",children:w.map(z=>c.jsx("option",{value:z.id,className:"bg-gray-800",children:z.name},z.id))})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("button",{onClick:()=>O(!M),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:M?"パラメータを隠す":"パラメータを設定"}),M&&c.jsx("div",{className:"mt-4",children:c.jsx(YL,{modelType:_,parameters:j,onParametersChange:N,onClose:()=>O(!1)})})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx("button",{onClick:ce,disabled:C,className:`px-8 py-4 rounded-lg font-bold text-lg transition-colors ${C?"bg-gray-500 cursor-not-allowed":"bg-green-500 hover:bg-green-600 text-white"}`,children:C?"学習中...":"学習開始"})}),C&&k&&c.jsx("div",{className:"mt-6",children:c.jsx(ww,{progress:k})}),I&&c.jsxs("div",{className:"mt-6 p-4 bg-white bg-opacity-10 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"学習結果"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[Math.round(I.accuracy*100),"%"]}),c.jsx("div",{className:"text-sm text-white",children:"精度"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[I.training_time.toFixed(2),"s"]}),c.jsx("div",{className:"text-sm text-white",children:"学習時間"})]})]})]}),c.jsxs("div",{className:"mt-6 flex justify-between",children:[c.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),I&&c.jsxs("button",{onClick:fr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",c.jsx(Wt,{className:"w-5 h-5 inline ml-2"})]})]})]}),V==="evaluation"&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"評価"}),c.jsxs("div",{className:"mb-6 p-4 bg-white bg-opacity-10 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"評価指標を選択"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:["accuracy","precision","recall","f1_score","mae","mse","rmse"].map(z=>c.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[c.jsx("input",{type:"checkbox",checked:H.includes(z),onChange:ue=>{ue.target.checked?Z([...H,z]):Z(H.filter(mt=>mt!==z))},className:"rounded"}),c.jsx("span",{className:"text-sm",children:z})]},z))})]}),c.jsxs("div",{className:"mb-6 p-4 bg-white bg-opacity-10 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"データ分割設定"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm mb-1",children:"学習データ比率"}),c.jsx("input",{type:"range",min:"0.5",max:"0.9",step:"0.1",value:T.trainRatio,onChange:z=>$e({...T,trainRatio:parseFloat(z.target.value),validationRatio:(1-parseFloat(z.target.value))*.5,testRatio:(1-parseFloat(z.target.value))*.5}),className:"w-full"}),c.jsxs("div",{className:"text-white text-sm",children:[Math.round(T.trainRatio*100),"%"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm mb-1",children:"ランダムシード"}),c.jsx("input",{type:"number",value:T.randomSeed,onChange:z=>$e({...T,randomSeed:parseInt(z.target.value)||42}),className:"w-full p-2 bg-white bg-opacity-10 border border-white border-opacity-20 rounded text-white"})]})]}),c.jsx("div",{className:"mt-2",children:c.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[c.jsx("input",{type:"checkbox",checked:T.stratified,onChange:z=>$e({...T,stratified:z.target.checked}),className:"rounded"}),c.jsx("span",{className:"text-sm",children:"層化サンプリングを使用"})]})})]}),aa?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-400 mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"評価中..."})]}):c.jsx("div",{className:"text-center",children:c.jsx("button",{onClick:Xe,className:"px-8 py-4 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg text-lg transition-colors",children:"評価実行"})}),$&&c.jsxs("div",{className:"mt-6 p-6 bg-white bg-opacity-10 rounded-lg",children:[c.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"評価結果"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[Math.round($.validationScore*100),"%"]}),c.jsx("div",{className:"text-sm text-white",children:"スコア"})]}),H.map(z=>c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[Math.round(($.metrics[z]||0)*100),"%"]}),c.jsx("div",{className:"text-sm text-white",children:z})]},z))]}),c.jsxs("div",{className:"mt-4 text-sm text-white",children:[c.jsxs("div",{children:["データ分割: 学習",Math.round(T.trainRatio*100),"% / 検証",Math.round(T.validationRatio*100),"% / テスト",Math.round(T.testRatio*100),"%"]}),c.jsxs("div",{children:["ランダムシード: ",T.randomSeed]}),c.jsxs("div",{children:["層化サンプリング: ",T.stratified?"有効":"無効"]})]})]}),c.jsxs("div",{className:"mt-6 flex justify-between",children:[c.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),$&&c.jsxs("button",{onClick:fr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",c.jsx(Wt,{className:"w-5 h-5 inline ml-2"})]})]})]}),V==="submission"&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"提出"}),$?c.jsxs("div",{children:[c.jsxs("div",{className:"mb-6 p-6 bg-white bg-opacity-10 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"提出内容"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-xl font-bold text-yellow-400",children:[Math.round($.validationScore*100),"%"]}),c.jsx("div",{className:"text-sm text-white",children:"スコア"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xl font-bold text-yellow-400",children:_}),c.jsx("div",{className:"text-sm text-white",children:"モデル"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xl font-bold text-yellow-400",children:b.length}),c.jsx("div",{className:"text-sm text-white",children:"特徴量数"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xl font-bold text-yellow-400",children:f}),c.jsx("div",{className:"text-sm text-white",children:"ユーザー"})]})]})]}),c.jsx("div",{className:"text-center",children:c.jsx("button",{onClick:Ze,disabled:R,className:`px-8 py-4 rounded-lg font-bold text-lg transition-colors ${R?"bg-gray-500 cursor-not-allowed":"bg-green-500 hover:bg-green-600 text-white"}`,children:R?"提出中...":"リーダーボードに提出"})}),$&&c.jsx("div",{className:"mt-6 p-4 bg-green-500 bg-opacity-20 border border-green-500 rounded-lg",children:c.jsx("p",{className:"text-green-200 text-center",children:"提出が完了しました！"})})]}):c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-white text-lg",children:"評価を先に実行してください"})}),c.jsxs("div",{className:"mt-6 flex justify-between",children:[c.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),c.jsx("button",{onClick:s,className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-lg transition-colors",children:"完了"})]})]})]})})]})})]})}class Ai{static WEEKLY_PROBLEMS_KEY="weekly_problems";static CURRENT_WEEK_KEY="current_week_problem";static generateWeeklyProblems(){console.log("週次問題を生成中...");const e=[],r=new Date;r.setDate(r.getDate()-(r.getDay()||7)+1);const n=[{title:"現代株価予測チャレンジ",description:"過去の株価データから将来の株価を予測し、投資戦略を提案する",dataset:"modern_stock_prediction",difficulty:"easy",category:"金融分析"},{title:"感情分析マスター",description:"テキストデータから感情を分析し、ユーザーの満足度を予測する",dataset:"modern_sentiment_analysis",difficulty:"easy",category:"自然言語処理"},{title:"画像分類エキスパート",description:"画像データを分類し、物体認識の精度を競う",dataset:"modern_image_classification",difficulty:"medium",category:"コンピュータビジョン"},{title:"推薦システム最適化",description:"ユーザーの行動データから最適な推薦を提案する",dataset:"modern_recommendation",difficulty:"medium",category:"推薦システム"},{title:"不正検出システム",description:"取引データから不正なパターンを検出し、セキュリティを向上させる",dataset:"modern_fraud_detection",difficulty:"hard",category:"セキュリティ"}];for(let a=0;a<12;a++){const i=new Date(r);i.setDate(i.getDate()+a*7);const s=new Date(i);s.setDate(s.getDate()+6);const o=n[a%n.length],l={id:`weekly_${a+1}`,title:`${o.title} (第${a+1}週)`,description:o.description,dataset:o.dataset,difficulty:o.difficulty,category:o.category,startDate:i.toISOString(),endDate:s.toISOString(),isActive:a===0,publicLeaderboard:[],privateLeaderboard:[],timeLimit:10080*60};console.log(`週次問題 ${a+1} を生成:`,l),e.push(l)}return e}static getCurrentWeeklyProblem(){return this.getWeeklyProblems().find(n=>n.isActive)||null}static getWeeklyProblems(){const e=localStorage.getItem(this.WEEKLY_PROBLEMS_KEY);if(e)return JSON.parse(e);const r=this.generateWeeklyProblems();return localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(r)),r}static updateWeeklyProblems(){const e=this.getWeeklyProblems(),r=new Date;e.forEach(n=>{const a=new Date(n.startDate),i=new Date(n.endDate);n.isActive=r>=a&&r<=i}),localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e))}static async updateProblemLeaderboard(e){const r=this.getWeeklyProblems(),n=r.find(a=>a.id===e);if(n)try{const a=await Ma.getProblemLeaderboard(e,10,!1);n.publicLeaderboard=a;const i=await Ma.getProblemLeaderboard(e,10,!0);n.privateLeaderboard=i,localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(r))}catch(a){console.error("リーダーボード更新エラー:",a)}}static forceUpdateCurrentProblem(){localStorage.removeItem(this.WEEKLY_PROBLEMS_KEY),localStorage.removeItem(this.CURRENT_WEEK_KEY);const e=this.generateWeeklyProblems();return localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e)),e.length>0?(e[0].isActive=!0,localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e)),console.log("週次問題をリセット:",e[0]),e[0]):null}static updateWeeklyProblemsRealtime(){const e=this.getWeeklyProblems(),r=new Date;if(e.length===0)return this.generateWeeklyProblems(),this.getCurrentWeeklyProblem();const n=new Date("2024-01-01T00:00:00Z"),a=Math.floor((r.getTime()-n.getTime())/(10080*60*1e3)),i=a%e.length;if(e.forEach(s=>s.isActive=!1),e[i]){e[i].isActive=!0;const s=new Date(n.getTime()+a*7*24*60*60*1e3),o=new Date(s.getTime()+10080*60*1e3);return e[i].startDate=s.toISOString(),e[i].endDate=o.toISOString(),localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e)),console.log(`週次問題を自動更新: 週${a+1}`,e[i]),e[i]}return null}static isProblemActive(e){const r=this.getWeeklyProblems().find(s=>s.id===e);if(!r)return!1;const n=new Date,a=new Date(r.startDate),i=new Date(r.endDate);return n>=a&&n<=i}static getProblemTimeRemaining(e){const r=this.getWeeklyProblems().find(d=>d.id===e);if(!r)return"終了";const n=new Date,i=new Date(r.endDate).getTime()-n.getTime();if(i<=0)return"終了";const s=Math.floor(i/(1e3*60*60*24)),o=Math.floor(i%(1e3*60*60*24)/(1e3*60*60)),l=Math.floor(i%(1e3*60*60)/(1e3*60));return s>0?`${s}日${o}時間`:o>0?`${o}時間${l}分`:`${l}分`}}function XL({roomId:t,userId:e,username:r,isMultiplayer:n=!1}){const[a,i]=v.useState(!1),[s,o]=v.useState(new Map),[l,d]=v.useState([]),[u,h]=v.useState("waiting"),[f,m]=v.useState(null),[g,p]=v.useState([]);v.useEffect(()=>{console.log("useRealtimeBattle初期化:",{roomId:t,userId:e,username:r});const O=()=>{console.log("リアルタイム接続完了"),i(!0),m(null),se.joinRoom(t,r)},C=()=>{console.log("リアルタイム接続切断"),i(!1)},P=k=>{console.error("リアルタイム接続エラー:",k),m(k.message||"接続エラーが発生しました")};return se.on("connected",O),se.on("disconnected",C),se.on("error",P),se.connect(e,t),()=>{se.off("connected",O),se.off("disconnected",C),se.off("error",P),se.disconnect()}},[t,e,r]),v.useEffect(()=>{const O=C=>{o(P=>{const k=new Map(P);return k.set(C.userId,C),k})};return se.on("participant_update",O),()=>{se.off("participant_update",O)}},[]),v.useEffect(()=>{const O=C=>{d(P=>[...P,C])};return se.on("chat_message",O),()=>{se.off("chat_message",O)}},[]),v.useEffect(()=>{const O=()=>{h("active")},C=()=>{h("finished")};return se.on("battle_start",O),se.on("battle_end",C),()=>{se.off("battle_start",O),se.off("battle_end",C)}},[]);const y=v.useCallback((O,C,P=!1)=>{se.sendProgress(O,C,P)},[]),b=v.useCallback(O=>{se.sendChatMessage(O)},[]),x=v.useCallback(()=>{se.startBattle(t)},[t]),w=v.useCallback(O=>{se.endBattle(t,O)},[t]),_=v.useCallback(async(O=!1,C)=>{try{const P=await Ma.getLeaderboard(10,O,C);p(P),console.log("リーダーボード更新:",P)}catch(P){console.error("リーダーボード更新エラー:",P)}},[]);v.useEffect(()=>{_(!1,n?"team":"individual")},[_,n]);const S=v.useCallback(()=>Array.from(s.values()),[s]),j=v.useCallback(()=>s.get(e),[s,e]),N=v.useCallback(async O=>{try{console.log("ルーム参加:",O),await se.joinRoom(O,r),m(null)}catch(C){console.error("ルーム参加エラー:",C),m("ルームの参加に失敗しました")}},[r]),M=v.useCallback(async()=>{try{console.log("ルーム退出"),await se.leaveRoom(t)}catch(O){console.error("ルーム退出エラー:",O)}},[t]);return{isConnected:a,participants:S(),myProgress:j(),chatMessages:l,battleStatus:u,error:f,leaderboard:g,sendProgress:y,sendChatMessage:b,joinRoom:N,leaveRoom:M,startBattle:x,endBattle:w,updateLeaderboard:_}}function re(t,e){const r=Math.random(),n=Math.random();return Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n)*e+t}function ZL(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(1e3,Math.min(1e6,re(1e5,5e4))),a=Math.max(.01,Math.min(.5,re(.2,.1))),i=Math.max(-.3,Math.min(.3,re(0,.1))),s=Math.max(0,Math.min(100,re(50,20))),o=Math.max(-2,Math.min(2,re(0,.5))),l=Math.max(5,Math.min(50,re(20,10))),d=100,u=n/1e5*.1+(a-.2)*50+i*30+(s-50)/100*20+o*10+(20-l)/20*15+re(0,5),h=Math.max(10,d+u);e.push({features:[Math.round(n),Math.round(a*100)/100,Math.round(i*100)/100,Math.round(s),Math.round(o*100)/100,Math.round(l)],label:Math.round(h*100)/100}),t.push({features:[(n-1e3)/999e3,(a-.01)/.49,(i+.3)/.6,s/100,(o+2)/4,(l-5)/45],label:(h-10)/200})}return{data:t,raw:e,featureNames:["出来高","ボラティリティ","モメンタム","RSI","MACD","PER"],featureUnits:["株","","","","",""],problemType:"regression",description:"株価予測問題。出来高、ボラティリティ、モメンタム、RSI、MACD、PERから翌日の株価を予測します。",difficulty:"medium",targetName:"株価",targetUnit:"円"}}function QL(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(0,Math.min(60,re(30,15))),a=Math.max(20,Math.min(120,re(70,25))),i=Math.max(0,Math.min(8e3,re(3e3,2e3))),s=Math.random()<.5?0:1,o=Math.random()<.8?1:0,l=Math.random()<.3?1:0,u=(60-n)/60*.3+(a-20)/100*.2+(1-s)*.2+(1-o)*.15+(1-l)*.1+re(0,.1)>.5;e.push({features:[Math.round(n),Math.round(a),Math.round(i),s,o,l],label:u?"離脱":"継続"}),t.push({features:[n/60,(a-20)/100,i/8e3,s,o,l],label:u?1:0})}return{data:t,raw:e,featureNames:["在籍期間","月額料金","総料金","契約タイプ","インターネットサービス","テクニカルサポート"],featureUnits:["月","ドル","ドル","","",""],problemType:"classification",description:"顧客離脱予測問題。在籍期間、料金、契約タイプ、サービス利用状況から顧客の離脱を予測します。",difficulty:"medium",targetName:"離脱",targetUnit:"離脱/継続",classes:["継続","離脱"]}}function e4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(500,Math.min(5e3,re(2e3,800))),a=Math.max(1,Math.min(6,Math.round(re(3,1)))),i=Math.max(1,Math.min(4,Math.round(re(2,.5)))),s=Math.max(0,Math.min(50,re(15,10))),o=Math.max(1,Math.min(10,re(6,2))),l=Math.max(1,Math.min(10,re(7,2))),u=2e5+(n-1e3)*100+(a-2)*1e4+(i-1)*15e3+(50-s)*2e3+(o-5)*2e4+(l-5)*15e3+re(0,3e4);e.push({features:[Math.round(n),a,i,Math.round(s),Math.round(o),Math.round(l)],label:Math.round(u)}),t.push({features:[(n-500)/4500,(a-1)/5,(i-1)/3,s/50,(o-1)/9,(l-1)/9],label:(u-1e5)/5e5})}return{data:t,raw:e,featureNames:["面積","寝室数","浴室数","築年数","立地スコア","学校評価"],featureUnits:["平方フィート","室","室","年","点","点"],problemType:"regression",description:"住宅価格予測問題。面積、寝室数、浴室数、築年数、立地、学校評価から住宅価格を予測します。",difficulty:"easy",targetName:"価格",targetUnit:"ドル"}}function t4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(10,Math.min(200,re(50,30))),a=Math.max(0,Math.min(20,re(5,3))),i=Math.max(0,Math.min(20,re(3,2))),s=Math.max(0,Math.min(10,re(1,2))),o=Math.max(0,Math.min(5,re(.5,1))),l=Math.max(0,Math.min(1,re(.1,.1))),d=(a-i)/20*.4+(s-o)/10*.2+l*.2+(n-50)/150*.1+re(0,.1),u=d>.1?"positive":d<-.1?"negative":"neutral";e.push({features:[Math.round(n),Math.round(a),Math.round(i),Math.round(s),Math.round(o),Math.round(l*100)/100],label:u}),t.push({features:[(n-10)/190,a/20,i/20,s/10,o/5,l],label:u==="positive"?1:u==="negative"?0:.5})}return{data:t,raw:e,featureNames:["単語数","ポジティブ単語","ネガティブ単語","感嘆符数","疑問符数","大文字比率"],featureUnits:["語","語","語","個","個",""],problemType:"classification",description:"感情分析問題。テキストの特徴量から感情（ポジティブ/ネガティブ/ニュートラル）を予測します。",difficulty:"hard",targetName:"感情",targetUnit:"ポジティブ/ネガティブ/ニュートラル",classes:["negative","neutral","positive"]}}function r4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(0,Math.min(1e5,re(3e4,15e3))),a=Math.max(10,Math.min(100,re(50,20))),i=Math.max(10,Math.min(100,re(45,15))),s=Math.max(0,Math.min(1,re(.5,.2))),o=Math.max(0,Math.min(1,re(.6,.2))),l=Math.max(0,Math.min(1e3,re(200,100))),u=1e4+n/1e3*.5+(100-a)*50+(i-a)*20+s*5e3+o*3e3+l/10*10+re(0,2e3);e.push({features:[Math.round(n),Math.round(a),Math.round(i),Math.round(s*100)/100,Math.round(o*100)/100,Math.round(l)],label:Math.round(u)}),t.push({features:[n/1e5,(a-10)/90,(i-10)/90,s,o,l/1e3],label:(u-5e3)/2e4})}return{data:t,raw:e,featureNames:["広告予算","価格","競合価格","季節性","経済指標","SNS言及数"],featureUnits:["ドル","ドル","ドル","","","件"],problemType:"regression",description:"売上予測問題。広告予算、価格、競合価格、季節性、経済指標、SNS言及数から売上を予測します。",difficulty:"hard",targetName:"売上",targetUnit:"ドル"}}function n4(t){return[ZL,QL,e4,t4,r4].map(r=>r())}const a4=async t=>{const e=n4();switch(t){case"modern_stock_prediction":return e[0];case"modern_sentiment_analysis":return e[1];case"modern_image_classification":return e[2];case"modern_customer_churn":return e[3];case"modern_housing_price":return e[4];default:return e[0]}},i4=async t=>{try{if(Be.getProblem(t.id)){console.log("問題は既に登録されています:",t.id);return}await Be.createProblem(t.id,t.title,t.description,t.dataset.data,t.dataset.featureNames,t.dataset.targetName,t.dataset.problemType,t.dataset.classes),console.log("コンペティション問題を登録しました:",t.id)}catch(e){console.error("問題登録エラー:",e)}};function s4({onBack:t}){const[e,r]=v.useState(null),[n,a]=v.useState(!1),[i,s]=v.useState(""),[o,l]=v.useState(!0),[d,u]=v.useState(null),[h,f]=v.useState("individual"),[m,g]=v.useState(null),[p,y]=v.useState(3600),[b,x]=v.useState(!1),[w,_]=v.useState([]),[S,j]=v.useState(0),N=Ct.getCurrentUser(),{participants:M,chatMessages:O,leaderboard:C,sendChatMessage:P,joinRoom:k}=XL({roomId:i||"default",userId:N?.id||"",username:N?.username||"",isMultiplayer:!0});v.useEffect(()=>{D()},[]),v.useEffect(()=>{let R;return b&&m&&(R=setInterval(()=>{const Y=Math.floor((Date.now()-m)/1e3),$=Math.max(0,3600-Y);y($),$===0&&(x(!1),g(null))},1e3)),()=>{R&&clearInterval(R)}},[b,m]);const D=async()=>{try{l(!0),Ai.updateWeeklyProblems();const R=Ai.getCurrentWeeklyProblem();if(R){const Y=await a4(R.dataset),$={...R,dataset:Y};r($),await i4($);const qe=`weekly_${R.id}_multiplayer`;s(qe),await k(qe)}else u("利用可能な問題がありません")}catch(R){console.error("問題読み込みエラー:",R),u(`問題の読み込みに失敗しました: ${R instanceof Error?R.message:"Unknown error"}`)}finally{l(!1)}},I=()=>{!e||!N||(g(Date.now()),x(!0),y(3600),j(0),_([]),a(!0))},W=R=>{console.log("バトル完了:",R),_(Y=>[...Y,R]),j(100),x(!1),a(!1)},V=R=>{const Y=Math.floor(R/3600),$=Math.floor(R%3600/60),qe=R%60;return`${Y.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}:${qe.toString().padStart(2,"0")}`},K=()=>{a(!1),x(!1),g(null),D()};if(n&&e&&N)return c.jsx(JL,{problemId:e.id,problemTitle:e.title,problemDescription:e.description,dataset:{train:e.dataset?.data||[],test:e.dataset?.data?.slice(0,Math.floor((e.dataset?.data?.length||0)*.3))||[],featureNames:e.dataset?.featureNames||[],labelName:e.dataset?.targetName||"target",classes:e.dataset?.classes||[]},difficulty:e.difficulty,timeLimit:3600,onComplete:R=>{console.log("マルチプレイヤーバトル完了:",R),W(R)},isMultiplayer:h==="team",roomId:i,userId:N.id,username:N.username,onBack:K});if(o)return c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-yellow-400 mx-auto mb-4"}),c.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"読み込み中..."})]})})});if(d)return c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsx("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:c.jsxs("div",{className:"p-8 text-center",children:[c.jsx("h2",{className:"text-3xl font-bold text-red-900 mb-4",children:"エラーが発生しました"}),c.jsx("p",{className:"text-lg text-red-700 mb-6",children:d}),c.jsx("button",{onClick:t,className:"bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700 transition-colors",children:"ホームに戻る"})]})})})});if(!e)return c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsx("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:c.jsxs("div",{className:"p-8 text-center",children:[c.jsx("h2",{className:"text-3xl font-bold text-blue-900 mb-4",children:"今週の問題はありません"}),c.jsx("p",{className:"text-lg text-blue-700 mb-6",children:"来週の新しい問題をお待ちください。"}),c.jsx("button",{onClick:t,className:"bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors",children:"ホームに戻る"})]})})})});Ai.getProblemTimeRemaining(e.id);const X=Ai.isProblemActive(e.id),B=Array.from(M.values());return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:c.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/20 overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 p-6",children:c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("button",{onClick:t,className:"flex items-center space-x-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl",children:[c.jsx(gg,{className:"w-5 h-5"}),c.jsx("span",{children:"ホームに戻る"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:"マルチプレイヤー戦"}),c.jsx("p",{className:"text-white/80 text-lg",children:"他のプレイヤーと協力して問題を解決"})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-white/80 font-bold text-lg",children:"残り時間"}),c.jsx("div",{className:"text-white text-3xl font-mono",children:b?V(p):"00:00:00"}),b&&c.jsx("div",{className:"text-green-300 text-sm font-bold",children:"⚡ バトル進行中"})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"bg-gradient-to-br from-white/20 to-white/10 backdrop-blur-sm rounded-2xl p-8 border border-white/30 shadow-xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl shadow-lg",children:c.jsx(Xt,{className:"w-8 h-8 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:e.title}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("span",{className:"bg-blue-500/20 text-blue-200 px-4 py-2 rounded-full text-sm font-bold border border-blue-400/30",children:e.category}),c.jsx("span",{className:"bg-green-500/20 text-green-200 px-4 py-2 rounded-full text-sm font-bold border border-green-400/30",children:e.difficulty}),c.jsx("span",{className:"bg-purple-500/20 text-purple-200 px-4 py-2 rounded-full text-sm font-bold border border-purple-400/30",children:e.dataset?.problemType||"Unknown"})]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-sm text-white/70 font-medium",children:"ステータス"}),c.jsx("div",{className:`font-bold text-lg ${X?"text-green-400":"text-red-400"}`,children:X?"🟢 アクティブ":"🔴 終了"})]})]}),c.jsx("p",{className:"text-white/90 text-lg mb-6 leading-relaxed",children:e.description}),e.dataset&&c.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 mb-6 border border-white/20",children:[c.jsxs("h4",{className:"font-bold text-white text-lg mb-4 flex items-center",children:[c.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full mr-3"}),"データセット情報"]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-300",children:e.dataset.featureNames?.length||0}),c.jsx("div",{className:"text-sm text-white/70",children:"特徴量数"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-green-300",children:e.dataset.data?.length||0}),c.jsx("div",{className:"text-sm text-white/70",children:"サンプル数"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-purple-300",children:e.dataset.problemType||"Unknown"}),c.jsx("div",{className:"text-sm text-white/70",children:"問題タイプ"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-orange-300",children:e.dataset.difficulty||"Unknown"}),c.jsx("div",{className:"text-sm text-white/70",children:"難易度"})]})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center",children:[c.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full mr-3"}),"参加モードを選択"]}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("button",{onClick:()=>f("individual"),className:`px-8 py-4 rounded-xl font-bold transition-all duration-300 flex items-center space-x-3 ${h==="individual"?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg transform scale-105":"bg-white/10 text-white/70 hover:bg-white/20 hover:text-white"}`,children:[c.jsx(Ci,{className:"w-6 h-6"}),c.jsx("span",{children:"個人で参加"})]}),c.jsxs("button",{onClick:()=>f("team"),className:`px-8 py-4 rounded-xl font-bold transition-all duration-300 flex items-center space-x-3 ${h==="team"?"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg transform scale-105":"bg-white/10 text-white/70 hover:bg-white/20 hover:text-white"}`,children:[c.jsx(Ci,{className:"w-6 h-6"}),c.jsx("span",{children:"チームで参加"})]})]})]}),b&&c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsx("span",{className:"text-lg font-bold text-white",children:"進捗"}),c.jsxs("span",{className:"text-xl font-bold text-yellow-300",children:[S,"%"]})]}),c.jsx("div",{className:"w-full bg-white/20 rounded-full h-4 overflow-hidden",children:c.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 h-4 rounded-full transition-all duration-500 shadow-lg",style:{width:`${S}%`}})})]}),c.jsx("button",{onClick:I,disabled:!X||b,className:`w-full py-4 px-8 rounded-xl font-bold text-lg transition-all duration-300 ${X&&!b?"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white shadow-lg hover:shadow-xl transform hover:scale-105":"bg-gray-500/50 text-gray-300 cursor-not-allowed"}`,children:b?"⚡ バトル進行中...":X?"🚀 マルチプレイヤー戦を開始":"❌ 問題終了"})]}),w.length>0&&c.jsxs("div",{className:"bg-gradient-to-br from-green-500/20 to-emerald-500/20 backdrop-blur-sm rounded-2xl p-6 border border-green-400/30 mb-6 shadow-xl",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl shadow-lg",children:c.jsx(Zt,{className:"w-6 h-6 text-white"})}),c.jsx("h3",{className:"text-2xl font-bold text-white",children:"🏆 バトル結果"})]}),c.jsx("div",{className:"space-y-4",children:w.map((R,Y)=>c.jsxs("div",{className:"bg-white/10 backdrop-blur-sm p-4 rounded-xl border border-white/20 hover:bg-white/20 transition-all duration-300",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsxs("span",{className:"text-white font-bold text-lg",children:["提出 #",Y+1]}),c.jsxs("span",{className:"text-yellow-300 font-bold text-xl",children:[R.score?(R.score*100).toFixed(1):"N/A","%"]})]}),c.jsxs("div",{className:"text-sm text-white/80 flex space-x-4",children:[c.jsxs("span",{children:["🤖 モデル: ",R.modelType||"Unknown"]}),c.jsxs("span",{children:["⏱️ 時間: ",R.trainingTime?`${R.trainingTime}ms`:"N/A"]})]})]},Y))})]}),c.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-indigo-500/20 backdrop-blur-sm rounded-2xl p-6 border border-blue-400/30 shadow-xl",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl shadow-lg",children:c.jsx(Ci,{className:"w-6 h-6 text-white"})}),c.jsxs("h3",{className:"text-2xl font-bold text-white",children:["👥 参加者 (",B.length,"人)"]})]}),c.jsx("div",{className:"space-y-3",children:B.map(R=>c.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/10 backdrop-blur-sm rounded-xl border border-white/20 hover:bg-white/20 transition-all duration-300",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg",children:R.username.charAt(0).toUpperCase()}),c.jsx("span",{className:"font-bold text-white text-lg",children:R.username})]}),c.jsx("div",{className:"text-sm text-white/80 font-medium",children:R.isReady?"✅ 準備完了":"⏳ 準備中"})]},R.userId))})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-pink-500/20 backdrop-blur-sm rounded-2xl p-6 border border-purple-400/30 shadow-xl",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl shadow-lg",children:c.jsx(Ow,{className:"w-6 h-6 text-white"})}),c.jsx("h3",{className:"text-2xl font-bold text-white",children:"💬 チャット"})]}),c.jsx("div",{className:"h-64 overflow-y-auto border border-white/20 rounded-xl p-4 mb-4 bg-white/5 backdrop-blur-sm",children:O.length===0?c.jsx("p",{className:"text-white/60 text-center py-8",children:"まだメッセージはありません。"}):O.map((R,Y)=>c.jsxs("div",{className:"mb-3 p-3 bg-white/10 rounded-lg border border-white/20",children:[c.jsx("div",{className:"font-bold text-blue-300 text-sm",children:R.username}),c.jsx("div",{className:"text-white/90",children:R.message})]},Y))}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("input",{type:"text",placeholder:"メッセージを入力...",className:"flex-1 px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/20 transition-all duration-300",onKeyPress:R=>{if(R.key==="Enter"){const Y=R.target;Y.value.trim()&&(P(Y.value.trim()),Y.value="")}}}),c.jsx("button",{onClick:()=>{const R=document.querySelector('input[type="text"]');R.value.trim()&&(P(R.value.trim()),R.value="")},className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:c.jsx(Aw,{className:"w-5 h-5"})})]})]}),c.jsxs("div",{className:"bg-gradient-to-br from-yellow-500/20 to-orange-500/20 backdrop-blur-sm rounded-2xl p-6 border border-yellow-400/30 shadow-xl",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl shadow-lg",children:c.jsx(Zt,{className:"w-6 h-6 text-white"})}),c.jsx("h3",{className:"text-2xl font-bold text-white",children:"🏆 リーダーボード"})]}),c.jsx("div",{className:"space-y-3",children:C.length===0?c.jsx("p",{className:"text-white/60 text-center py-8",children:"まだ提出がありません。"}):C.map((R,Y)=>c.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/10 backdrop-blur-sm rounded-xl border border-white/20 hover:bg-white/20 transition-all duration-300",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg",children:R.rank}),c.jsxs("div",{children:[c.jsx("span",{className:"font-bold text-white text-lg",children:R.username}),c.jsx("div",{className:"text-sm text-white/70",children:R.modelType})]})]}),c.jsxs("span",{className:"font-bold text-yellow-300 text-xl",children:[(R.score*100).toFixed(1),"%"]})]},Y))})]})]})]})]})})})}function o4({onBack:t}){return c.jsx(s4,{onBack:t})}function l4({onBack:t}){const[e,r]=v.useState(null),[n,a]=v.useState([]),[i,s]=v.useState(null),[o,l]=v.useState(!0),[d,u]=v.useState("public");v.useEffect(()=>{h();const p=setInterval(()=>{i&&f(i)},1e4);return()=>clearInterval(p)},[i]);const h=async()=>{try{l(!0);const p=Be.getActiveProblems();a(p),p.length>0&&(s(p[0].id),await f(p[0].id))}catch(p){console.error("問題読み込みエラー:",p)}finally{l(!1)}},f=async p=>{try{const y=await _a.getLeaderboard(p,20);r(y)}catch(y){console.error("リーダーボード読み込みエラー:",y)}},m=async p=>{s(p),await f(p)},g=p=>{u(p)};return o?c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-yellow-400 mx-auto mb-4"}),c.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"読み込み中..."})]})})}):c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsxs("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:[c.jsx("div",{className:"p-6",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%)"},children:c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("button",{onClick:t,className:"flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors shadow-lg",children:[c.jsx(Zt,{className:"w-5 h-5"}),c.jsx("span",{children:"ホームに戻る"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-3xl font-bold text-yellow-300 mb-2",children:"🏆 リーダーボード"}),c.jsx("p",{className:"text-blue-200",children:"機械学習の実力を競おう"})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-yellow-300 font-bold text-lg",children:"総参加者"}),c.jsxs("div",{className:"text-white text-2xl",children:[e?.participantCount||0,"人"]})]})]})}),c.jsxs("div",{className:"p-6 border-b-2 border-blue-200",children:[c.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[c.jsx("button",{onClick:()=>g("public"),className:`px-4 py-2 rounded-lg font-bold transition-colors ${d==="public"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"📊 Public評価"}),c.jsx("button",{onClick:()=>g("private"),className:`px-4 py-2 rounded-lg font-bold transition-colors ${d==="private"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"🔍 Private評価"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-2",children:["問題を選択 (",n.length,"問)"]}),n.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:n.map(p=>c.jsxs("button",{onClick:()=>m(p.id),className:`p-3 rounded-lg border-2 text-left transition-colors ${i===p.id?"bg-blue-100 border-blue-300":"bg-white border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("div",{className:"font-bold text-blue-900",children:p.title}),c.jsx("div",{className:"text-sm text-gray-600",children:p.description}),c.jsxs("div",{className:"text-xs text-gray-500",children:["参加者: ",p.participantCount,"人 | 提出: ",p.submissionCount,"件"]})]},p.id))}):c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx("p",{children:"アクティブな問題がありません"}),c.jsx("p",{className:"text-sm",children:"新しい問題が追加されるまでお待ちください"})]})]})]}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-bold text-blue-900",children:d==="public"?"📊 Public評価リーダーボード":"🔍 Private評価リーダーボード"}),c.jsxs("button",{onClick:()=>i&&f(i),className:"flex items-center space-x-2 px-3 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg text-sm transition-colors",children:[c.jsx(vg,{className:"w-4 h-4"}),c.jsx("span",{children:"更新"})]})]}),!e||e.submissions.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Zt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),c.jsx("h3",{className:"text-xl font-bold text-gray-600 mb-2",children:"データがありません"}),c.jsx("p",{className:"text-gray-500",children:"まだ誰も参加していません。最初の参加者になりましょう！"}),c.jsxs("div",{className:"mt-4 text-sm text-gray-400",children:[c.jsx("p",{children:"• オンライン対戦で問題に挑戦すると、リーダーボードに表示されます"}),c.jsxs("p",{children:["• ",d==="public"?"検証データ":"テストデータ","でのスコアが表示されます"]})]})]}):c.jsx("div",{className:"space-y-3",children:e.submissions.map((p,y)=>c.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg border-2 ${y===0?"bg-yellow-100 border-yellow-300":y===1?"bg-gray-100 border-gray-300":y===2?"bg-orange-100 border-orange-300":"bg-white border-slate-300"}`,children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-900 w-8",children:y===0?"🥇":y===1?"🥈":y===2?"🥉":`#${y+1}`}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:p.username.charAt(0).toUpperCase()}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-blue-900 text-lg",children:p.username}),c.jsxs("div",{className:"flex items-center space-x-4 text-sm text-slate-600",children:[c.jsxs("span",{className:"flex items-center space-x-1",children:[c.jsx(Xt,{className:"w-4 h-4"}),c.jsx("span",{children:p.teamId?"チーム":"個人"})]}),p.teamId&&c.jsxs("span",{className:"flex items-center space-x-1",children:[c.jsx(Ci,{className:"w-4 h-4"}),c.jsx("span",{children:p.teamId})]}),c.jsxs("span",{className:"flex items-center space-x-1",children:[c.jsx(tn,{className:"w-4 h-4"}),c.jsx("span",{children:p.modelType})]})]})]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[((p.score||0)*100).toFixed(1),"%"]}),c.jsxs("div",{className:"text-sm text-slate-600",children:[d==="public"?"Public":"Private","スコア"]}),c.jsx("div",{className:"text-xs text-slate-500",children:new Date(p.submittedAt).toLocaleDateString()})]})]},p.id))})]})]})})})}function c4(){const{user:t,regions:e,progress:r,setCurrentView:n}=Ms(),[a,i]=v.useState(!1),[s,o]=v.useState(!1);if(!t)return null;const d=Ct.getCurrentUser()?.username||t.shogun_name||"プレイヤー",u=Object.values(r).filter(f=>f.is_completed).length,h=Object.values(r).reduce((f,m)=>f+m.stars,0);return a?c.jsx(o4,{onBack:()=>i(!1)}):s?c.jsx(l4,{onBack:()=>o(!1)}):c.jsx("div",{className:"min-h-screen p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsxs("div",{className:"rounded-lg shadow-2xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:[c.jsx("div",{className:"p-6",style:{background:"linear-gradient(to right, var(--accent-strong), var(--accent))"},children:c.jsx("h1",{className:"text-4xl font-bold text-white text-center tracking-wide",children:"samurAI - 機械学習で天下統一"})}),c.jsx("div",{className:"p-6 md:p-12",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[c.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-6 md:p-8 shadow-xl border-2",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 space-y-2 sm:space-y-0",children:[c.jsxs("h2",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:[d,"様"]}),c.jsx("span",{className:"text-lg md:text-2xl font-bold text-white px-4 py-2 rounded-full border-2 self-start sm:self-auto",style:{background:"var(--accent-strong)",borderColor:"var(--gold)"},children:t.title})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 md:gap-4 mt-6",children:[c.jsxs("div",{className:"text-center p-3 md:p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:[c.jsx("div",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:t.level}),c.jsx("div",{className:"text-xs md:text-sm mt-1",style:{color:"var(--ink-light)"},children:"レベル"})]}),c.jsxs("div",{className:"text-center p-3 md:p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:[u,"/",e.length]}),c.jsx("div",{className:"text-xs md:text-sm mt-1",style:{color:"var(--ink-light)"},children:"地域制覇"})]}),c.jsxs("div",{className:"text-center p-3 md:p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:[c.jsx("div",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:h}),c.jsx("div",{className:"text-xs md:text-sm mt-1",style:{color:"var(--ink-light)"},children:"獲得星数"})]})]}),c.jsx("div",{className:"mt-6 rounded-full h-6 border-2 overflow-hidden",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:c.jsx("div",{className:"h-full transition-all duration-500",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))",width:`${Math.min(t.total_xp%1e3/10,100)}%`}})}),c.jsxs("div",{className:"text-center text-sm mt-2",style:{color:"var(--ink-light)"},children:["経験値: ",t.total_xp," / ",Math.ceil(t.total_xp/1e3)*1e3]})]}),c.jsx("button",{onClick:()=>{console.log("日本地図ボタンがクリックされました"),n("map")},className:"w-full text-white p-8 rounded-lg shadow-xl border-4 transition-all transform hover:scale-105 group",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))",borderColor:"var(--gold)"},children:c.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[c.jsx(Ew,{className:"w-16 h-16 group-hover:rotate-12 transition-transform"}),c.jsxs("div",{className:"text-left",children:[c.jsx("div",{className:"text-3xl font-bold",children:"日本地図を開く"}),c.jsx("div",{className:"text-xl mt-2",style:{color:"var(--gold-light)"},children:"各地の課題に挑戦しよう"})]})]})})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-6 shadow-xl border-2",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(gg,{className:"w-6 h-6",style:{color:"var(--accent-strong)"}}),c.jsx("h3",{className:"text-xl font-bold",style:{color:"var(--ink)"},children:"オンライン対戦"})]}),c.jsx("p",{className:"text-sm leading-relaxed mb-4",style:{color:"var(--ink-light)"},children:"週次問題で他のプレイヤーと競い合おう！"}),c.jsx("button",{onClick:()=>i(!0),className:"w-full text-white py-3 px-4 rounded-lg font-medium transition-all transform hover:scale-105 shadow-lg",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))"},children:"⚔️ オンライン対戦"})]}),c.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-6 shadow-xl border-2",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(Zt,{className:"w-6 h-6",style:{color:"var(--accent-strong)"}}),c.jsx("h3",{className:"text-xl font-bold",style:{color:"var(--ink)"},children:"リーダーボード"})]}),c.jsx("p",{className:"text-sm leading-relaxed mb-4",style:{color:"var(--ink-light)"},children:"他のプレイヤーとスコアを競い合おう！"}),c.jsx("button",{onClick:()=>o(!0),className:"w-full text-white py-3 px-4 rounded-lg font-medium transition-all transform hover:scale-105 shadow-lg",style:{background:"linear-gradient(to right, #f59e0b, #d97706)"},children:"🏆 リーダーボードを見る"})]})]})]})})]})})})}const u4={kyoto:{x:46,y:62,name:"京都",daimyo:"足利将軍家"},sakai:{x:45,y:67,name:"堺",daimyo:"商人自治"},kai:{x:58,y:55,name:"甲斐",daimyo:"武田信玄"},echigo:{x:62,y:47,name:"越後",daimyo:"上杉謙信"},owari:{x:53,y:63,name:"尾張",daimyo:"織田信長"},satsuma:{x:20,y:85,name:"薩摩",daimyo:"島津義弘"},hizen:{x:17,y:73,name:"肥前",daimyo:"鍋島直茂"},sagami:{x:64,y:62,name:"相模",daimyo:"北条氏康"},dewa:{x:74,y:35,name:"出羽",daimyo:"最上義光"},morioka:{x:72,y:25,name:"盛岡",daimyo:"南部信直"},sendai:{x:72,y:43,name:"仙台",daimyo:"伊達政宗"},kanazawa:{x:54,y:49,name:"金沢",daimyo:"前田利家"},takamatsu:{x:38,y:68,name:"高松",daimyo:"生駒親正"},kumamoto:{x:23,y:81,name:"熊本",daimyo:"加藤清正"},yamaguchi:{x:26,y:67,name:"長門",daimyo:"毛利元就"},kaga:{x:52,y:57,name:"加賀",daimyo:"一向一揆"},tosa:{x:35,y:74,name:"土佐",daimyo:"長宗我部元親"}},d4={kyoto:{dx:-8,dy:8},sakai:{dx:-14,dy:18},kai:{dx:10,dy:10},echigo:{dx:10,dy:-2},owari:{dx:12,dy:24},sagami:{dx:18,dy:14},hizen:{dx:6,dy:8},satsuma:{dx:0,dy:6},dewa:{dx:6,dy:-4},morioka:{dx:8,dy:-6},sendai:{dx:12,dy:-2},kanazawa:{dx:-4,dy:6},takamatsu:{dx:-8,dy:12},kumamoto:{dx:4,dy:8},yamaguchi:{dx:-6,dy:4},kaga:{dx:2,dy:-2},tosa:{dx:-4,dy:10},modern_stock_prediction:{dx:-20,dy:-20},modern_sentiment_analysis:{dx:-15,dy:-15},modern_image_classification:{dx:-10,dy:-10},modern_recommendation:{dx:-5,dy:-5},modern_fraud_detection:{dx:0,dy:0}};function h4(){const{user:t,regions:e,progress:r,setCurrentView:n,setSelectedRegion:a,loading:i}=Ms(),[s,o]=v.useState(null);if(console.log("JapanMap render:",{user:!!t,regions:e.length,progress:Object.keys(r).length,loading:i}),i)return c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-yellow-400 mx-auto mb-4"}),c.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"読み込み中..."})]})})});if(!t)return c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"ユーザーが認証されていません"}),c.jsx("p",{className:"text-lg text-yellow-200 mt-4",children:"ホーム画面に戻ってユーザー認証を行ってください"})]})})});const l=f=>{const m=r[f];m&&m.is_unlocked&&(a(f),n("challenge"))},d=f=>{o(f)},u=Object.values(r).filter(f=>f.is_completed).length,h=Object.values(r).filter(f=>f.is_unlocked).length;return c.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-7xl mx-auto",children:c.jsxs("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:[c.jsxs("div",{className:"p-6",style:{background:"linear-gradient(to right, var(--accent-strong), var(--accent))"},children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("button",{onClick:()=>n("home"),className:"flex items-center space-x-2 text-yellow-100 hover:text-white transition-colors bg-white/10 px-4 py-2 rounded-lg backdrop-blur-sm",children:[c.jsx(Kr,{className:"w-5 h-5"}),c.jsx("span",{className:"font-medium",children:"ホームに戻る"})]}),c.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-yellow-100 text-center flex-1",children:"全国の課題マップ"}),c.jsx("div",{className:"w-32"})]}),c.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-8",children:[c.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg px-6 py-3 text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-white",children:[u,"/",e.length]}),c.jsx("div",{className:"text-sm text-blue-100",children:"クリア済み"})]}),c.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg px-6 py-3 text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-white",children:h}),c.jsx("div",{className:"text-sm text-blue-100",children:"挑戦可能"})]})]})]}),c.jsxs("div",{className:"p-6 md:p-12",children:[c.jsx("div",{className:"mb-8 text-center",children:c.jsx("p",{className:"text-gray-700 text-lg",children:"日本地図上のピンをクリックして、各地域の課題を確認しよう！"})}),c.jsxs("div",{className:"relative rounded-2xl border-4 border-[var(--gold)] shadow-2xl overflow-hidden mb-8",style:{background:"rgba(10,18,36,0.06)"},children:[c.jsx("div",{className:"absolute inset-0 opacity-30 pointer-events-none",style:{backgroundImage:"linear-gradient(0deg, transparent 24%, rgba(139,105,20,0.08) 25%, rgba(139,105,20,0.08) 26%, transparent 27%, transparent 74%, rgba(139,105,20,0.08) 75%, rgba(139,105,20,0.08) 76%, transparent 77%, transparent),                        linear-gradient(90deg, transparent 24%, rgba(139,105,20,0.08) 25%, rgba(139,105,20,0.08) 26%, transparent 27%, transparent 74%, rgba(139,105,20,0.08) 75%, rgba(139,105,20,0.08) 76%, transparent 77%, transparent)",backgroundSize:"50px 50px"}}),c.jsx("div",{className:"absolute inset-0 opacity-15 pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(214,193,113,0.35), transparent 60%)"}}),c.jsxs("div",{className:"relative w-full h-[900px] md:h-[1100px]",children:[c.jsx("div",{className:"absolute inset-0 z-0",children:c.jsx("img",{src:"./japan-map.png",onError:f=>{f.currentTarget.src="./japan-oldmap.png/Gemini_Generated_Image_9k83oi9k83oi9k83.png"},alt:"日本地図",className:"w-full h-full object-cover",style:{transform:"translateX(-3%) scale(1.25)",transformOrigin:"50% 42%",filter:"saturate(0.95) contrast(1.02)",pointerEvents:"none"}})}),c.jsx("div",{className:"absolute inset-0 z-30",children:e.map(f=>{const m=u4[f.id];if(!m)return null;const g=r[f.id],p=g?.is_unlocked||!1,y=g?.is_completed||!1,b=g?.stars||0,x=d4[f.id]||{dx:0,dy:0};return c.jsxs("div",{className:"absolute group cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full",style:{left:`${m.x}%`,top:`${m.y}%`,transform:`translate(-50%, -50%) translate(${x.dx}px, ${x.dy}px)`},onClick:()=>d(f.id),role:"button",tabIndex:0,"aria-label":`${m.name} - ${y?"クリア済み":p?"挑戦可能":"ロック中"}`,onKeyDown:w=>{(w.key==="Enter"||w.key===" ")&&d(f.id)},children:[c.jsx("div",{className:"absolute w-3 h-3 bg-black/30 rounded-full blur-sm translate-x-1 translate-y-1"}),c.jsxs("div",{className:`relative w-8 h-8 rounded-full border-2 shadow-lg transition-all duration-300 group-hover:scale-110 group-hover:shadow-xl ${y?"bg-gradient-to-br from-[#5fbad1] via-[#6ad6e2] to-[#7fe0da] border-[#e7f0f3]":p?"bg-gradient-to-br from-[#3a8fb7] via-[#4fa3c3] to-[#6bb7d1] border-[#e7f0f3]":"bg-gradient-to-br from-[#9aa7b1] via-[#8d99a6] to-[#7c8794] border-[#e7f0f3]"} border-white/60`,children:[c.jsx("div",{className:"absolute inset-0.5 rounded-full bg-white/20"}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:y?c.jsx(pg,{className:"w-4 h-4 text-white drop-shadow-lg"}):p?c.jsx(Oh,{className:"w-4 h-4 text-white drop-shadow-lg"}):c.jsx(Cw,{className:"w-4 h-4 text-white drop-shadow-lg"})}),y&&b>0&&c.jsx("div",{className:"absolute -top-2 -right-2 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-full w-4 h-4 flex items-center justify-center shadow-lg border border-white",children:c.jsx("span",{className:"text-white text-[8px] font-bold",children:b})}),p&&!y&&c.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-400 animate-ping opacity-40"}),c.jsx("div",{className:"absolute inset-0 rounded-full bg-white/30 animate-pulse"})]}),c.jsx("div",{className:`absolute top-7 left-1/2 -translate-x-1/2 whitespace-nowrap px-2 py-0.5 rounded-full text-[11px] font-medium transition-all duration-300 group-hover:scale-105 shadow-md border ${p?"bg-gradient-to-r from-[#2e6f9e] to-[#3e8bb9] text-white border-[#cfe3ec]":"bg-gradient-to-r from-gray-500 to-gray-600 text-white border-gray-300"}`,children:m.name}),c.jsx("div",{className:`hidden sm:block absolute top-12 left-1/2 -translate-x-1/2 whitespace-nowrap px-1.5 py-0.5 rounded-full text-[9px] font-medium transition-all duration-300 group-hover:scale-105 shadow-sm border ${p?"bg-gradient-to-r from-[#e6f2f7] to-[#d9eef6] text-[#0a192f] border-[#cfe3ec]":"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-600 border-gray-200"}`,children:m.daimyo})]},f.id)})}),c.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-sm rounded-xl px-4 py-3 text-sm text-gray-700 shadow-lg border border-white/50",children:[c.jsx("div",{className:"font-bold text-gray-800 mb-2 text-center",children:"凡例"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-400 to-cyan-500 rounded-full shadow-sm border border-blue-300"}),c.jsx("span",{className:"text-xs",children:"挑戦可能"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full shadow-sm border border-green-300"}),c.jsx("span",{className:"text-xs",children:"クリア済み"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-gray-400 to-gray-500 rounded-full shadow-sm border border-gray-300"}),c.jsx("span",{className:"text-xs",children:"ロック中"})]})]})]})]})]}),s&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsx("div",{className:"bg-white rounded-2xl border-2 shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",style:{borderColor:"var(--gold)"},children:c.jsx("div",{className:"p-6",children:(()=>{const f=e.find(x=>x.id===s),m=r[s],g=m?.is_unlocked||!1,p=m?.is_completed||!1,y=m?.stars||0,b=m?.best_accuracy||0;return f?c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:`p-3 rounded-xl ${g?"bg-blue-100":"bg-gray-200"}`,children:c.jsx(Oh,{className:`w-8 h-8 ${g?"text-blue-600":"text-gray-500"}`})}),c.jsxs("div",{children:[c.jsx("h3",{className:`text-2xl font-bold ${g?"text-gray-900":"text-gray-600"}`,children:f.name}),c.jsx("p",{className:`text-lg ${g?"text-blue-600":"text-gray-500"}`,children:f.daimyo})]})]}),c.jsx("button",{onClick:()=>o(null),className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:`p-4 rounded-xl ${g?"bg-blue-50 border border-blue-200":"bg-gray-100 border border-gray-200"}`,children:[c.jsx("div",{className:"text-sm font-medium mb-2 text-gray-600",children:"地域の説明"}),c.jsx("p",{className:`text-base leading-relaxed ${g?"text-gray-700":"text-gray-500"}`,children:f.description})]}),c.jsxs("div",{className:`p-4 rounded-xl ${g?"bg-yellow-50 border border-yellow-200":"bg-gray-100 border border-gray-200"}`,children:[c.jsx("div",{className:"text-sm font-medium mb-2 text-gray-600",children:"課題の内容"}),c.jsx("p",{className:`text-base ${g?"text-gray-800":"text-gray-500"}`,children:f.problem_description})]}),c.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-600",children:"難易度:"}),c.jsx("div",{className:"flex space-x-1",children:[...Array(5)].map((x,w)=>c.jsx("div",{className:`w-3 h-5 rounded-sm ${w<f.difficulty?g?"bg-orange-400":"bg-gray-400":"bg-gray-200"}`},w))})]}),p&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Tw,{className:"w-5 h-5 text-yellow-500"}),c.jsxs("span",{className:"text-lg font-bold text-gray-700",children:[(b*100).toFixed(0),"%"]}),c.jsx("div",{className:"flex space-x-1",children:[...Array(3)].map((x,w)=>c.jsx("span",{className:`text-xl ${w<y?"text-yellow-400":"text-gray-300"}`,children:"★"},w))})]})]}),g?c.jsx("button",{onClick:()=>{l(f.id),o(null)},className:`w-full py-4 rounded-xl font-bold text-lg transition-all ${p?"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white":"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white shadow-md hover:shadow-lg"}`,children:p?"再挑戦する":"挑戦する"}):c.jsx("div",{className:"bg-gray-200 text-gray-500 py-4 rounded-xl text-center font-medium text-lg",children:"前の課題をクリアしよう"})]})]}):null})()})})}),c.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-6 border-2 border-blue-200",children:c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx("div",{className:"bg-blue-500 text-white rounded-full p-3",children:c.jsx(yg,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"進め方のヒント"}),c.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"1."}),c.jsx("span",{children:"地図上のピンをクリックして地域の詳細を確認しよう"})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"2."}),c.jsx("span",{children:"最初は簡単な課題から始めよう"})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"3."}),c.jsx("span",{children:"データをよく観察して、特徴を見つけよう"})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"4."}),c.jsx("span",{children:"いろいろなモデルを試して、比べてみよう"})]})]})]})]})})]})]})})})}function je(t){const e=[...t];for(let r=e.length-1;r>0;r--){const n=Math.floor(Math.random()*(r+1));[e[r],e[n]]=[e[n],e[r]]}return e}function E(t,e){const r=Math.random(),n=Math.random();return Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n)*e+t}function hg(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(1200,Math.min(1600,E(1400,100))),s=Math.max(1,Math.min(10,E(6,2))),o=Math.max(1,Math.min(10,E(6,2))),l=Math.max(1,Math.min(10,E(6,2))),u=s/10*.4+o/10*.3+l/10*.2+(1600-i)/400*.1+E(0,.1)>.5;e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l)],label:u?1:0}),t.push({features:[Math.min(1,(i-1200)/400),s/10,o/10,l/10],label:u?1:0})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["年代","職人技","材質","古色"],classes:["贋作","本物"],labelName:"真贋",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["年代","職人技","材質","古色"],featureUnits:["年","点","点","点"]}}}function f4(){const t=[],e=[],r=["中国","南蛮","朝鮮","日本"];for(let i=0;i<300;i++){const s=Math.floor(Math.random()*4);let o,l,d,u;switch(s){case 0:o=Math.min(10,Math.max(1,E(8,1))),l=Math.min(10,Math.max(1,E(8,1))),d=Math.min(10,Math.max(1,E(7,1))),u=Math.min(500,Math.max(50,E(300,50)));break;case 1:o=Math.min(10,Math.max(1,E(6,1))),l=Math.min(10,Math.max(1,E(3,1))),d=Math.min(10,Math.max(1,E(5,1))),u=Math.min(500,Math.max(50,E(400,50)));break;case 2:o=Math.min(10,Math.max(1,E(7,1))),l=Math.min(10,Math.max(1,E(6,1))),d=Math.min(10,Math.max(1,E(8,1))),u=Math.min(500,Math.max(50,E(200,50)));break;case 3:default:o=Math.min(10,Math.max(1,E(6,1))),l=Math.min(10,Math.max(1,E(7,1))),d=Math.min(10,Math.max(1,E(6,1))),u=Math.min(500,Math.max(50,E(250,50)));break}e.push({features:[Math.round(o),Math.round(l),Math.round(d),Math.round(u)],label:r[s]}),t.push({features:[o/10,l/10,d/10,u/500],label:s})}const n=je(t),a=Math.floor(t.length*.7);return{train:n.slice(0,a),test:n.slice(a),featureNames:["材質","装飾","職人技","価格"],classes:r,labelName:"産地",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["材質","装飾","職人技","価格"],featureUnits:["点","点","点","文"]}}}function m4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(5,Math.min(100,E(50,20))),s=Math.max(1,Math.min(15,E(8,3))),o=Math.max(-5,Math.min(30,E(15,8))),l=Math.max(0,Math.min(300,E(100,40))),d=Math.max(1,Math.min(8,E(5,2))),u=Math.max(1,Math.min(8,E(5,2))),f=i/100*.3+s/15*.25+d/8*.2+u/8*.15+(1-Math.abs(o-15)/25)*.05+(1-l/300)*.05+E(0,.1)>.5;e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l),Math.round(d),Math.round(u)],label:f?"成功":"失敗"}),t.push({features:[i/100,s/15,(o+5)/35,l/300,d/8,u/8],label:f?1:0})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["労働者数","経験値","気温","降水量","機具の質","鉱石の品質"],classes:[],labelName:"産出量",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["労働者数","経験値","気温","降水量","機具の質","鉱石の品質"],featureUnits:["人","年","℃","mm","点","点"]}}}function p4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(10,Math.min(30,E(20,5))),s=Math.max(50,Math.min(300,E(150,50))),o=Math.max(100,Math.min(300,E(200,50))),l=Math.max(1,Math.min(10,E(5,2))),d=Math.max(1,Math.min(10,E(5,2))),u=Math.max(0,Math.min(50,E(25,15))),h=100,f=(i-10)/20,m=(s-50)/250,g=(o-100)/200,p=(l-1)/9,y=(d-1)/9,b=u/50,x=h+f*30+m*40+g*35+p*25+y*20+b*15+(Math.random()-.5)*20;a<5&&console.log(`上杉謙信問題 サンプル ${a+1}:`,{temperature:i,rainfall:s,sunshine:o,soilQuality:l,seedQuality:d,fertilizer:u,harvestYield:x,normalizedLabel:x/200}),e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l),Math.round(d),Math.round(u)],label:Math.round(x*10)/10}),t.push({features:[(i-10)/20,(s-50)/250,(o-100)/200,(l-1)/9,(d-1)/9,u/50],label:x/200}),a<5&&console.log(`正規化後 サンプル ${a+1}:`,{features:[(i-10)/20,(s-50)/250,(o-100)/200,(l-1)/9,(d-1)/9,u/50],label:x/200})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["気温","降水量","日照時間","土壌の質","種子の質","肥料の量"],classes:[],labelName:"収穫量",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["気温","降水量","日照時間","土壌の質","種子の質","肥料の量"],featureUnits:["℃","mm","時間","点","点","kg"]}}}function g4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(16,Math.min(50,E(25,8))),s=Math.max(1,Math.min(10,E(6,2))),o=Math.max(1,Math.min(10,E(5,2))),l=Math.max(1,Math.min(10,E(5,2))),d=Math.max(0,Math.min(20,E(3,4))),u=Math.max(1,Math.min(5,E(3,1))),h=i<20?1.1:i>40?.9:1,f=Math.min(10,Math.max(1,s*h)),m=Math.min(10,Math.max(1,o*h)),g=(f+m)/20,p=l/10,y=d/20,b=u/5,w=(g*.35+p*.25+y*.25+b*.15)*100+E(0,10);e.push({features:[Math.round(i),Math.round(f),Math.round(m),Math.round(l),Math.round(d),Math.round(u)],label:Math.round(w*10)/10}),t.push({features:[(i-16)/34,(f-1)/9,(m-1)/9,(l-1)/9,d/20,(u-1)/4],label:w/100})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["年齢","筋力","敏捷性","知力","戦闘経験","社会階級"],classes:["槍兵","弓兵","鉄砲隊","騎馬隊"],labelName:"役職",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["年齢","筋力","敏捷性","知力","戦闘経験","社会階級"],featureUnits:["歳","点","点","点","年","段階"]}}}function v4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(0,Math.min(20,E(8,4))),s=Math.max(0,Math.min(5,E(2,1))),o=Math.max(5,Math.min(50,E(20,10))),l=Math.max(1,Math.min(10,E(6,2))),d=Math.max(1,Math.min(8,E(5,2))),u=Math.max(1,Math.min(5,E(3,1))),h=i>15?.7:i<3?.8:1,f=s>3?.6:s<1?.9:1,m=Math.log(o)/Math.log(50),g=l/10,p=d/8,y=u<=2?1:u===3?.8:u===4?.6:.4,x=h*f*m*g*p*y>.5;e.push({features:[Math.round(i*10)/10,Math.round(s*10)/10,Math.round(o),Math.round(l),Math.round(d),Math.round(u)],label:x?1:0}),t.push({features:[i/20,s/5,o/50,l/10,d/8,u/5],label:x?1:0})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["風速","波高","船数","乗組員経験","武器の質","天候"],classes:["敗北","勝利"],labelName:"戦果",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["風速","波高","船数","乗組員経験","武器の質","天候"],featureUnits:["m/s","m","隻","点","点","段階"]}}}function y4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(0,E(.6,.2))),s=Math.min(1,Math.max(0,E(.7,.15))),o=Math.max(800,Math.min(1400,E(1200,100))),l=Math.min(1,Math.max(0,E(.65,.2))),d=Math.min(1,Math.max(0,E(.5,.25))),u=Math.min(1,Math.max(0,E(.6,.2))),h=(i+s)/2,f=(l+d)/2,m=Math.exp(-Math.pow(o-1200,2)/2e4),g=h*.3+f*.3+m*.2+u*.2;let p=0;g>.8?p=2:g>.6&&(p=1);const y=["下級","中級","上級"];e.push({features:[Math.round(i*10)/10,Math.round(s*10)/10,Math.round(o),Math.round(l*10)/10,Math.round(d*10)/10,Math.round(u*10)/10],label:y[p]}),t.push({features:[i,s,o/1500,l,d,u],label:p})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["粘土の品質","釉薬の品質","焼成温度","陶工の技能","装飾の美しさ","厚さの均一性"],classes:["下級","中級","上級"],labelName:"等級",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["粘土の品質","釉薬の品質","焼成温度","陶工の技能","装飾の美しさ","厚さの均一性"],featureUnits:["","","℃","","",""]}}}function b4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(1e3,Math.min(1e4,E(5e3,2e3))),s=Math.min(1,Math.max(0,E(.6,.2))),o=Math.min(1,Math.max(0,E(.7,.15))),l=Math.min(1,Math.max(0,E(.5,.25))),d=Math.min(1,Math.max(0,E(.6,.2))),u=Math.min(1,Math.max(0,E(.6,.2))),h=(s+o+l+d+u)/5,f=Math.log(i/1e3)/10,m=s*o*.1,g=Math.min(1,Math.max(0,h+f+m));let p=0;g>.75?p=2:g>.5&&(p=1);const y=["低い","中程度","高い"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*10)/10,Math.round(u*10)/10],label:y[p]}),t.push({features:[i/1e4,s,o,l,d,u],label:p})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["人口","商業の発達度","農業の発達度","統治の質","政治安定性","立地の良さ"],classes:["低い","中程度","高い"],labelName:"繁栄度",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["人口","商業の発達度","農業の発達度","統治の質","政治安定性","立地の良さ"],featureUnits:["人","","","","",""]}}}function x4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(10,Math.min(100,E(50,20))),s=Math.max(100,Math.min(500,E(300,100))),o=Math.min(1,Math.max(0,E(.6,.2))),l=Math.min(1,Math.max(0,E(.5,.25))),d=Math.min(1,Math.max(0,E(.6,.2))),u=Math.random(),h=Math.exp(-i/50),f=Math.exp(-s/1e3),m=o,g=Math.pow(l,1.5),p=1-Math.abs(u-.5)*.3,y=h*f*m*g*p*d;e.push({features:[Math.round(i),Math.round(s),Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*10)/10,Math.round(u*100)/100],label:Math.round(y*1e3)/1e3}),t.push({features:[i/100,s/1e3,o,l,d,u],label:y})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["距離","標高","天候の良さ","道路の質","荷物の価値","季節"],classes:[],labelName:"輸送効率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["距離","標高","天候の良さ","道路の質","荷物の価値","季節"],featureUnits:["km","m","","","",""]}}}function w4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(0,E(.6,.2))),s=Math.max(3,Math.min(15,E(8,3))),o=Math.min(1,Math.max(0,E(.7,.15))),l=Math.min(1,Math.max(0,E(.6,.2))),d=Math.random(),u=Math.max(0,Math.min(5,E(2,1))),h=Math.pow(i,1.2),f=Math.exp(-Math.pow(s-8,2)/20),m=o,g=Math.pow(l,.8),p=1-Math.abs(d-.5)*.4,y=Math.exp(-u/3),b=h*f*m*g*p*y*(.7+Math.random()*.6);e.push({features:[Math.round(i*10)/10,Math.round(s),Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*100)/100,Math.round(u)],label:Math.round(b*1e3)/1e3}),t.push({features:[i,s/15,o,l,d,u/5],label:b})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["血統スコア","年齢","健康状態","飼育環境","季節","交配回数"],classes:[],labelName:"繁殖成功率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["血統スコア","年齢","健康状態","飼育環境","季節","交配回数"],featureUnits:["","年","","","","回"]}}}function _4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(5,Math.min(35,E(20,8))),s=Math.max(0,Math.min(400,E(150,50))),o=Math.max(50,Math.min(300,E(200,40))),l=Math.min(1,Math.max(0,E(.6,.2))),d=Math.min(1,Math.max(0,E(.5,.25))),u=Math.random(),h=Math.exp(-Math.pow(i-22,2)/100),f=Math.exp(-Math.pow(s-150,2)/5e3),m=Math.min(1,o/200),g=Math.pow(l*d,.7),p=1-Math.abs(u-.3)*.5,y=h*f*m*g*p*(.6+Math.random()*.8);e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l*10)/10,Math.round(d*10)/10,Math.round(u*100)/100],label:Math.round(y*1e3)/1e3}),t.push({features:[i/35,s/400,o/300,l,d,u],label:y})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["気温","降水量","日照時間","土壌水分","肥料量","植え付け時期"],classes:[],labelName:"収穫量",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["気温","降水量","日照時間","土壌水分","肥料量","植え付け時期"],featureUnits:["℃","mm","時間","","",""]}}}function j4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(.8,E(.95,.05))),s=Math.max(800,Math.min(1200,E(1e3,100))),o=Math.min(1,Math.max(0,E(.4,.2))),l=Math.max(50,Math.min(200,E(120,30))),d=Math.min(1,Math.max(0,E(.7,.2))),u=Math.max(2,Math.min(12,E(6,2))),h=Math.pow(i,2),f=Math.exp(-Math.pow(s-1e3,2)/2e4),m=Math.exp(-Math.pow(o-.4,2)/.2),g=Math.exp(-Math.pow(l-120,2)/2e3),p=Math.pow(d,1.5),y=Math.exp(-Math.pow(u-6,2)/8),b=h*f*m*g*p*y;let x=0;b>.8?x=3:b>.6?x=2:b>.4&&(x=1);const w=["下級","中級","上級","最高級"];e.push({features:[Math.round(i*1e3)/1e3,Math.round(s),Math.round(o*10)/10,Math.round(l),Math.round(d*10)/10,Math.round(u)],label:w[x]}),t.push({features:[i,s/1200,o,l/200,d,u/12],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["金の純度","温度","湿度","圧延回数","職人経験","作業時間"],classes:["下級","中級","上級","最高級"],labelName:"品質等級",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["金の純度","温度","湿度","圧延回数","職人経験","作業時間"],featureUnits:["","℃","","回","","時間"]}}}function S4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(0,Math.min(30,E(10,5))),s=Math.max(0,Math.min(5,E(1.5,.8))),o=Math.max(0,Math.min(5,E(2,1))),l=Math.min(1,Math.max(0,E(.5,.3))),d=Math.max(980,Math.min(1030,E(1013,15))),u=Math.random(),h=Math.exp(-i/15),f=Math.exp(-s/2),m=Math.exp(-o/3),g=1-l*.3,p=Math.exp(-Math.pow(d-1013,2)/200),y=1-Math.abs(u-.5)*.4,b=h*f*m*g*p*y;let x=0;b>.7?x=2:b>.4&&(x=1);const w=["危険","注意","安全"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d),Math.round(u*100)/100],label:w[x]}),t.push({features:[i/30,s/5,o/5,l,d/1030,u],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["風速","波高","海流速度","雲量","気圧","潮汐"],classes:["危険","注意","安全"],labelName:"安全性",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["風速","波高","海流速度","雲量","気圧","潮汐"],featureUnits:["m/s","m","m/s","","hPa",""]}}}function N4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(0,E(.6,.2))),s=Math.max(.1,Math.min(2,E(.8,.3))),o=Math.min(1,Math.max(0,E(.7,.15))),l=Math.min(1,Math.max(0,E(.4,.2))),d=Math.max(60,Math.min(90,E(75,8))),u=Math.max(.5,Math.min(3,E(1.5,.5))),h=Math.pow(i,1.5),f=Math.exp(-Math.pow(s-.8,2)/.2),m=Math.pow(o,1.2),g=Math.exp(-Math.pow(l-.4,2)/.1),p=Math.exp(-Math.pow(d-75,2)/50),y=Math.pow(u,.8),b=h*f*m*g*p*y*(.6+Math.random()*.8);e.push({features:[Math.round(i*10)/10,Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d),Math.round(u*10)/10],label:Math.round(b*1e3)/1e3}),t.push({features:[i,s/2,o,l,d/90,u/3],label:b})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["石の硬さ","石の大きさ","積み方","モルタル量","角度","基礎の深さ"],classes:[],labelName:"強度",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["石の硬さ","石の大きさ","積み方","モルタル量","角度","基礎の深さ"],featureUnits:["","m","","","度","m"]}}}function P4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(0,Math.min(30,E(10,5))),s=Math.max(0,Math.min(5,E(1.5,.8))),o=Math.max(5,Math.min(50,E(20,10))),l=Math.max(50,Math.min(500,E(200,100))),d=Math.max(1,Math.min(20,E(8,4))),u=Math.random(),h=Math.exp(-i/15),f=Math.exp(-s/2),m=Math.log(o)/10,g=Math.log(l)/20,p=Math.exp(-d/10),y=1-Math.abs(u-.5)*.3,b=h*f*m*g*p*y*(.5+Math.random()*.5);let x=0;b>.7?x=2:b>.4&&(x=1);const w=["敗北","引き分け","勝利"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o),Math.round(l),Math.round(d),Math.round(u*24)],label:w[x]}),t.push({features:[i/30,s/5,o/50,l/500,d/20,u],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["風速","波高","船数","兵数","距離","時間"],classes:["敗北","引き分け","勝利"],labelName:"戦果",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["風速","波高","船数","兵数","距離","時間"],featureUnits:["m/s","m","隻","人","km","時"]}}}function k4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(10,Math.min(200,E(80,30))),s=Math.min(1,Math.max(0,E(.6,.2))),o=Math.min(1,Math.max(0,E(.4,.25))),l=Math.min(1,Math.max(0,E(.3,.2))),d=Math.min(1,Math.max(0,E(.5,.25))),u=Math.random(),h=Math.log(i)/10,f=Math.pow(s,.8),m=Math.exp(-o/2),g=Math.exp(-l/3),p=Math.pow(d,1.2),y=1-Math.abs(u-.5)*.4,b=h*f*m*g*p*y*(.3+Math.random()*.7),x=Math.max(0,Math.round(b*100));e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*10)/10,Math.round(u*100)/100],label:x}),t.push({features:[i/200,s,o,l,d,u],label:b})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["人口密度","経済状況","教育レベル","既存宗教","交通便","季節"],classes:[],labelName:"信者獲得数",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["人口密度","経済状況","教育レベル","既存宗教","交通便","季節"],featureUnits:["人/km²","","","","",""]}}}function M4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(100,Math.min(2e3,E(800,300))),s=Math.min(1,Math.max(0,E(.6,.2))),o=Math.min(1,Math.max(0,E(.5,.25))),l=Math.min(1,Math.max(0,E(.6,.2))),d=Math.max(50,Math.min(1500,E(600,250))),u=Math.min(1,Math.max(0,E(.7,.15))),h=Math.log(i)/15,f=Math.pow(s,1.3),m=Math.pow(o,.9),g=l,p=Math.exp(-d/1e3),y=Math.pow(u,1.1),b=h*f*m*g*p*y*(.4+Math.random()*.6);let x=0;b>.8?x=2:b>.5&&(x=1);const w=["失敗","部分成功","完全成功"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d),Math.round(u*10)/10],label:w[x]}),t.push({features:[i/2e3,s,o,l,d/1500,u],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["兵力","装備","地形","天候","敵兵力","補給"],classes:["失敗","部分成功","完全成功"],labelName:"戦略結果",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["兵力","装備","地形","天候","敵兵力","補給"],featureUnits:["人","","","","人",""]}}}function O4(t){switch(t){case"kyoto":return hg();case"sakai":return f4();case"kai":return m4();case"echigo":return p4();case"owari":return g4();case"satsuma":return v4();case"hizen":return y4();case"sagami":return b4();case"dewa":return x4();case"morioka":return w4();case"sendai":return _4();case"kanazawa":return j4();case"takamatsu":return S4();case"kumamoto":return N4();case"yamaguchi":return P4();case"kaga":return k4();case"tosa":return M4();case"modern_stock_prediction":return A4();case"modern_sentiment_analysis":return E4();case"modern_image_classification":return C4();case"modern_recommendation":return T4();case"modern_fraud_detection":return I4();default:return hg()}}function A4(){const t=[],e=[];for(let a=0;a<1e3;a++){const i=Math.max(100,Math.min(1e3,E(500,150))),s=Math.max(1e3,Math.min(1e6,E(1e5,5e4))),o=Math.max(1e6,Math.min(1e9,E(1e7,5e6))),l=Math.max(5,Math.min(50,E(20,8))),d=Math.min(1,Math.max(0,E(.3,.2))),u=E(.05,.15),h=Math.min(.5,Math.max(-.2,E(.1,.1))),f=E(0,.05)+u*.3+h*.2;e.push({features:[Math.round(i*100)/100,Math.round(s),Math.round(o),Math.round(l*10)/10,Math.round(d*100)/100,Math.round(u*1e3)/1e3,Math.round(h*1e3)/1e3],label:Math.round(f*1e4)/1e4}),t.push({features:[i/1e3,s/1e6,o/1e9,l/50,d,u,h],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["始値","出来高","時価総額","PER","負債比率","売上成長率","利益率"],labelName:"株価変化率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["始値","出来高","時価総額","PER","負債比率","売上成長率","利益率"],featureUnits:["円","株","円","","","",""]}}}function E4(){const t=[],e=[];for(let a=0;a<2e3;a++){const i=Math.max(5,Math.min(100,E(30,15))),s=Math.min(i,Math.floor(Math.random()*5)),o=Math.min(i-s,Math.floor(Math.random()*5)),l=i-s-o,d=Math.floor(Math.random()*3),u=Math.floor(Math.random()*2),h=Math.min(1,Math.random()*.3);let f=0;s>o&&s>l?f=2:l>s&&l>o&&(f=1);const m=["ネガティブ","ニュートラル","ポジティブ"];e.push({features:[i,s,o,l,d,u,Math.round(h*100)/100],label:m[f]}),t.push({features:[i/100,s/i,o/i,l/i,d/i,u/i,h],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["単語数","ポジティブ単語比率","ネガティブ単語比率","ニュートラル単語比率","感嘆符比率","疑問符比率","大文字比率"],classes:["ネガティブ","ニュートラル","ポジティブ"],labelName:"感情",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["単語数","ポジティブ単語比率","ネガティブ単語比率","ニュートラル単語比率","感嘆符比率","疑問符比率","大文字比率"],featureUnits:["語","","","","","",""]}}}function C4(){const t=[],e=[],r=["猫","犬","車","飛行機","建物","花","食べ物","人物"];for(let i=0;i<1500;i++){const s=Math.min(1,Math.max(0,E(.5,.2))),o=Math.min(1,Math.max(0,E(.5,.2))),l=Math.min(1,Math.max(0,E(.6,.3))),d=Math.min(1,Math.max(0,E(.4,.2))),u=Math.min(1,Math.max(0,E(.5,.3))),h=Math.min(1,Math.max(0,E(.6,.3))),f=Math.max(.5,Math.min(2,E(1,.3)));let m=0;s>.7&&l>.6?m=6:d>.6&&u>.5?m=0:h>.7&&f>1.5?m=2:s<.4&&d>.5?m=4:m=Math.floor(Math.random()*r.length),e.push({features:[Math.round(s*100)/100,Math.round(o*100)/100,Math.round(l*100)/100,Math.round(d*100)/100,Math.round(u*100)/100,Math.round(h*100)/100,Math.round(f*100)/100],label:r[m]}),t.push({features:[s,o,l,d,u,h,f],label:m})}const n=je(t),a=Math.floor(t.length*.7);return{train:n.slice(0,a),test:n.slice(a),featureNames:["明度","コントラスト","色彩豊かさ","エッジ密度","テクスチャ複雑さ","対称性","アスペクト比"],classes:r,labelName:"画像タイプ",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["明度","コントラスト","色彩豊かさ","エッジ密度","テクスチャ複雑さ","対称性","アスペクト比"],featureUnits:["","","","","","",""]}}}function T4(){const t=[],e=[];for(let a=0;a<3e3;a++){const i=Math.max(18,Math.min(80,E(35,15))),s=Math.max(200,Math.min(1e3,E(500,200))),o=Math.min(1,Math.max(0,E(.6,.3))),l=Math.max(10,Math.min(1e3,E(200,150))),d=Math.min(5,Math.max(1,E(3.5,1))),u=Math.floor(Math.random()*10),h=Math.min(1,Math.max(0,E(.5,.3))),f=Math.min(1,Math.max(0,o*.3+d/5*.2+h*.2+s/1e3*.1+l/1e3*-.1+E(0,.1)));e.push({features:[i,Math.round(s),Math.round(o*100)/100,Math.round(l),Math.round(d*10)/10,u,Math.round(h*100)/100],label:Math.round(f*1e3)/1e3}),t.push({features:[i/80,s/1e3,o,l/1e3,d/5,u/10,h],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["ユーザー年齢","ユーザー収入","ユーザー活動度","アイテム価格","アイテム評価","アイテムカテゴリ","アイテム人気度"],labelName:"購入確率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["ユーザー年齢","ユーザー収入","ユーザー活動度","アイテム価格","アイテム評価","アイテムカテゴリ","アイテム人気度"],featureUnits:["歳","万円","","円","","",""]}}}function I4(){const t=[],e=[];for(let a=0;a<5e3;a++){const i=Math.max(1,Math.min(1e5,E(5e3,3e3))),s=Math.floor(Math.random()*24),o=Math.floor(Math.random()*7),l=Math.floor(Math.random()*100),d=Math.floor(Math.random()*20),u=Math.min(1,Math.max(0,E(.7,.3))),h=Math.floor(Math.random()*5),f=Math.random()<.02?1:0;let m=i,g=s,p=l;f===1&&(m=Math.max(5e4,i*2),g=Math.random()<.5?2:3,p=Math.floor(Math.random()*10)),e.push({features:[Math.round(m),g,o,p,d,Math.round(u*100)/100,h],label:f===1?"不正":"正常"}),t.push({features:[m/1e5,g/24,o/7,p/100,d/20,u,h/5],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["取引金額","時間","曜日","地域","店舗タイプ","ユーザー履歴","デバイスタイプ"],classes:["正常","不正"],labelName:"不正検出",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["取引金額","時間","曜日","地域","店舗タイプ","ユーザー履歴","デバイスタイプ"],featureUnits:["円","時","","","","",""]}}}class D4{static detectOverfitting(e,r,n=.1){const a=e-r;return a>.2?{isOverfitting:!0,severity:"high",message:"⚠️ 過学習が発生しています。モデルが複雑すぎる可能性があります。",suggestions:["モデルを簡素化してください","正則化を試してください","より多くのデータを集めてください","特徴量の数を減らしてください"]}:a>.1?{isOverfitting:!0,severity:"medium",message:"⚠️ 過学習の可能性があります。注意深く監視してください。",suggestions:["交差検証を実施してください","モデルの複雑さを確認してください","テストデータでの性能を監視してください"]}:{isOverfitting:!1,severity:"low",message:"✅ 適切な学習状態です。",suggestions:["現在のモデルは適切です"]}}}const dc=[{id:"logistic_regression",name:"ロジスティック回帰",description:"Yes/Noの判断に強いAI",category:"classification",difficulty:"簡単",detailedDescription:"データを2つのグループに分ける直線を引くAI。境界線を学習して、新しいデータがどちらのグループに属するかを判断します。",tips:["💡 例：戦で勝つか負けるか、商品が売れるか売れないかを予測","⚡ 計算が速く、結果が分かりやすい","🎯 直線で分けられる問題に最適","⚠️ 複雑な曲線的な関係は苦手"],useCases:"戦略の成功/失敗、商品の売上予測、病気の診断など",params:{learning_rate:{default:.01,min:.001,max:.1,step:.001,label:"学習速度",description:"AIが学習する速さ。大きすぎると学習が不安定になり、小さすぎると時間がかかる",tips:"0.01が一般的な値。問題が複雑な場合は0.001、シンプルな場合は0.05を試してみよう"},max_iterations:{default:100,min:50,max:500,step:10,label:"学習回数",description:"何回練習するか。多いほど精度が上がるが、時間がかかる",tips:"100回で十分な場合が多い。精度が足りない場合は200-300回に増やしてみよう"}}},{id:"linear_regression",name:"線形回帰",description:"数値を予測するAI",category:"regression",difficulty:"簡単",detailedDescription:"データの傾向を直線で表現し、新しいデータの値を予測するAI。特徴量と目的変数の関係を学習します。",tips:["💡 例：気温から収穫量を予測、人口から税収を予測","📈 「これが増えれば、あれも増える」という関係を見つける","⚡ 計算が速く、結果が分かりやすい","⚠️ 直線的な関係でない場合は精度が下がる"],useCases:"収穫量予測、売上予測、価格予測、需要予測など",params:{learning_rate:{default:.01,min:.001,max:.1,step:.001,label:"学習速度",description:"AIが学習する速さ。大きすぎると学習が不安定になり、小さすぎると時間がかかる",tips:"0.01が一般的な値。データが少ない場合は0.001、多い場合は0.05を試してみよう"},max_iterations:{default:100,min:50,max:500,step:10,label:"学習回数",description:"何回練習するか。多いほど精度が上がるが、時間がかかる",tips:"100回で十分な場合が多い。複雑なデータの場合は200-300回に増やしてみよう"}}},{id:"knn",name:"k近傍法",description:"似ているデータを探すAI",category:"classification",difficulty:"普通",detailedDescription:"新しいデータの周りにあるk個の最も近いデータを探し、それらの多数決で判断するAI。距離を計算して近いデータを見つけます。",tips:["💡 例：似たような条件の戦いの結果を参考に判断","🔍 データの形が複雑でも対応できる","⚡ 学習は不要で、すぐに予測できる","⚠️ データが多いと計算に時間がかかる"],useCases:"戦略の分類、商品のカテゴリ分け、顧客の行動予測など",params:{k:{default:5,min:1,max:20,step:1,label:"近くの数",description:"参考にする近くのデータの数。奇数にすると多数決で決まりやすくなる",tips:"5が一般的な値。データが少ない場合は3、多い場合は7-9を試してみよう。偶数だと同数になることがあるので奇数がおすすめ"}}},{id:"neural_network",name:"ニューラルネットワーク",description:"複雑な問題に強いAI",category:"classification",difficulty:"難しい",detailedDescription:"人間の脳の仕組みをまねたAI。複雑なパターンを学習して、高度な判断ができます。",tips:["🧠 例：複雑な画像認識、自然言語処理、高度な予測","⚡ 複雑な関係性を学習できる","🎯 大量のデータがある場合に威力を発揮","⚠️ 設定が複雑で、過学習しやすい"],useCases:"画像認識、音声認識、翻訳、高度な予測など",params:{learning_rate:{default:.01,min:.001,max:.1,step:.001,label:"学習速度",description:"AIが学習する速さ。ニューラルネットワークでは特に重要",tips:"0.01が一般的。複雑な問題は0.001、シンプルな問題は0.05を試してみよう"},max_iterations:{default:100,min:50,max:500,step:10,label:"学習回数",description:"何回練習するか。ニューラルネットワークは時間がかかる",tips:"100回から始めて、精度が足りない場合は200-300回に増やそう"}}},{id:"ensemble",name:"アンサンブル学習",description:"複数のAIを組み合わせた強力なAI",category:"both",difficulty:"難しい",detailedDescription:"複数の異なるモデルを組み合わせて、より正確な予測を行う手法です。各モデルの長所を活かして、単体では難しい問題も解決できます。",tips:["🤝 例：複数の専門家の意見をまとめる","⚡ 単体のモデルより高い精度を実現","🎯 多様性のあるモデルを組み合わせると効果的","⚠️ 計算量が多く、解釈が困難"],useCases:"高精度な予測が必要な場合、複雑な問題の解決など",params:{n_estimators:{default:10,min:5,max:50,step:1,label:"モデル数",description:"組み合わせるモデルの数。多いほど精度が上がるが、計算量も増える",tips:"10個が一般的。問題が簡単な場合は5個、複雑な場合は20-30個を試してみよう"},voting_method:{default:0,min:0,max:1,step:1,label:"投票方法",description:"0: 多数決、1: 重み付き平均",tips:"分類問題は多数決、回帰問題は重み付き平均が一般的"}}},{id:"random_forest",name:"ランダムフォレスト",description:"多数の決定木を組み合わせたAI",category:"both",difficulty:"中程度",detailedDescription:"複数の決定木をランダムに作成し、それらの結果をまとめて予測する手法です。過学習に強く、特徴量の重要度も分かります。",tips:["🌳 例：多数の専門家が独立して判断し、その結果をまとめる","⚡ 過学習に強く、安定した性能","🎯 特徴量の重要度が分かる","⚠️ 大量のデータが必要"],useCases:"特徴量の重要度を知りたい場合、安定した予測が必要な場合など",params:{n_trees:{default:100,min:10,max:500,step:10,label:"木の数",description:"作成する決定木の数。多いほど精度が上がるが、計算量も増える",tips:"100本が一般的。問題が簡単な場合は50本、複雑な場合は200-300本を試してみよう"},max_depth:{default:10,min:3,max:20,step:1,label:"木の深さ",description:"各決定木の最大の深さ。深いほど複雑なパターンを学習できるが、過学習しやすくなる",tips:"10が一般的。データが少ない場合は5-8、大量のデータがある場合は15-20を試してみよう"}}},{id:"svm",name:"サポートベクターマシン",description:"境界線を最適化するAI",category:"classification",difficulty:"中程度",detailedDescription:"データを分ける境界線を最適化する手法です。マージン（余裕）を最大化することで、汎化性能の高いモデルを作ります。",tips:["📏 例：2つのグループを最も明確に分ける線を引く","⚡ 高次元データに強い","🎯 少ないデータでも高い性能","⚠️ 大量のデータには向かない"],useCases:"高次元データの分類、少ないデータでの学習など",params:{kernel:{default:0,min:0,max:2,step:1,label:"カーネル",description:"0: 線形、1: 多項式、2: RBF",tips:"線形データは線形、非線形データはRBFが一般的"},c:{default:1,min:.1,max:10,step:.1,label:"正則化パラメータ",description:"誤分類の許容度。小さいほど誤分類を許容し、大きいほど厳密に分類",tips:"1が一般的。過学習している場合は0.1、未学習の場合は10を試してみよう"}}}];function $4({selectedModel:t,parameters:e,onModelChange:r,onParametersChange:n,regionType:a}){const[i,s]=v.useState(null),[o,l]=v.useState(!1),d=dc.filter(g=>a==="classification"?g.category==="classification":a==="regression"?g.category==="regression":!0),u=dc.find(g=>g.id===t)||d[0],h=(g,p)=>{n({...e,[g]:p})},f=g=>{s(g),l(!0)},m=()=>{s(null),l(!1)};return c.jsxs("div",{className:"rounded-lg p-6 shadow-lg border-2",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(Ah,{className:"w-5 h-5",style:{color:"var(--gold)"}}),c.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--ink)"},children:"AIモデルを選ぼう"})]}),c.jsx("p",{className:"text-sm mb-4",style:{color:"var(--ink-light)"},children:"問題に合ったAIの種類を選んで、設定を調整しよう！"}),c.jsxs("div",{className:"mb-6 p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--accent-strong)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"var(--accent)"}}),c.jsx("span",{className:"text-sm font-bold",style:{color:"var(--ink)"},children:"問題タイプ別のヒント"})]}),a==="classification"?c.jsxs("div",{className:"text-sm",style:{color:"var(--ink-light)"},children:[c.jsxs("p",{className:"mb-2",children:["📊 ",c.jsx("strong",{children:"分類問題"}),"：データをグループに分ける問題です"]}),c.jsx("p",{className:"text-xs",style:{color:"var(--ink-light)"},children:"例：戦で勝つか負けるか、商品が売れるか売れないか、病気か健康か"})]}):a==="regression"?c.jsxs("div",{className:"text-sm",style:{color:"var(--ink-light)"},children:[c.jsxs("p",{className:"mb-2",children:["📈 ",c.jsx("strong",{children:"回帰問題"}),"：数値を予測する問題です"]}),c.jsx("p",{className:"text-xs",style:{color:"var(--ink-light)"},children:"例：収穫量、売上金額、価格、温度、人口など"})]}):c.jsxs("div",{className:"text-sm",style:{color:"var(--ink-light)"},children:[c.jsxs("p",{className:"mb-2",children:["🤔 ",c.jsx("strong",{children:"問題タイプを確認"}),"：まずデータを確認して問題の種類を把握しましょう"]}),c.jsx("p",{className:"text-xs",style:{color:"var(--ink-light)"},children:"分類：グループ分け、回帰：数値予測"})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-lg font-bold mb-3 text-blue-900",children:"AIモデルの種類"}),c.jsx("div",{className:"space-y-3",children:d.map(g=>c.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg border-2 cursor-pointer transition-all ${t===g.id?"shadow-lg bg-yellow-50 border-yellow-400":"hover:bg-blue-50 border-slate-300"}`,onClick:()=>r(g.id),children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${t===g.id?"bg-blue-600 border-blue-600":"border-slate-400"}`,children:t===g.id&&c.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-lg text-blue-900",children:g.name}),c.jsx("div",{className:"text-sm text-blue-700",children:g.description})]})]}),c.jsx("button",{onClick:p=>{p.stopPropagation(),f(g.id)},className:"p-2 rounded-full hover:bg-gray-100 transition-colors",title:"詳細情報を見る",children:c.jsx(yg,{className:"w-4 h-4",style:{color:"var(--ink-light)"}})})]},g.id))})]}),c.jsxs("div",{className:"p-4 rounded-lg border",style:{background:"var(--silver-light)",borderColor:"var(--accent-strong)"},children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(ks,{className:"w-4 h-4",style:{color:"var(--accent-strong)"}}),c.jsx("h4",{className:"text-sm font-bold",style:{color:"var(--ink)"},children:"AIの設定を調整"})]}),c.jsx("p",{className:"text-xs mb-3",style:{color:"var(--ink-light)"},children:"スライダーを動かして、AIの動作を調整しよう"}),c.jsx("div",{className:"space-y-4",children:Object.entries(u.params).map(([g,p])=>{const y=e[g]??p.default;return c.jsxs("div",{className:"p-3 rounded-lg border",style:{background:"var(--ink-white)",borderColor:"var(--accent-strong)"},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("label",{className:"text-sm font-medium",style:{color:"var(--ink)"},children:p.label||g}),c.jsx("span",{className:"text-sm font-bold px-2 py-1 rounded",style:{color:"var(--accent-strong)",background:"var(--silver-light)"},children:y})]}),c.jsx("p",{className:"text-xs mb-2",style:{color:"var(--ink-light)"},children:p.description}),p.tips&&c.jsxs("div",{className:"text-xs p-2 rounded border-l-2 mb-2",style:{color:"var(--accent-strong)",background:"var(--silver-light)",borderColor:"var(--accent)"},children:["💡 ",p.tips]}),c.jsx("input",{type:"range",min:p.min,max:p.max,step:p.step,value:y,onChange:b=>h(g,Number(b.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer",style:{background:"rgba(30,58,138,0.15)",accentColor:"var(--accent-strong)"}}),c.jsxs("div",{className:"flex justify-between text-xs mt-1 text-gray-600",children:[c.jsx("span",{children:"小さい"}),c.jsx("span",{children:"大きい"})]})]},g)})})]})]}),i&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fadeIn",children:c.jsx("div",{className:`bg-white rounded-2xl border-2 shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transform transition-all duration-500 ${o?"scale-100 opacity-100 rotate-0":"scale-95 opacity-0 rotate-2"}`,style:{borderColor:"var(--gold)"},children:c.jsx("div",{className:"p-6",children:(()=>{const g=dc.find(p=>p.id===i);return g?c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"p-3 rounded-xl bg-blue-100",children:c.jsx(Ah,{className:"w-8 h-8 text-blue-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:g.name}),c.jsx("p",{className:"text-lg text-blue-600",children:g.description})]})]}),c.jsx("button",{onClick:m,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),c.jsxs("div",{className:"mb-6 animate-slideInUp",style:{animationDelay:"0.3s"},children:[c.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-3",children:"詳しい説明"}),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:g.detailedDescription}),c.jsxs("div",{className:"mb-4",children:[c.jsx("h5",{className:"text-sm font-bold text-gray-800 mb-2",children:"📋 使用例"}),c.jsx("p",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded border-l-4 border-blue-400",children:g.useCases})]}),c.jsxs("div",{children:[c.jsx("h5",{className:"text-sm font-bold text-gray-800 mb-2",children:"💡 ヒントとコツ"}),c.jsx("div",{className:"space-y-2",children:g.tips.map((p,y)=>c.jsx("div",{className:"text-sm text-gray-600 bg-yellow-50 p-2 rounded border-l-2 border-yellow-300",children:p},y))})]})]})]}),c.jsxs("div",{className:"mb-6 animate-slideInUp",style:{animationDelay:"0.4s"},children:[c.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-3",children:"設定パラメータ"}),c.jsx("div",{className:"space-y-4",children:Object.entries(g.params).map(([p,y])=>c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"font-medium text-gray-900",children:y.label}),c.jsxs("span",{className:"text-sm text-gray-600 bg-white px-3 py-1 rounded border font-bold",children:["現在値: ",e[p]??y.default]})]}),c.jsx("p",{className:"text-sm text-gray-700 mb-3 leading-relaxed",children:y.description}),y.tips&&c.jsxs("div",{className:"bg-blue-50 p-3 rounded border-l-4 border-blue-400 mb-3",children:[c.jsx("div",{className:"text-xs font-bold text-blue-800 mb-1",children:"💡 調整のコツ"}),c.jsx("p",{className:"text-xs text-blue-700",children:y.tips})]}),c.jsxs("div",{className:"text-xs text-gray-500 bg-white/50 px-3 py-2 rounded border",children:[c.jsx("span",{className:"font-medium",children:"範囲:"})," ",y.min," ～ ",y.max,c.jsx("span",{className:"ml-2 font-medium",children:"ステップ:"})," ",y.step]})]},p))})]}),c.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl animate-slideInUp",style:{animationDelay:"0.6s"},children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-600",children:"難易度:"}),c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${g.difficulty==="簡単"?"bg-green-100 text-green-800":g.difficulty==="普通"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:g.difficulty})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-600",children:"タイプ:"}),c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${g.category==="classification"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:g.category==="classification"?"分類":"回帰"})]})]})}),c.jsx("div",{className:"mt-6 flex justify-end animate-slideInUp",style:{animationDelay:"0.7s"},children:c.jsx("button",{onClick:m,className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg",children:"閉じる"})})]}):null})()})})})]})}function R4({featureImportance:t}){const e=t.map(n=>({name:n.featureName,importance:n.importance*100})),r=["#16a34a","#22c55e","#4ade80","#86efac","#bbf7d0"];return c.jsxs("div",{className:"bg-white/95 rounded-lg p-6 shadow-lg border-2 border-green-600",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(Ei,{className:"w-5 h-5 text-green-900"}),c.jsx("h3",{className:"text-lg font-bold text-green-900",children:"特徴量の重要度"})]}),c.jsx("p",{className:"text-sm text-green-800 mb-4",children:"各特徴量がモデルの予測にどれだけ影響を与えているかを示します。重要度が高い特徴量ほど、予測精度の向上に貢献しています。"}),c.jsx(wr,{width:"100%",height:300,children:c.jsxs(ya,{data:e,layout:"vertical",margin:{top:5,right:30,left:100,bottom:5},children:[c.jsx(jr,{strokeDasharray:"3 3",stroke:"#d1fae5"}),c.jsx(Sr,{type:"number",domain:[0,100],stroke:"#166534"}),c.jsx(Nr,{type:"category",dataKey:"name",stroke:"#166534"}),c.jsx(xr,{contentStyle:{backgroundColor:"#f0fdf4",border:"2px solid #16a34a",borderRadius:"8px"},formatter:n=>`${n.toFixed(1)}%`}),c.jsx(An,{dataKey:"importance",radius:[0,8,8,0],children:e.map((n,a)=>c.jsx(mn,{fill:r[a%r.length]},`cell-${a}`))})]})}),c.jsx("div",{className:"mt-4 space-y-2",children:c.jsx("div",{className:"bg-green-50 p-3 rounded border border-green-300",children:c.jsxs("p",{className:"text-sm text-green-900",children:[c.jsx("span",{className:"font-bold",children:"ヒント："}),"重要度の低い特徴量を除外することで、モデルがシンプルになり、過学習を防ぐことができます。"]})})})]})}function L4({confusionMatrix:t,classes:e}){const r=t.flat().reduce((o,l)=>o+l,0),n=Math.max(...t.flat()),a=o=>{const l=o/n;return l>.7?"bg-green-600 text-white":l>.4?"bg-green-400 text-green-900":l>.1?"bg-green-200 text-green-900":"bg-green-50 text-green-700"},s=e.map((l,d)=>{const u=t[d][d],h=t.reduce((y,b,x)=>y+(x!==d?b[d]:0),0),f=t[d].reduce((y,b,x)=>y+(x!==d?b:0),0),m=u/(u+h)||0,g=u/(u+f)||0,p=2*(m*g)/(m+g)||0;return{class:e[d],precision:m,recall:g,f1:p}});return c.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-blue-300",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(Di,{className:"w-5 h-5 text-blue-700"}),c.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"予測の正確さを見てみよう"})]}),c.jsx("p",{className:"text-sm text-gray-700 mb-4 leading-relaxed",children:"モデルが「正しく予測できた数」を表にしたものです。左上から右下への斜め線の数字が大きいほど、よく当たっています。"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("div",{className:"inline-block min-w-full",children:[c.jsxs("div",{className:"flex items-end mb-2",children:[c.jsx("div",{className:"w-20"}),c.jsxs("div",{className:"flex-1 text-center",children:[c.jsx("div",{className:"text-sm font-bold text-blue-900 mb-1",children:"予測値"}),c.jsx("div",{className:"flex justify-center space-x-1",children:e.map((o,l)=>c.jsx("div",{className:"w-20 text-xs font-medium text-blue-800 px-1",children:o},l))})]})]}),c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex flex-col justify-center mr-2",children:c.jsx("div",{className:"text-sm font-bold text-blue-900 mb-1 -rotate-90 origin-center whitespace-nowrap",style:{width:"80px",transform:"rotate(-90deg) translateX(-20px)"},children:"実際の値"})}),c.jsx("div",{className:"flex flex-col space-y-1",children:t.map((o,l)=>c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("div",{className:"w-16 text-xs font-medium text-blue-800 text-right pr-2",children:e[l]}),c.jsx("div",{className:"flex space-x-1",children:o.map((d,u)=>c.jsx("div",{className:`w-20 h-12 flex items-center justify-center rounded font-bold transition-all hover:scale-110 ${a(d)}`,children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg",children:d}),c.jsxs("div",{className:"text-xs opacity-75",children:[(d/r*100).toFixed(0),"%"]})]})},u))})]},l))})]})]})}),c.jsxs("div",{className:"mt-6 space-y-3",children:[c.jsx("h4",{className:"text-sm font-bold text-blue-900",children:"クラス別の性能指標"}),s.map((o,l)=>c.jsxs("div",{className:"bg-blue-50 p-3 rounded border border-blue-300",children:[c.jsx("div",{className:"text-sm font-bold text-blue-900 mb-2",children:o.class}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-blue-700",children:"適合率"}),c.jsxs("div",{className:"font-bold text-blue-900",children:[(o.precision*100).toFixed(1),"%"]}),c.jsx("div",{className:"h-2 bg-blue-200 rounded-full mt-1",children:c.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${o.precision*100}%`}})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-blue-700",children:"再現率"}),c.jsxs("div",{className:"font-bold text-blue-900",children:[(o.recall*100).toFixed(1),"%"]}),c.jsx("div",{className:"h-2 bg-blue-200 rounded-full mt-1",children:c.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${o.recall*100}%`}})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-blue-700",children:"F1スコア"}),c.jsxs("div",{className:"font-bold text-blue-900",children:[(o.f1*100).toFixed(1),"%"]}),c.jsx("div",{className:"h-2 bg-blue-200 rounded-full mt-1",children:c.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${o.f1*100}%`}})})]})]})]},l))]}),c.jsx("div",{className:"mt-4 bg-amber-50 p-3 rounded border border-amber-400",children:c.jsxs("p",{className:"text-sm text-amber-900",children:[c.jsx("span",{className:"font-bold",children:"ヒント："}),"適合率は「予測が正しい確率」、再現率は「見逃しの少なさ」を表します。 両方のバランスを取ることが重要です。"]})})]})}function B4({accuracy:t,requiredAccuracy:e,modelType:r}){const n=t>=e,a=e-t,s=(()=>{const o=[];return n?o.push({icon:Xt,title:"素晴らしい！",description:"AIの設定が完璧だったね！他の地域の課題にも挑戦してみよう。",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"}):(a>.2&&o.push({icon:Iw,title:"データをよく観察しよう",description:"グラフや表を見て、データの特徴やパターンを見つけてみよう。何か気づくことはないかな？",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}),(r==="logistic_regression"||r==="linear_regression")&&o.push({icon:tn,title:"学習速度を調整してみよう",description:"学習速度が速すぎると、AIがうまく学習できないことがあるよ。少し遅くしてみよう。",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"}),r==="knn"&&o.push({icon:Xt,title:"近くのデータ数を変えてみよう",description:"k近傍法では、参考にする近くのデータの数が重要だよ。3〜7の間で試してみよう。",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"}),o.push({icon:En,title:"特徴選択を見直してみよう",description:"選んだ特徴が本当に答えに関係しているかな？他の特徴も試してみよう。",color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200"})),o})();return c.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-6 border-2 border-yellow-300 shadow-lg",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(En,{className:"w-6 h-6 text-yellow-600"}),c.jsx("h3",{className:"text-lg font-bold text-yellow-900",children:"学習のヒント"})]}),c.jsx("div",{className:"space-y-3",children:s.map((o,l)=>{const d=o.icon;return c.jsx("div",{className:`p-4 rounded-lg border-2 ${o.bgColor} ${o.borderColor}`,children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(d,{className:`w-5 h-5 mt-0.5 ${o.color}`}),c.jsxs("div",{children:[c.jsx("h4",{className:`font-semibold ${o.color} mb-1`,children:o.title}),c.jsx("p",{className:"text-sm text-gray-700",children:o.description})]})]})},l)})}),!n&&c.jsx("div",{className:"mt-4 p-3 bg-orange-100 rounded-lg border border-orange-300",children:c.jsxs("p",{className:"text-sm text-orange-800",children:[c.jsx("strong",{children:"💡 コツ："})," 間違えても大丈夫！何度でも挑戦できるから、いろいろな設定を試してみよう。 データをよく観察することが一番大切だよ！"]})})]})}function U4({result:t,dataset:e,requiredAccuracy:r,modelType:n}){const a=t.accuracy>=r,i=t.predictions.slice(0,20).map((o,l)=>({index:l+1,predicted:Number(o),actual:Number(t.actual[l])})),s=e.featureNames;return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:`rounded-lg p-6 shadow-lg border-4 ${a?"bg-gradient-to-br from-green-100 to-green-50 border-green-600":"bg-gradient-to-br from-orange-100 to-orange-50 border-orange-600"}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Zt,{className:`w-8 h-8 ${a?"text-green-700":"text-orange-700"}`}),c.jsxs("div",{children:[c.jsx("h3",{className:`text-2xl font-bold ${a?"text-green-900":"text-orange-900"}`,children:a?"🎉 成功！課題クリア！":"💪 もう少し！"}),c.jsx("p",{className:`text-sm ${a?"text-green-700":"text-orange-700"}`,children:a?"AIの予測がとても正確でした！":"設定を調整してもう一度挑戦してみよう！"})]})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`text-4xl font-bold ${a?"text-green-700":"text-orange-700"}`,children:[(t.accuracy*100).toFixed(1),"%"]}),c.jsx("div",{className:`text-sm ${a?"text-green-600":"text-orange-600"}`,children:"正解率"})]})]}),c.jsxs("div",{className:"bg-white/60 p-4 rounded-lg",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"必要精度"}),c.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[(r*100).toFixed(0),"%"]})]}),c.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden relative",children:[c.jsx("div",{className:"absolute top-0 left-0 h-full border-r-2 border-red-500",style:{left:`${r*100}%`}}),c.jsx("div",{className:`h-full transition-all duration-1000 ${a?"bg-gradient-to-r from-green-500 to-green-600":"bg-gradient-to-r from-orange-400 to-orange-500"}`,style:{width:`${Math.min(t.accuracy*100,100)}%`}})]})]})]}),c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-indigo-600",children:[c.jsx("h4",{className:"text-lg font-bold text-indigo-900 mb-3",children:"学習条件の要約"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-600",children:"モデル"}),c.jsx("div",{className:"font-semibold text-gray-900",children:n||"—"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-600",children:"使用した特徴量"}),c.jsx("div",{className:"font-semibold text-gray-900 truncate",title:s.join(", "),children:s.join(", ")})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-600",children:"訓練時間"}),c.jsxs("div",{className:"font-semibold text-gray-900",children:[t.training_time,"秒"]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-blue-600",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(Xt,{className:"w-4 h-4 text-blue-700"}),c.jsx("span",{className:"text-xs font-medium text-blue-900",children:"精度"})]}),c.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[(t.accuracy*100).toFixed(1),"%"]})]}),t.precision!==void 0&&c.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-purple-600",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(tn,{className:"w-4 h-4 text-purple-700"}),c.jsx("span",{className:"text-xs font-medium text-purple-900",children:"適合率"})]}),c.jsxs("div",{className:"text-2xl font-bold text-purple-800",children:[(t.precision*100).toFixed(1),"%"]})]}),t.recall!==void 0&&c.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-pink-600",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(tn,{className:"w-4 h-4 text-pink-700"}),c.jsx("span",{className:"text-xs font-medium text-pink-900",children:"再現率"})]}),c.jsxs("div",{className:"text-2xl font-bold text-pink-800",children:[(t.recall*100).toFixed(1),"%"]})]}),c.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-gray-600",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(Dw,{className:"w-4 h-4 text-gray-700"}),c.jsx("span",{className:"text-xs font-medium text-gray-900",children:"訓練時間"})]}),c.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[t.training_time,"秒"]})]})]}),t.confusion_matrix&&e.classes&&c.jsx(L4,{confusionMatrix:t.confusion_matrix,classes:e.classes}),t.feature_importance&&t.feature_importance.length>0&&c.jsx(R4,{featureImportance:t.feature_importance}),c.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-teal-600",children:[c.jsx("h4",{className:"text-lg font-bold text-teal-900 mb-4",children:"予測 vs 実測値（最初の20件）"}),c.jsx(wr,{width:"100%",height:300,children:c.jsxs(PL,{data:i,children:[c.jsx(jr,{strokeDasharray:"3 3"}),c.jsx(Sr,{dataKey:"index",label:{value:"サンプル",position:"insideBottom",offset:-5}}),c.jsx(Nr,{label:{value:"値",angle:-90,position:"insideLeft"}}),c.jsx(xr,{}),c.jsx(pu,{type:"monotone",dataKey:"actual",stroke:"#059669",strokeWidth:2,name:"実測値"}),c.jsx(pu,{type:"monotone",dataKey:"predicted",stroke:"#dc2626",strokeWidth:2,name:"予測値",strokeDasharray:"5 5"})]})})]}),e.classes&&c.jsxs("div",{className:"bg-amber-50 p-6 rounded-lg border-2 border-amber-600",children:[c.jsx("h4",{className:"text-lg font-bold text-amber-900 mb-3",children:"アドバイス"}),c.jsx("ul",{className:"space-y-2 text-sm text-amber-800",children:t.accuracy<r?c.jsxs(c.Fragment,{children:[c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"💡"}),c.jsx("span",{children:"パラメータを調整してみましょう。学習率を変更すると結果が改善するかもしれません。"})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"💡"}),c.jsx("span",{children:"別のモデルを試してみるのも良い方法です。"})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"💡"}),c.jsx("span",{children:"イテレーション数を増やすと、より良い結果が得られることがあります。"})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"🎉"}),c.jsx("span",{children:"素晴らしい！課題をクリアしました。次の地域に挑戦しましょう！"})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx("span",{className:"mr-2",children:"⭐"}),c.jsx("span",{children:"より高い精度を目指して、さらなる改善に挑戦してみてください。"})]})]})})]}),c.jsx(B4,{accuracy:t.accuracy,requiredAccuracy:r,modelType:n||""})]})}function F4(){const{user:t,regions:e,progress:r,selectedRegion:n,setCurrentView:a,refreshProgress:i}=Ms(),[s,o]=v.useState(null),[l,d]=v.useState(null),[u,h]=v.useState(null),[f,m]=v.useState([]),[g,p]=v.useState("logistic_regression"),[y,b]=v.useState({}),[x,w]=v.useState(!1),[_,S]=v.useState(null),[j,N]=v.useState(null),[M,O]=v.useState("data"),[C,P]=v.useState([]),[k,D]=v.useState(""),I=e.find(B=>B.id===n),W=n?r[n]:null;v.useEffect(()=>{if(n&&I){console.log("Loading dataset for region:",n);const B=O4(n);console.log("Dataset loaded:",{hasData:!!B,trainLength:B?.train?.length,hasRaw:!!B?.raw,featureNames:B?.featureNames}),d(B),o(B),h(B),m([]),N(null),S(null),O("data"),I.problem_type==="classification"?(B.classes?.length||2)>2?p("neural_network"):p("logistic_regression"):I.problem_type==="regression"?p("linear_regression"):p("logistic_regression"),P([]),D(""),b({})}},[n,I]),v.useEffect(()=>{if(u)if(f.length>0){const B=Y=>({features:f.map($=>Y.features[$]),label:Y.label}),R={train:u.train.map(B),test:u.test.map(B),featureNames:f.map(Y=>u.featureNames[Y]),labelName:u.labelName,classes:u.classes,raw:u.raw};o(R)}else o(u)},[f,u]);const V=B=>{h(B),o(B),O("features")},K=async()=>{if(!(!s||!t||!n)){w(!0),N(null),S(null),O("train");try{const B=$i(g),R=s.train||s.data||[],Y=s.test||[];if(console.log("学習データ:",{trainingDataLength:R.length,testDataLength:Y.length,datasetKeys:Object.keys(s)}),R.length===0)throw new Error("学習データがありません");await B.train(R,y,te=>{S(te)});const $=B.evaluate(Y.length>0?Y:R);N($);const qe=D4.detectOverfitting($.accuracy,$.accuracy);qe.isOverfitting&&P([qe.message,...qe.suggestions]),await Gw({user_id:t.id,region_id:n,model_type:g,parameters:y,accuracy:$.accuracy,precision:$.precision||null,recall:$.recall||null,f1_score:$.f1_score||null,training_time:$.training_time});const hr=W?.best_accuracy||0;if($.accuracy>hr){let te=0;const Bt=I?.required_accuracy||.8;$.accuracy>=Bt&&(te=1,$.accuracy>=Bt+.05&&(te=2),$.accuracy>=Bt+.1&&(te=3));const $r=$.accuracy>=Bt;if(await Su(t.id,n,{is_completed:$r,best_accuracy:$.accuracy,stars:te,attempts:(W?.attempts||0)+1,last_attempt_at:new Date().toISOString()}),$r){const aa=e.filter(L=>L.unlock_condition===n);for(const L of aa)await Vw(t.id,L.id)}await i()}O("result")}catch(B){console.error("Training failed:",B)}finally{w(!1)}}};if(!I||!s||!l||!u)return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-100 to-blue-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Eh,{className:"w-12 h-12 animate-spin text-blue-500 mx-auto mb-4"}),c.jsx("p",{className:"text-lg text-gray-700",children:"読み込み中..."})]})});const X=[{id:"data",label:"データを見る",icon:ju,completed:M!=="data"},{id:"preprocessing",label:"前処理",icon:Ch,completed:M==="features"||M==="model"||M==="train"||M==="result"},{id:"features",label:"特徴を選ぶ",icon:Ch,completed:M==="model"||M==="train"||M==="result"},{id:"model",label:"モデルを選ぶ",icon:$w,completed:M==="train"||M==="result"},{id:"train",label:"学習する",icon:mc,completed:M==="result"},{id:"result",label:"結果を見る",icon:Zt,completed:!1}];return c.jsx("div",{className:"min-h-screen",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-6xl mx-auto",children:c.jsxs("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:[c.jsxs("div",{className:"p-6",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%)"},children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("button",{onClick:()=>a("map"),className:"flex items-center space-x-2 text-white hover:text-yellow-200 transition-colors bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg backdrop-blur-sm border border-white/20",children:[c.jsx(Kr,{className:"w-5 h-5"}),c.jsx("span",{className:"font-medium",children:"マップに戻る"})]}),c.jsxs("div",{className:"text-center flex-1",children:[c.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-white",children:[I.name,"の課題"]}),c.jsx("p",{className:"text-lg mt-2 text-yellow-200",children:I.daimyo})]}),c.jsx("div",{className:"w-32"})]}),c.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap md:space-x-4",children:X.map((B,R)=>{const Y=B.icon,$=M===B.id,qe=B.completed||$;return c.jsxs("div",{className:"flex items-center",children:[c.jsxs("button",{onClick:()=>qe&&O(B.id),disabled:!qe,className:`flex items-center space-x-2 px-3 md:px-4 py-2 rounded-lg transition-all border-2 ${$?"bg-yellow-400 shadow-lg scale-105 text-blue-900":B.completed?"bg-yellow-200 text-blue-800 hover:bg-yellow-300 border-yellow-300":"bg-white/10 text-white/60 cursor-not-allowed border-white/20"}`,style:{borderColor:$||B.completed?"#fbbf24":void 0},children:[c.jsx(Y,{className:"w-4 h-4 md:w-5 md:h-5"}),c.jsx("span",{className:"text-sm md:text-base font-medium hidden sm:inline",children:B.label})]}),R<X.length-1&&c.jsx(Wt,{className:"w-4 h-4 md:w-5 md:h-5 text-yellow-200 mx-1 hidden md:block"})]},B.id)})})]}),c.jsxs("div",{className:"p-6 md:p-8",children:[c.jsxs("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-slate-50 rounded-xl p-4 md:p-6 border-2 border-blue-200 shadow-lg",children:[c.jsxs("h2",{className:"text-xl font-bold text-blue-900 mb-3 flex items-center",children:[c.jsx("span",{className:"w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center text-blue-900 font-bold mr-3",children:"!"}),"課題の説明"]}),c.jsx("p",{className:"text-blue-800 leading-relaxed mb-4 text-lg",children:I.problem_description}),c.jsxs("div",{className:"flex items-center space-x-6 text-base",children:[c.jsxs("div",{className:"flex items-center space-x-2 bg-yellow-100 px-4 py-3 rounded-lg",children:[c.jsx("span",{className:"text-blue-700 font-bold",children:"目標:"}),c.jsxs("span",{className:"font-bold text-blue-900 text-lg",children:["正解率 ",(I.required_accuracy*100).toFixed(0),"% 以上"]})]}),W?.best_accuracy&&W.best_accuracy>0&&c.jsxs("div",{className:"flex items-center space-x-2 bg-slate-100 px-4 py-3 rounded-lg",children:[c.jsx("span",{className:"text-blue-700 font-bold",children:"自己ベスト:"}),c.jsxs("span",{className:"font-bold text-blue-900 text-lg",children:[(W.best_accuracy*100).toFixed(1),"%"]})]})]})]}),M==="data"&&c.jsxs("div",{className:"space-y-6",children:[c.jsx(yw,{dataset:l}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{onClick:()=>O("preprocessing"),className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-2 border-yellow-400 text-lg",children:[c.jsx("span",{children:"次へ：前処理"}),c.jsx(Wt,{className:"w-6 h-6"})]})})]}),M==="preprocessing"&&l&&c.jsxs("div",{className:"space-y-6",children:[c.jsx(bw,{dataset:l,onPreprocess:V}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("button",{onClick:()=>O("data"),className:"flex items-center space-x-2 text-slate-600 hover:text-slate-800 px-6 py-4 rounded-lg font-medium transition-colors border-2 border-slate-300 hover:border-slate-400 text-lg",children:[c.jsx(Kr,{className:"w-6 h-6"}),c.jsx("span",{children:"戻る：データを見る"})]}),c.jsxs("button",{onClick:()=>O("features"),className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-2 border-yellow-400 text-lg",children:[c.jsx("span",{children:"前処理なしで次へ：特徴を選ぶ"}),c.jsx(Wt,{className:"w-6 h-6"})]})]})]}),M==="features"&&u&&c.jsxs("div",{className:"space-y-6",children:[c.jsx(xw,{dataset:u,selectedFeatures:f,onFeaturesChange:m}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("button",{onClick:()=>O("data"),className:"flex items-center space-x-2 text-slate-600 hover:text-slate-800 px-6 py-4 rounded-lg font-medium transition-colors border-2 border-slate-300 hover:border-slate-400 text-lg",children:[c.jsx(Kr,{className:"w-6 h-6"}),c.jsx("span",{children:"戻る：データを見る"})]}),c.jsxs("button",{onClick:()=>O("model"),disabled:f.length===0,className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-2 border-yellow-400 text-lg",children:[c.jsx("span",{children:"次へ：モデルを選ぶ"}),c.jsx(Wt,{className:"w-6 h-6"})]})]})]}),M==="model"&&c.jsxs("div",{className:"space-y-6",children:[c.jsx($4,{regionType:I.problem_type,selectedModel:g,parameters:y,onModelChange:p,onParametersChange:b}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("button",{onClick:()=>O("features"),className:"flex items-center space-x-2 text-slate-600 hover:text-slate-800 px-6 py-4 rounded-lg font-medium transition-colors border-2 border-slate-300 hover:border-slate-400 text-lg",children:[c.jsx(Kr,{className:"w-6 h-6"}),c.jsx("span",{children:"戻る：特徴を選ぶ"})]}),c.jsxs("button",{onClick:K,disabled:x,className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 border-2 border-blue-600 text-lg",children:[c.jsx(mc,{className:"w-6 h-6"}),c.jsx("span",{children:"学習を開始"})]})]})]}),M==="train"&&c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-8 border-2 border-blue-200",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx(Eh,{className:"w-16 h-16 animate-spin text-blue-500 mx-auto mb-4"}),c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"学習中..."}),c.jsx("p",{className:"text-gray-600",children:"モデルがデータから学んでいます。しばらくお待ちください。"})]}),_&&c.jsx(ww,{progress:_})]})}),M==="result"&&j&&c.jsxs("div",{className:"space-y-6",children:[c.jsx(U4,{result:j,dataset:s,requiredAccuracy:I.required_accuracy,modelType:g}),C.length>0&&c.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-6",children:[c.jsxs("h3",{className:"text-lg font-bold text-red-800 mb-3 flex items-center",children:[c.jsx("span",{className:"w-6 h-6 mr-2",children:"⚠️"}),"安全性チェック"]}),c.jsx("ul",{className:"space-y-2",children:C.map((B,R)=>c.jsxs("li",{className:"text-red-700 text-base",children:["• ",B]},R))})]}),k&&c.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:[c.jsxs("h3",{className:"text-lg font-bold text-blue-800 mb-3 flex items-center",children:[c.jsx("span",{className:"w-6 h-6 mr-2",children:"📚"}),"学習ポイント"]}),c.jsx("p",{className:"text-blue-700 text-base",children:k})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("button",{onClick:()=>O("features"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 px-6 py-3 rounded-lg font-medium transition-colors",children:[c.jsx(Kr,{className:"w-5 h-5"}),c.jsx("span",{children:"特徴を変えて再挑戦"})]}),c.jsx("button",{onClick:()=>a("map"),className:"flex items-center space-x-2 text-white px-8 py-3 rounded-lg font-bold shadow-lg transition-all",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))"},children:c.jsx("span",{children:"マップに戻る"})})]})]})]})]})})})}function fg({onUserReady:t}){const[e,r]=v.useState(""),[n,a]=v.useState(""),[i,s]=v.useState(!1),[o,l]=v.useState(null);v.useEffect(()=>{const h=Ct.getCurrentUser();h&&(l(h),t(h))},[t]);const d=async()=>{if(e.trim()){s(!0);try{const h=Ct.loginUser(e.trim(),n.trim()||void 0);l(h),t(h)}catch(h){console.error("ログインに失敗:",h)}finally{s(!1)}}},u=()=>{Ct.logout(),l(null),r(""),a("")};if(o){const h=Ct.getUserStats();return c.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-md w-full mx-4",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-4 p-8",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full overflow-hidden border-4",style:{borderColor:"var(--gold)"},children:c.jsx("img",{src:o.avatar,alt:o.username,className:"w-full h-full object-cover"})}),c.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-2",children:o.username}),c.jsxs("div",{className:"text-sm text-slate-600",children:["レベル ",o.level," • 経験値 ",o.experience]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[c.jsx(Zt,{className:"w-6 h-6 text-yellow-500 mx-auto mb-2"}),c.jsx("div",{className:"text-lg font-bold text-blue-900",children:o.wins}),c.jsx("div",{className:"text-sm text-blue-700",children:"勝利数"})]}),c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[c.jsx(Xt,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),c.jsxs("div",{className:"text-lg font-bold text-green-900",children:[Math.round(o.winRate*100),"%"]}),c.jsx("div",{className:"text-sm text-green-700",children:"勝率"})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex justify-between text-sm text-slate-600 mb-2",children:[c.jsxs("span",{children:["レベル ",o.level]}),c.jsxs("span",{children:[Math.round(h.progress),"%"]})]}),c.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3",children:c.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-300",style:{width:`${h.progress}%`}})}),c.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["次のレベルまで ",h.nextLevelExp-o.experience," EXP"]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{onClick:()=>t(o),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 hover:shadow-lg",children:[c.jsx(Rw,{className:"w-5 h-5 inline-block mr-2"}),"対戦を開始"]}),c.jsx("button",{onClick:u,className:"w-full text-slate-600 hover:text-slate-800 py-2 px-4 rounded-lg border-2 border-slate-300 hover:border-slate-400 transition-colors",children:"別のユーザーでログイン"})]})]})})})}return c.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--paper)"},children:c.jsx("div",{className:"max-w-md w-full mx-4",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-4 p-8",style:{borderColor:"var(--gold)"},children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center",children:c.jsx(Lw,{className:"w-8 h-8 text-white"})}),c.jsx("h1",{className:"text-3xl font-bold text-blue-900 mb-2",children:"プレイヤー登録"}),c.jsx("p",{className:"text-slate-600",children:"オンライン対戦に参加するためのユーザー情報を入力してください"})]}),c.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},className:"space-y-6",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["ユーザー名 ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:e,onChange:h=>r(h.target.value),placeholder:"プレイヤー名を入力",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"メールアドレス（任意）"}),c.jsx("input",{type:"email",value:n,onChange:h=>a(h.target.value),placeholder:"メールアドレス（任意）",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),c.jsx("button",{type:"submit",disabled:!e.trim()||i,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 disabled:from-slate-400 disabled:to-slate-500 text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 hover:shadow-lg disabled:cursor-not-allowed",children:i?c.jsxs("div",{className:"flex items-center justify-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"ログイン中..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Bw,{className:"w-5 h-5 inline-block mr-2"}),"対戦を開始"]})})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx("p",{className:"text-sm text-slate-500",children:"ユーザー情報はローカルに保存され、統計やリーダーボードに反映されます"})})]})})})}function z4(){const{user:t,currentView:e,loading:r,error:n}=Ms(),[a,i]=v.useState(!1),[s,o]=v.useState(!1),[l,d]=v.useState(null),[u,h]=v.useState("");v.useEffect(()=>{try{console.log("GameContent useEffect開始");const m=Ct.getCurrentUser();console.log("userManager.getCurrentUser():",m),m?(d(m),h("ユーザーが見つかりました - イントロ表示"),o(!0)):(h("ユーザーが見つかりません - 認証画面表示"),i(!0))}catch(m){console.error("GameContent useEffect エラー:",m),h(`エラー: ${m}`)}},[]),v.useEffect(()=>{l&&t&&console.log("ユーザー同期完了:",{currentUser:l,user:t})},[l,t]),console.log("App.tsx state:",{showUserAuth:a,showQuoteIntro:s,currentUser:!!l,user:!!t,currentView:e,loading:r,error:n,debugInfo:u});const f=m=>{d(m),i(!1),o(!1)};return a?c.jsxs("div",{children:[c.jsx(fg,{onUserReady:f}),u&&c.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[c.jsxs("div",{children:["デバッグ: ",u]}),c.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),c.jsxs("div",{children:["Error: ",n||"None"]})]})]}):s?c.jsxs("div",{children:[c.jsx(Xw,{onComplete:()=>o(!1),durationScale:1.3}),u&&c.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[c.jsxs("div",{children:["デバッグ: ",u]}),c.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),c.jsxs("div",{children:["Error: ",n||"None"]})]})]}):r?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-900 to-red-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-yellow-400 mx-auto mb-4"}),c.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"読み込み中..."})]})}):n?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-900 to-orange-900 flex items-center justify-center p-4",children:c.jsxs("div",{className:"max-w-md bg-white/95 rounded-lg shadow-2xl p-8 text-center",children:[c.jsx(fc,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),c.jsx("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"エラーが発生しました"}),c.jsx("p",{className:"text-red-800 mb-6",children:n}),c.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center space-x-2 bg-red-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-red-700 transition-colors mx-auto",children:[c.jsx(vg,{className:"w-5 h-5"}),c.jsx("span",{children:"ページを再読み込み"})]})]})}):l||t?(console.log("App.tsx currentView:",e),e==="map"?(console.log("日本地図を表示します"),c.jsxs("div",{children:[c.jsx(h4,{}),u&&c.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[c.jsxs("div",{children:["デバッグ: ",u]}),c.jsxs("div",{children:["View: ",e]}),c.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),c.jsxs("div",{children:["Error: ",n||"None"]})]})]})):e==="challenge"?(console.log("チャレンジ画面を表示します"),c.jsxs("div",{children:[c.jsx(F4,{}),u&&c.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[c.jsxs("div",{children:["デバッグ: ",u]}),c.jsxs("div",{children:["View: ",e]}),c.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),c.jsxs("div",{children:["Error: ",n||"None"]})]})]})):(console.log("ホーム画面を表示します"),c.jsxs("div",{children:[c.jsx(c4,{}),u&&c.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[c.jsxs("div",{children:["デバッグ: ",u]}),c.jsxs("div",{children:["View: ",e]}),c.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),c.jsxs("div",{children:["Error: ",n||"None"]})]})]}))):c.jsxs("div",{children:[c.jsx(fg,{onUserReady:f}),u&&c.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[c.jsxs("div",{children:["デバッグ: ",u]}),c.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),c.jsxs("div",{children:["Error: ",n||"None"]})]})]})}function q4(){return c.jsx(Jw,{children:c.jsx(z4,{})})}async function W4(){try{Pr.showSecurityWarning(),Pr.checkProductionSecurity(),console.log("🚀 アプリケーション初期化開始..."),console.log("🎯 アプリケーション初期化完了")}catch(t){throw console.error("アプリケーション初期化エラー:",t),t}}W4();qw.createRoot(document.getElementById("root")).render(c.jsx(v.StrictMode,{children:c.jsx(q4,{})}));export{Be as C,_a as a};
