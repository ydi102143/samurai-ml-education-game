const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/privateEvaluationScheduler-Bic-QRG4.js","assets/vendor-B1sUnLqs.js","assets/ui-DckeBngJ.js"])))=>i.map(i=>d[i]);
import{r as Ps,a as mg,b as jw,g as rr}from"./vendor-B1sUnLqs.js";import{r as v,S as Sw,T as Tn,R as Nw,B as wo,G as Di,M as fc,D as _o,a as Ei,L as On,E as Su,b as Pr,A as mc,c as ks,d as jo,C as So,e as pg,f as Pw,g as Oh,X as kw,h as Mw,i as zr,P as pc,j as Cn,U as Ow,k as zt,l as gg,m as No,n as Aw,o as Ew,p as Tw,q as Ah,s as Cw,t as Iw,I as vg,u as Eh,v as Dw,w as $w,x as Th,F as Ch,y as Rw,Z as Lw,z as Bw,H as Uw,J as Fw}from"./ui-DckeBngJ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Po={exports:{}},sa={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ih;function Ww(){if(Ih)return sa;Ih=1;var t=Ps(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(o,l,d){var c,h={},f=null,m=null;d!==void 0&&(f=""+d),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(m=l.ref);for(c in l)n.call(l,c)&&!i.hasOwnProperty(c)&&(h[c]=l[c]);if(o&&o.defaultProps)for(c in l=o.defaultProps,l)h[c]===void 0&&(h[c]=l[c]);return{$$typeof:e,type:o,key:f,ref:m,props:h,_owner:a.current}}return sa.Fragment=r,sa.jsx=s,sa.jsxs=s,sa}var Dh;function qw(){return Dh||(Dh=1,Po.exports=Ww()),Po.exports}var u=qw(),si={},$h;function zw(){if($h)return si;$h=1;var t=mg();return si.createRoot=t.createRoot,si.hydrateRoot=t.hydrateRoot,si}var Kw=zw();const Hw=[{id:"kyoto",name:"京都",daimyo:"足利将軍家",description:"商業の中心地として栄え、多くの茶器が取引される中で贋作を見抜く目が求められている。",problem_type:"classification",problem_description:"茶器の情報から真贋を判定するAIを構築する。",required_accuracy:.8,unlock_condition:null,difficulty:1,reward_xp:100,order_index:1,dataset_info:{features:["年代","職人技","材質","古色"],classes:["贋作","本物"],samples:300},created_at:new Date().toISOString()},{id:"sakai",name:"堺",daimyo:"商人自治",description:"南蛮貿易で栄える国際港湾都市。世界中から届く品物の産地を正確に識別する必要がある。",problem_type:"classification",problem_description:"貿易品の特徴から産地を分類する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:2,dataset_info:{features:["材質","装飾","職人技","価格"],classes:["中国","南蛮","朝鮮","日本"],samples:300},created_at:new Date().toISOString()},{id:"kai",name:"甲斐",daimyo:"武田信玄",description:"豊富な金山を有する武田領。鉱山の産出量を予測し、効率的な資源管理を実現する。",problem_type:"regression",problem_description:"気象条件と労働力から金山の月間産出量を予測する。",required_accuracy:.7,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:3,dataset_info:{features:["労働者数","経験値","気温","降水量","機具の質","鉱石の品質"],samples:300},created_at:new Date().toISOString()},{id:"echigo",name:"越後",daimyo:"上杉謙信",description:"豊かな穀倉地帯として知られる越後。気象データから米の収穫量を予測し、領民を飢饉から守る。",problem_type:"regression",problem_description:"気象条件と土壌データから米の収穫量を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:4,dataset_info:{features:["気温","降水量","日照時間","土壌の質","種子の質","肥料の量"],samples:300},created_at:new Date().toISOString()},{id:"owari",name:"尾張",daimyo:"織田信長",description:"兵農分離を進める織田領。兵士の適性を科学的に分析し、最適な配置を実現する。",problem_type:"classification",problem_description:"兵士の能力データから最適な役職を判定する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:5,dataset_info:{features:["年齢","筋力","敏捷性","知力","戦闘経験","社会階級"],classes:["槍兵","弓兵","鉄砲隊","騎馬隊"],samples:300},created_at:new Date().toISOString()},{id:"satsuma",name:"薩摩",daimyo:"島津義弘",description:"鉄砲生産で名高い薩摩。火縄銃の品質検査を自動化し、不良品を検出する。",problem_type:"classification",problem_description:"鉄砲の製造データから品質を判定する。",required_accuracy:.85,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:6,dataset_info:{features:["鉄の品質","鋼の品質","鍛造技術","組み立て精度","検査の厳密さ","製造温度"],classes:["不良品","良品"],samples:300},created_at:new Date().toISOString()},{id:"hizen",name:"肥前",daimyo:"鍋島直茂",description:"有田焼など陶磁器で名高い肥前。焼成条件から等級を見極める。",problem_type:"classification",problem_description:"陶器の製造データから等級（上・中・下）を分類する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:180,order_index:7,dataset_info:{features:["粘土の品質","釉薬の品質","焼成温度","陶工の技能","装飾の美しさ","厚さの均一性"],classes:["下級","中級","上級"],samples:300},created_at:new Date().toISOString()},{id:"sagami",name:"相模",daimyo:"北条氏康",description:"小田原を擁する北条領。政治・経済指標から地域の繁栄度を判断する。",problem_type:"classification",problem_description:"地域指標から繁栄レベル（低・中・高）を分類する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:8,dataset_info:{features:["人口","商業の発達度","農業の発達度","統治の質","政治安定性","立地の良さ"],classes:["低い","中程度","高い"],samples:300},created_at:new Date().toISOString()},{id:"dewa",name:"出羽",daimyo:"最上義光",description:"山形の険しい地形での物流網最適化。条件から輸送効率を予測する。",problem_type:"regression",problem_description:"距離や標高、天候などから輸送効率を予測する。",required_accuracy:.7,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:9,dataset_info:{features:["距離","標高","天候の良さ","道路の質","荷物の価値","季節"],samples:300},created_at:new Date().toISOString()},{id:"morioka",name:"盛岡",daimyo:"南部信直",description:"南部藩の中心地。馬の品種改良データから最適な繁殖条件を予測する。",problem_type:"regression",problem_description:"馬の血統と環境条件から繁殖成功率を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:10,dataset_info:{features:["血統スコア","年齢","健康状態","飼育環境","季節","交配回数"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"sendai",name:"仙台",daimyo:"伊達政宗",description:"東北最大の藩。米の収穫量を気象データから予測し、年貢を最適化する。",problem_type:"regression",problem_description:"気象条件から米の収穫量を予測する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:11,dataset_info:{features:["気温","降水量","日照時間","土壌水分","肥料量","植え付け時期"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"kanazawa",name:"金沢",daimyo:"前田利家",description:"加賀百万石。金箔の品質を製造条件から判定し、最高級品を選別する。",problem_type:"classification",problem_description:"金箔の製造データから品質等級を分類する。",required_accuracy:.85,unlock_condition:"kai",difficulty:4,reward_xp:250,order_index:12,dataset_info:{features:["金の純度","温度","湿度","圧延回数","職人経験","作業時間"],classes:["下級","中級","上級","最高級"],samples:300},created_at:new Date().toISOString()},{id:"takamatsu",name:"高松",daimyo:"生駒親正",description:"四国の要衝。海運の安全を天候と海流データから予測する。",problem_type:"classification",problem_description:"天候と海流から航海の安全性を判定する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:180,order_index:13,dataset_info:{features:["風速","波高","海流速度","雲量","気圧","潮汐"],classes:["危険","注意","安全"],samples:300},created_at:new Date().toISOString()},{id:"kumamoto",name:"熊本",daimyo:"加藤清正",description:"肥後熊本藩。城の石垣の強度を材料と工法から予測する。",problem_type:"regression",problem_description:"石の材質と積み方から石垣の強度を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:14,dataset_info:{features:["石の硬さ","石の大きさ","積み方","モルタル量","角度","基礎の深さ"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"yamaguchi",name:"長門",daimyo:"毛利元就",description:"中国地方の雄。水軍の戦術データから最適な戦略を予測する。",problem_type:"classification",problem_description:"海戦の条件から勝利確率を予測する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:200,order_index:15,dataset_info:{features:["風速","波高","船数","兵数","距離","時間"],classes:["敗北","引き分け","勝利"],samples:300},created_at:new Date().toISOString()},{id:"kaga",name:"加賀",daimyo:"一向一揆",description:"一向宗の自治領。信者の分布データから布教戦略を最適化する。",problem_type:"regression",problem_description:"地域の特性から信者獲得数を予測する。",required_accuracy:.75,unlock_condition:"kyoto",difficulty:2,reward_xp:150,order_index:16,dataset_info:{features:["人口密度","経済状況","教育レベル","既存宗教","交通便","季節"],classes:[],samples:300},created_at:new Date().toISOString()},{id:"tosa",name:"土佐",daimyo:"長宗我部元親",description:"四国の統一者。領土拡大の戦略をデータから最適化する。",problem_type:"classification",problem_description:"戦略条件から成功確率を予測する。",required_accuracy:.8,unlock_condition:"sakai",difficulty:3,reward_xp:180,order_index:17,dataset_info:{features:["兵力","装備","地形","天候","敵兵力","補給"],classes:["失敗","部分成功","完全成功"],samples:300},created_at:new Date().toISOString()},{id:"modern_stock_prediction",name:"株価予測",daimyo:"現代金融",description:"現代の金融市場で株価の変動を予測し、投資戦略を最適化する。",problem_type:"regression",problem_description:"企業の財務データから株価変化率を予測する。",required_accuracy:.7,unlock_condition:null,difficulty:5,reward_xp:500,order_index:30,dataset_info:{features:["始値","出来高","時価総額","PER","負債比率","売上成長率","利益率"],samples:1e3},created_at:new Date().toISOString()},{id:"modern_sentiment_analysis",name:"感情分析",daimyo:"テキスト解析",description:"SNSやレビューのテキストから感情を分析し、顧客満足度を向上させる。",problem_type:"classification",problem_description:"テキストの特徴から感情を分類する。",required_accuracy:.8,unlock_condition:null,difficulty:4,reward_xp:400,order_index:31,dataset_info:{features:["単語数","ポジティブ単語比率","ネガティブ単語比率","ニュートラル単語比率","感嘆符比率","疑問符比率","大文字比率"],classes:["ネガティブ","ニュートラル","ポジティブ"],samples:2e3},created_at:new Date().toISOString()},{id:"modern_image_classification",name:"画像分類",daimyo:"コンピュータビジョン",description:"画像の特徴量から物体を分類し、自動認識システムを構築する。",problem_type:"classification",problem_description:"画像の特徴量から物体を分類する。",required_accuracy:.85,unlock_condition:null,difficulty:5,reward_xp:500,order_index:32,dataset_info:{features:["明度","コントラスト","色彩豊かさ","エッジ密度","テクスチャ複雑さ","対称性","アスペクト比"],classes:["猫","犬","車","飛行機","建物","花","食べ物","人物"],samples:1500},created_at:new Date().toISOString()},{id:"modern_recommendation",name:"推薦システム",daimyo:"ECサイト",description:"ユーザーの行動データから購入確率を予測し、パーソナライズされた推薦を行う。",problem_type:"regression",problem_description:"ユーザーとアイテムの特徴から購入確率を予測する。",required_accuracy:.75,unlock_condition:null,difficulty:4,reward_xp:400,order_index:33,dataset_info:{features:["ユーザー年齢","ユーザー収入","ユーザー活動度","アイテム価格","アイテム評価","アイテムカテゴリ","アイテム人気度"],samples:3e3},created_at:new Date().toISOString()},{id:"modern_fraud_detection",name:"不正検出",daimyo:"セキュリティ",description:"取引データから不正な行為を検出し、金融システムの安全性を守る。",problem_type:"classification",problem_description:"取引の特徴から不正を検出する（不均衡データ）。",required_accuracy:.95,unlock_condition:null,difficulty:5,reward_xp:600,order_index:34,dataset_info:{features:["取引金額","時間","曜日","地域","店舗タイプ","ユーザー履歴","デバイスタイプ"],classes:["正常","不正"],samples:5e3},created_at:new Date().toISOString()}],Pa=(t,e)=>`samurai_${e}_${t}`;async function yg(){return Hw}async function Vw(t){const e={id:`user_${Date.now()}`,shogun_name:t,level:1,total_xp:0,title:"足軽",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return localStorage.setItem(Pa(e.id,"profile"),JSON.stringify(e)),e}async function gc(t){const e=localStorage.getItem(Pa(t,"progress"));return e?JSON.parse(e):[]}async function Nu(t,e,r){const n=await gc(t),a=n.findIndex(i=>i.region_id===e);a>=0?n[a]={...n[a],...r}:n.push({id:`progress_${e}`,user_id:t,region_id:e,is_unlocked:!1,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString(),...r}),localStorage.setItem(Pa(t,"progress"),JSON.stringify(n))}async function Gw(t,e){await Nu(t,e,{is_unlocked:!0})}async function Yw(){return[{id:"logistic_regression",name:"Logistic Regression",name_ja:"ロジスティック回帰",description:"線形分類器で、シンプルで理解しやすいモデルです。",category:"classification",unlock_level:1,icon:"TrendingUp",parameters_schema:{learning_rate:{type:"number",min:.001,max:.1,default:.01},max_iterations:{type:"number",min:10,max:1e3,default:100}},created_at:new Date().toISOString()},{id:"linear_regression",name:"Linear Regression",name_ja:"線形回帰",description:"連続値を予測する基本的な回帰モデルです。",category:"regression",unlock_level:1,icon:"BarChart",parameters_schema:{learning_rate:{type:"number",min:.001,max:.1,default:.01},max_iterations:{type:"number",min:10,max:1e3,default:100}},created_at:new Date().toISOString()},{id:"neural_network",name:"Neural Network",name_ja:"ニューラルネットワーク",description:"複雑なパターンを学習できる高度なモデルです。",category:"classification",unlock_level:2,icon:"Brain",parameters_schema:{hidden_layers:{type:"number",min:1,max:5,default:2},neurons_per_layer:{type:"number",min:4,max:128,default:16},learning_rate:{type:"number",min:.001,max:.1,default:.01},epochs:{type:"number",min:10,max:500,default:100}},created_at:new Date().toISOString()}]}async function Jw(t){const e=localStorage.getItem(Pa(t.user_id,"attempts")),r=e?JSON.parse(e):[],n={id:`attempt_${Date.now()}`,...t,created_at:new Date().toISOString()};r.push(n),localStorage.setItem(Pa(t.user_id,"attempts"),JSON.stringify(r))}async function Xw(t){const e=await yg();for(const r of e)await Nu(t,r.id,{is_unlocked:!0,is_completed:!1,best_accuracy:0,stars:0,attempts:0})}new Date().toISOString(),new Date().toISOString(),new Date().toISOString();new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString();new Date().toISOString(),new Date().toISOString();new Date().toISOString();const bg=v.createContext(null);function Zw({children:t}){const[e,r]=v.useState(null),[n,a]=v.useState([]),[i,s]=v.useState({}),[o,l]=v.useState([]),[d,c]=v.useState(!0),[h,f]=v.useState(null),[m,p]=v.useState("home"),[g,y]=v.useState(null),b=async _=>{try{f(null);const S=await Vw(_);r(S),await Xw(S.id),await x()}catch(S){console.error("Failed to initialize user:",S),f("ユーザーの初期化に失敗しました。もう一度お試しください。")}},x=async()=>{if(e)try{f(null);const _=await gc(e.id),S={};for(const j of n){const N=_.find(O=>O.region_id===j.id),M=w(j,S,n);N?S[j.id]={...N,is_unlocked:M}:S[j.id]={id:`progress_${j.id}`,user_id:e.id,region_id:j.id,is_unlocked:M,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString()}}s(S)}catch(_){console.error("Failed to refresh progress:",_),f("進捗データの取得に失敗しました。")}},w=(_,S,j)=>{if(!_.unlock_condition||S[_.unlock_condition]?.is_completed)return!0;const M=_.difficulty-1;return!!(M>0&&j.filter(P=>P.difficulty===M).every(P=>S[P.id]?.is_completed||!1))};return v.useEffect(()=>{(async()=>{try{console.log("useGameState: データ読み込み開始"),c(!0),f(null),console.log("useGameState: getRegions()を呼び出し");const S=await yg();console.log("useGameState: getRegions()完了:",S?.length),console.log("useGameState: getMLModels()を呼び出し");const j=await Yw();if(console.log("useGameState: getMLModels()完了:",j?.length),!S||S.length===0)throw console.error("useGameState: 地域データが空です"),new Error("No regions data available");if(!j||j.length===0)throw console.error("useGameState: モデルデータが空です"),new Error("No models data available");a(S),l(j);const N=JSON.parse(localStorage.getItem("samurai_current_user")||"null");if(N){const M={id:N.id,shogun_name:N.username,title:N.title||"足軽",level:N.level||1,total_xp:N.experience||0,created_at:N.createdAt||new Date().toISOString(),updated_at:new Date().toISOString()};r(M);const O=await gc(M.id),T={};for(const P of S){const k=O.find(I=>I.region_id===P.id),D=w(P,T,S);k?T[P.id]={...k,is_unlocked:D}:T[P.id]={id:`progress_${P.id}`,user_id:M.id,region_id:P.id,is_unlocked:D,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString()}}s(T)}else{const M={id:"mock_user",shogun_name:"テスト将軍",level:1,total_xp:0,title:"足軽",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};r(M);const O={};for(const T of S){const P=w(T,O,S);O[T.id]={id:`progress_${T.id}`,user_id:M.id,region_id:T.id,is_unlocked:P,is_completed:!1,best_accuracy:0,stars:0,attempts:0,first_completed_at:null,last_attempt_at:null,created_at:new Date().toISOString()}}s(O)}}catch(S){console.error("useGameState: データ読み込みエラー:",S),S instanceof Error?S.message==="Timeout"?f("データの読み込みに時間がかかりすぎています。ネットワーク接続を確認してください。"):S.message.includes("No regions")||S.message.includes("No models")?f("データベースが空です。管理者に連絡してください。"):f(`データの読み込みに失敗しました: ${S.message}`):f(`予期しないエラーが発生しました: ${String(S)}`)}finally{console.log("useGameState: データ読み込み完了、loading=false"),c(!1)}})()},[]),v.useEffect(()=>{e&&localStorage.setItem("samurai_user_id",e.id)},[e]),u.jsx(bg.Provider,{value:{user:e,regions:n,progress:i,models:o,loading:d,error:h,currentView:m,selectedRegion:g,setCurrentView:p,setSelectedRegion:y,initializeUser:b,refreshProgress:x},children:t})}function Ms(){const t=v.useContext(bg);if(!t)throw new Error("useGameState must be used within GameProvider");return t}function Qw({onComplete:t,durationScale:e=1.3}){const[r,n]=v.useState(0),[a,i]=v.useState(!1),[s,o]=v.useState(!1),[l,d]=v.useState(!1),[c,h]=v.useState(!1),[f,m]=v.useState(!1),p=v.useMemo(()=>["Data is the sword of the 21st century,","those who wield it well, the Samurai."],[]),g=v.useMemo(()=>["データは21世紀の刀、","それを使いこなす者こそ、侍。"],[]),[y,b]=v.useState(["",""]),[x,w]=v.useState(["",""]),[_,S]=v.useState(!1),[j,N]=v.useState(!1);v.useEffect(()=>{if(typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches){t();return}const T=[],P=(D,I)=>{const z=window.setTimeout(D,I);T.push(z)},k=[200].map(D=>Math.round(D*e));return P(()=>i(!0),k[0]),P(()=>n(1),k[0]),()=>{T.forEach(D=>clearTimeout(D))}},[e,t]),v.useEffect(()=>{if(r!==1)return;let O=0,T=0,P=0;const k=setInterval(()=>{P===0?O<=p[0].length?(b(D=>[p[0].slice(0,O),D[1]]),w(D=>[g[0].slice(0,Math.min(T,g[0].length)),D[1]]),O++,T=Math.floor(O*.3)):(P=1,O=0,T=0):P===1&&(O<=p[1].length?(b(D=>[D[0],p[1].slice(0,O)]),w(D=>[D[0],g[1].slice(0,Math.min(Math.floor(O*.43),g[1].length))]),O++):(clearInterval(k),N(!0),setTimeout(()=>S(!0),1e3)))},Math.max(40,70*e));return()=>clearInterval(k)},[r,e,p,g]),v.useEffect(()=>{j&&console.log("タイプライタ完了。ユーザーのクリックを待機中...")},[j,t]),v.useEffect(()=>{r===2&&(console.log("タイトル表示画面に到達。フェードインを開始します..."),setTimeout(()=>{console.log("フェードインを開始します"),console.log("titleFadeIn状態:",l),h(!0),setTimeout(()=>{d(!0),console.log("setTitleFadeIn(true)を実行しました"),setTimeout(()=>{console.log("タイトル表示完了。ホーム画面に自動遷移します..."),t()},7e3)},100)},500))},[r,t]),v.useEffect(()=>{if(r===2){console.log("タイトル表示画面に到達しました。ユーザーインタラクション後なので確実に音声を再生します...");const O=()=>{try{const T=new Audio("./audio/拍子木3.mp3");T.volume=.8,T.preload="auto",console.log("🎵 音声ファイルを読み込み中...");const P=T.play();P!==void 0&&P.then(()=>{console.log("🎵 拍子木の音が再生されました！"),m(!0)}).catch(k=>{console.log("音声再生に失敗しました:",k)})}catch(T){console.log("音声の初期化に失敗しました:",T)}};setTimeout(()=>{console.log("🎵 タイトル表示画面で音声を再生します..."),O()},200)}},[r]),v.useEffect(()=>{const O=T=>{T.key==="Escape"&&t()};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[t]);const M=()=>{if(console.log("スキップボタンがクリックされました"),s){console.log("既にスキップ処理中です");return}o(!0),console.log("スキップ処理を開始します");try{const O=new Audio("./audio/拍子木3.mp3");O.volume=.8,O.preload="auto",console.log("🎵 スキップ時に音声を再生します...");const T=O.play();T!==void 0&&T.then(()=>{console.log("🎵 スキップ時に拍子木の音が再生されました！"),m(!0)}).catch(P=>{console.warn("スキップ時の音声再生に失敗:",P)})}catch(O){console.warn("スキップ時の音声初期化に失敗:",O)}setTimeout(()=>{console.log("イントロを完了します"),t()},100)};return u.jsx("div",{className:"h-screen",style:{background:"#404040"},children:u.jsxs("div",{className:"w-full h-full flex items-center justify-center p-4 relative overflow-hidden",children:[u.jsx("button",{onClick:M,className:"absolute top-4 right-4 text-sm px-3 py-1 rounded-lg transition-colors",style:{color:"white",background:"rgba(255,255,255,0.2)",border:"1px solid var(--gold)"},"aria-label":"イントロをスキップ（音声再生）",children:r===2&&!f?"🎵 音声付きでスキップ":"スキップ"}),u.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`
            radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 70%, rgba(255,255,255,0.05) 0%, transparent 50%),
            radial-gradient(circle at 40% 80%, rgba(255,255,255,0.08) 0%, transparent 50%),
            repeating-linear-gradient(
              0deg,
              transparent 0px,
              rgba(255,255,255,0.02) 1px,
              transparent 2px,
              rgba(0,0,0,0.02) 3px,
              transparent 4px
            )
          `,animation:"noise 0.2s steps(8) infinite"}}),u.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((O,T)=>u.jsx("div",{className:"absolute w-0.5 h-0.5 rounded-full animate-pulse",style:{background:"var(--gold)",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*4}s`,opacity:.8}},T))}),u.jsxs("div",{className:`text-center z-10 transition-all duration-1000 ${a?"opacity-100":"opacity-0"}`,children:[r===1&&u.jsxs("div",{className:"fixed inset-0 w-full h-full flex items-center justify-center",style:{background:"#404040"},children:[u.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`
                  repeating-linear-gradient(
                    0deg,
                    transparent 0px,
                    rgba(0,0,0,0.3) 0.5px,
                    transparent 1px,
                    rgba(0,0,0,0.4) 1.5px,
                    transparent 2px,
                    rgba(0,0,0,0.2) 2.5px,
                    transparent 3px,
                    rgba(0,0,0,0.5) 3.5px,
                    transparent 4px,
                    rgba(0,0,0,0.1) 4.5px,
                    transparent 5px
                  ),
                  repeating-linear-gradient(
                    90deg,
                    transparent 0px,
                    rgba(0,0,0,0.25) 0.3px,
                    transparent 0.8px,
                    rgba(0,0,0,0.35) 1.3px,
                    transparent 1.8px,
                    rgba(0,0,0,0.15) 2.3px,
                    transparent 2.8px,
                    rgba(0,0,0,0.45) 3.3px,
                    transparent 3.8px
                  ),
                  repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    rgba(0,0,0,0.2) 0.2px,
                    transparent 0.6px,
                    rgba(0,0,0,0.3) 1.1px,
                    transparent 1.6px,
                    rgba(0,0,0,0.1) 2.1px,
                    transparent 2.6px
                  ),
                  repeating-linear-gradient(
                    135deg,
                    transparent 0px,
                    rgba(0,0,0,0.18) 0.1px,
                    transparent 0.5px,
                    rgba(0,0,0,0.28) 1px,
                    transparent 1.5px,
                    rgba(0,0,0,0.08) 2px,
                    transparent 2.5px
                  )
                `,animation:"tvNoise 0.005s steps(1) infinite"}}),u.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`
                  radial-gradient(circle at 5% 10%, rgba(0,0,0,0.4) 0%, transparent 0.2px),
                  radial-gradient(circle at 15% 25%, rgba(0,0,0,0.5) 0%, transparent 0.1px),
                  radial-gradient(circle at 25% 40%, rgba(0,0,0,0.3) 0%, transparent 0.3px),
                  radial-gradient(circle at 35% 55%, rgba(0,0,0,0.6) 0%, transparent 0.15px),
                  radial-gradient(circle at 45% 70%, rgba(0,0,0,0.35) 0%, transparent 0.4px),
                  radial-gradient(circle at 55% 15%, rgba(0,0,0,0.7) 0%, transparent 0.08px),
                  radial-gradient(circle at 65% 30%, rgba(0,0,0,0.25) 0%, transparent 0.6px),
                  radial-gradient(circle at 75% 45%, rgba(0,0,0,0.55) 0%, transparent 0.2px),
                  radial-gradient(circle at 85% 60%, rgba(0,0,0,0.45) 0%, transparent 0.35px),
                  radial-gradient(circle at 95% 75%, rgba(0,0,0,0.65) 0%, transparent 0.12px)
                `,animation:"tvNoise 0.003s steps(1) infinite"}}),u.jsxs("div",{className:"space-y-8 w-full px-4 relative z-10",style:{maxWidth:"90vw"},children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"text-3xl font-bold leading-relaxed",style:{color:"#ffffff",textShadow:"0 0 5px #ffffff, 0 0 10px #ffffff, 0 0 15px #ffffff, 0 0 20px #ffffff",fontFamily:"monospace",textAlign:"center",fontWeight:"bold"},children:y[0]}),u.jsx("div",{className:"text-lg font-medium leading-relaxed",style:{color:"#cccccc",textShadow:"0 0 3px #cccccc, 0 0 6px #cccccc, 0 0 9px #cccccc",fontFamily:"monospace",textAlign:"center",whiteSpace:"nowrap"},children:x[0]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"text-3xl font-bold leading-relaxed",style:{color:"#ffffff",textShadow:"0 0 5px #ffffff, 0 0 10px #ffffff, 0 0 15px #ffffff, 0 0 20px #ffffff",fontFamily:"monospace",textAlign:"center",fontWeight:"bold"},children:y[1]}),u.jsx("div",{className:"text-lg font-medium leading-relaxed",style:{color:"#cccccc",textShadow:"0 0 3px #cccccc, 0 0 6px #cccccc, 0 0 9px #cccccc",fontFamily:"monospace",textAlign:"center",whiteSpace:"nowrap"},children:x[1]})]})]}),_&&u.jsxs("div",{className:`transition-all duration-3000 mt-6 ${_?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[u.jsx("p",{className:"text-xl font-light text-center",style:{color:"#999999",textShadow:"0 0 3px #999999, 0 0 6px #999999",fontFamily:"monospace"},children:"— Jonathan Rosenberg"}),u.jsx("div",{className:"mt-8",children:u.jsx("button",{onClick:()=>{console.log("ユーザーがクリックしました。タイトル画面に遷移します..."),n(2),h(!0),setTimeout(()=>{d(!0),console.log("setTitleFadeIn(true)を実行しました")},100)},className:"px-6 py-3 rounded-lg transition-all duration-300 hover:scale-105",style:{background:"linear-gradient(135deg, var(--accent-strong) 0%, var(--accent) 100%)",color:"white",border:"2px solid var(--gold)",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",fontFamily:"monospace",fontSize:"16px",fontWeight:"bold"},children:"開始"})})]})]})]}),r===2&&u.jsxs("div",{className:"fixed inset-0 w-full h-full flex items-center justify-center",style:{background:"linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%)"},children:[u.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[...Array(40)].map((O,T)=>{const P=Math.random()*7+4,k=Math.random()*120-10,D=Math.random()*30-30,I=6,z=Math.random()*3,H=Math.random()*360,K=Math.random()*.2+.2;return u.jsx("div",{className:"absolute",style:{left:`${k}%`,top:`${D}%`,width:`${P}px`,height:`${P}px`,background:"radial-gradient(circle at 30% 30%, #ffb3d1, #ff69b4, #ff1493)",borderRadius:"50% 10% 50% 10%",transform:`rotate(${H}deg)`,animation:`sakura6Sec ${I}s linear forwards`,animationDelay:`${z}s`,opacity:K,boxShadow:"0 0 8px rgba(255, 105, 180, 0.3)",filter:"blur(0.5px)"}},T)})}),u.jsxs("div",{className:"space-y-8",style:{opacity:c&&l?1:0,transform:c&&l?"translateY(0) scale(1)":"translateY(12px) scale(0.95)",transition:c?"opacity 6s ease-out 0s, transform 6s ease-out 0s":"none",willChange:"opacity, transform"},children:[u.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-8",children:[u.jsx(Sw,{className:"w-16 h-16",style:{color:"#D4AF37",filter:"drop-shadow(0 0 8px rgba(212, 175, 55, 0.6))",transition:c?"opacity 6s ease-out 0s, transform 6s ease-out 0s":"none",opacity:c&&l?1:0,transform:c&&l?"scale(1) rotate(0deg)":"scale(0.8) rotate(-5deg)",willChange:"opacity, transform"}}),u.jsx("h1",{className:"text-6xl font-bold text-white tracking-wider",style:{textShadow:"0 0 20px rgba(255,255,255,0.8)",transition:c?"opacity 6s ease-out 0s, transform 6s ease-out 0s":"none",opacity:c&&l?1:0,transform:c&&l?"translateY(0) scale(1)":"translateY(20px) scale(0.9)",willChange:"opacity, transform"},children:"samurAI"})]}),u.jsx("p",{className:"text-2xl text-white/90 font-light tracking-wide",style:{textShadow:"0 0 10px rgba(255,255,255,0.6)",transition:c?"opacity 6s ease-out 0.5s, transform 6s ease-out 0.5s":"none",opacity:c&&l?1:0,transform:c&&l?"translateY(0) scale(1)":"translateY(15px) scale(0.95)",willChange:"opacity, transform"},children:"機械学習で天下統一"})]})]})]})]})})}class e1{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=e.map(c=>c.features),l=e.map(c=>c.label);if(!o[0]||!Array.isArray(o[0]))throw new Error("特徴量が配列ではありません");const d=o[0].length;this.weights=new Array(d).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=0,console.log(`ロジスティック回帰学習開始: ${e.length}サンプル, ${d}特徴量, ${i}エポック`);for(let c=0;c<i;c++){let h=0,f=0;for(let m=0;m<o.length;m++){const p=this.sigmoid(this.dotProduct(o[m],this.weights)+this.bias),g=l[m]-p;if(isFinite(g)&&isFinite(p)){for(let y=0;y<this.weights.length;y++)this.weights[y]+=s*g*o[m][y];this.bias+=s*g,h+=g*g,f++}}if(n){const m=f>0?h/f:0,p=this.calculateAccuracy(o,l),g=(c+1)/i*100,y=Date.now()-a;n({epoch:c+1,total:i,message:`ロジスティック回帰 - エポック ${c+1}/${i} (${g.toFixed(1)}%)`,loss:isFinite(m)?m:0,accuracy:isFinite(p)?p:0,progress:Math.round(g),elapsed:y,eta:Math.round(y/(c+1)*(i-c-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`ロジスティック回帰学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.sigmoid(this.dotProduct(e,this.weights)+this.bias)}evaluate(e){const r=e.map(d=>d.features),n=e.map(d=>d.label),a=r.map(d=>this.predict(d)),i=this.calculateAccuracyFromPredictions(a,n),{precision:s,recall:o,f1_score:l}=this.calculateMetrics(a,n);return{accuracy:i,training_time:this.trainingTime,precision:s,recall:o,f1_score:l,predictions:a,actual:n}}dotProduct(e,r){return e.reduce((n,a,i)=>n+a*r[i],0)}sigmoid(e){return 1/(1+Math.exp(-e))}calculateAccuracy(e,r){if(e.length===0||e.length!==r.length)return 0;let n=0;for(let i=0;i<e.length;i++)(this.sigmoid(this.dotProduct(e[i],this.weights)+this.bias)>.5?1:0)===r[i]&&n++;const a=n/e.length;return isNaN(a)?0:a}calculateAccuracyFromPredictions(e,r){if(e.length===0||e.length!==r.length)return 0;let n=0;for(let i=0;i<e.length;i++)(e[i]>.5?1:0)===r[i]&&n++;const a=n/e.length;return isNaN(a)?0:a}calculateMetrics(e,r){let n=0,a=0,i=0;for(let d=0;d<e.length;d++){const c=e[d]>.5?1:0;c===1&&r[d]===1&&n++,c===1&&r[d]===0&&a++,c===0&&r[d]===1&&i++}const s=n/(n+a)||0,o=n/(n+i)||0,l=2*(s*o)/(s+o)||0;return{precision:s,recall:o,f1_score:l}}}class t1{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=e.map(c=>c.features),l=e.map(c=>c.label);if(!o[0]||!Array.isArray(o[0]))throw new Error("特徴量が配列ではありません");const d=o[0].length;this.weights=new Array(d).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=0,console.log(`線形回帰学習開始: ${e.length}サンプル, ${d}特徴量, ${i}エポック`);for(let c=0;c<i;c++){let h=0,f=0;for(let m=0;m<o.length;m++){const p=this.dotProduct(o[m],this.weights)+this.bias,g=l[m]-p;if(isFinite(g)&&isFinite(p)){for(let y=0;y<this.weights.length;y++)this.weights[y]+=s*g*o[m][y];this.bias+=s*g,h+=g*g,f++}}if(n){const m=f>0?h/f:0,p=this.calculateR2(o,l),g=(c+1)/i*100,y=Date.now()-a;n({epoch:c+1,total:i,message:`線形回帰 - エポック ${c+1}/${i} (${g.toFixed(1)}%)`,loss:isFinite(m)?m:0,accuracy:isFinite(p)?p:0,progress:Math.round(g),elapsed:y,eta:Math.round(y/(c+1)*(i-c-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`線形回帰学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.dotProduct(e,this.weights)+this.bias}evaluate(e){const r=e.map(o=>o.features),n=e.map(o=>o.label),a=r.map(o=>this.predict(o)),i=this.calculateR2(r,n),s=this.calculateMAE(a,n);return{accuracy:Math.max(0,i),training_time:this.trainingTime,precision:1-s,recall:1-s,f1_score:1-s,predictions:a,actual:n}}dotProduct(e,r){return e.reduce((n,a,i)=>n+a*r[i],0)}calculateR2(e,r){if(e.length===0)return 0;const n=e.map(l=>this.dotProduct(l,this.weights)+this.bias),a=r.reduce((l,d)=>l+d,0)/r.length,i=n.reduce((l,d,c)=>l+Math.pow(r[c]-d,2),0),s=r.reduce((l,d)=>l+Math.pow(d-a,2),0);if(s===0)return 1;const o=1-i/s;return Math.max(0,Math.min(1,o))}calculateMAE(e,r){return e.reduce((n,a,i)=>n+Math.abs(a-r[i]),0)/e.length}}class r1{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=e.map(c=>c.features),l=e.map(c=>c.label);if(!o[0]||!Array.isArray(o[0]))throw new Error("特徴量が配列ではありません");const d=o[0].length;this.weights=new Array(d).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=(Math.random()-.5)*.1,console.log(`ニューラルネットワーク学習開始: ${e.length}サンプル, ${d}特徴量, ${i}エポック`);for(let c=0;c<i;c++){let h=0;for(let f=0;f<o.length;f++){const m=this.forward(o[f]),p=l[f]-m;for(let g=0;g<this.weights.length;g++)this.weights[g]+=s*p*o[f][g];this.bias+=s*p,h+=p*p}if(n){const f=(c+1)/i*100,m=Date.now()-a;n({epoch:c+1,total:i,message:`ニューラルネットワーク - エポック ${c+1}/${i} (${f.toFixed(1)}%)`,loss:h/o.length,accuracy:this.calculateAccuracy(o,l),progress:Math.round(f),elapsed:m,eta:Math.round(m/(c+1)*(i-c-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`ニューラルネットワーク学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.forward(e)}evaluate(e){const r=e.map(d=>d.features),n=e.map(d=>d.label),a=r.map(d=>this.predict(d)),i=this.calculateAccuracyFromPredictions(a,n),{precision:s,recall:o,f1_score:l}=this.calculateMetrics(a,n);return{accuracy:i,training_time:this.trainingTime,precision:s,recall:o,f1_score:l,predictions:a,actual:n}}forward(e){let r=0;for(let n=0;n<e.length;n++)r+=e[n]*this.weights[n];return this.sigmoid(r+this.bias)}sigmoid(e){return 1/(1+Math.exp(-e))}calculateAccuracy(e,r){let n=0;for(let a=0;a<e.length;a++)(this.forward(e[a])>.5?1:0)===r[a]&&n++;return n/e.length}calculateAccuracyFromPredictions(e,r){if(e.length===0||e.length!==r.length)return 0;let n=0;for(let i=0;i<e.length;i++)(e[i]>.5?1:0)===r[i]&&n++;const a=n/e.length;return isNaN(a)?0:a}calculateMetrics(e,r){let n=0,a=0,i=0;for(let d=0;d<e.length;d++){const c=e[d]>.5?1:0;c===1&&r[d]===1&&n++,c===1&&r[d]===0&&a++,c===0&&r[d]===1&&i++}const s=n/(n+a)||0,o=n/(n+i)||0,l=2*(s*o)/(s+o)||0;return{precision:s,recall:o,f1_score:l}}}class n1{trainingData=[];k=3;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now();this.k=r.k||3,this.trainingData=e.map(i=>({features:i.features,label:i.label})),this.isTrained=!0,this.trainingTime=Date.now()-a,console.log(`KNN学習完了: ${e.length}サンプル, k=${this.k}, ${this.trainingTime}ms`),n&&n({epoch:1,total:1,message:`KNN学習完了 - ${e.length}サンプル, k=${this.k}`,loss:0,accuracy:1,progress:100,elapsed:this.trainingTime,eta:0})}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");const r=this.trainingData.map(o=>({distance:this.euclideanDistance(e,o.features),label:o.label}));r.sort((o,l)=>o.distance-l.distance);const n=r.slice(0,this.k);if(typeof n[0].label=="number")return n.reduce((l,d)=>l+d.label,0)/n.length;const a={};n.forEach(o=>{const l=String(o.label);a[l]=(a[l]||0)+1});let i=0,s=n[0].label;for(const[o,l]of Object.entries(a))l>i&&(i=l,s=Number(o));return s}evaluate(e){const r=e.map(s=>s.features),n=e.map(s=>s.label),a=r.map(s=>this.predict(s)),i=this.calculateAccuracy(a,n);return{accuracy:i,training_time:this.trainingTime,precision:i,recall:i,f1_score:i,predictions:a,actual:n}}euclideanDistance(e,r){if(e.length!==r.length)throw new Error("特徴量の次元が一致しません");let n=0;for(let a=0;a<e.length;a++)n+=Math.pow(e[a]-r[a],2);return Math.sqrt(n)}calculateAccuracy(e,r){if(e.length===0||e.length!==r.length)return 0;let n=0;for(let i=0;i<e.length;i++)Math.abs(e[i]-r[i])<.1&&n++;const a=n/e.length;return isNaN(a)?0:a}}class a1{weights=[];bias=0;isTrained=!1;trainingTime=0;async train(e,r,n){if(!Array.isArray(e)||e.length===0)throw new Error("データが配列ではありませんまたは空です");const a=Date.now(),i=r.epochs||100,s=r.learningRate||.01,o=r.C||1,l=e.map(h=>h.features),d=e.map(h=>h.label);if(!l[0]||!Array.isArray(l[0]))throw new Error("特徴量が配列ではありません");const c=l[0].length;this.weights=new Array(c).fill(0).map(()=>(Math.random()-.5)*.1),this.bias=0,console.log(`SVM学習開始: ${e.length}サンプル, ${c}特徴量, ${i}エポック, C=${o}`);for(let h=0;h<i;h++){let f=0,m=0;for(let p=0;p<l.length;p++){const g=this.dotProduct(l[p],this.weights)+this.bias,y=d[p]===0?-1:1,b=Math.max(0,1-y*g);if(b>0){for(let x=0;x<this.weights.length;x++)this.weights[x]+=s*(y*l[p][x]-o*this.weights[x]);this.bias+=s*y}else for(let x=0;x<this.weights.length;x++)this.weights[x]-=s*o*this.weights[x];f+=b,m++}if(n){const p=m>0?f/m:0,g=this.calculateAccuracy(l,d),y=(h+1)/i*100,b=Date.now()-a;n({epoch:h+1,total:i,message:`SVM - エポック ${h+1}/${i} (${y.toFixed(1)}%)`,loss:isFinite(p)?p:0,accuracy:isFinite(g)?g:0,progress:Math.round(y),elapsed:b,eta:Math.round(b/(h+1)*(i-h-1))})}}this.trainingTime=Date.now()-a,this.isTrained=!0,console.log(`SVM学習完了: ${this.trainingTime}ms`)}predict(e){if(!this.isTrained)throw new Error("モデルが学習されていません");return this.dotProduct(e,this.weights)+this.bias>0?1:0}evaluate(e){const r=e.map(d=>d.features),n=e.map(d=>d.label),a=r.map(d=>this.predict(d)),i=this.calculateAccuracyFromPredictions(a,n),{precision:s,recall:o,f1_score:l}=this.calculateMetrics(a,n);return{accuracy:i,training_time:this.trainingTime,precision:s,recall:o,f1_score:l,predictions:a,actual:n}}dotProduct(e,r){return e.reduce((n,a,i)=>n+a*r[i],0)}calculateAccuracy(e,r){if(e.length===0)return 0;let n=0;for(let a=0;a<e.length;a++)(this.dotProduct(e[a],this.weights)+this.bias>0?1:0)===r[a]&&n++;return n/e.length}calculateAccuracyFromPredictions(e,r){let n=0;for(let a=0;a<e.length;a++)e[a]===r[a]&&n++;return n/e.length}calculateMetrics(e,r){let n=0,a=0,i=0;for(let d=0;d<e.length;d++)e[d]===1&&r[d]===1&&n++,e[d]===1&&r[d]===0&&a++,e[d]===0&&r[d]===1&&i++;const s=n/(n+a)||0,o=n/(n+i)||0,l=2*(s*o)/(s+o)||0;return{precision:s,recall:o,f1_score:l}}}function $i(t){switch(t){case"logistic_regression":return new e1;case"linear_regression":return new t1;case"neural_network":return new r1;case"knn":return new n1;case"svm":return new a1;default:throw new Error(`未知のモデルタイプ: ${t}`)}}class Rh{static async trainModel(e,r,n){const a=Date.now();try{console.log("動的学習システム開始:",{datasetSize:e.train.length,modelType:r.modelType,selectedFeatures:r.selectedFeatures,parameters:r.parameters});const{train:i,validation:s,test:o}=this.splitData(e,r.dataSplit);console.log("データ分割完了:",{trainSize:i.length,validationSize:s.length,testSize:o.length});const l=i.map(p=>({features:r.selectedFeatures.map(g=>p.features[g]),label:p.label})),d=o.map(p=>({features:r.selectedFeatures.map(g=>p.features[g]),label:p.label}));console.log("モデル作成中:",r.modelType);const c=$i(r.modelType);console.log("モデル作成完了:",c.constructor.name),console.log("学習開始:",{trainDataSize:l.length,parameters:r.parameters}),await c.train(l,r.parameters,n),console.log("学習完了"),console.log("評価開始:",{testDataSize:d.length});const h=c.evaluate(d);console.log("評価結果:",{accuracy:h.accuracy,loss:h.loss,precision:h.precision,recall:h.recall,f1_score:h.f1_score});const f=Date.now()-a,m={validationScore:h.accuracy,testScore:h.accuracy,metrics:this.buildMetrics(h,r.evaluationMetrics),predictions:h.predictions,actual:h.actual,trainingTime:f/1e3,config:r};return{model:c,result:h,trainingTime:f,evaluation:m,config:r}}catch(i){throw console.error("動的学習エラー:",{error:i,message:i instanceof Error?i.message:"Unknown error",stack:i instanceof Error?i.stack:void 0,config:r}),i}}static splitData(e,r){const{trainRatio:n,validationRatio:a,testRatio:i,randomSeed:s,stratified:o}=r,l=Math.random;s!==void 0&&(Math.random=()=>{const g=Math.sin(s)*1e4;return g-Math.floor(g)});const c=[...[...e.train,...e.test]].sort(()=>Math.random()-.5);if(o&&e.classes&&e.classes.length>0){const g=this.stratifiedSplit(c,n,a,i);return Math.random=l,g}const h=c.length,f=Math.floor(h*n),m=Math.floor(h*a),p={train:c.slice(0,f),validation:c.slice(f,f+m),test:c.slice(f+m)};return Math.random=l,p}static stratifiedSplit(e,r,n,a){const i={};e.forEach(d=>{const c=d.label.toString();i[c]||(i[c]=[]),i[c].push(d)});const s=[],o=[],l=[];return Object.values(i).forEach(d=>{const c=d.length,h=Math.floor(c*r),f=Math.floor(c*n),m=[...d].sort(()=>Math.random()-.5);s.push(...m.slice(0,h)),o.push(...m.slice(h,h+f)),l.push(...m.slice(h+f))}),{train:s,validation:o,test:l}}static buildMetrics(e,r){const n={};return r.forEach(a=>{switch(a){case"accuracy":n.accuracy=e.accuracy;break;case"precision":n.precision=e.precision;break;case"recall":n.recall=e.recall;break;case"f1_score":n.f1_score=e.f1_score;break;case"mae":n.mae=e.accuracy;break;case"mse":n.mse=e.accuracy;break;case"rmse":n.rmse=e.accuracy;break}}),n}static async batchTrain(e,r,n){const a=[];for(let i=0;i<r.length;i++)try{const s=await this.trainModel(e,r[i]);a.push(s),n&&n({current:i+1,total:r.length,result:s})}catch(s){console.error(`設定${i+1}の学習に失敗:`,s)}return a}static generateLearningConfigs(e,r,n,a,i){const s=[];return e.forEach(o=>{r.forEach(l=>{(n[o]||[{}]).forEach(c=>{i.forEach(h=>{s.push({modelType:o,parameters:c,selectedFeatures:l,evaluationMetrics:a,dataSplit:h})})})})}),s}}class Pn{static instance;currentUser=null;static getInstance(){return Pn.instance||(Pn.instance=new Pn),Pn.instance}getCurrentUser(){return this.currentUser}setUser(e){this.currentUser=e,this.saveUserToStorage()}loginUser(e,r){const n=this.loadUserFromStorage();if(n&&n.username===e)return this.currentUser=n,this.updateLastActive(),n;const a={id:this.generateUserId(),username:e,email:r,avatar:this.generateAvatar(e),createdAt:new Date().toISOString(),lastActiveAt:new Date().toISOString(),totalBattles:0,wins:0,losses:0,winRate:0,bestScore:0,currentStreak:0};return this.currentUser=a,this.saveUserToStorage(),a}logoutUser(){this.currentUser=null,localStorage.removeItem("currentUser")}updateBattleResult(e,r){if(!this.currentUser)return;const n=this.currentUser;n.totalBattles++,e?(n.wins++,n.currentStreak++):(n.losses++,n.currentStreak=0),n.winRate=n.totalBattles>0?n.wins/n.totalBattles:0,r>n.bestScore&&(n.bestScore=r),this.updateUser(n)}generateUserId(){const e=Date.now().toString(36),r=Math.random().toString(36).substr(2,5);return`user_${e}_${r}`}generateAvatar(e){const r=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8"],n=e.charCodeAt(0)%r.length;return r[n]}updateUser(e){this.currentUser=e,this.saveUserToStorage()}updateLastActive(){this.currentUser&&(this.currentUser.lastActiveAt=new Date().toISOString(),this.saveUserToStorage())}saveUserToStorage(){this.currentUser&&localStorage.setItem("currentUser",JSON.stringify(this.currentUser))}loadUserFromStorage(){try{const e=localStorage.getItem("currentUser");return e?JSON.parse(e):null}catch(e){return console.error("ユーザーデータの読み込みに失敗:",e),null}}getLevelInfo(){return{level:1,experience:0,nextLevelExp:0,progress:0}}}const Tt=Pn.getInstance();class Lh{static getRecommendedModel(e){return e<3?"logistic_regression":e<5?"linear_regression":"neural_network"}static getRecommendedFeatures(e,r){const n=Math.min(3+r,e.featureNames.length),a=[],s=this.calculateFeatureImportance(e).map((o,l)=>({index:l,importance:o})).sort((o,l)=>l.importance-o.importance);for(let o=0;o<n&&o<s.length;o++)a.push(s[o].index);return a}static calculateFeatureImportance(e){const r=[];for(let n=0;n<e.featureNames.length;n++){const a=e.train.map(o=>o.features[n]),i=this.calculateVariance(a),s=this.calculateCorrelation(a,e.train.map(o=>o.label));r.push(i*Math.abs(s))}return r}static calculateVariance(e){const r=e.reduce((a,i)=>a+i,0)/e.length;return e.reduce((a,i)=>a+Math.pow(i-r,2),0)/e.length}static calculateCorrelation(e,r){if(e.length!==r.length)return 0;const n=r.map(f=>typeof f=="string"?f.charCodeAt(0):f),a=e.length,i=e.reduce((f,m)=>f+m,0),s=n.reduce((f,m)=>f+m,0),o=e.reduce((f,m,p)=>f+m*n[p],0),l=e.reduce((f,m)=>f+m*m,0),d=n.reduce((f,m)=>f+m*m,0),c=a*o-i*s,h=Math.sqrt((a*l-i*i)*(a*d-s*s));return h===0?0:c/h}static analyzeUserStrengths(e){const r=[],n=[];return e.winRate>.8?r.push("high_accuracy"):e.winRate<.5&&n.push("low_accuracy"),e.averageTrainingTime<30?r.push("fast_learning"):e.averageTrainingTime>120&&n.push("slow_learning"),e.preferredModel==="neural_network"?r.push("advanced_models"):e.preferredModel==="logistic_regression"&&n.push("basic_models"),{strengths:r,weaknesses:n}}static adjustProblemDifficulty(e,r){return r>.9?this.increaseDifficulty(e):r<.6?this.decreaseDifficulty(e):e}static increaseDifficulty(e){const r=["modern_fraud_detection","modern_image_classification"];return r[Math.floor(Math.random()*r.length)]}static decreaseDifficulty(e){const r=["modern_stock_prediction","modern_sentiment_analysis"];return r[Math.floor(Math.random()*r.length)]}static getRecommendedParameters(e,r){const a={...{logistic_regression:{learning_rate:.01,max_iterations:100,regularization:.1},linear_regression:{learning_rate:.001,max_iterations:200,regularization:.01},neural_network:{learning_rate:.001,max_iterations:300,hidden_layers:2,neurons_per_layer:64}}[e]};return r>5&&(a.learning_rate*=.5,a.max_iterations*=1.5),a}static getLearningTips(e,r){const a={data:["データの分布を確認して、異常値がないかチェックしましょう","特徴量間の相関を確認して、重複する情報がないか見てみましょう"],preprocessing:["数値データは正規化して、スケールを統一しましょう","カテゴリデータは適切にエンコーディングしましょう"],features:["重要度の高い特徴量を優先的に選択しましょう","特徴量が多すぎると過学習の原因になります"],model:["シンプルなモデルから始めて、徐々に複雑にしていきましょう","パラメータはデフォルト値から始めて調整しましょう"],train:["学習曲線を確認して、過学習していないかチェックしましょう","バリデーション精度が向上しない場合は、学習を停止しましょう"]}[e]||[];return r>3&&a.push("高度なテクニック: アンサンブル学習を試してみましょう"),a}}const i1="modulepreload",s1=function(t){return"/samurai-ml-education-game/"+t},Bh={},zn=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){let l=function(d){return Promise.all(d.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=s?.nonce||s?.getAttribute("nonce");a=l(r.map(d=>{if(d=s1(d),d in Bh)return;Bh[d]=!0;const c=d.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":i1,c||(f.as="script"),f.crossOrigin="",f.href=d,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((m,p)=>{f.addEventListener("load",m),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};class o1{static createCompetitionDataset(e,r,n,a,i){const s=this.shuffleArray([...e]),o=Math.floor(s.length*.7),l=Math.floor(s.length*.15),d=s.slice(0,o),c=s.slice(o,o+l),h=s.slice(o+l);return{data:s,train:d,validation:c,test:h,featureNames:r,labelName:n,classes:i,problemType:a,description:`${a}問題 - ${r.length}個の特徴量`,defaultMetric:a==="classification"?"accuracy":"mae",metric:a==="classification"?"accuracy":"mae"}}static shuffleArray(e){const r=[...e];for(let n=r.length-1;n>0;n--){const a=Math.floor(Math.random()*(n+1));[r[n],r[a]]=[r[a],r[n]]}return r}static selectFeatures(e,r){return{...e,train:e.train.map(n=>({...n,features:r.map(a=>n.features[a])})),validation:e.validation.map(n=>({...n,features:r.map(a=>n.features[a])})),test:e.test.map(n=>({...n,features:r.map(a=>n.features[a])})),featureNames:r.map(n=>e.featureNames[n])}}static preprocessDataset(e,r,n){return r==="none"?e:r==="normalize"?this.normalizeDataset(e):r==="standardize"?this.standardizeDataset(e):r==="encode"&&n?this.encodeDataset(e,n):e}static normalizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(1/0),a=Array(r).fill(-1/0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]=Math.min(n[l],o),a[l]=Math.max(a[l],o)})});const i=s=>({...s,features:s.features.map((o,l)=>{const d=a[l]-n[l];return!isFinite(d)||d===0?0:(o-n[l])/d})});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static standardizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(0),a=Array(r).fill(0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]+=o})}),n.forEach((s,o)=>{n[o]=s/e.train.length}),e.train.forEach(s=>{s.features.forEach((o,l)=>{a[l]+=Math.pow(o-n[l],2)})}),a.forEach((s,o)=>{a[o]=Math.sqrt(s/e.train.length)});const i=s=>({...s,features:s.features.map((o,l)=>a[l]===0?0:(o-n[l])/a[l])});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static encodeDataset(e,r){const n={};e.train.forEach(i=>{r.forEach(s=>{n[s]||(n[s]=new Map);const o=String(i.features[s]);n[s].has(o)||n[s].set(o,n[s].size)})});const a=i=>({...i,features:i.features.map((s,o)=>{if(r.includes(o)){const l=String(s);return n[o].get(l)??0}return s})});return{...e,train:e.train.map(a),validation:e.validation.map(a),test:e.test.map(a)}}static getPlayerDataset(e){return{train:e.train,test:e.validation,featureNames:e.featureNames,labelName:e.labelName,classes:e.classes}}static getOfficialDataset(e){return{train:e.train,test:e.test,featureNames:e.featureNames,labelName:e.labelName,classes:e.classes}}}class Ke{static problems=new Map;static async createProblem(e,r,n,a,i,s,o,l){const d=a.map((m,p)=>({id:`point_${p}`,features:m.features||m.slice(0,-1),label:m.label||m[m.length-1]})),c=o1.createCompetitionDataset(d,i,s,o,l),h={id:e,title:r,description:n,dataset:c,metric:o==="classification"?"accuracy":"mae",constraints:{maxFeatures:Math.min(i.length,20),maxTrainingTime:300,maxSubmissions:10,allowedModels:["logistic_regression","linear_regression","neural_network","knn"]},startTime:new Date,endTime:new Date(Date.now()+10080*60*1e3),participantCount:0,submissionCount:0};this.problems.set(e,h);const{PrivateEvaluationScheduler:f}=await zn(async()=>{const{PrivateEvaluationScheduler:m}=await import("./privateEvaluationScheduler-Bic-QRG4.js");return{PrivateEvaluationScheduler:m}},__vite__mapDeps([0,1,2]));return f.scheduleForNewProblem(e),h}static getProblem(e){return this.problems.get(e)}static getAllProblems(){return Array.from(this.problems.values())}static getActiveProblems(){const e=new Date;return Array.from(this.problems.values()).filter(r=>r.startTime<=e&&r.endTime>=e)}static updateParticipantCount(e,r){const n=this.problems.get(e);n&&(n.participantCount=r)}static isProblemActive(e){const r=this.problems.get(e);if(!r)return!1;const n=new Date;return r.startTime<=n&&r.endTime>=n}static updateSubmissionCount(e,r){const n=this.problems.get(e);n&&(n.submissionCount=r)}static getRemainingTime(e){const r=this.problems.get(e);if(!r)return 0;const n=new Date,a=r.endTime.getTime()-n.getTime();return Math.max(0,Math.floor(a/1e3))}static getProblemProgress(e){const r=this.problems.get(e);if(!r)return 0;const n=new Date,a=r.endTime.getTime()-r.startTime.getTime(),i=n.getTime()-r.startTime.getTime();return Math.min(1,Math.max(0,i/a))}static async createDefaultProblems(){console.log("CompetitionProblemManager: オンライン対戦用問題を作成中...");const e=this.generateStockMarketData(5e3);console.log("株式市場データ生成完了:",e.length,"件"),await this.createProblem("stock_market_prediction","AI株価予測チャレンジ","過去の株価データ、市場指標、ニュース感情分析から未来の株価を予測する高度な回帰問題。金融業界で実際に使用される手法を学習できます。",e,["過去価格","出来高","RSI","MACD","ボリンジャーバンド","ニュース感情スコア","VIX","金利","GDP成長率","失業率"],"予測価格","regression"),console.log("株式市場問題作成完了");const r=this.generateMedicalImageData(8e3);console.log("医療画像データ生成完了:",r.length,"件"),await this.createProblem("medical_image_diagnosis","AI医療画像診断コンペ","X線画像から疾患を自動診断する分類問題。医療AIの最先端技術を体験し、人命に関わる重要な判断を学びます。",r,["画像特徴1","画像特徴2","画像特徴3","画像特徴4","画像特徴5","画像特徴6","画像特徴7","画像特徴8","患者年齢","性別"],"疾患タイプ","classification",["正常","肺炎","結核","がん","その他"]),console.log("医療画像問題作成完了");const n=this.generateNLPData(6e3);console.log("NLPデータ生成完了:",n.length,"件"),await this.createProblem("sentiment_analysis_advanced","高度感情分析AI","ソーシャルメディアの投稿から感情を分析し、ブランド評価や市場動向を予測する分類問題。自然言語処理の最新技術を学習します。",n,["単語数","感情語彙スコア","否定語数","大文字率","感嘆符数","疑問符数","URL数","ハッシュタグ数","メンション数","投稿時間"],"感情","classification",["ポジティブ","ネガティブ","ニュートラル","複雑"]),console.log("NLP問題作成完了");const a=this.generateAutonomousDrivingData(7e3);console.log("自動運転データ生成完了:",a.length,"件"),await this.createProblem("autonomous_driving","自動運転AI開発","センサーデータから交通状況を認識し、適切な運転行動を決定する分類問題。自動運転技術の核心を学習します。",a,["前方距離","左側距離","右側距離","後方距離","速度","加速度","ステアリング角度","ブレーキ圧","天候","時間帯"],"運転行動","classification",["直進","左折","右折","停止","加速","減速"]),console.log("自動運転問題作成完了");const i=this.generateClimateData(4e3);console.log("気候データ生成完了:",i.length,"件"),await this.createProblem("climate_prediction","気候変動予測AI","気象データから地球温暖化の影響を予測する回帰問題。環境科学とAIの融合技術を学習します。",i,["気温","湿度","気圧","降水量","風速","CO2濃度","海面温度","氷河面積","森林面積","人口密度"],"温度上昇","regression"),console.log("気候変動問題作成完了"),console.log("CompetitionProblemManager: オンライン対戦用問題作成完了。総問題数:",this.problems.size)}static generateStockMarketData(e){const r=[];for(let n=0;n<e;n++){const a=100+Math.random()*900,i=Math.random()*1e6,s=Math.random()*100,o=(Math.random()-.5)*10,l=Math.random()*50,d=(Math.random()-.5)*2,c=Math.random()*50,h=Math.random()*5,f=(Math.random()-.5)*10,m=Math.random()*15,p=a*(1+(s-50)*.001+o*.01+d*.05+(c-25)*-.002+(h-2.5)*-.01+f*.005+(m-7.5)*-.003+(Math.random()-.5)*.1);r.push({features:[a,i,s,o,l,d,c,h,f,m],label:Math.max(0,p)})}return r}static generateMedicalImageData(e){const r=[],n=["正常","肺炎","結核","がん","その他"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=20+Math.random()*60,o=Math.random()>.5?1:0,l=Array(8).fill(0).map(()=>Math.random()*100);i>0&&(l[i-1]+=50+Math.random()*50,l[7]+=30),r.push({features:[...l,s,o],label:n[i]})}return r}static generateNLPData(e){const r=[],n=["ポジティブ","ネガティブ","ニュートラル","複雑"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=10+Math.random()*200,o=Math.random()*100,l=Math.random()*10,d=Math.random(),c=Math.random()*20,h=Math.random()*10,f=Math.random()*5,m=Math.random()*10,p=Math.random()*5,g=Math.random()*24;r.push({features:[s,o,l,d,c,h,f,m,p,g],label:n[i]})}return r}static generateAutonomousDrivingData(e){const r=[],n=["直進","左折","右折","停止","加速","減速"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=Math.random()*100,o=Math.random()*50,l=Math.random()*50,d=Math.random()*30,c=Math.random()*120,h=(Math.random()-.5)*10,f=(Math.random()-.5)*180,m=Math.random()*100,p=Math.random()*10,g=Math.random()*24;r.push({features:[s,o,l,d,c,h,f,m,p,g],label:n[i]})}return r}static generateClimateData(e){const r=[];for(let n=0;n<e;n++){const a=15+Math.random()*20,i=Math.random()*100,s=980+Math.random()*40,o=Math.random()*200,l=Math.random()*30,d=300+Math.random()*200,c=15+Math.random()*15,h=Math.random()*1e6,f=Math.random()*1e7,m=Math.random()*1e3,p=(d-400)*.01+(h-5e5)*-1e-6+(f-5e6)*1e-7+(m-500)*.001+(Math.random()-.5)*.5;r.push({features:[a,i,s,o,l,d,c,h,f,m],label:Math.max(0,p)})}return r}static generateClassificationData(e){const r=[],n=["織田","豊臣","徳川","武田","上杉"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=[Math.random()*100,Math.random()*100,Math.random()*100,Math.random()*100,Math.random()*100];r.push({features:s,label:n[i]})}return r}static generateRegressionData(e){const r=[];for(let n=0;n<e;n++){const a=[Math.random()*1e5,Math.random()*100,Math.random()*100,Math.random()*500,Math.random()*10],i=a[0]*.3+a[1]*.2+a[2]*.2+a[3]*.1+a[4]*.2+(Math.random()-.5)*1e4;r.push({features:a,label:Math.max(0,i)})}return r}}class ko{static splitData(e,r){const{trainRatio:n,validationRatio:a,testRatio:i,randomSeed:s,stratified:o}=r,l=n+a+i;if(Math.abs(l-1)>.001)throw new Error("データ分割比率の合計が1.0になる必要があります");if(s!==void 0){const m=s;Math.random=()=>{const p=Math.sin(m)*1e4;return p-Math.floor(p)}}const d=[...e].sort(()=>Math.random()-.5);if(o&&e.length>0&&typeof e[0].label=="string")return this.stratifiedSplit(d,n,a,i);const c=d.length,h=Math.floor(c*n),f=Math.floor(c*a);return{train:d.slice(0,h),validation:d.slice(h,h+f),test:d.slice(h+f)}}static stratifiedSplit(e,r,n,a){const i=new Map;e.forEach(d=>{const c=d.label.toString();i.has(c)||i.set(c,[]),i.get(c).push(d)});const s=[],o=[],l=[];return i.forEach(d=>{const c=d.length,h=Math.floor(c*r),f=Math.floor(c*n),m=d.sort(()=>Math.random()-.5);s.push(...m.slice(0,h)),o.push(...m.slice(h,h+f)),l.push(...m.slice(h+f))}),{train:s,validation:o,test:l}}static async evaluatePlayerModel(e,r,n,a,i,s){try{console.log("安定版機械学習モデルを使用中...");const o=s||{metrics:[e.defaultMetric],dataSplit:{trainRatio:.7,validationRatio:.2,testRatio:.1,randomSeed:42,stratified:e.problemType==="classification"}},l={train:e.train.map(b=>({features:r.map(x=>b.features[x]),label:b.label})),test:e.test.map(b=>({features:r.map(x=>b.features[x]),label:b.label})),featureNames:r.map(b=>e.featureNames[b]),labelName:e.labelName,classes:e.classes},d=Date.now(),c=$i(n);await c.train(l.train,a);const h=Date.now()-d;console.log("モデル評価を開始しています...");const f=c.evaluate(l.test);console.log("評価が完了しました");const m=o.metrics,p=m[0]||e.defaultMetric,g=this.calculateScore(f,p),y={};return m.forEach(b=>{switch(b){case"accuracy":y.accuracy=f.accuracy||0;break;case"precision":y.precision=f.precision||0;break;case"recall":y.recall=f.recall||0;break;case"f1_score":y.f1_score=f.f1_score||0;break;case"mae":y.mae=f.accuracy||0;break;case"mse":y.mse=f.accuracy||0;break;case"rmse":y.rmse=f.accuracy||0;break}}),{validationScore:g,testScore:0,metrics:y,predictions:f.predictions.map(b=>typeof b=="string"?parseFloat(b):b),actual:f.actual.map(b=>typeof b=="string"?parseFloat(b):b),probabilities:void 0,featureImportance:void 0,trainingTime:h/1e3,modelComplexity:this.calculateModelComplexity(n,a,r.length),evaluationOptions:o}}catch(o){throw console.error("評価エラー:",o),new Error(`モデル評価に失敗しました: ${o}`)}}static async evaluateOfficialModel(e,r){const n=this.selectFeatures(e,r.selectedFeatures),a=this.preprocessDataset(n,r.preprocessing),i={train:a.train,test:a.test,featureNames:a.featureNames,labelName:a.labelName,classes:a.classes},s=Date.now(),o=$i(r.modelType);await o.train(i.train,r.parameters);const l=Date.now()-s,d=o.evaluate(i.test);return{validationScore:0,testScore:this.calculateScore(d,e.metric),metrics:{accuracy:d.accuracy,precision:d.precision,recall:d.recall,f1_score:d.f1_score,mae:d.accuracy,mse:d.accuracy,rmse:d.accuracy},predictions:d.predictions.map(c=>typeof c=="string"?parseFloat(c):c),actual:d.actual.map(c=>typeof c=="string"?parseFloat(c):c),probabilities:void 0,featureImportance:void 0,trainingTime:l/1e3,modelComplexity:this.calculateModelComplexity(r.modelType,r.parameters,r.selectedFeatures.length)}}static selectFeatures(e,r){return{...e,train:e.train.map(n=>({...n,features:r.map(a=>n.features[a])})),validation:e.validation.map(n=>({...n,features:r.map(a=>n.features[a])})),test:e.test.map(n=>({...n,features:r.map(a=>n.features[a])})),featureNames:r.map(n=>e.featureNames[n])}}static preprocessDataset(e,r){return r.method==="none"?e:r.method==="normalize"?this.normalizeDataset(e):r.method==="standardize"?this.standardizeDataset(e):r.method==="encode"&&r.encodedFeatures?this.encodeDataset(e,r.encodedFeatures):e}static normalizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(1/0),a=Array(r).fill(-1/0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]=Math.min(n[l],o),a[l]=Math.max(a[l],o)})});const i=s=>({...s,features:s.features.map((o,l)=>{const d=a[l]-n[l];return!isFinite(d)||d===0?0:(o-n[l])/d})});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static standardizeDataset(e){const r=e.featureNames.length,n=Array(r).fill(0),a=Array(r).fill(0);e.train.forEach(s=>{s.features.forEach((o,l)=>{n[l]+=o})}),n.forEach((s,o)=>{n[o]=s/e.train.length}),e.train.forEach(s=>{s.features.forEach((o,l)=>{a[l]+=Math.pow(o-n[l],2)})}),a.forEach((s,o)=>{a[o]=Math.sqrt(s/e.train.length)});const i=s=>({...s,features:s.features.map((o,l)=>a[l]===0?0:(o-n[l])/a[l])});return{...e,train:e.train.map(i),validation:e.validation.map(i),test:e.test.map(i)}}static encodeDataset(e,r){const n={};e.train.forEach(i=>{r.forEach(s=>{n[s]||(n[s]=new Map);const o=String(i.features[s]);n[s].has(o)||n[s].set(o,n[s].size)})});const a=i=>({...i,features:i.features.map((s,o)=>{if(r.includes(o)){const l=String(s);return n[o].get(l)??0}return s})});return{...e,train:e.train.map(a),validation:e.validation.map(a),test:e.test.map(a)}}static calculateScore(e,r){switch(r){case"accuracy":return e.accuracy||0;case"f1_score":return e.f1_score||0;case"precision":return e.precision||0;case"recall":return e.recall||0;case"mae":return Math.max(0,1-(e.mae||0)/100);case"mse":return 1/(1+(e.mse||0));case"rmse":return 1/(1+(e.rmse||0));default:return e.accuracy||0}}static calculateModelComplexity(e,r,n){let a=0;switch(e){case"logistic_regression":a=n;break;case"linear_regression":a=n;break;case"neural_network":const i=r.hidden_units||16;a=n*i+i*(r.num_classes||2);break;case"knn":a=n*(r.k||5);break;default:a=n}return a}}const l1=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>zn(async()=>{const{default:n}=await Promise.resolve().then(()=>Kn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class Pu extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class c1 extends Pu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Uh extends Pu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Fh extends Pu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var vc;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(vc||(vc={}));var u1=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};class d1{constructor(e,{headers:r={},customFetch:n,region:a=vc.Any}={}){this.url=e,this.headers=r,this.region=a,this.fetch=l1(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return u1(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region);const d=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,d.searchParams.set("forceFunctionRegion",l));let c;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=s):typeof s=="string"?(o["Content-Type"]="text/plain",c=s):typeof FormData<"u"&&s instanceof FormData?c=s:(o["Content-Type"]="application/json",c=JSON.stringify(s)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:c}).catch(g=>{throw new c1(g)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new Uh(h);if(!h.ok)throw new Fh(h);let m=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return m==="application/json"?p=yield h.json():m==="application/octet-stream"?p=yield h.blob():m==="text/event-stream"?p=h:m==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof Fh||a instanceof Uh?a.context:void 0}}})}}var Re={},fn={},mn={},pn={},gn={},vn={},h1=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},In=h1();const f1=In.fetch,xg=In.fetch.bind(In),wg=In.Headers,m1=In.Request,p1=In.Response,Kn=Object.freeze(Object.defineProperty({__proto__:null,Headers:wg,Request:m1,Response:p1,default:xg,fetch:f1},Symbol.toStringTag,{value:"Module"})),g1=jw(Kn);var oi={},Wh;function _g(){if(Wh)return oi;Wh=1,Object.defineProperty(oi,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return oi.default=t,oi}var qh;function jg(){if(qh)return vn;qh=1;var t=vn&&vn.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(vn,"__esModule",{value:!0});const e=t(g1),r=t(_g());class n{constructor(i){var s,o;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(o=i.isMaybeSingle)!==null&&o!==void 0?o:!1,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var c,h,f,m;let p=null,g=null,y=null,b=d.status,x=d.statusText;if(d.ok){if(this.method!=="HEAD"){const j=await d.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?g=j:g=JSON.parse(j))}const _=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),S=(f=d.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");_&&S&&S.length>1&&(y=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,y=null,b=406,x="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const _=await d.text();try{p=JSON.parse(_),Array.isArray(p)&&d.status===404&&(g=[],p=null,b=200,x="OK")}catch{d.status===404&&_===""?(b=204,x="No Content"):p={message:_}}if(p&&this.isMaybeSingle&&(!((m=p?.details)===null||m===void 0)&&m.includes("0 rows"))&&(p=null,b=200,x="OK"),p&&this.shouldThrowOnError)throw new r.default(p)}return{error:p,data:g,count:y,status:b,statusText:x}});return this.shouldThrowOnError||(l=l.catch(d=>{var c,h,f;return{error:{message:`${(c=d?.name)!==null&&c!==void 0?c:"FetchError"}: ${d?.message}`,details:`${(h=d?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=d?.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,s)}returns(){return this}overrideTypes(){return this}}return vn.default=n,vn}var zh;function Sg(){if(zh)return gn;zh=1;var t=gn&&gn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(gn,"__esModule",{value:!0});const e=t(jg());class r extends e.default{select(a){let i=!1;const s=(a??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:i=!0,nullsFirst:s,foreignTable:o,referencedTable:l=o}={}){const d=l?`${l}.order`:"order",c=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${c?`${c},`:""}${a}.${i?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:s=i}={}){const o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${a}`),this}range(a,i,{foreignTable:s,referencedTable:o=s}={}){const l=typeof o>"u"?"offset":`${o}.offset`,d=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${a}`),this.url.searchParams.set(d,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:i=!1,settings:s=!1,buffers:o=!1,wal:l=!1,format:d="text"}={}){var c;const h=[a?"analyze":null,i?"verbose":null,s?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${f}"; options=${h};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return gn.default=r,gn}var Kh;function ku(){if(Kh)return pn;Kh=1;var t=pn&&pn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(pn,"__esModule",{value:!0});const e=t(Sg());class r extends e.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const s=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(a,`in.(${s})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:s,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const d=s===void 0?"":`(${s})`;return this.url.searchParams.append(a,`${l}fts${d}.${i}`),this}match(a){return Object.entries(a).forEach(([i,s])=>{this.url.searchParams.append(i,`eq.${s}`)}),this}not(a,i,s){return this.url.searchParams.append(a,`not.${i}.${s}`),this}or(a,{foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.or`:"or";return this.url.searchParams.append(o,`(${a})`),this}filter(a,i,s){return this.url.searchParams.append(a,`${i}.${s}`),this}}return pn.default=r,pn}var Hh;function Ng(){if(Hh)return mn;Hh=1;var t=mn&&mn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(mn,"__esModule",{value:!0});const e=t(ku());class r{constructor(a,{headers:i={},schema:s,fetch:o}){this.url=a,this.headers=new Headers(i),this.schema=s,this.fetch=o}select(a,{head:i=!1,count:s}={}){const o=i?"HEAD":"GET";let l=!1;const d=(a??"*").split("").map(c=>/\s/.test(c)&&!l?"":(c==='"'&&(l=!l),c)).join("");return this.url.searchParams.set("select",d),s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:i,defaultToNull:s=!0}={}){var o;const l="POST";if(i&&this.headers.append("Prefer",`count=${i}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const d=a.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(d.length>0){const c=[...new Set(d)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(a,{onConflict:i,ignoreDuplicates:s=!1,count:o,defaultToNull:l=!0}={}){var d;const c="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(h.length>0){const f=[...new Set(h)].map(m=>`"${m}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(a,{count:i}={}){var s;const o="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:a}={}){var i;const s="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return mn.default=r,mn}var Vh;function v1(){if(Vh)return fn;Vh=1;var t=fn&&fn.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(fn,"__esModule",{value:!0});const e=t(Ng()),r=t(ku());class n{constructor(i,{headers:s={},schema:o,fetch:l}={}){this.url=i,this.headers=new Headers(s),this.schemaName=o,this.fetch=l}from(i){const s=new URL(`${this.url}/${i}`);return new e.default(s,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,s={},{head:o=!1,get:l=!1,count:d}={}){var c;let h;const f=new URL(`${this.url}/rpc/${i}`);let m;o||l?(h=o?"HEAD":"GET",Object.entries(s).filter(([g,y])=>y!==void 0).map(([g,y])=>[g,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([g,y])=>{f.searchParams.append(g,y)})):(h="POST",m=s);const p=new Headers(this.headers);return d&&p.set("Prefer",`count=${d}`),new r.default({method:h,url:f,headers:p,schema:this.schemaName,body:m,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}}return fn.default=n,fn}var Gh;function y1(){if(Gh)return Re;Gh=1;var t=Re&&Re.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Re,"__esModule",{value:!0}),Re.PostgrestError=Re.PostgrestBuilder=Re.PostgrestTransformBuilder=Re.PostgrestFilterBuilder=Re.PostgrestQueryBuilder=Re.PostgrestClient=void 0;const e=t(v1());Re.PostgrestClient=e.default;const r=t(Ng());Re.PostgrestQueryBuilder=r.default;const n=t(ku());Re.PostgrestFilterBuilder=n.default;const a=t(Sg());Re.PostgrestTransformBuilder=a.default;const i=t(jg());Re.PostgrestBuilder=i.default;const s=t(_g());return Re.PostgrestError=s.default,Re.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:i.default,PostgrestError:s.default},Re}var b1=y1();const x1=rr(b1),{PostgrestClient:w1,PostgrestQueryBuilder:G4,PostgrestFilterBuilder:Y4,PostgrestTransformBuilder:J4,PostgrestBuilder:X4,PostgrestError:Z4}=x1;class _1{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const j1="2.15.5",S1=`realtime-js/${j1}`,N1="1.0.0",yc=1e4,P1=1e3,k1=100;var ba;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ba||(ba={}));var Oe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Oe||(Oe={}));var kt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(kt||(kt={}));var bc;(function(t){t.websocket="websocket"})(bc||(bc={}));var Kr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Kr||(Kr={}));class M1{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(e.slice(s,s+a));s=s+a;const l=n.decode(e.slice(s,s+i));s=s+i;const d=JSON.parse(n.decode(e.slice(s,e.byteLength)));return{ref:null,topic:o,event:l,payload:d}}}class Pg{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var fe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(fe||(fe={}));const Yh=(t,e,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,s)=>(i[s]=O1(s,t,e,a),i),{})},O1=(t,e,r,n)=>{const a=e.find(o=>o.name===t),i=a?.type,s=r[t];return i&&!n.includes(i)?kg(i,s):xc(s)},kg=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return C1(e,r)}switch(t){case fe.bool:return A1(e);case fe.float4:case fe.float8:case fe.int2:case fe.int4:case fe.int8:case fe.numeric:case fe.oid:return E1(e);case fe.json:case fe.jsonb:return T1(e);case fe.timestamp:return I1(e);case fe.abstime:case fe.date:case fe.daterange:case fe.int4range:case fe.int8range:case fe.money:case fe.reltime:case fe.text:case fe.time:case fe.timestamptz:case fe.timetz:case fe.tsrange:case fe.tstzrange:return xc(e);default:return xc(e)}},xc=t=>t,A1=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},E1=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},T1=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},C1=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const s=t.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>kg(e,o))}return t},I1=t=>typeof t=="string"?t.replace(" ","T"):t,Mg=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Mo{constructor(e,r,n={},a=yc){this.channel=e,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Jh;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Jh||(Jh={}));class xa{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xa.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=xa.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=xa.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,a){const i=this.cloneDeep(e),s=this.transformState(r),o={},l={};return this.map(i,(d,c)=>{s[d]||(l[d]=c)}),this.map(s,(d,c)=>{const h=i[d];if(h){const f=c.map(y=>y.presence_ref),m=h.map(y=>y.presence_ref),p=c.filter(y=>m.indexOf(y.presence_ref)<0),g=h.filter(y=>f.indexOf(y.presence_ref)<0);p.length>0&&(o[d]=p),g.length>0&&(l[d]=g)}else o[d]=c}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(e,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var d;const c=(d=e[o])!==null&&d!==void 0?d:[];if(e[o]=this.cloneDeep(l),c.length>0){const h=e[o].map(m=>m.presence_ref),f=c.filter(m=>h.indexOf(m.presence_ref)<0);e[o].unshift(...f)}n(o,c,l)}),this.map(s,(o,l)=>{let d=e[o];if(!d)return;const c=l.map(h=>h.presence_ref);d=d.filter(h=>c.indexOf(h.presence_ref)<0),e[o]=d,a(o,d,l),d.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const a=e[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Xh;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Xh||(Xh={}));var wa;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(wa||(wa={}));var qt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qt||(qt={}));class Mu{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Oe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Mo(this,kt.join,this.params,this.timeout),this.rejoinTimer=new Pg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Oe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Oe.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(kt.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new xa(this),this.broadcastEndpointURL=Mg(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Oe.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&a!==void 0?a:[],c=!!this.bindings[wa.PRESENCE]&&this.bindings[wa.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:d,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>e?.(qt.CHANNEL_ERROR,m)),this._onClose(()=>e?.(qt.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var p;if(this.socket.setAuth(),m===void 0){e?.(qt.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(p=g?.length)!==null&&p!==void 0?p:0,b=[];for(let x=0;x<y;x++){const w=g[x],{filter:{event:_,schema:S,table:j,filter:N}}=w,M=m&&m[x];if(M&&M.event===_&&M.schema===S&&M.table===j&&M.filter===N)b.push(Object.assign(Object.assign({},w),{id:M.id}));else{this.unsubscribe(),this.state=Oe.errored,e?.(qt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(qt.SUBSCRIBED);return}}).receive("error",m=>{this.state=Oe.errored,e?.(qt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e?.(qt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===Oe.joined&&e===wa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:s}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Oe.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(kt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Mo(this,kt.leave,{},e),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Oe.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Mo(this,e,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>k1){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var a,i;const s=e.toLocaleLowerCase(),{close:o,error:l,leave:d,join:c}=kt;if(n&&[o,l,d,c].indexOf(s)>=0&&n!==this._joinRef())return;let f=this._onMessage(s,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var p,g,y;return((p=m.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(g=m.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===s}).map(m=>m.callback(f,n)):(i=this.bindings[s])===null||i===void 0||i.filter(m=>{var p,g,y,b,x,w;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in m){const _=m.id,S=(p=m.filter)===null||p===void 0?void 0:p.event;return _&&((g=r.ids)===null||g===void 0?void 0:g.includes(_))&&(S==="*"||S?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const _=(x=(b=m?.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return _==="*"||_===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===s}).map(m=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:g,table:y,commit_timestamp:b,type:x,errors:w}=p;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:b,eventType:x,new:{},old:{},errors:w}),this._getPayloadRecords(p))}m.callback(f,n)})}_isClosed(){return this.state===Oe.closed}_isJoined(){return this.state===Oe.joined}_isJoining(){return this.state===Oe.joining}_isLeaving(){return this.state===Oe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const a=e.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Mu.isEqual(a.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(kt.close,{},e)}_onError(e){this._on(kt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Oe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Yh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Yh(e.columns,e.old_record)),r}}const Oo=()=>{},li={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},D1=[1e3,2e3,5e3,1e4],$1=1e4,R1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class L1{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=yc,this.transport=null,this.heartbeatIntervalMs=li.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Oo,this.ref=0,this.reconnectTimer=null,this.logger=Oo,this.conn=null,this.sendBuffer=[],this.serializer=new M1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...s)=>zn(async()=>{const{default:o}=await Promise.resolve().then(()=>Kn);return{default:o}},void 0).then(({default:o})=>o(...s)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...s)=>i(...s)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${bc.websocket}`,this.httpEndpoint=Mg(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=_1.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:N1}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ba.connecting:return Kr.Connecting;case ba.open:return Kr.Open;case ba.closing:return Kr.Closing;default:return Kr.Closed}}isConnected(){return this.connectionState()===Kr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new Mu(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:a,ref:i}=e,s=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(P1,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},li.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:s}=r,o=s?`(${s})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(kt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${e}${n}${a}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([R1],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:S1};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(kt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Pg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},li.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,a,i,s,o,l,d,c;if(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:yc,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:li.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(s=e?.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(o=e?.heartbeatCallback)!==null&&o!==void 0?o:Oo,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:(h=>D1[h-1]||$1),this.encode=(d=e?.encode)!==null&&d!==void 0?d:((h,f)=>f(JSON.stringify(h))),this.decode=(c=e?.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Ou extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ae(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class B1 extends Ou{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class wc extends Ou{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var U1=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const Og=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>zn(async()=>{const{default:n}=await Promise.resolve().then(()=>Kn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},F1=()=>U1(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield zn(()=>Promise.resolve().then(()=>Kn),void 0)).Response:Response}),_c=t=>{if(Array.isArray(t))return t.map(r=>_c(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=_c(n)}),e},W1=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var ln=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const Ao=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),q1=(t,e,r)=>ln(void 0,void 0,void 0,function*(){const n=yield F1();t instanceof n&&!r?.noResolveJson?t.json().then(a=>{const i=t.status||500,s=a?.statusCode||i+"";e(new B1(Ao(a),i,s))}).catch(a=>{e(new wc(Ao(a),a))}):e(new wc(Ao(t),t))}),z1=(t,e,r,n)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"||!n?a:(W1(n)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(n)):a.body=n,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),r))};function Fa(t,e,r,n,a,i){return ln(this,void 0,void 0,function*(){return new Promise((s,o)=>{t(r,z1(e,n,a,i)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>q1(l,o,n))})})}function Ri(t,e,r,n){return ln(this,void 0,void 0,function*(){return Fa(t,"GET",e,r,n)})}function Et(t,e,r,n,a){return ln(this,void 0,void 0,function*(){return Fa(t,"POST",e,n,a,r)})}function jc(t,e,r,n,a){return ln(this,void 0,void 0,function*(){return Fa(t,"PUT",e,n,a,r)})}function K1(t,e,r,n){return ln(this,void 0,void 0,function*(){return Fa(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Ag(t,e,r,n,a){return ln(this,void 0,void 0,function*(){return Fa(t,"DELETE",e,n,a,r)})}var Qe=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const H1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Zh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class V1{constructor(e,r={},n,a){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=Og(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,a){return Qe(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},Zh),a);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a?.headers&&(o=Object.assign(Object.assign({},o),a.headers));const d=this._removeEmptyFolders(r),c=this._getFinalPath(d),h=yield(e=="PUT"?jc:Et)(this.fetch,`${this.url}/object/${c}`,i,Object.assign({headers:o},s?.duplex?{duplex:s.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ae(i))return{data:null,error:i};throw i}})}upload(e,r,n){return Qe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,a){return Qe(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const d=Object.assign({upsert:Zh.upsert},a),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",d.cacheControl)):(l=n,c["cache-control"]=`max-age=${d.cacheControl}`,c["content-type"]=d.contentType);const h=yield jc(this.fetch,o.toString(),l,{headers:c});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ae(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return Qe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const i=yield Et(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new Ou("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}update(e,r,n){return Qe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Qe(this,void 0,void 0,function*(){try{return{data:yield Et(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}copy(e,r,n){return Qe(this,void 0,void 0,function*(){try{return{data:{path:(yield Et(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}createSignedUrl(e,r,n){return Qe(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Et(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}createSignedUrls(e,r,n){return Qe(this,void 0,void 0,function*(){try{const a=yield Et(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}download(e,r){return Qe(this,void 0,void 0,function*(){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Ri(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ae(o))return{data:null,error:o};throw o}})}info(e){return Qe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Ri(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:_c(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}exists(e){return Qe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield K1(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n)&&n instanceof wc){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),a=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&a.push(l);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${d}`)}}}remove(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield Ag(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}list(e,r,n){return Qe(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},H1),r),{prefix:e||""});return{data:yield Et(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ae(a))return{data:null,error:a};throw a}})}listV2(e,r){return Qe(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Et(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const G1="2.12.1",Y1={"X-Client-Info":`storage-js/${G1}`};var yn=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};class J1{constructor(e,r={},n,a){this.shouldThrowOnError=!1;const i=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Y1),r),this.fetch=Og(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return yn(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ae(e))return{data:null,error:e};throw e}})}getBucket(e){return yn(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return yn(this,void 0,void 0,function*(){try{return{data:yield Et(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return yn(this,void 0,void 0,function*(){try{return{data:yield jc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ae(n))return{data:null,error:n};throw n}})}emptyBucket(e){return yn(this,void 0,void 0,function*(){try{return{data:yield Et(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}deleteBucket(e){return yn(this,void 0,void 0,function*(){try{return{data:yield Ag(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ae(r))return{data:null,error:r};throw r}})}}class X1 extends J1{constructor(e,r={},n,a){super(e,r,n,a)}from(e){return new V1(this.url,this.headers,e,this.fetch)}}const Z1="2.57.4";let pa="";typeof Deno<"u"?pa="deno":typeof document<"u"?pa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?pa="react-native":pa="node";const Q1={"X-Client-Info":`supabase-js-${pa}/${Z1}`},e_={headers:Q1},t_={schema:"public"},r_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},n_={};var a_=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};const i_=t=>{let e;return t?e=t:typeof fetch>"u"?e=xg:e=fetch,(...r)=>e(...r)},s_=()=>typeof Headers>"u"?wg:Headers,o_=(t,e,r)=>{const n=i_(r),a=s_();return(i,s)=>a_(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:t;let d=new a(s?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:d}))})};var l_=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};function c_(t){return t.endsWith("/")?t:t+"/"}function u_(t,e){var r,n;const{db:a,auth:i,realtime:s,global:o}=t,{db:l,auth:d,realtime:c,global:h}=e,f={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},c),s),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(n=o?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>l_(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function d_(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(c_(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Eg="2.71.1",Sn=30*1e3,Sc=3,Eo=Sc*Sn,h_="http://localhost:9999",f_="supabase.auth.token",m_={"X-Client-Info":`gotrue-js/${Eg}`},Nc="X-Supabase-Api-Version",Tg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},p_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,g_=600*1e3;class Au extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function G(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class v_ extends Au{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function y_(t){return G(t)&&t.name==="AuthApiError"}class Cg extends Au{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Or extends Au{constructor(e,r,n,a){super(e,n,a),this.name=r,this.status=n}}class fr extends Or{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function b_(t){return G(t)&&t.name==="AuthSessionMissingError"}class ci extends Or{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ui extends Or{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class di extends Or{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function x_(t){return G(t)&&t.name==="AuthImplicitGrantRedirectError"}class Qh extends Or{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pc extends Or{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function To(t){return G(t)&&t.name==="AuthRetryableFetchError"}class ef extends Or{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class kc extends Or{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),tf=` 	
\r=`.split(""),w_=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<tf.length;e+=1)t[tf[e].charCodeAt(0)]=-2;for(let e=0;e<Li.length;e+=1)t[Li[e].charCodeAt(0)]=e;return t})();function rf(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Li[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Li[n]),e.queuedBits-=6}}function Ig(t,e,r){const n=w_[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function nf(t){const e=[],r=s=>{e.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{S_(s,n,r)};for(let s=0;s<t.length;s+=1)Ig(t.charCodeAt(s),a,i);return e.join("")}function __(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function j_(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}__(n,e)}}function S_(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function N_(t){const e=[],r={queue:0,queuedBits:0},n=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)Ig(t.charCodeAt(a),r,n);return new Uint8Array(e)}function P_(t){const e=[];return j_(t,r=>e.push(r)),new Uint8Array(e)}function k_(t){const e=[],r={queue:0,queuedBits:0},n=a=>{e.push(a)};return t.forEach(a=>rf(a,r,n)),rf(null,r,n),e.join("")}function M_(t){return Math.round(Date.now()/1e3)+t}function O_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Pt=()=>typeof window<"u"&&typeof document<"u",Rr={tested:!1,writable:!1},Dg=()=>{if(!Pt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rr.tested)return Rr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Rr.tested=!0,Rr.writable=!0}catch{Rr.tested=!0,Rr.writable=!1}return Rr.writable};function A_(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{e[a]=n}),e}const $g=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>zn(async()=>{const{default:n}=await Promise.resolve().then(()=>Kn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},E_=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Nn=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Lr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},hr=async(t,e)=>{await t.removeItem(e)};class Os{constructor(){this.promise=new Os.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Os.promiseConstructor=Promise;function Co(t){const e=t.split(".");if(e.length!==3)throw new kc("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!p_.test(e[n]))throw new kc("JWT not in base64url format");return{header:JSON.parse(nf(e[0])),payload:JSON.parse(nf(e[1])),signature:N_(e[2]),raw:{header:e[0],payload:e[1]}}}async function T_(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function C_(t,e){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await t(i);if(!e(i,null,s)){n(s);return}}catch(s){if(!e(i,s)){a(s);return}}})()})}function I_(t){return("0"+t.toString(16)).substr(-2)}function D_(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(e),Array.from(e,I_).join("")}async function $_(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function R_(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await $_(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bn(t,e,r=!1){const n=D_();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Nn(t,`${e}-code-verifier`,a);const i=await R_(n);return[i,n===i?"plain":"s256"]}const L_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function B_(t){const e=t.headers.get(Nc);if(!e||!e.match(L_))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function U_(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function F_(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const W_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xn(t){if(!W_.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Io(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function af(t){return JSON.parse(JSON.stringify(t))}var q_=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r};const Ur=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),z_=[502,503,504];async function sf(t){var e;if(!E_(t))throw new Pc(Ur(t),0);if(z_.includes(t.status))throw new Pc(Ur(t),t.status);let r;try{r=await t.json()}catch(i){throw new Cg(Ur(i),i)}let n;const a=B_(t);if(a&&a.getTime()>=Tg["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new ef(Ur(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new fr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new ef(Ur(r),t.status,r.weak_password.reasons);throw new v_(Ur(r),t.status||500,n)}const K_=(t,e,r,n)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function J(t,e,r,n){var a;const i=Object.assign({},n?.headers);i[Nc]||(i[Nc]=Tg["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await H_(t,e,r+o,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function H_(t,e,r,n,a,i){const s=K_(e,n,a,i);let o;try{o=await t(r,Object.assign({},s))}catch(l){throw console.error(l),new Pc(Ur(l),0)}if(o.ok||await sf(o),n?.noResolveJson)return o;try{return await o.json()}catch(l){await sf(l)}}function Wt(t){var e;let r=null;J_(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=M_(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function of(t){const e=Wt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function gr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function V_(t){return{data:t,error:null}}function G_(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=t,s=q_(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function Y_(t){return t}function J_(t){return t.access_token&&t.refresh_token&&t.expires_in}const Do=["global","local","others"];var X_=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r};class Z_{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=$g(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Do[0]){if(Do.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Do.join(", ")}`);try{return await J(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await J(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:gr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=X_(e,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await J(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:G_,redirectTo:r?.redirectTo})}catch(r){if(G(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await J(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:gr})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,a,i,s,o,l;try{const d={nextPage:null,lastPage:0,total:0},c=await J(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Y_});if(c.error)throw c.error;const h=await c.json(),f=(s=c.headers.get("x-total-count"))!==null&&s!==void 0?s:0,m=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(G(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){xn(e);try{return await J(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:gr})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){xn(e);try{return await J(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:gr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){xn(e);try{return await J(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:gr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){xn(e.userId);try{const{data:r,error:n}=await J(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(G(r))return{data:null,error:r};throw r}}async _deleteFactor(e){xn(e.userId),xn(e.id);try{return{data:await J(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}}}function lf(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function Q_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wn={debug:!!(globalThis&&Dg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Rg extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ej extends Rg{}async function tj(t,e,r){wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),wn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await r()}finally{wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new ej(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(wn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Q_();const rj={url:h_,storageKey:f_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:m_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cf(t,e,r){return await r()}const _n={};class ka{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ka.nextInstanceID,ka.nextInstanceID+=1,this.instanceID>0&&Pt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},rj),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Z_({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=$g(a.fetch),this.lock=a.lock||cf,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Pt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=tj:this.lock=cf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Dg()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lf(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=lf(this.memoryStorage)),Pt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=_n[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){_n[this.storageKey]=Object.assign(Object.assign({},_n[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=_n[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){_n[this.storageKey]=Object.assign(Object.assign({},_n[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Eg}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=A_(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Pt()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),x_(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return G(r)?{error:r}:{error:new Cg("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,a;try{const i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Wt}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(G(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,a;try{let i;if("email"in e){const{email:c,password:h,options:f}=e;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await bn(this.storage,this.storageKey)),i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:c,password:h,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:p},xform:Wt})}else if("phone"in e){const{phone:c,password:h,options:f}=e;i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=f?.data)!==null&&n!==void 0?n:{},channel:(a=f?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Wt})}else throw new ui("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(G(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:s,options:o}=e;r=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:of})}else if("phone"in e){const{phone:i,password:s,options:o}=e;r=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:of})}else throw new ui("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ci}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,a,i,s,o,l,d,c,h,f,m;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:y,wallet:b,statement:x,options:w}=e;let _;if(Pt())if(typeof b=="object")_=b;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))_=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=b}const S=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const j=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),x?{statement:x}:null));let N;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")N=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)N=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)p=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),g=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${S.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((s=w?.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(c=w?.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const j=await _.signMessage(new TextEncoder().encode(p),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=j}}try{const{data:y,error:b}=await J(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:k_(g)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Wt});if(b)throw b;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new ci}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:b})}catch(y){if(G(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const r=await Lr(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await J(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Wt});if(await hr(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ci}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(G(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=e,o=await J(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Wt}),{data:l,error:d}=o;return d?{data:{user:null,session:null},error:d}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ci}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:d})}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,a,i,s;try{if("email"in e){const{email:o,options:l}=e;let d=null,c=null;this.flowType==="pkce"&&([d,c]=await bn(this.storage,this.storageKey));const{error:h}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:d,code_challenge_method:c},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:d,error:c}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l?.data)!==null&&a!==void 0?a:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(s=l?.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:c}}throw new ui("You must provide either an email or phone number.")}catch(o){if(G(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var r,n;try{let a,i;"options"in e&&(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await J(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Wt});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,d=s.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(a){if(G(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await bn(this.storage,this.storageKey)),await J(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:V_})}catch(i){if(G(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new fr;const{error:a}=await J(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(G(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:i}=e,{error:s}=await J(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in e){const{phone:n,type:a,options:i}=e,{data:s,error:o}=await J(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:s?.message_id},error:o}}throw new ui("You must provide either an email or phone number and a type")}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Lr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Eo:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const s=await Lr(this.userStorage,this.storageKey+"-user");s?.user?e.user=s.user:e.user=Io()}if(this.storage.isServer&&e.user){let s=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,d,c)=>(!s&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,d,c))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:gr}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new fr}:await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:gr})})}catch(r){if(G(r))return b_(r)&&(await this._removeSession(),await hr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new fr;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await bn(this.storage,this.storageKey));const{data:d,error:c}=await J(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:gr});if(c)throw c;return s.user=d.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new fr;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=Co(e.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(G(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:s,error:o}=r;if(o)throw o;e=(n=s.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new fr;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(G(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Pt())throw new di("No browser detected.");if(e.error||e.error_description||e.error_code)throw new di(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Qh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new di("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Qh("No code detected.");const{data:x,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:d}=e;if(!i||!o||!s||!d)throw new di("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let f=c+h;l&&(f=parseInt(l));const m=f-c;m*1e3<=Sn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const p=f-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,c);const{data:g,error:y}=await this._getUser(i);if(y)throw y;const b={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:f,refresh_token:s,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(G(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Lr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,e);if(o&&!(y_(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await hr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=O_(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await bn(this.storage,this.storageKey,!0));try{return await J(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(G(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,d,c;const{data:h,error:f}=i;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await J(this.fetch,"GET",m,{headers:this.headers,jwt:(c=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&c!==void 0?c:void 0})});if(a)throw a;return Pt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(G(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await J(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await C_(async a=>(a>0&&await T_(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await J(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Wt})),(a,i)=>{const s=200*Math.pow(2,a);return i&&To(i)&&Date.now()+s-n<Sn})}catch(n){if(this._debug(r,"error",n),G(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Pt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Lr(this.storage,this.storageKey);if(a&&this.userStorage){let s=await Lr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await Nn(this.userStorage,this.storageKey+"-user",s)),a.user=(e=s?.user)!==null&&e!==void 0?e:Io()}else if(a&&!a.user&&!a.user){const s=await Lr(this.storage,this.storageKey+"-user");s&&s?.user?(a.user=s.user,await hr(this.storage,this.storageKey+"-user"),await Nn(this.storage,this.storageKey,a)):a.user=Io()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Eo;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Eo}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),To(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:o}=await this._getUser(a.access_token);!o&&s?.user?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new fr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Os;const{data:i,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!i.session)throw new fr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),G(i)){const s={session:null,error:i};return To(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,r,n=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Nn(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=af(a);await Nn(this.storage,this.storageKey,i)}else{const a=af(r);await Nn(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await hr(this.storage,this.storageKey),await hr(this.storage,this.storageKey+"-code-verifier"),await hr(this.storage,this.storageKey+"-user"),this.userStorage&&await hr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Pt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Sn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-e)/Sn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Sn}ms, refresh threshold is ${Sc} ticks`),a<=Sc&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Rg)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Pt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await bn(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await J(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:d}=await J(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((a=l?.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await J(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(G(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await J(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(G(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=e?.factors||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Co(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const c=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(o=>o.kid===e);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+g_>a)return n;const{data:i,error:s}=await J(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:m,error:p}=await this.getSession();if(p||!m.session)return{data:null,error:p};n=m.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=Co(n);r?.allowExpired||U_(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:i,header:a,signature:s},error:null}}const c=F_(a.alg),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,s,P_(`${o}.${l}`)))throw new kc("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}}ka.nextInstanceID=0;const nj=ka;class aj extends nj{constructor(e){super(e)}}var ij=function(t,e,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(c){try{d(n.next(c))}catch(h){s(h)}}function l(c){try{d(n.throw(c))}catch(h){s(h)}}function d(c){c.done?i(c.value):a(c.value).then(o,l)}d((n=n.apply(t,e||[])).next())})};class sj{constructor(e,r,n){var a,i,s;this.supabaseUrl=e,this.supabaseKey=r;const o=d_(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,d={db:t_,realtime:n_,auth:Object.assign(Object.assign({},r_),{storageKey:l}),global:e_},c=u_(n??{},d);this.storageKey=(a=c.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=c.auth)!==null&&s!==void 0?s:{},this.headers,c.global.fetch),this.fetch=o_(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new w1(new URL("rest/v1",o).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new X1(this.storageUrl.href,this.headers,this.fetch,n?.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new d1(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return ij(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:s,flowType:o,lock:l,debug:d},c,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new aj({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:o,lock:l,debug:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new L1(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Lg=(t,e,r)=>new sj(t,e,r);function oj(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}oj()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Bg=typeof navigator<"u"&&!navigator.onLine,lj=()=>Bg?"offline":"https://ovghanpxibparkuyxxdh.supabase.co",cj=()=>Bg?"offline":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92Z2hhbnB4aWJwYXJrdXl4eGRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDQ3MjksImV4cCI6MjA3NTQ4MDcyOX0.56Caf4btExzGvizmzJwZZA8KZIh81axQVcds8eXlq_Y",Bi={supabase:{url:lj(),anonKey:cj()}};function uj(){return Bi.supabase.url&&Bi.supabase.anonKey?!0:(console.error("❌ Supabase設定が不完全です"),!1)}uj();const Ug=Bi.supabase.url,Fg=Bi.supabase.anonKey;let _a=null;const dj=Ug==="offline"||Fg==="offline";if(dj)console.log("🔄 オフラインモードで動作します"),_a={auth:{getUser:()=>Promise.resolve({data:{user:null},error:null}),signIn:()=>Promise.resolve({data:{user:null},error:{message:"オフラインモードです"}}),signUp:()=>Promise.resolve({data:{user:null},error:{message:"オフラインモードです"}}),signOut:()=>Promise.resolve({error:null})},from:()=>({select:()=>Promise.resolve({data:[],error:null}),insert:()=>Promise.resolve({data:[],error:null}),update:()=>Promise.resolve({data:[],error:null}),delete:()=>Promise.resolve({data:[],error:null})})};else try{_a=Lg(Ug,Fg)}catch(t){console.error("❌ Supabaseクライアント作成に失敗。オフラインモードに切り替えます:",t),_a={auth:{getUser:()=>Promise.resolve({data:{user:null},error:null}),signIn:()=>Promise.resolve({data:{user:null},error:{message:"オフラインモードです"}}),signUp:()=>Promise.resolve({data:{user:null},error:{message:"オフラインモードです"}}),signOut:()=>Promise.resolve({error:null})},from:()=>({select:()=>Promise.resolve({data:[],error:null}),insert:()=>Promise.resolve({data:[],error:null}),update:()=>Promise.resolve({data:[],error:null}),delete:()=>Promise.resolve({data:[],error:null})})}}class Ma{static async saveBattleResult(e){const r=`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n={...e,id:r};if(this.saveToLocalStorage(n),console.log("ローカルストレージに保存完了:",n),navigator.onLine===!1)return console.log("オフラインモード: ローカルストレージのみ使用"),n;try{console.log("Supabaseに保存を試行:",{room_id:e.roomId,user_id:e.userId,username:e.username,problem_id:e.problemId,accuracy:e.accuracy,training_time:Math.round(Number(e.trainingTime)),model_type:e.modelType,battle_type:e.battleType});const{data:a,error:i}=await _a.from("battle_results").insert([{room_id:e.roomId,user_id:e.userId,username:e.username,problem_id:e.problemId,accuracy:e.accuracy,training_time:Math.round(Number(e.trainingTime)),model_type:e.modelType,parameters:e.parameters,is_private:e.isPrivate,battle_type:e.battleType,team_id:e.teamId,team_members:e.teamMembers,score:e.score}]).select().single();i?(console.error("Supabase保存エラー:",i),console.error("エラー詳細:",{code:i.code,message:i.message,details:i.details,hint:i.hint}),this.scheduleRetry(n)):(console.log("Supabaseに保存完了:",a),this.removeFromLocalStorage(n.id))}catch(a){console.error("Supabase接続エラー:",a),this.scheduleRetry(n)}return n}static saveToLocalStorage(e){const r=JSON.parse(localStorage.getItem("battle_submissions")||"[]");r.push(e),localStorage.setItem("battle_submissions",JSON.stringify(r)),console.log("ローカルストレージに保存:",e)}static scheduleRetry(e){const r=JSON.parse(localStorage.getItem("retry_queue")||"[]");r.push({...e,retryCount:0,nextRetry:Date.now()+5e3}),localStorage.setItem("retry_queue",JSON.stringify(r))}static removeFromLocalStorage(e){const n=JSON.parse(localStorage.getItem("battle_submissions")||"[]").filter(a=>a.id!==e);localStorage.setItem("battle_submissions",JSON.stringify(n))}static async processRetryQueue(){const e=JSON.parse(localStorage.getItem("retry_queue")||"[]"),r=Date.now();for(let n=e.length-1;n>=0;n--){const a=e[n];if(r>=a.nextRetry&&a.retryCount<3)try{await this.saveBattleResult(a),e.splice(n,1)}catch{a.retryCount++,a.nextRetry=Date.now()+5e3*Math.pow(2,a.retryCount)}}localStorage.setItem("retry_queue",JSON.stringify(e))}static createTeam(e,r){const n=`team_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,a={id:n,leader:e,members:[e],usernames:[r],createdAt:new Date().toISOString(),isActive:!0},i=JSON.parse(localStorage.getItem("teams")||"[]");return i.push(a),localStorage.setItem("teams",JSON.stringify(i)),n}static joinTeam(e,r,n){const a=JSON.parse(localStorage.getItem("teams")||"[]"),i=a.find(s=>s.id===e);return!i||!i.isActive?!1:(i.members.includes(r)||(i.members.push(r),i.usernames.push(n),localStorage.setItem("teams",JSON.stringify(a))),!0)}static getTeam(e){return JSON.parse(localStorage.getItem("teams")||"[]").find(n=>n.id===e)||null}static async getLeaderboard(e=10,r=!1,n){try{let a=_a.from("leaderboard_view").select("*").order("score",{ascending:!1}).limit(e);const{data:i,error:s}=await a;if(s)return console.error("Supabase取得エラー:",s),this.getLeaderboardFromLocal(e,r,n);if(i&&i.length>0)return console.log("Supabaseからリーダーボード取得:",i),i.map((o,l)=>({rank:l+1,userId:o.user_id,username:o.username,totalBattles:o.total_battles,wins:o.wins,losses:o.losses,winRate:o.total_battles>0?o.wins/o.total_battles:0,averageAccuracy:o.average_accuracy,bestAccuracy:o.best_accuracy,totalScore:o.total_score,lastBattleAt:o.last_battle_at,isPrivate:o.is_private,battleType:o.battle_type,teamId:o.team_id,teamMembers:o.team_members,level:1,streak:o.streak||0}))}catch(a){console.error("Supabase接続エラー:",a)}return this.getLeaderboardFromLocal(e,r,n)}static getLeaderboardFromLocal(e,r,n){const a=JSON.parse(localStorage.getItem("battle_submissions")||"[]");console.log("ローカルストレージから取得した提出データ:",a);const i=a.filter(s=>{const o=r?s.isPrivate===!0:s.isPrivate!==!0,l=!n||s.battleType===n;return o&&l});return console.log("フィルタリング後の提出データ:",i),this.getUnifiedLeaderboard(i,e)}static getUnifiedLeaderboard(e,r){const n=new Map;return e.forEach(i=>{const s=i.battleType==="team"?i.teamId||`team_${i.userId}`:i.userId,o=i.battleType==="team"?`チーム ${i.teamId?.split("_")[1]||i.username}`:i.username;n.has(s)||n.set(s,{userId:s,username:o,totalBattles:0,wins:0,losses:0,accuracies:[],totalScore:0,lastBattleAt:i.submittedAt,isPrivate:i.isPrivate||!1,battleType:i.battleType,teamId:i.teamId,teamMembers:i.teamMembers});const l=n.get(s);l.totalBattles++,i.accuracy>.8?l.wins++:l.losses++,l.accuracies.push(i.accuracy),l.totalScore+=i.accuracy*1e3,l.lastBattleAt=i.submittedAt}),Array.from(n.values()).map(i=>({userId:i.userId,username:i.username,totalBattles:i.totalBattles,wins:i.wins,losses:i.losses,winRate:i.totalBattles>0?i.wins/i.totalBattles:0,averageAccuracy:i.accuracies.reduce((s,o)=>s+o,0)/i.accuracies.length,bestAccuracy:Math.max(...i.accuracies),totalScore:i.totalScore,lastBattleAt:i.lastBattleAt,isPrivate:i.isPrivate,battleType:i.battleType,teamId:i.teamId,teamMembers:i.teamMembers,level:1,streak:0})).sort((i,s)=>s.totalScore-i.totalScore).slice(0,r).map((i,s)=>({...i,rank:s+1}))}static getTeamLeaderboard(e,r){const n=new Map;return e.forEach(i=>{const s=i.teamId||`team_${i.userId}`,o=`チーム ${s.split("_")[1]||i.username}`;n.has(s)||n.set(s,{teamId:s,teamName:o,teamMembers:i.teamMembers||[i.username],totalBattles:0,wins:0,losses:0,accuracies:[],totalScore:0,lastBattleAt:i.submittedAt,isPrivate:i.isPrivate||!1});const l=n.get(s);l.totalBattles++,i.accuracy>.8?l.wins++:l.losses++,l.accuracies.push(i.accuracy),l.totalScore+=i.accuracy*1e3,l.lastBattleAt=i.submittedAt}),Array.from(n.values()).map(i=>({userId:i.teamId,username:i.teamName,totalBattles:i.totalBattles,wins:i.wins,losses:i.losses,winRate:i.totalBattles>0?i.wins/i.totalBattles:0,averageAccuracy:i.accuracies.reduce((s,o)=>s+o,0)/i.accuracies.length,bestAccuracy:Math.max(...i.accuracies),totalScore:i.totalScore,lastBattleAt:i.lastBattleAt,isPrivate:i.isPrivate,teamId:i.teamId,teamMembers:i.teamMembers,level:1,streak:0,battleType:"team"})).sort((i,s)=>s.totalScore-i.totalScore).slice(0,r).map((i,s)=>({...i,rank:s+1}))}static async getUserStats(e){return(await this.getLeaderboard(100)).find(n=>n.userId===e)||null}static async getBattleHistory(e,r=20){return JSON.parse(localStorage.getItem("battle_submissions")||"[]").filter(a=>a.userId===e).sort((a,i)=>new Date(i.submittedAt).getTime()-new Date(a.submittedAt).getTime()).slice(0,r)}static async getProblemLeaderboard(e,r=10,n=!1,a){const i=JSON.parse(localStorage.getItem("battle_submissions")||"[]"),s=JSON.parse(localStorage.getItem("offline_data_battle_result")||"[]");console.log("リーダーボード取得:",{problemId:e,submissions:i.length,offlineData:s.length,isPrivate:n,battleType:a});const l=[...i,...s].filter(h=>{const f=h.problemId===e,m=n?h.isPrivate===!0:h.isPrivate!==!0,p=!a||h.battleType===a;return f&&m&&p});return console.log("フィルタリング後:",{filteredSubmissions:l.length,submissions:l}),l.length===0?(console.log("データなし - サンプルデータを生成"),[{userId:"sample_user_1",username:"サンプルプレイヤー1",accuracy:.85,score:850,rank:1,submittedAt:new Date().toISOString(),modelType:"logistic_regression",trainingTime:45,isPrivate:!1,battleType:"individual"},{userId:"sample_user_2",username:"サンプルプレイヤー2",accuracy:.78,score:780,rank:2,submittedAt:new Date().toISOString(),modelType:"neural_network",trainingTime:120,isPrivate:!1,battleType:"individual"}]):l.map(h=>{const f=typeof h.accuracy=="number"&&!isNaN(h.accuracy)?h.accuracy:0,m=typeof h.trainingTime=="number"&&!isNaN(h.trainingTime)?h.trainingTime:0,p=h.modelType||"logistic_regression",g=Math.round(f*1e3);return{...h,accuracy:f,trainingTime:m,modelType:p,score:g}}).sort((h,f)=>f.score-h.score).slice(0,r).map((h,f)=>({userId:h.userId||`user_${f+1}`,username:h.username||"プレイヤー",accuracy:h.accuracy||0,score:h.score||0,rank:f+1,submittedAt:h.submittedAt||new Date().toISOString(),modelType:h.modelType||"logistic_regression",trainingTime:h.trainingTime||120,isPrivate:h.isPrivate||!1,battleType:h.battleType||"individual"}))}static async getProblemStats(e){const n=JSON.parse(localStorage.getItem("battle_submissions")||"[]").filter(l=>l.problemId===e);if(n.length===0)return{totalSubmissions:0,averageAccuracy:0,bestAccuracy:0,topParticipants:[]};const a=n.map(l=>l.accuracy),i=a.reduce((l,d)=>l+d,0)/a.length,s=Math.max(...a),o=n.sort((l,d)=>d.accuracy-l.accuracy).slice(0,10).map(l=>({username:l.username,accuracy:l.accuracy,submittedAt:l.submittedAt}));return{totalSubmissions:n.length,averageAccuracy:i,bestAccuracy:s,topParticipants:o}}}class Sr{static instance;static getInstance(){return this.instance||(this.instance=new Sr),this.instance}static validateEnvironment(){return{isValid:!0,missingVars:[],errors:[]}}static getSecureSupabaseConfig(){const e=this.validateEnvironment();return e.isValid?{url:"https://ovghanpxibparkuyxxdh.supabase.co",key:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92Z2hhbnB4aWJwYXJrdXl4eGRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU4NDQ5NzQsImV4cCI6MjA1MTQyMDk3NH0.placeholder"}:(console.error("環境変数の検証に失敗しました:",e),null)}static showSecurityWarning(){}static checkDevelopmentSecurity(){}static checkProductionSecurity(){}}Sr.getInstance();class hj{socket=null;roomId=null;userId=null;callbacks=new Map;supabase=null;supabaseChannel=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;isReconnecting=!1;heartbeatInterval=null;constructor(){this.setupSupabaseRealtime()}setupSupabaseRealtime(){try{Sr.checkDevelopmentSecurity(),Sr.checkProductionSecurity();const e=Sr.getSecureSupabaseConfig();if(!e){console.error("Supabase設定の取得に失敗しました"),this.emit("error",new Error("Supabase設定が無効です"));return}this.supabase=Lg(e.url,e.key),console.log("Supabase Realtime接続を開始"),this.supabase.from("battle_events").select("count").limit(1).then(()=>{console.log("Supabase Realtime接続完了"),this.emit("connected")}).catch(r=>{console.error("Supabase接続エラー:",r),this.emit("error",r)})}catch(e){console.error("Supabase初期化エラー:",e),this.emit("error",e)}}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{console.log("WebSocket接続完了"),this.emit("connected")}),this.socket.on("disconnect",()=>{console.log("WebSocket接続切断"),this.emit("disconnected")}),this.socket.on("realtime_update",e=>{this.emit("realtime_update",e)}),this.socket.on("participant_update",e=>{this.emit("participant_update",e)}),this.socket.on("chat_message",e=>{this.emit("chat_message",e)}),this.socket.on("battle_start",e=>{this.emit("battle_start",e)}),this.socket.on("battle_end",e=>{this.emit("battle_end",e)}),this.socket.on("weekly_problem_change",e=>{this.emit("weekly_problem_change",e)}),this.socket.on("participant_count_update",e=>{this.emit("participant_count_update",e)}),this.socket.on("submission_count_update",e=>{this.emit("submission_count_update",e)}),this.socket.on("error",e=>{console.error("WebSocketエラー:",e),this.emit("error",e)}))}connect(e,r){this.userId=e,this.roomId=r,this.supabase?this.setupSupabaseChannel(r):this.socket&&!this.socket.connected&&this.socket.connect()}setupSupabaseChannel(e){this.supabase&&(this.supabaseChannel&&this.supabaseChannel.unsubscribe(),this.supabaseChannel=this.supabase.channel(`battle_room_${e}`).on("postgres_changes",{event:"*",schema:"public",table:"battle_events",filter:`room_id=eq.${e}`},r=>{this.handleSupabaseUpdate(r)}).on("broadcast",{event:"battle_progress"},r=>{this.handleBattleProgress(r)}).on("broadcast",{event:"chat_message"},r=>{this.handleChatMessage(r)}).subscribe())}handleSupabaseUpdate(e){const{eventType:r,new:n,old:a}=e;switch(r){case"INSERT":this.emit("participant_update",{userId:n.user_id,username:n.username,status:n.status,progress:n.progress});break;case"UPDATE":this.emit("realtime_update",{type:"progress",data:n,timestamp:new Date().toISOString(),userId:n.user_id,roomId:n.room_id});break;case"DELETE":this.emit("participant_update",{userId:a.user_id,username:a.username,status:"left",progress:0});break}}handleBattleProgress(e){this.emit("realtime_update",{type:"progress",data:e,timestamp:new Date().toISOString(),userId:e.userId,roomId:e.roomId})}handleChatMessage(e){this.emit("chat_message",{id:e.id,userId:e.userId,username:e.username,message:e.message,timestamp:e.timestamp,roomId:e.roomId})}disconnect(){this.socket&&this.socket.connected&&this.socket.disconnect(),this.userId=null,this.roomId=null}joinRoom(e,r){this.socket&&this.socket.connected&&this.socket.emit("join_room",{roomId:e,username:r})}leaveRoom(e){this.socket&&this.socket.connected&&this.socket.emit("leave_room",{roomId:e})}sendProgress(e,r,n=!1){console.log("進捗送信:",{progress:e,currentStep:r,isReady:n,userId:this.userId,roomId:this.roomId}),this.supabase&&this.supabaseChannel?this.supabaseChannel.send({type:"broadcast",event:"battle_progress",payload:{userId:this.userId,roomId:this.roomId,progress:e,currentStep:r,isReady:n,timestamp:new Date().toISOString()}}):this.socket&&this.socket.connected&&this.roomId&&this.socket.emit("progress_update",{roomId:this.roomId,progress:e,currentStep:r,isReady:n,timestamp:new Date().toISOString()})}sendChatMessage(e){this.supabase&&this.supabaseChannel?this.supabaseChannel.send({type:"broadcast",event:"chat_message",payload:{id:Date.now().toString(),userId:this.userId,username:"プレイヤー",message:e,timestamp:new Date().toISOString(),roomId:this.roomId}}):this.socket&&this.socket.connected&&this.roomId&&this.userId&&this.socket.emit("chat_message",{roomId:this.roomId,userId:this.userId,message:e,timestamp:new Date().toISOString()})}startBattle(e){this.socket&&this.socket.connected&&this.socket.emit("start_battle",{roomId:e})}endBattle(e,r){this.socket&&this.socket.connected&&this.socket.emit("end_battle",{roomId:e,result:r})}broadcastUpdate(e){this.socket&&this.socket.connected&&this.socket.emit("broadcast_update",e)}on(e,r){this.callbacks.has(e)||this.callbacks.set(e,[]),this.callbacks.get(e).push(r)}off(e,r){const n=this.callbacks.get(e);if(n){const a=n.indexOf(r);a>-1&&n.splice(a,1)}}emit(e,r){const n=this.callbacks.get(e);n&&n.forEach(a=>a(r))}isConnected(){return this.socket?this.socket.connected:!1}getCurrentRoom(){return this.roomId}getCurrentUser(){return this.userId}broadcastLeaderboardUpdate(e,r){this.broadcastUpdate({type:"leaderboard_update",data:{problemId:e,leaderboard:r},timestamp:new Date().toISOString(),userId:this.userId||"system",roomId:this.roomId||"global"})}}const se=new hj;class Ti{static submissions=new Map;static leaderboards=new Map;static async createSubmission(e,r,n,a,i,s,o,l,d){const c=Ke.getProblem(e);if(!c)throw new Error("問題が見つかりません");if(!Ke.isProblemActive(e))throw new Error("この問題は既に終了しています");const h=await ko.evaluatePlayerModel(c.dataset,a,i,s,o),f={id:`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:r,username:n,problemId:e,predictions:h.predictions,probabilities:h.probabilities,selectedFeatures:a,modelType:i,parameters:s,preprocessing:o,submittedAt:new Date,teamId:l,teamMembers:d};this.submissions.has(e)||this.submissions.set(e,[]),this.submissions.get(e).push(f);try{const m=Math.round(h.validationScore*100);console.log("保存するスコア:",m,"validationScore:",h.validationScore),await Ma.saveBattleResult({problemId:f.problemId,roomId:`comp_${f.problemId}`,userId:f.userId,username:f.username,accuracy:h.validationScore,score:m,trainingTime:h.trainingTime,modelType:f.modelType,parameters:f.parameters,isPrivate:!1,battleType:f.teamId?"team":"individual",teamId:f.teamId,teamMembers:f.teamMembers?.map(p=>({userId:p,username:p}))}),console.log("BattleDatabaseに保存完了 - スコア:",m)}catch(m){console.error("BattleDatabaseへの保存に失敗:",m)}return await this.updateLeaderboard(e),this.broadcastLeaderboardUpdate(e),f}static broadcastLeaderboardUpdate(e){try{const r=this.getLeaderboard(e);r&&(se.broadcastLeaderboardUpdate(e,r),console.log("リーダーボード更新をブロードキャスト:",e))}catch(r){console.error("リーダーボードブロードキャストエラー:",r)}}static getSubmissions(e){return this.submissions.get(e)||[]}static getUserSubmissions(e,r){return this.getSubmissions(e).filter(a=>a.userId===r)}static getLeaderboard(e,r=20){return this.leaderboards.get(e)||null}static async updateLeaderboard(e,r=100){const n=Ke.getProblem(e);if(!n)return;const a=this.getSubmissions(e),i=await Promise.all(a.map(async o=>{try{const l=await ko.evaluateOfficialModel(n.dataset,o);return{...o,score:l.testScore}}catch(l){return console.error("提出の評価に失敗:",l),{...o,score:0}}}));i.sort((o,l)=>(l.score||0)-(o.score||0)),i.forEach((o,l)=>{o.rank=l+1});const s={problemId:e,submissions:i.slice(0,r),lastUpdated:new Date,totalSubmissions:i.length,participantCount:new Set(i.map(o=>o.userId)).size};this.leaderboards.set(e,s);try{const o=await Ma.getProblemLeaderboard(e,"individual",r);console.log("BattleDatabaseリーダーボード同期:",o)}catch(o){console.error("リーダーボード同期エラー:",o)}Ke.updateSubmissionCount(e,i.length),Ke.updateParticipantCount(e,s.participantCount)}static async evaluatePrivateSubmission(e,r){const n=Ke.getProblem(e);if(!n)throw new Error("問題が見つかりません");const a=this.getSubmissions(e).find(s=>s.id===r);if(!a)throw new Error("提出が見つかりません");const i=await ko.evaluateOfficialModel(n.dataset,a);return a.score=i.testScore,a.privateScore=i.testScore,a.privateEvaluationDate=new Date,i}static getSubmissionStats(e){const r=this.getSubmissions(e),n=r.map(a=>a.score||0).filter(a=>a>0);return{totalSubmissions:r.length,participantCount:new Set(r.map(a=>a.userId)).size,averageScore:n.length>0?n.reduce((a,i)=>a+i,0)/n.length:0,bestScore:n.length>0?Math.max(...n):0,worstScore:n.length>0?Math.min(...n):0}}static getSubmissionHistory(e,r){const n=this.getUserSubmissions(e,r);this.getSubmissions(e);const a=n.length>0?Math.max(...n.map(l=>l.score||0)):0,i=n.length>1?(n[n.length-1].score||0)-(n[0].score||0):0,s=n.find(l=>l.score===a),o=s&&s.rank||0;return{submissions:n,bestScore:a,improvement:i,rank:o}}static deleteSubmission(e,r){const n=this.getSubmissions(e),a=n.findIndex(i=>i.id===r);return a===-1?!1:(n.splice(a,1),this.updateLeaderboard(e),!0)}static clearSubmissions(e){this.submissions.delete(e),this.leaderboards.delete(e)}static checkSubmissionLimit(e,r){const n=Ke.getProblem(e);if(!n)return{canSubmit:!1,remainingSubmissions:0,maxSubmissions:0};const a=this.getUserSubmissions(e,r),i=n.constraints.maxSubmissions-a.length;return{canSubmit:i>0,remainingSubmissions:Math.max(0,i),maxSubmissions:n.constraints.maxSubmissions}}}class hi{static currentWeek=0;static problemRotationInterval=null;static WEEK_DURATION=10080*60*1e3;static isInitialized=!1;static JST_OFFSET=540*60*1e3;static START_TIME=new Date("2024-01-01T00:00:00+09:00");static startWeeklyRotation(){if(this.isInitialized){console.log("週次問題切り替えシステムは既に開始されています");return}console.log("週次問題切り替えシステムを開始します"),this.isInitialized=!0,this.currentWeek=this.getCurrentWeekFromStart(),console.log(`現在の週: ${this.currentWeek} (日本時間基準)`),this.generateWeeklyProblems(),this.scheduleWeeklyRotation(),console.log(`週次問題切り替えシステム開始 - 現在の週: ${this.currentWeek}`)}static rotateToNextWeek(){this.currentWeek=this.getCurrentWeekFromStart(),console.log(`週次問題切り替え: 第${this.currentWeek}週開始 (日本時間基準)`),this.generateWeeklyProblems(),this.archivePreviousWeekProblems(),this.notifyWeeklyProblemChange(),this.scheduleWeeklyRotation()}static getCurrentWeek(){return this.currentWeek}static getCurrentWeekFromStart(){const e=new Date,n=new Date(e.getTime()+this.JST_OFFSET).getTime()-this.START_TIME.getTime(),a=Math.floor(n/this.WEEK_DURATION)+1;return Math.max(1,a)}static scheduleWeeklyRotation(){this.problemRotationInterval&&clearTimeout(this.problemRotationInterval);const e=new Date;new Date(e.getTime()+this.JST_OFFSET);const r=new Date(this.START_TIME.getTime()+(this.currentWeek-1)*this.WEEK_DURATION),n=new Date(r.getTime()+this.WEEK_DURATION),i=new Date(n.getTime()-this.JST_OFFSET).getTime()-e.getTime();console.log(`次の週次切り替え: ${n.toLocaleString("ja-JP",{timeZone:"Asia/Tokyo"})}`),this.problemRotationInterval=setTimeout(()=>{this.rotateToNextWeek()},i)}static getCurrentWeekProblem(){const e=`week_${this.currentWeek}`;return Ke.getProblem(e)}static async generateWeeklyProblems(){const e=`week_${this.currentWeek}`,r=["classification","regression"],n=r[this.currentWeek%r.length];console.log(`第${this.currentWeek}週の問題を生成中: ${n}`);try{await Ke.createProblem(e,`第${this.currentWeek}週 ${n==="classification"?"分類":"回帰"}問題`,`週次コンペティション問題 - ${n}。今週は${n==="classification"?"分類":"回帰"}問題に挑戦してください。`,this.generateWeeklyData(n),this.getWeeklyFeatureNames(n),"target",n,n==="classification"?["クラスA","クラスB","クラスC","クラスD"]:void 0),console.log(`第${this.currentWeek}週の問題生成完了: ${e}`)}catch(a){console.error(`第${this.currentWeek}週の問題生成エラー:`,a)}}static archivePreviousWeekProblems(){const e=`week_${this.currentWeek-1}`,r=Ke.getProblem(e);r&&(r.endTime=new Date,console.log(`前週の問題をアーカイブしました: ${e}`))}static generateWeeklyData(e){const r=5e3+Math.random()*3e3;return e==="classification"?this.generateClassificationWeeklyData(Math.floor(r)):this.generateRegressionWeeklyData(Math.floor(r))}static generateClassificationWeeklyData(e){const r=[],n=["クラスA","クラスB","クラスC","クラスD"];for(let a=0;a<e;a++){const i=Math.floor(Math.random()*n.length),s=Math.sin(this.currentWeek*.5)*.3+.7,o=[Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s,Math.random()*100*s];i>0&&(o[i-1]+=50+Math.random()*50,o[7]+=30),r.push({features:o,label:n[i]})}return r}static generateRegressionWeeklyData(e){const r=[];for(let n=0;n<e;n++){const a=1+Math.sin(this.currentWeek*.3)*.5,i=[Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a,Math.random()*100*a],s=i.reduce((o,l,d)=>{const c=(d+1)*.1*a;return o+l*c},0)+(Math.random()-.5)*50;r.push({features:i,label:Math.max(0,s)})}return r}static getWeeklyFeatureNames(e){return e==="classification"?["特徴量1","特徴量2","特徴量3","特徴量4","特徴量5","特徴量6","特徴量7","特徴量8","特徴量9","特徴量10"]:["入力変数1","入力変数2","入力変数3","入力変数4","入力変数5","入力変数6","入力変数7","入力変数8","入力変数9","入力変数10"]}static stopWeeklyRotation(){this.problemRotationInterval&&(clearTimeout(this.problemRotationInterval),this.problemRotationInterval=null),this.isInitialized=!1,console.log("週次問題切り替えシステムを停止しました")}static getTimeUntilNextRotation(){const e=new Date;new Date(e.getTime()+this.JST_OFFSET);const r=new Date(this.START_TIME.getTime()+(this.currentWeek-1)*this.WEEK_DURATION),n=new Date(r.getTime()+this.WEEK_DURATION);return new Date(n.getTime()-this.JST_OFFSET).getTime()-e.getTime()}static getCurrentWeekProgress(){const e=new Date,r=new Date(e.getTime()+this.JST_OFFSET),n=new Date(this.START_TIME.getTime()+(this.currentWeek-1)*this.WEEK_DURATION),a=r.getTime()-n.getTime();return Math.min(1,Math.max(0,a/this.WEEK_DURATION))}static getCurrentJSTTime(){const e=new Date;return new Date(e.getTime()+this.JST_OFFSET)}static getWeekStartTime(e){return new Date(this.START_TIME.getTime()+(e-1)*this.WEEK_DURATION)}static getWeekEndTime(e){const r=this.getWeekStartTime(e);return new Date(r.getTime()+this.WEEK_DURATION)}static notifyWeeklyProblemChange(){try{const e=this.getCurrentWeekProblem();e&&(se.broadcastUpdate({type:"weekly_problem_change",data:{week:this.currentWeek,problem:{id:e.id,title:e.title,description:e.description,difficulty:e.difficulty,timeLimit:e.timeLimit,participantCount:e.participantCount||0},nextRotation:this.getTimeUntilNextRotation(),progress:this.getCurrentWeekProgress()},timestamp:new Date().toISOString(),userId:"system",roomId:"global"}),console.log(`週次問題切り替え通知送信: 第${this.currentWeek}週`))}catch(e){console.error("週次問題切り替え通知エラー:",e)}}static updateParticipantCount(e,r){try{const n=Ke.getProblem(e);n&&(n.participantCount=(n.participantCount||0)+r,se.broadcastUpdate({type:"participant_count_update",data:{problemId:e,participantCount:n.participantCount,week:this.currentWeek},timestamp:new Date().toISOString(),userId:"system",roomId:"global"}),console.log(`参加者数更新: ${e} - ${n.participantCount}人`))}catch(n){console.error("参加者数更新エラー:",n)}}static updateSubmissionCount(e,r){try{const n=Ke.getProblem(e);n&&(n.submissionCount=(n.submissionCount||0)+r,se.broadcastUpdate({type:"submission_count_update",data:{problemId:e,submissionCount:n.submissionCount,week:this.currentWeek},timestamp:new Date().toISOString(),userId:"system",roomId:"global"}),console.log(`提出数更新: ${e} - ${n.submissionCount}件`))}catch(n){console.error("提出数更新エラー:",n)}}static getWeeklyStats(){const e=this.getCurrentWeekProblem();return{week:this.currentWeek,problem:e,participantCount:e?.participantCount||0,submissionCount:e?.submissionCount||0,timeUntilNext:this.getTimeUntilNextRotation(),progress:this.getCurrentWeekProgress()}}}class Eu{static instance;static CACHE_DURATION=300*1e3;cache=new Map;static getInstance(){return this.instance||(this.instance=new Eu),this.instance}async getProblem(e){const r=`problem_${e}`,n=this.getCachedData(r);if(n)return n;try{const a=hi.getCurrentWeekProblem();if(a&&a.id===e)return this.setCachedData(r,a),a;const i=Ke.getProblem(e);return i?(this.setCachedData(r,i),i):null}catch(a){return console.error("問題取得エラー:",a),null}}async getLeaderboard(e,r=20){const n=`leaderboard_${e}_${r}`,a=this.getCachedData(n);if(a)return a;try{const i=await Ti.getLeaderboard(e,r);return this.setCachedData(n,i),i}catch(i){return console.error("リーダーボード取得エラー:",i),{submissions:[],total:0}}}async submitResult(e,r,n,a,i,s,o,l,d,c,h){try{const f=await Ti.createSubmission(e,r,n,a,i,s,o,l,d);return this.broadcastSubmissionUpdate(e,f),this.clearCache(`leaderboard_${e}`),this.clearCache(`problem_${e}`),f}catch(f){throw console.error("提出エラー:",f),f}}async refreshLeaderboard(e){try{this.clearCache(`leaderboard_${e}`);const r=await Ti.getLeaderboard(e);return r&&se.broadcastLeaderboardUpdate(e,r),r}catch(r){throw console.error("リーダーボード更新エラー:",r),r}}getWeeklyStats(){return hi.getWeeklyStats()}updateParticipantCount(e,r){try{hi.updateParticipantCount(e,r);const n=Ke.getProblem(e);n&&(n.participantCount=(n.participantCount||0)+r)}catch(n){console.error("参加者数更新エラー:",n)}}updateSubmissionCount(e,r){try{hi.updateSubmissionCount(e,r);const n=Ke.getProblem(e);n&&(n.submissionCount=(n.submissionCount||0)+r)}catch(n){console.error("提出数更新エラー:",n)}}broadcastSubmissionUpdate(e,r){try{se.broadcastUpdate({type:"submission_count_update",data:{problemId:e,submissionId:r.id,userId:r.userId,username:r.username,score:r.score,timestamp:r.submittedAt},timestamp:new Date().toISOString(),userId:"system",roomId:"global"})}catch(n){console.error("リアルタイム更新エラー:",n)}}getCachedData(e){const r=this.cache.get(e);return r&&Date.now()-r.timestamp<this.CACHE_DURATION?r.data:null}setCachedData(e,r){this.cache.set(e,{data:r,timestamp:Date.now()})}clearCache(e){this.cache.delete(e)}clearAllCache(){this.cache.clear()}async validateDataConsistency(e){try{const r=await this.getProblem(e),n=await this.getLeaderboard(e);if(!r)return!1;const a=n.submissions?.length||0,i=r.submissionCount||0;return Math.abs(a-i)>1?(console.warn("データ不整合を検出:",{problemId:e,actualSubmissions:a,reportedSubmissions:i}),r.submissionCount=a,!1):!0}catch(r){return console.error("データ整合性チェックエラー:",r),!1}}}const fj=Eu.getInstance();function Oa(t){return t.reduce((e,r)=>e+r,0)/t.length}function mj(t){const e=[...t].sort((n,a)=>n-a),r=Math.floor(e.length/2);return e.length%2===0?(e[r-1]+e[r])/2:e[r]}function pj(t){const e=Oa(t),r=t.map(a=>Math.pow(a-e,2)),n=Oa(r);return Math.sqrt(n)}function uf(t,e){const r=[...t].sort((s,o)=>s-o),n=(r.length-1)*e,a=Math.floor(n),i=n-a;return r[a+1]!==void 0?r[a]+i*(r[a+1]-r[a]):r[a]}function gj(t){const e=[];for(let r=0;r<t.featureNames.length;r++){const n=t.raw?.train?.map(a=>a.features[r])??t.train.map(a=>a.features[r]);e.push({name:t.featureNames[r],mean:Oa(n),median:mj(n),std:pj(n),min:Math.min(...n),max:Math.max(...n),q1:uf(n,.25),q3:uf(n,.75)})}return e}function vj(t,e){const r=t.length,n=Oa(t),a=Oa(e);let i=0,s=0,o=0;for(let d=0;d<r;d++){const c=t[d]-n,h=e[d]-a;i+=c*h,s+=c*c,o+=h*h}const l=Math.sqrt(s*o);return l===0?0:i/l}function yj(t){const e=t.featureNames.length,r=[];for(let n=0;n<e;n++){r[n]=[];const a=t.raw?.train?.map(i=>i.features[n])??t.train.map(i=>i.features[n]);for(let i=0;i<e;i++){const s=t.raw?.train?.map(o=>o.features[i])??t.train.map(o=>o.features[i]);r[n][i]=vj(a,s)}}return r}function df(t,e=10){const r=Math.min(...t),i=(Math.max(...t)-r)/e,s=Array(e).fill(0),o=[];for(let l=0;l<e;l++){const d=r+l*i,c=r+(l+1)*i;o.push(`${d.toFixed(2)}-${c.toFixed(2)}`)}return t.forEach(l=>{const d=Math.min(Math.floor((l-r)/i),e-1);s[d]++}),s.map((l,d)=>({bin:o[d],count:l}))}function bj(t){if(!t.classes)return[];const e=new Map;return t.train.forEach(r=>{const n=r.label;e.set(n,(e.get(n)||0)+1)}),Array.from(e.entries()).map(([r,n])=>({class:t.classes?t.classes[Number(r)]:String(r),count:n}))}function Ne(t,e=2){if(t==null)return"";const r=typeof t=="string"?Number(t):t;return isFinite(r)?r.toFixed(e).replace(/\.0+$/,"").replace(/(\.\d*?[1-9])0+$/,"$1"):String(t)}function xj({dataset:t}){const e=gj(t);return u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-green-600",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(Tn,{className:"w-5 h-5 text-green-900"}),u.jsx("h3",{className:"text-lg font-bold text-green-900",children:"統計情報"})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b-2 border-green-300",children:[u.jsx("th",{className:"px-2 py-2 text-left text-green-900",children:"特徴量"}),u.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"平均"}),u.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"中央値"}),u.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"標準偏差"}),u.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"最小値"}),u.jsx("th",{className:"px-2 py-2 text-right text-green-900",children:"最大値"})]})}),u.jsx("tbody",{children:e.map((r,n)=>u.jsxs("tr",{className:"border-b border-green-200 hover:bg-green-50",children:[u.jsx("td",{className:"px-2 py-2 font-medium text-green-900",children:r.name}),u.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.mean)}),u.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.median)}),u.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.std)}),u.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.min)}),u.jsx("td",{className:"px-2 py-2 text-right text-green-800",children:Ne(r.max)})]},n))})]})}),u.jsx("div",{className:"mt-4 grid grid-cols-1 gap-3",children:e.map((r,n)=>u.jsxs("div",{className:"bg-green-50 p-3 rounded border border-green-300",children:[u.jsx("div",{className:"text-sm font-medium text-green-900 mb-2",children:r.name}),u.jsxs("div",{className:"relative h-8 bg-green-100 rounded",children:[u.jsx("div",{className:"absolute h-full bg-green-300 rounded-l",style:{left:"0%",width:`${(r.q1-r.min)/(r.max-r.min)*100}%`}}),u.jsx("div",{className:"absolute h-full bg-green-500",style:{left:`${(r.q1-r.min)/(r.max-r.min)*100}%`,width:`${(r.q3-r.q1)/(r.max-r.min)*100}%`}}),u.jsx("div",{className:"absolute h-full bg-green-300 rounded-r",style:{left:`${(r.q3-r.min)/(r.max-r.min)*100}%`,width:`${(r.max-r.q3)/(r.max-r.min)*100}%`}}),u.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-red-600",style:{left:`${(r.mean-r.min)/(r.max-r.min)*100}%`}})]}),u.jsxs("div",{className:"flex justify-between text-xs text-green-700 mt-1",children:[u.jsxs("span",{children:["最小: ",r.min.toFixed(2)]}),u.jsxs("span",{children:["Q1: ",r.q1.toFixed(2)]}),u.jsxs("span",{className:"font-bold text-red-700",children:["平均: ",r.mean.toFixed(2)]}),u.jsxs("span",{children:["Q3: ",r.q3.toFixed(2)]}),u.jsxs("span",{children:["最大: ",r.max.toFixed(2)]})]})]},n))})]})}function Wg(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=Wg(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ee(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=Wg(t))&&(n&&(n+=" "),n+=e);return n}var $o={},Ro={},hf;function wj(){return hf||(hf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(Ro)),Ro}var Lo={},ff;function qg(){return ff||(ff=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(Lo)),Lo}var Bo={},mf;function zg(){return mf||(mf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(Bo)),Bo}var Uo={},pf;function Tu(){return pf||(pf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",o="",l=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const d=r[i];o?d==="\\"&&i+1<a?(i++,s+=r[i]):d===o?o="":s+=d:l?d==='"'||d==="'"?o=d:d==="]"?(l=!1,n.push(s),s=""):s+=d:d==="["?(l=!0,s&&(n.push(s),s="")):d==="."?s&&(n.push(s),s=""):s+=d,i++}return s&&n.push(s),n}t.toPath=e})(Uo)),Uo}var gf;function Cu(){return gf||(gf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wj(),r=qg(),n=zg(),a=Tu();function i(o,l,d){if(o==null)return d;switch(typeof l){case"string":{if(e.isUnsafeProperty(l))return d;const c=o[l];return c===void 0?r.isDeepKey(l)?i(o,a.toPath(l),d):d:c}case"number":case"symbol":{typeof l=="number"&&(l=n.toKey(l));const c=o[l];return c===void 0?d:c}default:{if(Array.isArray(l))return s(o,l,d);if(Object.is(l?.valueOf(),-0)?l="-0":l=String(l),e.isUnsafeProperty(l))return d;const c=o[l];return c===void 0?d:c}}}function s(o,l,d){if(l.length===0)return d;let c=o;for(let h=0;h<l.length;h++){if(c==null||e.isUnsafeProperty(l[h]))return d;c=c[l[h]]}return c===void 0?d:c}t.get=i})($o)),$o}var Fo,vf;function _j(){return vf||(vf=1,Fo=Cu().get),Fo}var jj=_j();const en=rr(jj);var Wo={exports:{}},de={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yf;function Sj(){if(yf)return de;yf=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function p(g){if(typeof g=="object"&&g!==null){var y=g.$$typeof;switch(y){case t:switch(g=g.type,g){case r:case a:case n:case l:case d:case f:return g;default:switch(g=g&&g.$$typeof,g){case s:case o:case h:case c:return g;case i:return g;default:return y}}case e:return y}}}return de.ContextConsumer=i,de.ContextProvider=s,de.Element=t,de.ForwardRef=o,de.Fragment=r,de.Lazy=h,de.Memo=c,de.Portal=e,de.Profiler=a,de.StrictMode=n,de.Suspense=l,de.SuspenseList=d,de.isContextConsumer=function(g){return p(g)===i},de.isContextProvider=function(g){return p(g)===s},de.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===t},de.isForwardRef=function(g){return p(g)===o},de.isFragment=function(g){return p(g)===r},de.isLazy=function(g){return p(g)===h},de.isMemo=function(g){return p(g)===c},de.isPortal=function(g){return p(g)===e},de.isProfiler=function(g){return p(g)===a},de.isStrictMode=function(g){return p(g)===n},de.isSuspense=function(g){return p(g)===l},de.isSuspenseList=function(g){return p(g)===d},de.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===a||g===n||g===l||g===d||typeof g=="object"&&g!==null&&(g.$$typeof===h||g.$$typeof===c||g.$$typeof===s||g.$$typeof===i||g.$$typeof===o||g.$$typeof===m||g.getModuleId!==void 0)},de.typeOf=p,de}var bf;function Nj(){return bf||(bf=1,Wo.exports=Sj()),Wo.exports}var Pj=Nj(),Be=t=>t===0?0:t>0?1:-1,ut=t=>typeof t=="number"&&t!=+t,Hr=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,q=t=>(typeof t=="number"||t instanceof Number)&&!ut(t),Dt=t=>q(t)||typeof t=="string",kj=0,Aa=t=>{var e=++kj;return"".concat(t||"").concat(e)},Ye=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!q(e)&&typeof e!="string")return n;var i;if(Hr(e)){if(r==null)return n;var s=e.indexOf("%");i=r*parseFloat(e.slice(0,s))/100}else i=+e;return ut(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},Kg=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[t[n]])r[t[n]]=!0;else return!0;return!1},fi=(t,e)=>q(t)&&q(e)?r=>t+r*(e-t):()=>e;function we(t,e,r){return q(t)&&q(e)?t+r*(e-t):e}function Hg(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):en(n,e))===r)}var Mj=t=>{if(!t||!t.length)return null;for(var e=t.length,r=0,n=0,a=0,i=0,s=1/0,o=-1/0,l=0,d=0,c=0;c<e;c++)l=t[c].cx||0,d=t[c].cy||0,r+=l,n+=d,a+=l*d,i+=l*l,s=Math.min(s,l),o=Math.max(o,l);var h=e*i!==r*r?(e*a-r*n)/(e*i-r*r):0;return{xmin:s,xmax:o,a:h,b:(n-h*r)/e}},le=t=>t===null||typeof t>"u",Wa=t=>le(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),Oj=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Iu(t){if(typeof t!="string")return!1;var e=Oj;return e.includes(t)}var Aj=["viewBox","children"],xf=["points","pathLength"],qo={svg:Aj,polygon:xf,polyline:xf},Du=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(v.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{Iu(a)&&(n[a]=(i=>r[a](r,i)))}),n},Ej=(t,e,r)=>n=>(t(e,r,n),null),Hn=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var i=t[a];Iu(a)&&typeof i=="function"&&(n||(n={}),n[a]=Ej(i,e,r))}),n},Tj=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Vg(t){if(typeof t!="string")return!1;var e=Tj;return e.includes(t)}function jt(t){var e=Object.entries(t).filter(r=>{var[n]=r;return Vg(n)});return Object.fromEntries(e)}var wf=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",_f=null,zo=null,Gg=t=>{if(t===_f&&Array.isArray(zo))return zo;var e=[];return v.Children.forEach(t,r=>{le(r)||(Pj.isFragment(r)?e=e.concat(Gg(r.props.children)):e.push(r))}),zo=e,_f=t,e};function As(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>wf(a)):n=[wf(e)],Gg(t).forEach(a=>{var i=en(a,"type.displayName")||en(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var Yg=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,Cj=(t,e,r,n)=>{var a;if(typeof e=="symbol"||typeof e=="number")return!0;var i=(a=n&&qo?.[n])!==null&&a!==void 0?a:[],s=e.startsWith("data-"),o=typeof t!="function"&&(!!n&&i.includes(e)||Vg(e)),l=!!r&&Iu(e);return s||o||l},ye=(t,e,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(v.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;Cj((s=n)===null||s===void 0?void 0:s[i],i,e,r)&&(a[i]=n[i])}),a},Ij=["children","width","height","viewBox","className","style","title","desc"];function Mc(){return Mc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mc.apply(null,arguments)}function Dj(t,e){if(t==null)return{};var r,n,a=$j(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function $j(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var $u=v.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:o,title:l,desc:d}=t,c=Dj(t,Ij),h=i||{width:n,height:a,x:0,y:0},f=ee("recharts-surface",s);return v.createElement("svg",Mc({},ye(c,!0,"svg"),{className:f,width:n,height:a,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:e}),v.createElement("title",null,l),v.createElement("desc",null,d),r)}),Rj=["children","className"];function Oc(){return Oc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Oc.apply(null,arguments)}function Lj(t,e){if(t==null)return{};var r,n,a=Bj(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Bj(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _e=v.forwardRef((t,e)=>{var{children:r,className:n}=t,a=Lj(t,Rj),i=ee("recharts-layer",n);return v.createElement("g",Oc({className:i},ye(a,!0),{ref:e}),r)}),Jg=mg(),Xg=v.createContext(null),Uj=()=>v.useContext(Xg);function me(t){return function(){return t}}const Zg=Math.cos,Ui=Math.sin,At=Math.sqrt,Fi=Math.PI,Es=2*Fi,Ac=Math.PI,Ec=2*Ac,Fr=1e-6,Fj=Ec-Fr;function Qg(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function Wj(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Qg;const r=10**e;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class qj{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Qg:Wj(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,i,s){this._append`C${+e},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(e,r,n,a,i){if(e=+e,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,l=n-e,d=a-r,c=s-e,h=o-r,f=c*c+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(f>Fr)if(!(Math.abs(h*l-d*c)>Fr)||!i)this._append`L${this._x1=e},${this._y1=r}`;else{let m=n-s,p=a-o,g=l*l+d*d,y=m*m+p*p,b=Math.sqrt(g),x=Math.sqrt(f),w=i*Math.tan((Ac-Math.acos((g+f-y)/(2*b*x)))/2),_=w/x,S=w/b;Math.abs(_-1)>Fr&&this._append`L${e+_*c},${r+_*h}`,this._append`A${i},${i},0,0,${+(h*m>c*p)},${this._x1=e+S*l},${this._y1=r+S*d}`}}arc(e,r,n,a,i,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),l=n*Math.sin(a),d=e+o,c=r+l,h=1^s,f=s?a-i:i-a;this._x1===null?this._append`M${d},${c}`:(Math.abs(this._x1-d)>Fr||Math.abs(this._y1-c)>Fr)&&this._append`L${d},${c}`,n&&(f<0&&(f=f%Ec+Ec),f>Fj?this._append`A${n},${n},0,1,${h},${e-o},${r-l}A${n},${n},0,1,${h},${this._x1=d},${this._y1=c}`:f>Fr&&this._append`A${n},${n},0,${+(f>=Ac)},${h},${this._x1=e+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Ru(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new qj(e)}function Lu(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ev(t){this._context=t}ev.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Ts(t){return new ev(t)}function tv(t){return t[0]}function rv(t){return t[1]}function nv(t,e){var r=me(!0),n=null,a=Ts,i=null,s=Ru(o);t=typeof t=="function"?t:t===void 0?tv:me(t),e=typeof e=="function"?e:e===void 0?rv:me(e);function o(l){var d,c=(l=Lu(l)).length,h,f=!1,m;for(n==null&&(i=a(m=s())),d=0;d<=c;++d)!(d<c&&r(h=l[d],d,l))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+t(h,d,l),+e(h,d,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(t=typeof l=="function"?l:me(+l),o):t},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:me(+l),o):e},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:me(!!l),o):r},o.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),o):a},o.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),o):n},o}function mi(t,e,r){var n=null,a=me(!0),i=null,s=Ts,o=null,l=Ru(d);t=typeof t=="function"?t:t===void 0?tv:me(+t),e=typeof e=="function"?e:me(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?rv:me(+r);function d(h){var f,m,p,g=(h=Lu(h)).length,y,b=!1,x,w=new Array(g),_=new Array(g);for(i==null&&(o=s(x=l())),f=0;f<=g;++f){if(!(f<g&&a(y=h[f],f,h))===b)if(b=!b)m=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=f-1;p>=m;--p)o.point(w[p],_[p]);o.lineEnd(),o.areaEnd()}b&&(w[f]=+t(y,f,h),_[f]=+e(y,f,h),o.point(n?+n(y,f,h):w[f],r?+r(y,f,h):_[f]))}if(x)return o=null,x+""||null}function c(){return nv().defined(a).curve(s).context(i)}return d.x=function(h){return arguments.length?(t=typeof h=="function"?h:me(+h),n=null,d):t},d.x0=function(h){return arguments.length?(t=typeof h=="function"?h:me(+h),d):t},d.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:me(+h),d):n},d.y=function(h){return arguments.length?(e=typeof h=="function"?h:me(+h),r=null,d):e},d.y0=function(h){return arguments.length?(e=typeof h=="function"?h:me(+h),d):e},d.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:me(+h),d):r},d.lineX0=d.lineY0=function(){return c().x(t).y(e)},d.lineY1=function(){return c().x(t).y(r)},d.lineX1=function(){return c().x(n).y(e)},d.defined=function(h){return arguments.length?(a=typeof h=="function"?h:me(!!h),d):a},d.curve=function(h){return arguments.length?(s=h,i!=null&&(o=s(i)),d):s},d.context=function(h){return arguments.length?(h==null?i=o=null:o=s(i=h),d):i},d}class av{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function zj(t){return new av(t,!0)}function Kj(t){return new av(t,!1)}const Bu={draw(t,e){const r=At(e/Fi);t.moveTo(r,0),t.arc(0,0,r,0,Es)}},Hj={draw(t,e){const r=At(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},iv=At(1/3),Vj=iv*2,Gj={draw(t,e){const r=At(e/Vj),n=r*iv;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},Yj={draw(t,e){const r=At(e),n=-r/2;t.rect(n,n,r,r)}},Jj=.8908130915292852,sv=Ui(Fi/10)/Ui(7*Fi/10),Xj=Ui(Es/10)*sv,Zj=-Zg(Es/10)*sv,Qj={draw(t,e){const r=At(e*Jj),n=Xj*r,a=Zj*r;t.moveTo(0,-r),t.lineTo(n,a);for(let i=1;i<5;++i){const s=Es*i/5,o=Zg(s),l=Ui(s);t.lineTo(l*r,-o*r),t.lineTo(o*n-l*a,l*n+o*a)}t.closePath()}},Ko=At(3),eS={draw(t,e){const r=-At(e/(Ko*3));t.moveTo(0,r*2),t.lineTo(-Ko*r,-r),t.lineTo(Ko*r,-r),t.closePath()}},pt=-.5,gt=At(3)/2,Tc=1/At(12),tS=(Tc/2+1)*3,rS={draw(t,e){const r=At(e/tS),n=r/2,a=r*Tc,i=n,s=r*Tc+r,o=-i,l=s;t.moveTo(n,a),t.lineTo(i,s),t.lineTo(o,l),t.lineTo(pt*n-gt*a,gt*n+pt*a),t.lineTo(pt*i-gt*s,gt*i+pt*s),t.lineTo(pt*o-gt*l,gt*o+pt*l),t.lineTo(pt*n+gt*a,pt*a-gt*n),t.lineTo(pt*i+gt*s,pt*s-gt*i),t.lineTo(pt*o+gt*l,pt*l-gt*o),t.closePath()}};function nS(t,e){let r=null,n=Ru(a);t=typeof t=="function"?t:me(t||Bu),e=typeof e=="function"?e:me(e===void 0?64:+e);function a(){let i;if(r||(r=i=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(t=typeof i=="function"?i:me(i),a):t},a.size=function(i){return arguments.length?(e=typeof i=="function"?i:me(+i),a):e},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Wi(){}function qi(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function ov(t){this._context=t}ov.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:qi(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:qi(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function aS(t){return new ov(t)}function lv(t){this._context=t}lv.prototype={areaStart:Wi,areaEnd:Wi,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:qi(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function iS(t){return new lv(t)}function cv(t){this._context=t}cv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:qi(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function sS(t){return new cv(t)}function uv(t){this._context=t}uv.prototype={areaStart:Wi,areaEnd:Wi,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function oS(t){return new uv(t)}function jf(t){return t<0?-1:1}function Sf(t,e,r){var n=t._x1-t._x0,a=e-t._x1,i=(t._y1-t._y0)/(n||a<0&&-0),s=(r-t._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(jf(i)+jf(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function Nf(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function Ho(t,e,r){var n=t._x0,a=t._y0,i=t._x1,s=t._y1,o=(i-n)/3;t._context.bezierCurveTo(n+o,a+o*e,i-o,s-o*r,i,s)}function zi(t){this._context=t}zi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ho(this,this._t0,Nf(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Ho(this,Nf(this,r=Sf(this,t,e)),r);break;default:Ho(this,this._t0,r=Sf(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function dv(t){this._context=new hv(t)}(dv.prototype=Object.create(zi.prototype)).point=function(t,e){zi.prototype.point.call(this,e,t)};function hv(t){this._context=t}hv.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,i){this._context.bezierCurveTo(e,t,n,r,i,a)}};function lS(t){return new zi(t)}function cS(t){return new dv(t)}function fv(t){this._context=t}fv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=Pf(t),a=Pf(e),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Pf(t){var e,r=t.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,i[e]=4,s[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/i[e-1],i[e]-=n,s[e]-=n*s[e-1];for(a[r-1]=s[r-1]/i[r-1],e=r-2;e>=0;--e)a[e]=(s[e]-a[e+1])/i[e];for(i[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)i[e]=2*t[e+1]-a[e+1];return[a,i]}function uS(t){return new fv(t)}function Cs(t,e){this._context=t,this._t=e}Cs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function dS(t){return new Cs(t,.5)}function hS(t){return new Cs(t,0)}function fS(t){return new Cs(t,1)}function Dn(t,e){if((s=t.length)>1)for(var r=1,n,a,i=t[e[0]],s,o=i.length;r<s;++r)for(a=i,i=t[e[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Cc(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function mS(t,e){return t[e]}function pS(t){const e=[];return e.key=t,e}function gS(){var t=me([]),e=Cc,r=Dn,n=mS;function a(i){var s=Array.from(t.apply(this,arguments),pS),o,l=s.length,d=-1,c;for(const h of i)for(o=0,++d;o<l;++o)(s[o][d]=[0,+n(h,s[o].key,d,i)]).data=h;for(o=0,c=Lu(e(s));o<l;++o)s[c[o]].index=o;return r(s,c),s}return a.keys=function(i){return arguments.length?(t=typeof i=="function"?i:me(Array.from(i)),a):t},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:me(+i),a):n},a.order=function(i){return arguments.length?(e=i==null?Cc:typeof i=="function"?i:me(Array.from(i)),a):e},a.offset=function(i){return arguments.length?(r=i??Dn,a):r},a}function vS(t,e){if((n=t.length)>0){for(var r,n,a=0,i=t[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=t[r][a][1]||0;if(s)for(r=0;r<n;++r)t[r][a][1]/=s}Dn(t,e)}}function yS(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Dn(t,e)}}function bS(t,e){if(!(!((s=t.length)>0)||!((i=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,l=0,d=0;o<s;++o){for(var c=t[e[o]],h=c[n][1]||0,f=c[n-1][1]||0,m=(h-f)/2,p=0;p<o;++p){var g=t[e[p]],y=g[n][1]||0,b=g[n-1][1]||0;m+=y-b}l+=h,d+=m*h}a[n-1][1]+=a[n-1][0]=r,l&&(r-=d/l)}a[n-1][1]+=a[n-1][0]=r,Dn(t,e)}}var xS=["type","size","sizeType"];function Ic(){return Ic=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ic.apply(null,arguments)}function kf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Mf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kf(Object(r),!0).forEach(function(n){wS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kf(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wS(t,e,r){return(e=_S(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _S(t){var e=jS(t,"string");return typeof e=="symbol"?e:e+""}function jS(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SS(t,e){if(t==null)return{};var r,n,a=NS(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function NS(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var mv={symbolCircle:Bu,symbolCross:Hj,symbolDiamond:Gj,symbolSquare:Yj,symbolStar:Qj,symbolTriangle:eS,symbolWye:rS},PS=Math.PI/180,kS=t=>{var e="symbol".concat(Wa(t));return mv[e]||Bu},MS=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*PS;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},OS=(t,e)=>{mv["symbol".concat(Wa(t))]=e},Is=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=SS(t,xS),i=Mf(Mf({},a),{},{type:e,size:r,sizeType:n}),s="circle";typeof e=="string"&&(s=e);var o=()=>{var f=kS(s),m=nS().type(f).size(MS(r,n,s));return m()},{className:l,cx:d,cy:c}=i,h=ye(i,!0);return d===+d&&c===+c&&r===+r?v.createElement("path",Ic({},h,{className:ee("recharts-symbols",l),transform:"translate(".concat(d,", ").concat(c,")"),d:o()})):null};Is.registerSymbol=OS;function Dc(){return Dc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Dc.apply(null,arguments)}function Of(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function AS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Of(Object(r),!0).forEach(function(n){Uu(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Of(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Uu(t,e,r){return(e=ES(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ES(t){var e=TS(t,"string");return typeof e=="symbol"?e:e+""}function TS(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vt=32;class Fu extends v.PureComponent{renderIcon(e,r){var{inactiveColor:n}=this.props,a=vt/2,i=vt/6,s=vt/3,o=e.inactive?n:e.color,l=r??e.type;if(l==="none")return null;if(l==="plainline")return v.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:a,x2:vt,y2:a,className:"recharts-legend-icon"});if(l==="line")return v.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(vt,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(l==="rect")return v.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(vt/8,"h").concat(vt,"v").concat(vt*3/4,"h").concat(-vt,"z"),className:"recharts-legend-icon"});if(v.isValidElement(e.legendIcon)){var d=AS({},e);return delete d.legendIcon,v.cloneElement(e.legendIcon,d)}return v.createElement(Is,{fill:o,cx:a,cy:a,size:vt,sizeType:"diameter",type:l})}renderItems(){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,o={x:0,y:0,width:vt,height:vt},l={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((c,h)=>{var f=c.formatter||a,m=ee({"recharts-legend-item":!0,["legend-item-".concat(h)]:!0,inactive:c.inactive});if(c.type==="none")return null;var p=c.inactive?i:c.color,g=f?f(c.value,c,h):c.value;return v.createElement("li",Dc({className:m,style:l,key:"legend-item-".concat(h)},Hn(this.props,c,h)),v.createElement($u,{width:r,height:r,viewBox:o,style:d,"aria-label":"".concat(g," legend icon")},this.renderIcon(c,s)),v.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},g))})}render(){var{payload:e,layout:r,align:n}=this.props;if(!e||!e.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return v.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}Uu(Fu,"displayName","Legend");Uu(Fu,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Vo={},Go={},Af;function CS(){return Af||(Af=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],o=n(s);a.has(o)||a.set(o,s)}return Array.from(a.values())}t.uniqBy=e})(Go)),Go}var Yo={},Ef;function pv(){return Ef||(Ef=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(Yo)),Yo}var Jo={},Xo={},Zo={},Tf;function IS(){return Tf||(Tf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(Zo)),Zo}var Cf;function Wu(){return Cf||(Cf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=IS();function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(Xo)),Xo}var Qo={},If;function DS(){return If||(If=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(Qo)),Qo}var Df;function $S(){return Df||(Df=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Wu(),r=DS();function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(Jo)),Jo}var el={},tl={},$f;function RS(){return $f||($f=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cu();function r(n){return function(a){return e.get(a,n)}}t.property=r})(tl)),tl}var rl={},nl={},al={},il={},Rf;function gv(){return Rf||(Rf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(il)),il}var sl={},Lf;function vv(){return Lf||(Lf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(sl)),sl}var ol={},Bf;function yv(){return Bf||(Bf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(ol)),ol}var Uf;function LS(){return Uf||(Uf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qu(),r=gv(),n=vv(),a=yv();function i(h,f,m){return typeof m!="function"?e.isMatch(h,f):s(h,f,function p(g,y,b,x,w,_){const S=m(g,y,b,x,w,_);return S!==void 0?!!S:s(g,y,p,_)},new Map)}function s(h,f,m,p){if(f===h)return!0;switch(typeof f){case"object":return o(h,f,m,p);case"function":return Object.keys(f).length>0?s(h,{...f},m,p):a.eq(h,f);default:return r.isObject(h)?typeof f=="string"?f==="":!0:a.eq(h,f)}}function o(h,f,m,p){if(f==null)return!0;if(Array.isArray(f))return d(h,f,m,p);if(f instanceof Map)return l(h,f,m,p);if(f instanceof Set)return c(h,f,m,p);const g=Object.keys(f);if(h==null)return g.length===0;if(g.length===0)return!0;if(p&&p.has(f))return p.get(f)===h;p&&p.set(f,h);try{for(let y=0;y<g.length;y++){const b=g[y];if(!n.isPrimitive(h)&&!(b in h)||f[b]===void 0&&h[b]!==void 0||f[b]===null&&h[b]!==null||!m(h[b],f[b],b,h,f,p))return!1}return!0}finally{p&&p.delete(f)}}function l(h,f,m,p){if(f.size===0)return!0;if(!(h instanceof Map))return!1;for(const[g,y]of f.entries()){const b=h.get(g);if(m(b,y,g,h,f,p)===!1)return!1}return!0}function d(h,f,m,p){if(f.length===0)return!0;if(!Array.isArray(h))return!1;const g=new Set;for(let y=0;y<f.length;y++){const b=f[y];let x=!1;for(let w=0;w<h.length;w++){if(g.has(w))continue;const _=h[w];let S=!1;if(m(_,b,y,h,f,p)&&(S=!0),S){g.add(w),x=!0;break}}if(!x)return!1}return!0}function c(h,f,m,p){return f.size===0?!0:h instanceof Set?d([...h],[...f],m,p):!1}t.isMatchWith=i,t.isSetMatch=c})(al)),al}var Ff;function qu(){return Ff||(Ff=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=LS();function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(nl)),nl}var ll={},cl={},ul={},Wf;function BS(){return Wf||(Wf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(ul)),ul}var dl={},qf;function bv(){return qf||(qf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(dl)),dl}var hl={},zf;function xv(){return zf||(zf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",o="[object Date]",l="[object Map]",d="[object Set]",c="[object Array]",h="[object Function]",f="[object ArrayBuffer]",m="[object Object]",p="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",x="[object Uint16Array]",w="[object Uint32Array]",_="[object BigUint64Array]",S="[object Int8Array]",j="[object Int16Array]",N="[object Int32Array]",M="[object BigInt64Array]",O="[object Float32Array]",T="[object Float64Array]";t.argumentsTag=i,t.arrayBufferTag=f,t.arrayTag=c,t.bigInt64ArrayTag=M,t.bigUint64ArrayTag=_,t.booleanTag=a,t.dataViewTag=g,t.dateTag=o,t.errorTag=p,t.float32ArrayTag=O,t.float64ArrayTag=T,t.functionTag=h,t.int16ArrayTag=j,t.int32ArrayTag=N,t.int8ArrayTag=S,t.mapTag=l,t.numberTag=n,t.objectTag=m,t.regexpTag=e,t.setTag=d,t.stringTag=r,t.symbolTag=s,t.uint16ArrayTag=x,t.uint32ArrayTag=w,t.uint8ArrayTag=y,t.uint8ClampedArrayTag=b})(hl)),hl}var fl={},Kf;function US(){return Kf||(Kf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(fl)),fl}var Hf;function wv(){return Hf||(Hf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=BS(),r=bv(),n=xv(),a=vv(),i=US();function s(c,h){return o(c,void 0,c,new Map,h)}function o(c,h,f,m=new Map,p=void 0){const g=p?.(c,h,f,m);if(g!==void 0)return g;if(a.isPrimitive(c))return c;if(m.has(c))return m.get(c);if(Array.isArray(c)){const y=new Array(c.length);m.set(c,y);for(let b=0;b<c.length;b++)y[b]=o(c[b],b,f,m,p);return Object.hasOwn(c,"index")&&(y.index=c.index),Object.hasOwn(c,"input")&&(y.input=c.input),y}if(c instanceof Date)return new Date(c.getTime());if(c instanceof RegExp){const y=new RegExp(c.source,c.flags);return y.lastIndex=c.lastIndex,y}if(c instanceof Map){const y=new Map;m.set(c,y);for(const[b,x]of c)y.set(b,o(x,b,f,m,p));return y}if(c instanceof Set){const y=new Set;m.set(c,y);for(const b of c)y.add(o(b,void 0,f,m,p));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(c))return c.subarray();if(i.isTypedArray(c)){const y=new(Object.getPrototypeOf(c)).constructor(c.length);m.set(c,y);for(let b=0;b<c.length;b++)y[b]=o(c[b],b,f,m,p);return y}if(c instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&c instanceof SharedArrayBuffer)return c.slice(0);if(c instanceof DataView){const y=new DataView(c.buffer.slice(0),c.byteOffset,c.byteLength);return m.set(c,y),l(y,c,f,m,p),y}if(typeof File<"u"&&c instanceof File){const y=new File([c],c.name,{type:c.type});return m.set(c,y),l(y,c,f,m,p),y}if(c instanceof Blob){const y=new Blob([c],{type:c.type});return m.set(c,y),l(y,c,f,m,p),y}if(c instanceof Error){const y=new c.constructor;return m.set(c,y),y.message=c.message,y.name=c.name,y.stack=c.stack,y.cause=c.cause,l(y,c,f,m,p),y}if(typeof c=="object"&&d(c)){const y=Object.create(Object.getPrototypeOf(c));return m.set(c,y),l(y,c,f,m,p),y}return c}function l(c,h,f=c,m,p){const g=[...Object.keys(h),...e.getSymbols(h)];for(let y=0;y<g.length;y++){const b=g[y],x=Object.getOwnPropertyDescriptor(c,b);(x==null||x.writable)&&(c[b]=o(h[b],b,f,m,p))}}function d(c){switch(r.getTag(c)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=s,t.cloneDeepWithImpl=o,t.copyProperties=l})(cl)),cl}var Vf;function FS(){return Vf||(Vf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wv();function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(ll)),ll}var Gf;function WS(){return Gf||(Gf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qu(),r=FS();function n(a){return a=r.cloneDeep(a),i=>e.isMatch(i,a)}t.matches=n})(rl)),rl}var ml={},pl={},gl={},Yf;function qS(){return Yf||(Yf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wv(),r=xv();function n(a,i){return e.cloneDeepWith(a,(s,o,l,d)=>{const c=i?.(s,o,l,d);if(c!==void 0)return c;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new a.constructor(a?.valueOf());return e.copyProperties(h,a),h}case r.argumentsTag:{const h={};return e.copyProperties(h,a),h.length=a.length,h[Symbol.iterator]=a[Symbol.iterator],h}default:return}})}t.cloneDeepWith=n})(gl)),gl}var Jf;function zS(){return Jf||(Jf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qS();function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(pl)),pl}var vl={},yl={},Xf;function _v(){return Xf||(Xf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(yl)),yl}var bl={},Zf;function KS(){return Zf||(Zf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=bv();function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(bl)),bl}var Qf;function HS(){return Qf||(Qf=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qg(),r=_v(),n=KS(),a=Tu();function i(s,o){let l;if(Array.isArray(o)?l=o:typeof o=="string"&&e.isDeepKey(o)&&s?.[o]==null?l=a.toPath(o):l=[o],l.length===0)return!1;let d=s;for(let c=0;c<l.length;c++){const h=l[c];if((d==null||!Object.hasOwn(d,h))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(h)&&h<d.length))return!1;d=d[h]}return!0}t.has=i})(vl)),vl}var em;function VS(){return em||(em=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qu(),r=zg(),n=zS(),a=Cu(),i=HS();function s(o,l){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return l=n.cloneDeep(l),function(d){const c=a.get(d,o);return c===void 0?i.has(d,o):l===void 0?c===void 0:e.isMatch(c,l)}}t.matchesProperty=s})(ml)),ml}var tm;function GS(){return tm||(tm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=pv(),r=RS(),n=WS(),a=VS();function i(s){if(s==null)return e.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}t.iteratee=i})(el)),el}var rm;function YS(){return rm||(rm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=CS(),r=pv(),n=$S(),a=GS();function i(s,o=r.identity){return n.isArrayLikeObject(s)?e.uniqBy(Array.from(s),a.iteratee(o)):[]}t.uniqBy=i})(Vo)),Vo}var xl,nm;function JS(){return nm||(nm=1,xl=YS().uniqBy),xl}var XS=JS();const am=rr(XS);function jv(t,e,r){return e===!0?am(t,r):typeof e=="function"?am(t,e):t}var wl={exports:{}},_l={},jl={exports:{}},Sl={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var im;function ZS(){if(im)return Sl;im=1;var t=Ps();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,a=t.useEffect,i=t.useLayoutEffect,s=t.useDebugValue;function o(h,f){var m=f(),p=n({inst:{value:m,getSnapshot:f}}),g=p[0].inst,y=p[1];return i(function(){g.value=m,g.getSnapshot=f,l(g)&&y({inst:g})},[h,m,f]),a(function(){return l(g)&&y({inst:g}),h(function(){l(g)&&y({inst:g})})},[h]),s(m),m}function l(h){var f=h.getSnapshot;h=h.value;try{var m=f();return!r(h,m)}catch{return!0}}function d(h,f){return f()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:o;return Sl.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:c,Sl}var sm;function QS(){return sm||(sm=1,jl.exports=ZS()),jl.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var om;function eN(){if(om)return _l;om=1;var t=Ps(),e=QS();function r(d,c){return d===c&&(d!==0||1/d===1/c)||d!==d&&c!==c}var n=typeof Object.is=="function"?Object.is:r,a=e.useSyncExternalStore,i=t.useRef,s=t.useEffect,o=t.useMemo,l=t.useDebugValue;return _l.useSyncExternalStoreWithSelector=function(d,c,h,f,m){var p=i(null);if(p.current===null){var g={hasValue:!1,value:null};p.current=g}else g=p.current;p=o(function(){function b(j){if(!x){if(x=!0,w=j,j=f(j),m!==void 0&&g.hasValue){var N=g.value;if(m(N,j))return _=N}return _=j}if(N=_,n(w,j))return N;var M=f(j);return m!==void 0&&m(N,M)?(w=j,N):(w=j,_=M)}var x=!1,w,_,S=h===void 0?null:h;return[function(){return b(c())},S===null?void 0:function(){return b(S())}]},[c,h,f,m]);var y=a(d,p[0],p[1]);return s(function(){g.hasValue=!0,g.value=y},[y]),l(y),y},_l}var lm;function tN(){return lm||(lm=1,wl.exports=eN()),wl.exports}var rN=tN(),zu=v.createContext(null),nN=t=>t,be=()=>{var t=v.useContext(zu);return t?t.store.dispatch:nN},Ci=()=>{},aN=()=>Ci,iN=(t,e)=>t===e;function F(t){var e=v.useContext(zu);return rN.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:aN,e?e.store.getState:Ci,e?e.store.getState:Ci,e?t:Ci,iN)}function sN(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function oN(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function lN(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var cm=t=>Array.isArray(t)?t:[t];function cN(t){const e=Array.isArray(t[0])?t[0]:t;return lN(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function uN(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var dN=class{constructor(t){this.value=t}deref(){return this.value}},hN=typeof WeakRef<"u"?WeakRef:dN,fN=0,um=1;function pi(){return{s:fN,v:void 0,o:null,p:null}}function Sv(t,e={}){let r=pi();const{resultEqualityCheck:n}=e;let a,i=0;function s(){let o=r;const{length:l}=arguments;for(let h=0,f=l;h<f;h++){const m=arguments[h];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=o.o;p===null&&(o.o=p=new WeakMap);const g=p.get(m);g===void 0?(o=pi(),p.set(m,o)):o=g}else{let p=o.p;p===null&&(o.p=p=new Map);const g=p.get(m);g===void 0?(o=pi(),p.set(m,o)):o=g}}const d=o;let c;if(o.s===um)c=o.v;else if(c=t.apply(null,arguments),i++,n){const h=a?.deref?.()??a;h!=null&&n(h,c)&&(c=h,i!==0&&i--),a=typeof c=="object"&&c!==null||typeof c=="function"?new hN(c):c}return d.s=um,d.v=c,c}return s.clearCache=()=>{r=pi(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function mN(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let i=0,s=0,o,l={},d=a.pop();typeof d=="object"&&(l=d,d=a.pop()),sN(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const c={...r,...l},{memoize:h,memoizeOptions:f=[],argsMemoize:m=Sv,argsMemoizeOptions:p=[]}=c,g=cm(f),y=cm(p),b=cN(a),x=h(function(){return i++,d.apply(null,arguments)},...g),w=m(function(){s++;const S=uN(b,arguments);return o=x.apply(null,S),o},...y);return Object.assign(w,{resultFunc:d,memoizedResultFunc:x,dependencies:b,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var A=mN(Sv),pN=Object.assign((t,e=A)=>{oN(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(i=>t[i]);return e(n,(...i)=>i.reduce((s,o,l)=>(s[r[l]]=o,s),{}))},{withTypes:()=>pN}),Nl={},Pl={},kl={},dm;function gN(){return dm||(dm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=e(n),o=e(a);if(s===o&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?o-s:s-o}return 0};t.compareValues=r})(kl)),kl}var Ml={},Ol={},hm;function Nv(){return hm||(hm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Ol)),Ol}var fm;function vN(){return fm||(fm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nv(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||e.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}t.isKey=a})(Ml)),Ml}var mm;function yN(){return mm||(mm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=gN(),r=vN(),n=Tu();function a(i,s,o,l){if(i==null)return[];o=l?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(m=>String(m));const d=(m,p)=>{let g=m;for(let y=0;y<p.length&&g!=null;++y)g=g[p[y]];return g},c=(m,p)=>p==null||m==null?p:typeof m=="object"&&"key"in m?Object.hasOwn(p,m.key)?p[m.key]:d(p,m.path):typeof m=="function"?m(p):Array.isArray(m)?d(p,m):typeof p=="object"?p[m]:p,h=s.map(m=>(Array.isArray(m)&&m.length===1&&(m=m[0]),m==null||typeof m=="function"||Array.isArray(m)||r.isKey(m)?m:{key:m,path:n.toPath(m)}));return i.map(m=>({original:m,criteria:h.map(p=>c(p,m))})).slice().sort((m,p)=>{for(let g=0;g<h.length;g++){const y=e.compareValues(m.criteria[g],p.criteria[g],o[g]);if(y!==0)return y}return 0}).map(m=>m.original)}t.orderBy=a})(Pl)),Pl}var Al={},pm;function bN(){return pm||(pm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],i=Math.floor(n),s=(o,l)=>{for(let d=0;d<o.length;d++){const c=o[d];Array.isArray(c)&&l<i?s(c,l+1):a.push(c)}};return s(r,0),a}t.flatten=e})(Al)),Al}var El={},gm;function Pv(){return gm||(gm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_v(),r=Wu(),n=gv(),a=yv();function i(s,o,l){return n.isObject(l)&&(typeof o=="number"&&r.isArrayLike(l)&&e.isIndex(o)&&o<l.length||typeof o=="string"&&o in l)?a.eq(l[o],s):!1}t.isIterateeCall=i})(El)),El}var vm;function xN(){return vm||(vm=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yN(),r=bN(),n=Pv();function a(i,...s){const o=s.length;return o>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),e.orderBy(i,r.flatten(s),["asc"])}t.sortBy=a})(Nl)),Nl}var Tl,ym;function wN(){return ym||(ym=1,Tl=xN().sortBy),Tl}var _N=wN();const Ds=rr(_N);var kv=t=>t.legend.settings,jN=t=>t.legend.size,SN=t=>t.legend.payload,NN=A([SN,kv],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?Ds(n,r):n});function PN(){return F(NN)}var gi=1;function Mv(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=v.useState({height:0,left:0,top:0,width:0}),n=v.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-e.height)>gi||Math.abs(s.left-e.left)>gi||Math.abs(s.top-e.top)>gi||Math.abs(s.width-e.width)>gi)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function qe(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var kN=typeof Symbol=="function"&&Symbol.observable||"@@observable",bm=kN,Cl=()=>Math.random().toString(36).substring(7).split("").join("."),MN={INIT:`@@redux/INIT${Cl()}`,REPLACE:`@@redux/REPLACE${Cl()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Cl()}`},Ki=MN;function Ku(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Ov(t,e,r){if(typeof t!="function")throw new Error(qe(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(qe(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(qe(1));return r(Ov)(t,e)}let n=t,a=e,i=new Map,s=i,o=0,l=!1;function d(){s===i&&(s=new Map,i.forEach((y,b)=>{s.set(b,y)}))}function c(){if(l)throw new Error(qe(3));return a}function h(y){if(typeof y!="function")throw new Error(qe(4));if(l)throw new Error(qe(5));let b=!0;d();const x=o++;return s.set(x,y),function(){if(b){if(l)throw new Error(qe(6));b=!1,d(),s.delete(x),i=null}}}function f(y){if(!Ku(y))throw new Error(qe(7));if(typeof y.type>"u")throw new Error(qe(8));if(typeof y.type!="string")throw new Error(qe(17));if(l)throw new Error(qe(9));try{l=!0,a=n(a,y)}finally{l=!1}return(i=s).forEach(x=>{x()}),y}function m(y){if(typeof y!="function")throw new Error(qe(10));n=y,f({type:Ki.REPLACE})}function p(){const y=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(qe(11));function x(){const _=b;_.next&&_.next(c())}return x(),{unsubscribe:y(x)}},[bm](){return this}}}return f({type:Ki.INIT}),{dispatch:f,subscribe:h,getState:c,replaceReducer:m,[bm]:p}}function ON(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Ki.INIT})>"u")throw new Error(qe(12));if(typeof r(void 0,{type:Ki.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(qe(13))})}function Av(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const s=e[i];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let a;try{ON(r)}catch(i){a=i}return function(s={},o){if(a)throw a;let l=!1;const d={};for(let c=0;c<n.length;c++){const h=n[c],f=r[h],m=s[h],p=f(m,o);if(typeof p>"u")throw o&&o.type,new Error(qe(14));d[h]=p,l=l||p!==m}return l=l||n.length!==Object.keys(s).length,l?d:s}}function Hi(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function AN(...t){return e=>(r,n)=>{const a=e(r,n);let i=()=>{throw new Error(qe(15))};const s={getState:a.getState,dispatch:(l,...d)=>i(l,...d)},o=t.map(l=>l(s));return i=Hi(...o)(a.dispatch),{...a,dispatch:i}}}function Ev(t){return Ku(t)&&"type"in t&&typeof t.type=="string"}var Tv=Symbol.for("immer-nothing"),xm=Symbol.for("immer-draftable"),dt=Symbol.for("immer-state");function Mt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var $n=Object.getPrototypeOf;function tn(t){return!!t&&!!t[dt]}function Xt(t){return t?Cv(t)||Array.isArray(t)||!!t[xm]||!!t.constructor?.[xm]||qa(t)||Rs(t):!1}var EN=Object.prototype.constructor.toString();function Cv(t){if(!t||typeof t!="object")return!1;const e=$n(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===EN}function Vi(t,e){$s(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function $s(t){const e=t[dt];return e?e.type_:Array.isArray(t)?1:qa(t)?2:Rs(t)?3:0}function $c(t,e){return $s(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Iv(t,e,r){const n=$s(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function TN(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function qa(t){return t instanceof Map}function Rs(t){return t instanceof Set}function Wr(t){return t.copy_||t.base_}function Rc(t,e){if(qa(t))return new Map(t);if(Rs(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Cv(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[dt];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create($n(t),n)}else{const n=$n(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function Hu(t,e=!1){return Ls(t)||tn(t)||!Xt(t)||($s(t)>1&&Object.defineProperties(t,{set:{value:vi},add:{value:vi},clear:{value:vi},delete:{value:vi}}),Object.freeze(t),e&&Object.values(t).forEach(r=>Hu(r,!0))),t}function vi(){Mt(2)}function Ls(t){return Object.isFrozen(t)}var CN={};function rn(t){const e=CN[t];return e||Mt(0,t),e}var Ea;function Dv(){return Ea}function IN(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function wm(t,e){e&&(rn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Lc(t){Bc(t),t.drafts_.forEach(DN),t.drafts_=null}function Bc(t){t===Ea&&(Ea=t.parent_)}function _m(t){return Ea=IN(Ea,t)}function DN(t){const e=t[dt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function jm(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[dt].modified_&&(Lc(e),Mt(4)),Xt(t)&&(t=Gi(e,t),e.parent_||Yi(e,t)),e.patches_&&rn("Patches").generateReplacementPatches_(r[dt].base_,t,e.patches_,e.inversePatches_)):t=Gi(e,r,[]),Lc(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Tv?t:void 0}function Gi(t,e,r){if(Ls(e))return e;const n=e[dt];if(!n)return Vi(e,(a,i)=>Sm(t,n,e,a,i,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return Yi(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),Vi(i,(o,l)=>Sm(t,n,a,o,l,r,s)),Yi(t,a,!1),r&&t.patches_&&rn("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function Sm(t,e,r,n,a,i,s){if(tn(a)){const o=i&&e&&e.type_!==3&&!$c(e.assigned_,n)?i.concat(n):void 0,l=Gi(t,a,o);if(Iv(r,n,l),tn(l))t.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Xt(a)&&!Ls(a)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Gi(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(qa(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&Yi(t,a)}}function Yi(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Hu(e,r)}function $N(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:Dv(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=Vu;r&&(a=[n],i=Ta);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var Vu={get(t,e){if(e===dt)return t;const r=Wr(t);if(!$c(r,e))return RN(t,r,e);const n=r[e];return t.finalized_||!Xt(n)?n:n===Il(t.base_,e)?(Dl(t),t.copy_[e]=Fc(n,t)):n},has(t,e){return e in Wr(t)},ownKeys(t){return Reflect.ownKeys(Wr(t))},set(t,e,r){const n=$v(Wr(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=Il(Wr(t),e),i=a?.[dt];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(TN(r,a)&&(r!==void 0||$c(t.base_,e)))return!0;Dl(t),Uc(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Il(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Dl(t),Uc(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Wr(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Mt(11)},getPrototypeOf(t){return $n(t.base_)},setPrototypeOf(){Mt(12)}},Ta={};Vi(Vu,(t,e)=>{Ta[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ta.deleteProperty=function(t,e){return Ta.set.call(this,t,e,void 0)};Ta.set=function(t,e,r){return Vu.set.call(this,t[0],e,r,t[0])};function Il(t,e){const r=t[dt];return(r?Wr(r):t)[e]}function RN(t,e,r){const n=$v(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function $v(t,e){if(!(e in t))return;let r=$n(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=$n(r)}}function Uc(t){t.modified_||(t.modified_=!0,t.parent_&&Uc(t.parent_))}function Dl(t){t.copy_||(t.copy_=Rc(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var LN=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const s=this;return function(l=i,...d){return s.produce(l,c=>r.call(this,c,...d))}}typeof r!="function"&&Mt(6),n!==void 0&&typeof n!="function"&&Mt(7);let a;if(Xt(e)){const i=_m(this),s=Fc(e,void 0);let o=!0;try{a=r(s),o=!1}finally{o?Lc(i):Bc(i)}return wm(i,n),jm(a,i)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===Tv&&(a=void 0),this.autoFreeze_&&Hu(a,!0),n){const i=[],s=[];rn("Patches").generateReplacementPatches_(e,a,i,s),n(i,s)}return a}else Mt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,l=>e(l,...o));let n,a;return[this.produce(e,r,(s,o)=>{n=s,a=o}),n,a]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Xt(t)||Mt(8),tn(t)&&(t=Yt(t));const e=_m(this),r=Fc(t,void 0);return r[dt].isManual_=!0,Bc(e),r}finishDraft(t,e){const r=t&&t[dt];(!r||!r.isManual_)&&Mt(9);const{scope_:n}=r;return wm(n,e),jm(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=rn("Patches").applyPatches_;return tn(t)?n(t,e):this.produce(t,a=>n(a,e))}};function Fc(t,e){const r=qa(t)?rn("MapSet").proxyMap_(t,e):Rs(t)?rn("MapSet").proxySet_(t,e):$N(t,e);return(e?e.scope_:Dv()).drafts_.push(r),r}function Yt(t){return tn(t)||Mt(10,t),Rv(t)}function Rv(t){if(!Xt(t)||Ls(t))return t;const e=t[dt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Rc(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Rc(t,!0);return Vi(r,(n,a)=>{Iv(r,n,Rv(a))}),e&&(e.finalized_=!1),r}var BN=new LN,Lv=BN.produce;function Bv(t){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,t):a(i)}var UN=Bv(),FN=Bv,WN=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Hi:Hi.apply(null,arguments)};function wt(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(ct(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Ev(n)&&n.type===t,r}var Uv=class ga extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ga.prototype)}static get[Symbol.species](){return ga}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ga(...e[0].concat(this)):new ga(...e.concat(this))}};function Nm(t){return Xt(t)?Lv(t,()=>{}):t}function yi(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function qN(t){return typeof t=="boolean"}var zN=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=e??{};let s=new Uv;return r&&(qN(r)?s.push(UN):s.push(FN(r.extraArgument))),s},KN="RTK_autoBatch",Pm=t=>e=>{setTimeout(e,t)},HN=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,i=!1,s=!1;const o=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Pm(10):t.type==="callback"?t.queueNotification:Pm(t.timeout),d=()=>{s=!1,i&&(i=!1,o.forEach(c=>c()))};return Object.assign({},n,{subscribe(c){const h=()=>a&&c(),f=n.subscribe(h);return o.add(c),()=>{f(),o.delete(c)}},dispatch(c){try{return a=!c?.meta?.[KN],i=!a,i&&(s||(s=!0,l(d))),n.dispatch(c)}finally{a=!0}}})},VN=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new Uv(t);return n&&a.push(HN(typeof n=="object"?n:void 0)),a};function GN(t){const e=zN(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(Ku(r))o=Av(r);else throw new Error(ct(1));let l;typeof n=="function"?l=n(e):l=e();let d=Hi;a&&(d=WN({trace:!1,...typeof a=="object"&&a}));const c=AN(...l),h=VN(c);let f=typeof s=="function"?s(h):h();const m=d(...f);return Ov(o,i,m)}function Fv(t){const e={},r=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(ct(28));if(o in e)throw new Error(ct(29));return e[o]=s,a},addAsyncThunk(i,s){return s.pending&&(e[i.pending.type]=s.pending),s.rejected&&(e[i.rejected.type]=s.rejected),s.fulfilled&&(e[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return t(a),[e,r,n]}function YN(t){return typeof t=="function"}function JN(t,e){let[r,n,a]=Fv(e),i;if(YN(t))i=()=>Nm(t());else{const o=Nm(t);i=()=>o}function s(o=i(),l){let d=[r[l.type],...n.filter(({matcher:c})=>c(l)).map(({reducer:c})=>c)];return d.filter(c=>!!c).length===0&&(d=[a]),d.reduce((c,h)=>{if(h)if(tn(c)){const m=h(c,l);return m===void 0?c:m}else{if(Xt(c))return Lv(c,f=>h(f,l));{const f=h(c,l);if(f===void 0){if(c===null)return c;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return c},o)}return s.getInitialState=i,s}var XN="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ZN=(t=21)=>{let e="",r=t;for(;r--;)e+=XN[Math.random()*64|0];return e},QN=Symbol.for("rtk-slice-createasyncthunk");function eP(t,e){return`${t}/${e}`}function tP({creators:t}={}){const e=t?.asyncThunk?.[QN];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(ct(11));const s=(typeof n.reducers=="function"?n.reducers(nP()):n.reducers)||{},o=Object.keys(s),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,_){const S=typeof w=="string"?w:w.type;if(!S)throw new Error(ct(12));if(S in l.sliceCaseReducersByType)throw new Error(ct(13));return l.sliceCaseReducersByType[S]=_,d},addMatcher(w,_){return l.sliceMatchers.push({matcher:w,reducer:_}),d},exposeAction(w,_){return l.actionCreators[w]=_,d},exposeCaseReducer(w,_){return l.sliceCaseReducersByName[w]=_,d}};o.forEach(w=>{const _=s[w],S={reducerName:w,type:eP(a,w),createNotation:typeof n.reducers=="function"};iP(_)?oP(S,_,d,e):aP(S,_,d)});function c(){const[w={},_=[],S=void 0]=typeof n.extraReducers=="function"?Fv(n.extraReducers):[n.extraReducers],j={...w,...l.sliceCaseReducersByType};return JN(n.initialState,N=>{for(let M in j)N.addCase(M,j[M]);for(let M of l.sliceMatchers)N.addMatcher(M.matcher,M.reducer);for(let M of _)N.addMatcher(M.matcher,M.reducer);S&&N.addDefaultCase(S)})}const h=w=>w,f=new Map,m=new WeakMap;let p;function g(w,_){return p||(p=c()),p(w,_)}function y(){return p||(p=c()),p.getInitialState()}function b(w,_=!1){function S(N){let M=N[w];return typeof M>"u"&&_&&(M=yi(m,S,y)),M}function j(N=h){const M=yi(f,_,()=>new WeakMap);return yi(M,N,()=>{const O={};for(const[T,P]of Object.entries(n.selectors??{}))O[T]=rP(P,N,()=>yi(m,N,y),_);return O})}return{reducerPath:w,getSelectors:j,get selectors(){return j(S)},selectSlice:S}}const x={name:a,reducer:g,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:y,...b(i),injectInto(w,{reducerPath:_,...S}={}){const j=_??i;return w.inject({reducerPath:j,reducer:g},S),{...x,...b(j,!0)}}};return x}}function rP(t,e,r,n){function a(i,...s){let o=e(i);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return a.unwrapped=t,a}var ft=tP();function nP(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function aP({type:t,reducerName:e,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!sP(n))throw new Error(ct(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,s?wt(t,s):wt(t))}function iP(t){return t._reducerDefinitionType==="asyncThunk"}function sP(t){return t._reducerDefinitionType==="reducerWithPrepare"}function oP({type:t,reducerName:e},r,n,a){if(!a)throw new Error(ct(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:l,settled:d,options:c}=r,h=a(t,i,c);n.exposeAction(e,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),l&&n.addCase(h.rejected,l),d&&n.addMatcher(h.settled,d),n.exposeCaseReducer(e,{fulfilled:s||bi,pending:o||bi,rejected:l||bi,settled:d||bi})}function bi(){}var lP="task",Wv="listener",qv="completed",Gu="cancelled",cP=`task-${Gu}`,uP=`task-${qv}`,Wc=`${Wv}-${Gu}`,dP=`${Wv}-${qv}`,Bs=class{constructor(t){this.code=t,this.message=`${lP} ${Gu} (reason: ${t})`}name="TaskAbortError";message},Yu=(t,e)=>{if(typeof t!="function")throw new TypeError(ct(32))},Ji=()=>{},zv=(t,e=Ji)=>(t.catch(e),t),Kv=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Jr=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Xr=t=>{if(t.aborted){const{reason:e}=t;throw new Bs(e)}};function Hv(t,e){let r=Ji;return new Promise((n,a)=>{const i=()=>a(new Bs(t.reason));if(t.aborted){i();return}r=Kv(t,i),e.finally(()=>r()).then(n,a)}).finally(()=>{r=Ji})}var hP=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Bs?"cancelled":"rejected",error:r}}finally{e?.()}},Xi=t=>e=>zv(Hv(t,e).then(r=>(Xr(t),r))),Vv=t=>{const e=Xi(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:An}=Object,km={},Us="listenerMiddleware",fP=(t,e)=>{const r=n=>Kv(t,()=>Jr(n,t.reason));return(n,a)=>{Yu(n);const i=new AbortController;r(i);const s=hP(async()=>{Xr(t),Xr(i.signal);const o=await n({pause:Xi(i.signal),delay:Vv(i.signal),signal:i.signal});return Xr(i.signal),o},()=>Jr(i,uP));return a?.autoJoin&&e.push(s.catch(Ji)),{result:Xi(t)(s),cancel(){Jr(i,cP)}}}},mP=(t,e)=>{const r=async(n,a)=>{Xr(e);let i=()=>{};const o=[new Promise((l,d)=>{let c=t({predicate:n,effect:(h,f)=>{f.unsubscribe(),l([h,f.getState(),f.getOriginalState()])}});i=()=>{c(),d()}})];a!=null&&o.push(new Promise(l=>setTimeout(l,a,null)));try{const l=await Hv(e,Promise.race(o));return Xr(e),l}finally{i()}};return(n,a)=>zv(r(n,a))},Gv=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:i}=t;if(e)a=wt(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(ct(21));return Yu(i),{predicate:a,type:e,effect:i}},Yv=An(t=>{const{type:e,predicate:r,effect:n}=Gv(t);return{id:ZN(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ct(22))}}},{withTypes:()=>Yv}),Mm=(t,e)=>{const{type:r,effect:n,predicate:a}=Gv(e);return Array.from(t.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},qc=t=>{t.pending.forEach(e=>{Jr(e,Wc)})},pP=t=>()=>{t.forEach(qc),t.clear()},Om=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},Jv=An(wt(`${Us}/add`),{withTypes:()=>Jv}),gP=wt(`${Us}/removeAll`),Xv=An(wt(`${Us}/remove`),{withTypes:()=>Xv}),vP=(...t)=>{console.error(`${Us}/error`,...t)},za=(t={})=>{const e=new Map,{extra:r,onError:n=vP}=t;Yu(n);const a=c=>(c.unsubscribe=()=>e.delete(c.id),e.set(c.id,c),h=>{c.unsubscribe(),h?.cancelActive&&qc(c)}),i=c=>{const h=Mm(e,c)??Yv(c);return a(h)};An(i,{withTypes:()=>i});const s=c=>{const h=Mm(e,c);return h&&(h.unsubscribe(),c.cancelActive&&qc(h)),!!h};An(s,{withTypes:()=>s});const o=async(c,h,f,m)=>{const p=new AbortController,g=mP(i,p.signal),y=[];try{c.pending.add(p),await Promise.resolve(c.effect(h,An({},f,{getOriginalState:m,condition:(b,x)=>g(b,x).then(Boolean),take:g,delay:Vv(p.signal),pause:Xi(p.signal),extra:r,signal:p.signal,fork:fP(p.signal,y),unsubscribe:c.unsubscribe,subscribe:()=>{e.set(c.id,c)},cancelActiveListeners:()=>{c.pending.forEach((b,x,w)=>{b!==p&&(Jr(b,Wc),w.delete(b))})},cancel:()=>{Jr(p,Wc),c.pending.delete(p)},throwIfCancelled:()=>{Xr(p.signal)}})))}catch(b){b instanceof Bs||Om(n,b,{raisedBy:"effect"})}finally{await Promise.all(y),Jr(p,dP),c.pending.delete(p)}},l=pP(e);return{middleware:c=>h=>f=>{if(!Ev(f))return h(f);if(Jv.match(f))return i(f.payload);if(gP.match(f)){l();return}if(Xv.match(f))return s(f.payload);let m=c.getState();const p=()=>{if(m===km)throw new Error(ct(23));return m};let g;try{if(g=h(f),e.size>0){const y=c.getState(),b=Array.from(e.values());for(const x of b){let w=!1;try{w=x.predicate(f,y,m)}catch(_){w=!1,Om(n,_,{raisedBy:"predicate"})}w&&o(x,f,c,p)}}}finally{m=km}return g},startListening:i,stopListening:s,clearListeners:l}};function ct(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var yP={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Zv=ft({name:"chartLayout",initialState:yP,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,i;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(i=e.payload.left)!==null&&i!==void 0?i:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:bP,setLayout:xP,setChartSize:wP,setScale:_P}=Zv.actions,jP=Zv.reducer;function Am(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Em(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Am(Object(r),!0).forEach(function(n){SP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Am(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SP(t,e,r){return(e=NP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NP(t){var e=PP(t,"string");return typeof e=="symbol"?e:e+""}function PP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Zi=Math.PI/180,kP=t=>t*180/Math.PI,ke=(t,e,r,n)=>({x:t+Math.cos(-Zi*n)*r,y:e+Math.sin(-Zi*n)*r}),Qv=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},MP=(t,e)=>{var{x:r,y:n}=t,{x:a,y:i}=e;return Math.sqrt((r-a)**2+(n-i)**2)},OP=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:i}=e,s=MP({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var o=(r-a)/s,l=Math.acos(o);return n>i&&(l=2*Math.PI-l),{radius:s,angle:kP(l),angleInRadian:l}},AP=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:e-i*360,endAngle:r-i*360}},EP=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return t+s*360},TP=(t,e)=>{var{x:r,y:n}=t,{radius:a,angle:i}=OP({x:r,y:n},e),{innerRadius:s,outerRadius:o}=e;if(a<s||a>o||a===0)return null;var{startAngle:l,endAngle:d}=AP(e),c=i,h;if(l<=d){for(;c>d;)c-=360;for(;c<l;)c+=360;h=c>=l&&c<=d}else{for(;c>l;)c-=360;for(;c<d;)c+=360;h=c>=d&&c<=l}return h?Em(Em({},e),{},{radius:a,angle:EP(c,e)}):null};function ey(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Tm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tm(Object(r),!0).forEach(function(n){CP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CP(t,e,r){return(e=IP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IP(t){var e=DP(t,"string");return typeof e=="symbol"?e:e+""}function DP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ie(t,e,r){return le(t)||le(e)?r:Dt(e)?en(t,e,r):typeof e=="function"?e(t):r}var $P=(t,e,r,n,a)=>{var i,s=-1,o=(i=e?.length)!==null&&i!==void 0?i:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var d=l>0?r[l-1].coordinate:r[o-1].coordinate,c=r[l].coordinate,h=l>=o-1?r[0].coordinate:r[l+1].coordinate,f=void 0;if(Be(c-d)!==Be(h-c)){var m=[];if(Be(h-c)===Be(a[1]-a[0])){f=h;var p=c+a[1]-a[0];m[0]=Math.min(p,(p+d)/2),m[1]=Math.max(p,(p+d)/2)}else{f=d;var g=h+a[1]-a[0];m[0]=Math.min(c,(g+c)/2),m[1]=Math.max(c,(g+c)/2)}var y=[Math.min(c,(f+c)/2),Math.max(c,(f+c)/2)];if(t>y[0]&&t<=y[1]||t>=m[0]&&t<=m[1]){({index:s}=r[l]);break}}else{var b=Math.min(d,h),x=Math.max(d,h);if(t>(b+c)/2&&t<=(x+c)/2){({index:s}=r[l]);break}}}else if(e){for(var w=0;w<o;w++)if(w===0&&t<=(e[w].coordinate+e[w+1].coordinate)/2||w>0&&w<o-1&&t>(e[w].coordinate+e[w-1].coordinate)/2&&t<=(e[w].coordinate+e[w+1].coordinate)/2||w===o-1&&t>(e[w].coordinate+e[w-1].coordinate)/2){({index:s}=e[w]);break}}return s},RP=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:o}=e;if((o==="vertical"||o==="horizontal"&&s==="middle")&&i!=="center"&&q(t[i]))return bt(bt({},t),{},{[i]:t[i]+(n||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&s!=="middle"&&q(t[s]))return bt(bt({},t),{},{[s]:t[s]+(a||0)})}return t},Ar=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",ty=(t,e,r,n)=>{if(n)return t.map(o=>o.coordinate);var a,i,s=t.map(o=>(o.coordinate===e&&(a=!0),o.coordinate===r&&(i=!0),o.coordinate));return a||s.push(e),i||s.push(r),s},ry=(t,e,r)=>{if(!t)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:o,isCategorical:l,categoricalDomain:d,tickCount:c,ticks:h,niceTicks:f,axisType:m}=t;if(!s)return null;var p=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,g=a==="category"&&s.bandwidth?s.bandwidth()/p:0;if(g=m==="angleAxis"&&i&&i.length>=2?Be(i[0]-i[1])*2*g:g,h||f){var y=(h||f||[]).map((b,x)=>{var w=n?n.indexOf(b):b;return{coordinate:s(w)+g,value:b,offset:g,index:x}});return y.filter(b=>!ut(b.coordinate))}return l&&d?d.map((b,x)=>({coordinate:s(b)+g,value:b,index:x,offset:g})):s.ticks&&c!=null?s.ticks(c).map((b,x)=>({coordinate:s(b)+g,value:b,offset:g,index:x})):s.domain().map((b,x)=>({coordinate:s(b)+g,value:n?n[b]:b,index:x,offset:g}))},Cm=1e-4,LP=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-Cm,i=Math.max(n[0],n[1])+Cm,s=t(e[0]),o=t(e[r-1]);(s<a||s>i||o<a||o>i)&&t.domain([e[0],e[r-1]])}},BP=(t,e)=>{if(!e||e.length!==2||!q(e[0])||!q(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!q(t[0])||t[0]<r)&&(a[0]=r),(!q(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},UP=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var a=0,i=0,s=0;s<e;++s){var o=ut(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1]):(t[s][r][0]=i,t[s][r][1]=i+o,i=t[s][r][1])}},FP=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var a=0,i=0;i<e;++i){var s=ut(t[i][r][1])?t[i][r][0]:t[i][r][1];s>=0?(t[i][r][0]=a,t[i][r][1]=a+s,a=t[i][r][1]):(t[i][r][0]=0,t[i][r][1]=0)}},WP={sign:UP,expand:vS,none:Dn,silhouette:yS,wiggle:bS,positive:FP},qP=(t,e,r)=>{var n=WP[r],a=gS().keys(e).value((i,s)=>+ie(i,s,0)).order(Cc).offset(n);return a(t)};function zP(t){return t==null?void 0:String(t)}function Qi(t){var{axis:e,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!le(a[e.dataKey])){var o=Hg(r,"value",a[e.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var l=ie(a,le(s)?e.dataKey:s);return le(l)?null:e.scale(l)}var Im=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:i,index:s}=t;if(e.type==="category")return r[s]?r[s].coordinate+n:null;var o=ie(i,e.dataKey,e.scale.domain()[s]);return le(o)?null:e.scale(o)-a/2+n},KP=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},HP=t=>{var e=t.flat(2).filter(q);return[Math.min(...e),Math.max(...e)]},VP=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],GP=(t,e,r)=>{if(t!=null)return VP(Object.keys(t).reduce((n,a)=>{var i=t[a],{stackedData:s}=i,o=s.reduce((l,d)=>{var c=ey(d,e,r),h=HP(c);return[Math.min(l[0],h[0]),Math.max(l[1],h[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Dm=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,$m=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ca=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=Ds(e,c=>c.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var l=a[s],d=a[s-1];i=Math.min((l.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Rm(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:i}=t;return bt(bt({},e),{},{dataKey:r,payload:n,value:a,name:i})}function Er(t,e){if(t)return String(t);if(typeof e=="string")return e}function YP(t,e,r,n,a){if(r==="horizontal"||r==="vertical"){var i=t>=a.left&&t<=a.left+a.width&&e>=a.top&&e<=a.top+a.height;return i?{x:t,y:e}:null}return n?TP({x:t,y:e},n):null}var JP=(t,e,r,n)=>{var a=e.find(d=>d&&d.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.y};if(t==="vertical")return{x:n.x,y:a.coordinate};if(t==="centric"){var i=a.coordinate,{radius:s}=n;return bt(bt(bt({},n),ke(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:l}=n;return bt(bt(bt({},n),ke(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}},XP=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,nr=t=>t.layout.width,ar=t=>t.layout.height,ZP=t=>t.layout.scale,ny=t=>t.layout.margin,Fs=A(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Ws=A(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),Ju="data-recharts-item-index",Xu="data-recharts-item-data-key",Ka=60;function Lm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function xi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lm(Object(r),!0).forEach(function(n){QP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QP(t,e,r){return(e=ek(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ek(t){var e=tk(t,"string");return typeof e=="symbol"?e:e+""}function tk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rk=t=>t.brush.height;function nk(t){var e=Ws(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Ka;return r+a}return r},0)}function ak(t){var e=Ws(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Ka;return r+a}return r},0)}function ik(t){var e=Fs(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function sk(t){var e=Fs(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Te=A([nr,ar,ny,rk,nk,ak,ik,sk,kv,jN],(t,e,r,n,a,i,s,o,l,d)=>{var c={left:(r.left||0)+a,right:(r.right||0)+i},h={top:(r.top||0)+s,bottom:(r.bottom||0)+o},f=xi(xi({},h),c),m=f.bottom;f.bottom+=n,f=RP(f,l,d);var p=t-f.left-f.right,g=e-f.top-f.bottom;return xi(xi({brushBottom:m},f),{},{width:Math.max(p,0),height:Math.max(g,0)})}),ok=A(Te,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),Zu=A(nr,ar,(t,e)=>({x:0,y:0,width:t,height:e})),lk=v.createContext(null),Je=()=>v.useContext(lk)!=null,qs=t=>t.brush,zs=A([qs,Te,ny],(t,e,r)=>({height:t.height,x:q(t.x)?t.x:e.left,y:q(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:q(t.width)?t.width:e.width})),Ks=()=>{var t,e=Je(),r=F(ok),n=F(zs),a=(t=F(qs))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},ck={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},ay=()=>{var t;return(t=F(Te))!==null&&t!==void 0?t:ck},Qu=()=>F(nr),ed=()=>F(ar),uk=()=>F(t=>t.layout.margin),Q=t=>t.layout.layoutType,Hs=()=>F(Q),dk={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},iy=ft({name:"legend",initialState:dk,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var r=Yt(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)}}}),{setLegendSize:Bm,setLegendSettings:hk,addLegendPayload:sy,removeLegendPayload:oy}=iy.actions,fk=iy.reducer,mk=["contextPayload"];function zc(){return zc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zc.apply(null,arguments)}function Um(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Rn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Um(Object(r),!0).forEach(function(n){td(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Um(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function td(t,e,r){return(e=pk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pk(t){var e=gk(t,"string");return typeof e=="symbol"?e:e+""}function gk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vk(t,e){if(t==null)return{};var r,n,a=yk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function yk(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function bk(t){return t.value}function xk(t){var{contextPayload:e}=t,r=vk(t,mk),n=jv(e,t.payloadUniqBy,bk),a=Rn(Rn({},r),{},{payload:n});return v.isValidElement(t.content)?v.cloneElement(t.content,a):typeof t.content=="function"?v.createElement(t.content,a):v.createElement(Fu,a)}function wk(t,e,r,n,a,i){var{layout:s,align:o,verticalAlign:l}=e,d,c;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(o==="center"&&s==="vertical"?d={left:((n||0)-i.width)/2}:d=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(l==="middle"?c={top:((a||0)-i.height)/2}:c=l==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Rn(Rn({},d),c)}function _k(t){var e=be();return v.useEffect(()=>{e(hk(t))},[e,t]),null}function jk(t){var e=be();return v.useEffect(()=>(e(Bm(t)),()=>{e(Bm({width:0,height:0}))}),[e,t]),null}function Sk(t){var e=PN(),r=Uj(),n=uk(),{width:a,height:i,wrapperStyle:s,portal:o}=t,[l,d]=Mv([e]),c=Qu(),h=ed();if(c==null||h==null)return null;var f=c-(n.left||0)-(n.right||0),m=Vs.getWidthOrHeight(t.layout,i,a,f),p=o?s:Rn(Rn({position:"absolute",width:m?.width||a||"auto",height:m?.height||i||"auto"},wk(s,t,n,c,h,l)),s),g=o??r;if(g==null)return null;var y=v.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},v.createElement(_k,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),v.createElement(jk,{width:l.width,height:l.height}),v.createElement(xk,zc({},t,m,{margin:n,chartWidth:c,chartHeight:h,contextPayload:e})));return Jg.createPortal(y,g)}class Vs extends v.PureComponent{static getWidthOrHeight(e,r,n,a){return e==="vertical"&&q(r)?{height:r}:e==="horizontal"?{width:n||a}:null}render(){return v.createElement(Sk,this.props)}}td(Vs,"displayName","Legend");td(Vs,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Kc(){return Kc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Kc.apply(null,arguments)}function Fm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function $l(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fm(Object(r),!0).forEach(function(n){Nk(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nk(t,e,r){return(e=Pk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pk(t){var e=kk(t,"string");return typeof e=="symbol"?e:e+""}function kk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mk(t){return Array.isArray(t)&&Dt(t[0])&&Dt(t[1])?t.join(" ~ "):t}var Ok=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:l,labelClassName:d,label:c,labelFormatter:h,accessibilityLayer:f=!1}=t,m=()=>{if(i&&i.length){var S={padding:0,margin:0},j=(o?Ds(i,o):i).map((N,M)=>{if(N.type==="none")return null;var O=N.formatter||s||Mk,{value:T,name:P}=N,k=T,D=P;if(O){var I=O(T,P,N,M,i);if(Array.isArray(I))[k,D]=I;else if(I!=null)k=I;else return null}var z=$l({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},n);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:z},Dt(D)?v.createElement("span",{className:"recharts-tooltip-item-name"},D):null,Dt(D)?v.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,v.createElement("span",{className:"recharts-tooltip-item-value"},k),v.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:S},j)}return null},p=$l({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=$l({margin:0},a),y=!le(c),b=y?c:"",x=ee("recharts-default-tooltip",l),w=ee("recharts-tooltip-label",d);y&&h&&i!==void 0&&i!==null&&(b=h(c,i));var _=f?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",Kc({className:x,style:p},_),v.createElement("p",{className:w,style:g},v.isValidElement(b)?b:"".concat(b)),m())},oa="recharts-tooltip-wrapper",Ak={visibility:"hidden"};function Ek(t){var{coordinate:e,translateX:r,translateY:n}=t;return ee(oa,{["".concat(oa,"-right")]:q(r)&&e&&q(e.x)&&r>=e.x,["".concat(oa,"-left")]:q(r)&&e&&q(e.x)&&r<e.x,["".concat(oa,"-bottom")]:q(n)&&e&&q(e.y)&&n>=e.y,["".concat(oa,"-top")]:q(n)&&e&&q(e.y)&&n<e.y})}function Wm(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:l,viewBoxDimension:d}=t;if(i&&q(i[n]))return i[n];var c=r[n]-o-(a>0?a:0),h=r[n]+a;if(e[n])return s[n]?c:h;var f=l[n];if(f==null)return 0;if(s[n]){var m=c,p=f;return m<p?Math.max(h,f):Math.max(c,f)}if(d==null)return 0;var g=h+o,y=f+d;return g>y?Math.max(c,f):Math.max(h,f)}function Tk(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function Ck(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:o,viewBox:l}=t,d,c,h;return s.height>0&&s.width>0&&r?(c=Wm({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),h=Wm({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),d=Tk({translateX:c,translateY:h,useTranslate3d:o})):d=Ak,{cssProperties:d,cssClasses:Ek({translateX:c,translateY:h,coordinate:r})}}function qm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qm(Object(r),!0).forEach(function(n){Hc(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hc(t,e,r){return(e=Ik(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ik(t){var e=Dk(t,"string");return typeof e=="symbol"?e:e+""}function Dk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $k extends v.PureComponent{constructor(){super(...arguments),Hc(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Hc(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:o,isAnimationActive:l,offset:d,position:c,reverseDirection:h,useTranslate3d:f,viewBox:m,wrapperStyle:p,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,{cssClasses:x,cssProperties:w}=Ck({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:d,position:c,reverseDirection:h,tooltipBox:{height:g.height,width:g.width},useTranslate3d:f,viewBox:m}),_=b?{}:wi(wi({transition:l&&e?"transform ".concat(n,"ms ").concat(a):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),S=wi(wi({},_),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},p);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:x,style:S,ref:y},i)}}var Rk=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ir={devToolsEnabled:!1,isSsr:Rk()},ly=()=>F(t=>t.rootProps.accessibilityLayer);function ht(t){return Number.isFinite(t)}function Ln(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function Vc(){return Vc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vc.apply(null,arguments)}function zm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Km(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zm(Object(r),!0).forEach(function(n){Lk(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lk(t,e,r){return(e=Bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bk(t){var e=Uk(t,"string");return typeof e=="symbol"?e:e+""}function Uk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hm={curveBasisClosed:iS,curveBasisOpen:sS,curveBasis:aS,curveBumpX:zj,curveBumpY:Kj,curveLinearClosed:oS,curveLinear:Ts,curveMonotoneX:lS,curveMonotoneY:cS,curveNatural:uS,curveStep:dS,curveStepAfter:fS,curveStepBefore:hS},_i=t=>ht(t.x)&&ht(t.y),la=t=>t.x,ca=t=>t.y,Fk=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(Wa(t));return(r==="curveMonotone"||r==="curveBump")&&e?Hm["".concat(r).concat(e==="vertical"?"Y":"X")]:Hm[r]||Ts},Wk=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=t,s=Fk(e,a),o=i?r.filter(_i):r,l;if(Array.isArray(n)){var d=i?n.filter(h=>_i(h)):n,c=o.map((h,f)=>Km(Km({},h),{},{base:d[f]}));return a==="vertical"?l=mi().y(ca).x1(la).x0(h=>h.base.x):l=mi().x(la).y1(ca).y0(h=>h.base.y),l.defined(_i).curve(s),l(c)}return a==="vertical"&&q(n)?l=mi().y(ca).x1(la).x0(n):q(n)?l=mi().x(la).y1(ca).y0(n):l=nv().x(la).y(ca),l.defined(_i).curve(s),l(o)},Gs=t=>{var{className:e,points:r,path:n,pathRef:a}=t;if((!r||!r.length)&&!n)return null;var i=r&&r.length?Wk(t):n;return v.createElement("path",Vc({},jt(t),Du(t),{className:ee("recharts-curve",e),d:i===null?void 0:i,ref:a}))},qk=["x","y","top","left","width","height","className"];function Gc(){return Gc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gc.apply(null,arguments)}function Vm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vm(Object(r),!0).forEach(function(n){Kk(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kk(t,e,r){return(e=Hk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hk(t){var e=Vk(t,"string");return typeof e=="symbol"?e:e+""}function Vk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gk(t,e){if(t==null)return{};var r,n,a=Yk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Yk(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Jk=(t,e,r,n,a,i)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(i,",").concat(e,"h").concat(r),Xk=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:o}=t,l=Gk(t,qk),d=zk({x:e,y:r,top:n,left:a,width:i,height:s},l);return!q(e)||!q(r)||!q(i)||!q(s)||!q(n)||!q(a)?null:v.createElement("path",Gc({},ye(d,!0),{className:ee("recharts-cross",o),d:Jk(e,r,i,s,n,a)}))};function Zk(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function Gm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Qk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gm(Object(r),!0).forEach(function(n){eM(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function eM(t,e,r){return(e=tM(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tM(t){var e=rM(t,"string");return typeof e=="symbol"?e:e+""}function rM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ce(t,e){var r=Qk({},t),n=e,a=Object.keys(e),i=a.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return i}function nM(){}function Ym(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ym(Object(r),!0).forEach(function(n){aM(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ym(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aM(t,e,r){return(e=iM(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iM(t){var e=sM(t,"string");return typeof e=="symbol"?e:e+""}function sM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oM=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),cy=(t,e,r)=>t.map(n=>"".concat(oM(n)," ").concat(e,"ms ").concat(r)).join(","),lM=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),Ia=(t,e)=>Object.keys(e).reduce((r,n)=>Jm(Jm({},r),{},{[n]:t(n,e[n])}),{});function Xm(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ze(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xm(Object(r),!0).forEach(function(n){cM(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xm(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cM(t,e,r){return(e=uM(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uM(t){var e=dM(t,"string");return typeof e=="symbol"?e:e+""}function dM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var es=(t,e,r)=>t+(e-t)*r,Yc=t=>{var{from:e,to:r}=t;return e!==r},uy=(t,e,r)=>{var n=Ia((a,i)=>{if(Yc(i)){var[s,o]=t(i.from,i.to,i.velocity);return ze(ze({},i),{},{from:s,velocity:o})}return i},e);return r<1?Ia((a,i)=>Yc(i)?ze(ze({},i),{},{velocity:es(i.velocity,n[a].velocity,r),from:es(i.from,n[a].from,r)}):i,e):uy(t,n,r-1)};function hM(t,e,r,n,a,i){var s,o=n.reduce((f,m)=>ze(ze({},f),{},{[m]:{from:t[m],velocity:0,to:e[m]}}),{}),l=()=>Ia((f,m)=>m.from,o),d=()=>!Object.values(o).filter(Yc).length,c=null,h=f=>{s||(s=f);var m=f-s,p=m/r.dt;o=uy(r,o,p),a(ze(ze(ze({},t),e),l())),s=f,d()||(c=i.setTimeout(h))};return()=>(c=i.setTimeout(h),()=>{c()})}function fM(t,e,r,n,a,i,s){var o=null,l=a.reduce((h,f)=>ze(ze({},h),{},{[f]:[t[f],e[f]]}),{}),d,c=h=>{d||(d=h);var f=(h-d)/n,m=Ia((g,y)=>es(...y,r(f)),l);if(i(ze(ze(ze({},t),e),m)),f<1)o=s.setTimeout(c);else{var p=Ia((g,y)=>es(...y,r(1)),l);i(ze(ze(ze({},t),e),p))}};return()=>(o=s.setTimeout(c),()=>{o()})}const mM=(t,e,r,n,a,i)=>{var s=lM(t,e);return r.isStepper===!0?hM(t,e,r,s,a,i):fM(t,e,r,n,s,a,i)};var ts=1e-4,dy=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],hy=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),Zm=(t,e)=>r=>{var n=dy(t,e);return hy(n,r)},pM=(t,e)=>r=>{var n=dy(t,e),a=[...n.map((i,s)=>i*s).slice(1),0];return hy(a,r)},Qm=function(){for(var e,r,n,a,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[e,n,r,a]=[0,0,1,1];break;case"ease":[e,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[e,n,r,a]=[.42,0,1,1];break;case"ease-out":[e,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[e,n,r,a]=[0,0,.58,1];break;default:{var l=s[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([e,n,r,a]=l[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else s.length===4&&([e,n,r,a]=s);var d=Zm(e,r),c=Zm(n,a),h=pM(e,r),f=p=>p>1?1:p<0?0:p,m=p=>{for(var g=p>1?1:p,y=g,b=0;b<8;++b){var x=d(y)-g,w=h(y);if(Math.abs(x-g)<ts||w<ts)return c(y);y=f(y-x/w)}return c(y)};return m.isStepper=!1,m},gM=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,i=(s,o,l)=>{var d=-(s-o)*r,c=l*n,h=l+(d-c)*a/1e3,f=l*a/1e3+s;return Math.abs(f-o)<ts&&Math.abs(h)<ts?[o,0]:[f,h]};return i.isStepper=!0,i.dt=a,i},vM=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Qm(t);case"spring":return gM();default:if(t.split("(")[0]==="cubic-bezier")return Qm(t)}return typeof t=="function"?t:null};function yM(t){var e,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[l,...d]=o;if(typeof l=="number"){a=t.setTimeout(i.bind(null,d),l);return}i(l),a=t.setTimeout(i.bind(null,d));return}typeof s=="string"&&(e=s,r(e)),typeof s=="object"&&(e=s,r(e)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>t}}class bM{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?e(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function xM(){return yM(new bM)}var wM=v.createContext(xM);function _M(t,e){var r=v.useContext(wM);return v.useMemo(()=>e??r(t),[t,e,r])}var jM={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},ep={t:0},Rl={t:1};function Vn(t){var e=Ce(t,jM),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:l,children:d}=e,c=_M(e.animationId,e.animationManager),[h,f]=v.useState(r?ep:Rl),m=v.useRef(null);return v.useEffect(()=>{r||f(Rl)},[r]),v.useEffect(()=>{if(!r||!n)return nM;var p=mM(ep,Rl,vM(i),a,f,c.getTimeoutController()),g=()=>{m.current=p()};return c.start([l,s,g,a,o]),()=>{c.stop(),m.current&&m.current(),o()}},[r,n,a,i,s,l,o,c]),d(h.t)}function Gn(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(Aa(e)),n=v.useRef(t);return n.current!==t&&(r.current=Aa(e),n.current=t),r.current}function tp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tp(Object(r),!0).forEach(function(n){SM(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tp(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SM(t,e,r){return(e=NM(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NM(t){var e=PM(t,"string");return typeof e=="symbol"?e:e+""}function PM(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rs(){return rs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rs.apply(null,arguments)}var np=(t,e,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var c=[0,0,0,0],h=0,f=4;h<f;h++)c[h]=a[h]>i?i:a[h];d="M".concat(t,",").concat(e+s*c[0]),c[0]>0&&(d+="A ".concat(c[0],",").concat(c[0],",0,0,").concat(l,",").concat(t+o*c[0],",").concat(e)),d+="L ".concat(t+r-o*c[1],",").concat(e),c[1]>0&&(d+="A ".concat(c[1],",").concat(c[1],",0,0,").concat(l,`,
        `).concat(t+r,",").concat(e+s*c[1])),d+="L ".concat(t+r,",").concat(e+n-s*c[2]),c[2]>0&&(d+="A ".concat(c[2],",").concat(c[2],",0,0,").concat(l,`,
        `).concat(t+r-o*c[2],",").concat(e+n)),d+="L ".concat(t+o*c[3],",").concat(e+n),c[3]>0&&(d+="A ".concat(c[3],",").concat(c[3],",0,0,").concat(l,`,
        `).concat(t,",").concat(e+n-s*c[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var m=Math.min(i,a);d="M ".concat(t,",").concat(e+s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t+o*m,",").concat(e,`
            L `).concat(t+r-o*m,",").concat(e,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t+r,",").concat(e+s*m,`
            L `).concat(t+r,",").concat(e+n-s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t+r-o*m,",").concat(e+n,`
            L `).concat(t+o*m,",").concat(e+n,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(t,",").concat(e+n-s*m," Z")}else d="M ".concat(t,",").concat(e," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},kM={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},fy=t=>{var e=Ce(t,kM),r=v.useRef(null),[n,a]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var I=r.current.getTotalLength();I&&a(I)}catch{}},[]);var{x:i,y:s,width:o,height:l,radius:d,className:c}=e,{animationEasing:h,animationDuration:f,animationBegin:m,isAnimationActive:p,isUpdateAnimationActive:g}=e,y=v.useRef(o),b=v.useRef(l),x=v.useRef(i),w=v.useRef(s),_=v.useMemo(()=>({x:i,y:s,width:o,height:l,radius:d}),[i,s,o,l,d]),S=Gn(_,"rectangle-");if(i!==+i||s!==+s||o!==+o||l!==+l||o===0||l===0)return null;var j=ee("recharts-rectangle",c);if(!g)return v.createElement("path",rs({},ye(e,!0),{className:j,d:np(i,s,o,l,d)}));var N=y.current,M=b.current,O=x.current,T=w.current,P="0px ".concat(n===-1?1:n,"px"),k="".concat(n,"px 0px"),D=cy(["strokeDasharray"],f,typeof h=="string"?h:void 0);return v.createElement(Vn,{animationId:S,key:S,canBegin:n>0,duration:f,easing:h,isActive:g,begin:m},I=>{var z=we(N,o,I),H=we(M,l,I),K=we(O,i,I),X=we(T,s,I);r.current&&(y.current=z,b.current=H,x.current=K,w.current=X);var B;return p?I>0?B={transition:D,strokeDasharray:k}:B={strokeDasharray:P}:B={strokeDasharray:k},v.createElement("path",rs({},ye(e,!0),{className:j,d:np(K,X,z,H,d),ref:r,style:rp(rp({},B),e.style)}))})};function my(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:i}=t,s=ke(e,r,n,a),o=ke(e,r,n,i);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:a,endAngle:i}}function Jc(){return Jc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jc.apply(null,arguments)}var MM=(t,e)=>{var r=Be(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},ji=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:l}=t,d=o*(s?1:-1)+n,c=Math.asin(o/d)/Zi,h=l?a:a+i*c,f=ke(e,r,d,h),m=ke(e,r,n,h),p=l?a-i*c:a,g=ke(e,r,d*Math.cos(c*Zi),p);return{center:f,circleTangency:m,lineTangency:g,theta:c}},py=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=t,o=MM(i,s),l=i+o,d=ke(e,r,a,i),c=ke(e,r,a,l),h="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>l),`,
    `).concat(c.x,",").concat(c.y,`
  `);if(n>0){var f=ke(e,r,n,i),m=ke(e,r,n,l);h+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=l),`,
            `).concat(f.x,",").concat(f.y," Z")}else h+="L ".concat(e,",").concat(r," Z");return h},OM=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:l,endAngle:d}=t,c=Be(d-l),{circleTangency:h,lineTangency:f,theta:m}=ji({cx:e,cy:r,radius:a,angle:l,sign:c,cornerRadius:i,cornerIsExternal:o}),{circleTangency:p,lineTangency:g,theta:y}=ji({cx:e,cy:r,radius:a,angle:d,sign:-c,cornerRadius:i,cornerIsExternal:o}),b=o?Math.abs(l-d):Math.abs(l-d)-m-y;if(b<0)return s?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):py({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:l,endAngle:d});var x="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(c<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:w,lineTangency:_,theta:S}=ji({cx:e,cy:r,radius:n,angle:l,sign:c,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:j,lineTangency:N,theta:M}=ji({cx:e,cy:r,radius:n,angle:d,sign:-c,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),O=o?Math.abs(l-d):Math.abs(l-d)-S-M;if(O<0&&i===0)return"".concat(x,"L").concat(e,",").concat(r,"Z");x+="L".concat(N.x,",").concat(N.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(j.x,",").concat(j.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(O>180),",").concat(+(c>0),",").concat(w.x,",").concat(w.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(_.x,",").concat(_.y,"Z")}else x+="L".concat(e,",").concat(r,"Z");return x},AM={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},gy=t=>{var e=Ce(t,AM),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:d,endAngle:c,className:h}=e;if(i<a||d===c)return null;var f=ee("recharts-sector",h),m=i-a,p=Ye(s,m,0,!0),g;return p>0&&Math.abs(d-c)<360?g=OM({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(p,m/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:d,endAngle:c}):g=py({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:c}),v.createElement("path",Jc({},ye(e,!0),{className:f,d:g}))};function EM(t,e,r){var n,a,i,s;if(t==="horizontal")n=e.x,i=n,a=r.top,s=r.top+r.height;else if(t==="vertical")a=e.y,s=a,n=r.left,i=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:o,cy:l,innerRadius:d,outerRadius:c,angle:h}=e,f=ke(o,l,d,h),m=ke(o,l,c,h);n=f.x,a=f.y,i=m.x,s=m.y}else return my(e);return[{x:n,y:a},{x:i,y:s}]}var Ll={},Bl={},Ul={},ap;function TM(){return ap||(ap=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nv();function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(Ul)),Ul}var ip;function CM(){return ip||(ip=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=TM();function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(Bl)),Bl}var sp;function IM(){return sp||(sp=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pv(),r=CM();function n(a,i,s){s&&typeof s!="number"&&e.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((i-a)/(s||1)),0),l=new Array(o);for(let d=0;d<o;d++)l[d]=a,a+=s;return l}t.range=n})(Ll)),Ll}var Fl,op;function DM(){return op||(op=1,Fl=IM().range),Fl}var $M=DM();const vy=rr($M);function Nr(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function RM(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function rd(t){let e,r,n;t.length!==2?(e=Nr,r=(o,l)=>Nr(t(o),l),n=(o,l)=>t(o)-l):(e=t===Nr||t===RM?t:LM,r=t,n=t);function a(o,l,d=0,c=o.length){if(d<c){if(e(l,l)!==0)return c;do{const h=d+c>>>1;r(o[h],l)<0?d=h+1:c=h}while(d<c)}return d}function i(o,l,d=0,c=o.length){if(d<c){if(e(l,l)!==0)return c;do{const h=d+c>>>1;r(o[h],l)<=0?d=h+1:c=h}while(d<c)}return d}function s(o,l,d=0,c=o.length){const h=a(o,l,d,c-1);return h>d&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:a,center:s,right:i}}function LM(){return 0}function yy(t){return t===null?NaN:+t}function*BM(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const UM=rd(Nr),Ha=UM.right;rd(yy).center;class lp extends Map{constructor(e,r=qM){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(cp(this,e))}has(e){return super.has(cp(this,e))}set(e,r){return super.set(FM(this,e),r)}delete(e){return super.delete(WM(this,e))}}function cp({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function FM({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function WM({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function qM(t){return t!==null&&typeof t=="object"?t.valueOf():t}function zM(t=Nr){if(t===Nr)return by;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function by(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const KM=Math.sqrt(50),HM=Math.sqrt(10),VM=Math.sqrt(2);function ns(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=KM?10:i>=HM?5:i>=VM?2:1;let o,l,d;return a<0?(d=Math.pow(10,-a)/s,o=Math.round(t*d),l=Math.round(e*d),o/d<t&&++o,l/d>e&&--l,d=-d):(d=Math.pow(10,a)*s,o=Math.round(t/d),l=Math.round(e/d),o*d<t&&++o,l*d>e&&--l),l<o&&.5<=r&&r<2?ns(t,e,r*2):[o,l,d]}function Xc(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,i,s]=n?ns(e,t,r):ns(t,e,r);if(!(i>=a))return[];const o=i-a+1,l=new Array(o);if(n)if(s<0)for(let d=0;d<o;++d)l[d]=(i-d)/-s;else for(let d=0;d<o;++d)l[d]=(i-d)*s;else if(s<0)for(let d=0;d<o;++d)l[d]=(a+d)/-s;else for(let d=0;d<o;++d)l[d]=(a+d)*s;return l}function Zc(t,e,r){return e=+e,t=+t,r=+r,ns(t,e,r)[2]}function Qc(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?Zc(e,t,r):Zc(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function up(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function dp(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function xy(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?by:zM(a);n>r;){if(n-r>600){const l=n-r+1,d=e-r+1,c=Math.log(l),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(l-h)/l)*(d-l/2<0?-1:1),m=Math.max(r,Math.floor(e-d*h/l+f)),p=Math.min(n,Math.floor(e+(l-d)*h/l+f));xy(t,e,m,p,a)}const i=t[e];let s=r,o=n;for(ua(t,r,e),a(t[n],i)>0&&ua(t,r,n);s<o;){for(ua(t,s,o),++s,--o;a(t[s],i)<0;)++s;for(;a(t[o],i)>0;)--o}a(t[r],i)===0?ua(t,r,o):(++o,ua(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function ua(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function GM(t,e,r){if(t=Float64Array.from(BM(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return dp(t);if(e>=1)return up(t);var n,a=(n-1)*e,i=Math.floor(a),s=up(xy(t,i).subarray(0,i+1)),o=dp(t.subarray(i+1));return s+(o-s)*(a-i)}}function YM(t,e,r=yy){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,i=Math.floor(a),s=+r(t[i],i,t),o=+r(t[i+1],i+1,t);return s+(o-s)*(a-i)}}function JM(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,i=new Array(a);++n<a;)i[n]=t+n*r;return i}function St(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function sr(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const eu=Symbol("implicit");function nd(){var t=new lp,e=[],r=[],n=eu;function a(i){let s=t.get(i);if(s===void 0){if(n!==eu)return n;t.set(i,s=e.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new lp;for(const s of i)t.has(s)||t.set(s,e.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return nd(e,r).unknown(n)},St.apply(a,arguments),a}function ad(){var t=nd().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,i,s,o=!1,l=0,d=0,c=.5;delete t.unknown;function h(){var f=e().length,m=a<n,p=m?a:n,g=m?n:a;i=(g-p)/Math.max(1,f-l+d*2),o&&(i=Math.floor(i)),p+=(g-p-i*(f-l))*c,s=i*(1-l),o&&(p=Math.round(p),s=Math.round(s));var y=JM(f).map(function(b){return p+i*b});return r(m?y.reverse():y)}return t.domain=function(f){return arguments.length?(e(f),h()):e()},t.range=function(f){return arguments.length?([n,a]=f,n=+n,a=+a,h()):[n,a]},t.rangeRound=function(f){return[n,a]=f,n=+n,a=+a,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(f){return arguments.length?(o=!!f,h()):o},t.padding=function(f){return arguments.length?(l=Math.min(1,d=+f),h()):l},t.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),h()):l},t.paddingOuter=function(f){return arguments.length?(d=+f,h()):d},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),h()):c},t.copy=function(){return ad(e(),[n,a]).round(o).paddingInner(l).paddingOuter(d).align(c)},St.apply(h(),arguments)}function wy(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return wy(e())},t}function XM(){return wy(ad.apply(null,arguments).paddingInner(1))}function id(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function _y(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Va(){}var Da=.7,as=1/Da,En="\\s*([+-]?\\d+)\\s*",$a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",It="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ZM=/^#([0-9a-f]{3,8})$/,QM=new RegExp(`^rgb\\(${En},${En},${En}\\)$`),eO=new RegExp(`^rgb\\(${It},${It},${It}\\)$`),tO=new RegExp(`^rgba\\(${En},${En},${En},${$a}\\)$`),rO=new RegExp(`^rgba\\(${It},${It},${It},${$a}\\)$`),nO=new RegExp(`^hsl\\(${$a},${It},${It}\\)$`),aO=new RegExp(`^hsla\\(${$a},${It},${It},${$a}\\)$`),hp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};id(Va,Ra,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fp,formatHex:fp,formatHex8:iO,formatHsl:sO,formatRgb:mp,toString:mp});function fp(){return this.rgb().formatHex()}function iO(){return this.rgb().formatHex8()}function sO(){return jy(this).formatHsl()}function mp(){return this.rgb().formatRgb()}function Ra(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=ZM.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?pp(e):r===3?new nt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Si(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Si(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=QM.exec(t))?new nt(e[1],e[2],e[3],1):(e=eO.exec(t))?new nt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=tO.exec(t))?Si(e[1],e[2],e[3],e[4]):(e=rO.exec(t))?Si(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=nO.exec(t))?yp(e[1],e[2]/100,e[3]/100,1):(e=aO.exec(t))?yp(e[1],e[2]/100,e[3]/100,e[4]):hp.hasOwnProperty(t)?pp(hp[t]):t==="transparent"?new nt(NaN,NaN,NaN,0):null}function pp(t){return new nt(t>>16&255,t>>8&255,t&255,1)}function Si(t,e,r,n){return n<=0&&(t=e=r=NaN),new nt(t,e,r,n)}function oO(t){return t instanceof Va||(t=Ra(t)),t?(t=t.rgb(),new nt(t.r,t.g,t.b,t.opacity)):new nt}function tu(t,e,r,n){return arguments.length===1?oO(t):new nt(t,e,r,n??1)}function nt(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}id(nt,tu,_y(Va,{brighter(t){return t=t==null?as:Math.pow(as,t),new nt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Da:Math.pow(Da,t),new nt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new nt(Zr(this.r),Zr(this.g),Zr(this.b),is(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gp,formatHex:gp,formatHex8:lO,formatRgb:vp,toString:vp}));function gp(){return`#${Vr(this.r)}${Vr(this.g)}${Vr(this.b)}`}function lO(){return`#${Vr(this.r)}${Vr(this.g)}${Vr(this.b)}${Vr((isNaN(this.opacity)?1:this.opacity)*255)}`}function vp(){const t=is(this.opacity);return`${t===1?"rgb(":"rgba("}${Zr(this.r)}, ${Zr(this.g)}, ${Zr(this.b)}${t===1?")":`, ${t})`}`}function is(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Zr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Vr(t){return t=Zr(t),(t<16?"0":"")+t.toString(16)}function yp(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Ot(t,e,r,n)}function jy(t){if(t instanceof Ot)return new Ot(t.h,t.s,t.l,t.opacity);if(t instanceof Va||(t=Ra(t)),!t)return new Ot;if(t instanceof Ot)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),i=Math.max(e,r,n),s=NaN,o=i-a,l=(i+a)/2;return o?(e===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-e)/o+2:s=(e-r)/o+4,o/=l<.5?i+a:2-i-a,s*=60):o=l>0&&l<1?0:s,new Ot(s,o,l,t.opacity)}function cO(t,e,r,n){return arguments.length===1?jy(t):new Ot(t,e,r,n??1)}function Ot(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}id(Ot,cO,_y(Va,{brighter(t){return t=t==null?as:Math.pow(as,t),new Ot(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Da:Math.pow(Da,t),new Ot(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new nt(Wl(t>=240?t-240:t+120,a,n),Wl(t,a,n),Wl(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new Ot(bp(this.h),Ni(this.s),Ni(this.l),is(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=is(this.opacity);return`${t===1?"hsl(":"hsla("}${bp(this.h)}, ${Ni(this.s)*100}%, ${Ni(this.l)*100}%${t===1?")":`, ${t})`}`}}));function bp(t){return t=(t||0)%360,t<0?t+360:t}function Ni(t){return Math.max(0,Math.min(1,t||0))}function Wl(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const sd=t=>()=>t;function uO(t,e){return function(r){return t+r*e}}function dO(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function hO(t){return(t=+t)==1?Sy:function(e,r){return r-e?dO(e,r,t):sd(isNaN(e)?r:e)}}function Sy(t,e){var r=e-t;return r?uO(t,r):sd(isNaN(t)?e:t)}const xp=(function t(e){var r=hO(e);function n(a,i){var s=r((a=tu(a)).r,(i=tu(i)).r),o=r(a.g,i.g),l=r(a.b,i.b),d=Sy(a.opacity,i.opacity);return function(c){return a.r=s(c),a.g=o(c),a.b=l(c),a.opacity=d(c),a+""}}return n.gamma=t,n})(1);function fO(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=t[a]*(1-i)+e[a]*i;return n}}function mO(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pO(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Yn(t[s],e[s]);for(;s<r;++s)i[s]=e[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function gO(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function ss(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function vO(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=Yn(t[a],e[a]):n[a]=e[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var ru=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ql=new RegExp(ru.source,"g");function yO(t){return function(){return t}}function bO(t){return function(e){return t(e)+""}}function xO(t,e){var r=ru.lastIndex=ql.lastIndex=0,n,a,i,s=-1,o=[],l=[];for(t=t+"",e=e+"";(n=ru.exec(t))&&(a=ql.exec(e));)(i=a.index)>r&&(i=e.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,l.push({i:s,x:ss(n,a)})),r=ql.lastIndex;return r<e.length&&(i=e.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?bO(l[0].x):yO(e):(e=l.length,function(d){for(var c=0,h;c<e;++c)o[(h=l[c]).i]=h.x(d);return o.join("")})}function Yn(t,e){var r=typeof e,n;return e==null||r==="boolean"?sd(e):(r==="number"?ss:r==="string"?(n=Ra(e))?(e=n,xp):xO:e instanceof Ra?xp:e instanceof Date?gO:mO(e)?fO:Array.isArray(e)?pO:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?vO:ss)(t,e)}function od(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function wO(t,e){e===void 0&&(e=t,t=Yn);for(var r=0,n=e.length-1,a=e[0],i=new Array(n<0?0:n);r<n;)i[r]=t(a,a=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function _O(t){return function(){return t}}function os(t){return+t}var wp=[0,1];function tt(t){return t}function nu(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:_O(isNaN(e)?NaN:.5)}function jO(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function SO(t,e,r){var n=t[0],a=t[1],i=e[0],s=e[1];return a<n?(n=nu(a,n),i=r(s,i)):(n=nu(n,a),i=r(i,s)),function(o){return i(n(o))}}function NO(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),i=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)a[s]=nu(t[s],t[s+1]),i[s]=r(e[s],e[s+1]);return function(o){var l=Ha(t,o,1,n)-1;return i[l](a[l](o))}}function Ga(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ys(){var t=wp,e=wp,r=Yn,n,a,i,s=tt,o,l,d;function c(){var f=Math.min(t.length,e.length);return s!==tt&&(s=jO(t[0],t[f-1])),o=f>2?NO:SO,l=d=null,h}function h(f){return f==null||isNaN(f=+f)?i:(l||(l=o(t.map(n),e,r)))(n(s(f)))}return h.invert=function(f){return s(a((d||(d=o(e,t.map(n),ss)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,os),c()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),c()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),r=od,c()},h.clamp=function(f){return arguments.length?(s=f?!0:tt,c()):s!==tt},h.interpolate=function(f){return arguments.length?(r=f,c()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return n=f,a=m,c()}}function ld(){return Ys()(tt,tt)}function PO(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ls(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Bn(t){return t=ls(Math.abs(t)),t?t[1]:NaN}function kO(t,e){return function(r,n){for(var a=r.length,i=[],s=0,o=t[0],l=0;a>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),i.push(r.substring(a-=o,a+o)),!((l+=o+1)>n));)o=t[s=(s+1)%t.length];return i.reverse().join(e)}}function MO(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var OO=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function La(t){if(!(e=OO.exec(t)))throw new Error("invalid format: "+t);var e;return new cd({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}La.prototype=cd.prototype;function cd(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}cd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function AO(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var Ny;function EO(t,e){var r=ls(t,e);if(!r)return t+"";var n=r[0],a=r[1],i=a-(Ny=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ls(t,Math.max(0,e+i-1))[0]}function _p(t,e){var r=ls(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const jp={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:PO,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>_p(t*100,e),r:_p,s:EO,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Sp(t){return t}var Np=Array.prototype.map,Pp=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function TO(t){var e=t.grouping===void 0||t.thousands===void 0?Sp:kO(Np.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?Sp:MO(Np.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function d(h){h=La(h);var f=h.fill,m=h.align,p=h.sign,g=h.symbol,y=h.zero,b=h.width,x=h.comma,w=h.precision,_=h.trim,S=h.type;S==="n"?(x=!0,S="g"):jp[S]||(w===void 0&&(w=12),_=!0,S="g"),(y||f==="0"&&m==="=")&&(y=!0,f="0",m="=");var j=g==="$"?r:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",N=g==="$"?n:/[%p]/.test(S)?s:"",M=jp[S],O=/[defgprs%]/.test(S);w=w===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function T(P){var k=j,D=N,I,z,H;if(S==="c")D=M(P)+D,P="";else{P=+P;var K=P<0||1/P<0;if(P=isNaN(P)?l:M(Math.abs(P),w),_&&(P=AO(P)),K&&+P==0&&p!=="+"&&(K=!1),k=(K?p==="("?p:o:p==="-"||p==="("?"":p)+k,D=(S==="s"?Pp[8+Ny/3]:"")+D+(K&&p==="("?")":""),O){for(I=-1,z=P.length;++I<z;)if(H=P.charCodeAt(I),48>H||H>57){D=(H===46?a+P.slice(I+1):P.slice(I))+D,P=P.slice(0,I);break}}}x&&!y&&(P=e(P,1/0));var X=k.length+P.length+D.length,B=X<b?new Array(b-X+1).join(f):"";switch(x&&y&&(P=e(B+P,B.length?b-D.length:1/0),B=""),m){case"<":P=k+P+D+B;break;case"=":P=k+B+P+D;break;case"^":P=B.slice(0,X=B.length>>1)+k+P+D+B.slice(X);break;default:P=B+k+P+D;break}return i(P)}return T.toString=function(){return h+""},T}function c(h,f){var m=d((h=La(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Bn(f)/3)))*3,g=Math.pow(10,-p),y=Pp[8+p/3];return function(b){return m(g*b)+y}}return{format:d,formatPrefix:c}}var Pi,ud,Py;CO({thousands:",",grouping:[3],currency:["$",""]});function CO(t){return Pi=TO(t),ud=Pi.format,Py=Pi.formatPrefix,Pi}function IO(t){return Math.max(0,-Bn(Math.abs(t)))}function DO(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bn(e)/3)))*3-Bn(Math.abs(t)))}function $O(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Bn(e)-Bn(t))+1}function ky(t,e,r,n){var a=Qc(t,e,r),i;switch(n=La(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=DO(a,s))&&(n.precision=i),Py(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=$O(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=IO(a))&&(n.precision=i-(n.type==="%")*2);break}}return ud(n)}function Tr(t){var e=t.domain;return t.ticks=function(r){var n=e();return Xc(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return ky(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,i=n.length-1,s=n[a],o=n[i],l,d,c=10;for(o<s&&(d=s,s=o,o=d,d=a,a=i,i=d);c-- >0;){if(d=Zc(s,o,r),d===l)return n[a]=s,n[i]=o,e(n);if(d>0)s=Math.floor(s/d)*d,o=Math.ceil(o/d)*d;else if(d<0)s=Math.ceil(s*d)/d,o=Math.floor(o*d)/d;else break;l=d}return t},t}function My(){var t=ld();return t.copy=function(){return Ga(t,My())},St.apply(t,arguments),Tr(t)}function Oy(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,os),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return Oy(t).unknown(e)},t=arguments.length?Array.from(t,os):[0,1],Tr(r)}function Ay(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],i=t[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),t[r]=e.floor(a),t[n]=e.ceil(i),t}function kp(t){return Math.log(t)}function Mp(t){return Math.exp(t)}function RO(t){return-Math.log(-t)}function LO(t){return-Math.exp(-t)}function BO(t){return isFinite(t)?+("1e"+t):t<0?0:t}function UO(t){return t===10?BO:t===Math.E?Math.exp:e=>Math.pow(t,e)}function FO(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Op(t){return(e,r)=>-t(-e,r)}function dd(t){const e=t(kp,Mp),r=e.domain;let n=10,a,i;function s(){return a=FO(n),i=UO(n),r()[0]<0?(a=Op(a),i=Op(i),t(RO,LO)):t(kp,Mp),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const l=r();let d=l[0],c=l[l.length-1];const h=c<d;h&&([d,c]=[c,d]);let f=a(d),m=a(c),p,g;const y=o==null?10:+o;let b=[];if(!(n%1)&&m-f<y){if(f=Math.floor(f),m=Math.ceil(m),d>0){for(;f<=m;++f)for(p=1;p<n;++p)if(g=f<0?p/i(-f):p*i(f),!(g<d)){if(g>c)break;b.push(g)}}else for(;f<=m;++f)for(p=n-1;p>=1;--p)if(g=f>0?p/i(-f):p*i(f),!(g<d)){if(g>c)break;b.push(g)}b.length*2<y&&(b=Xc(d,c,y))}else b=Xc(f,m,Math.min(m-f,y)).map(i);return h?b.reverse():b},e.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=La(l)).precision==null&&(l.trim=!0),l=ud(l)),o===1/0)return l;const d=Math.max(1,n*o/e.ticks().length);return c=>{let h=c/i(Math.round(a(c)));return h*n<n-.5&&(h*=n),h<=d?l(c):""}},e.nice=()=>r(Ay(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),e}function Ey(){const t=dd(Ys()).domain([1,10]);return t.copy=()=>Ga(t,Ey()).base(t.base()),St.apply(t,arguments),t}function Ap(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Ep(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function hd(t){var e=1,r=t(Ap(e),Ep(e));return r.constant=function(n){return arguments.length?t(Ap(e=+n),Ep(e)):e},Tr(r)}function Ty(){var t=hd(Ys());return t.copy=function(){return Ga(t,Ty()).constant(t.constant())},St.apply(t,arguments)}function Tp(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function WO(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function qO(t){return t<0?-t*t:t*t}function fd(t){var e=t(tt,tt),r=1;function n(){return r===1?t(tt,tt):r===.5?t(WO,qO):t(Tp(r),Tp(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},Tr(e)}function md(){var t=fd(Ys());return t.copy=function(){return Ga(t,md()).exponent(t.exponent())},St.apply(t,arguments),t}function zO(){return md.apply(null,arguments).exponent(.5)}function Cp(t){return Math.sign(t)*t*t}function KO(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Cy(){var t=ld(),e=[0,1],r=!1,n;function a(i){var s=KO(t(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return t.invert(Cp(i))},a.domain=function(i){return arguments.length?(t.domain(i),a):t.domain()},a.range=function(i){return arguments.length?(t.range((e=Array.from(i,os)).map(Cp)),a):e.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(t.clamp(i),a):t.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Cy(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},St.apply(a,arguments),Tr(a)}function Iy(){var t=[],e=[],r=[],n;function a(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=YM(t,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:e[Ha(r,s)]}return i.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},i.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(Nr),a()},i.range=function(s){return arguments.length?(e=Array.from(s),a()):e.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return Iy().domain(t).range(e).unknown(n)},St.apply(i,arguments)}function Dy(){var t=0,e=1,r=1,n=[.5],a=[0,1],i;function s(l){return l!=null&&l<=l?a[Ha(n,l,0,r)]:i}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*e-(l-r)*t)/(r+1);return s}return s.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,o()):[t,e]},s.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,o()):a.slice()},s.invertExtent=function(l){var d=a.indexOf(l);return d<0?[NaN,NaN]:d<1?[t,n[0]]:d>=r?[n[r-1],e]:[n[d-1],n[d]]},s.unknown=function(l){return arguments.length&&(i=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return Dy().domain([t,e]).range(a).unknown(i)},St.apply(Tr(s),arguments)}function $y(){var t=[.5],e=[0,1],r,n=1;function a(i){return i!=null&&i<=i?e[Ha(t,i,0,n)]:r}return a.domain=function(i){return arguments.length?(t=Array.from(i),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(i){return arguments.length?(e=Array.from(i),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(i){var s=e.indexOf(i);return[t[s-1],t[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return $y().domain(t).range(e).unknown(r)},St.apply(a,arguments)}const zl=new Date,Kl=new Date;function Ie(t,e,r,n){function a(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(t(i=new Date(+i)),i),a.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(e(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const l=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return l;let d;do l.push(d=new Date(+i)),e(i,o),t(i);while(d<i&&i<s);return l},a.filter=i=>Ie(s=>{if(s>=s)for(;t(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!i(s););else for(;--o>=0;)for(;e(s,1),!i(s););}),r&&(a.count=(i,s)=>(zl.setTime(+i),Kl.setTime(+s),t(zl),t(Kl),Math.floor(r(zl,Kl))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const cs=Ie(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);cs.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Ie(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):cs);cs.range;const Vt=1e3,xt=Vt*60,Gt=xt*60,Zt=Gt*24,pd=Zt*7,Ip=Zt*30,Hl=Zt*365,Gr=Ie(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Vt)},(t,e)=>(e-t)/Vt,t=>t.getUTCSeconds());Gr.range;const gd=Ie(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Vt)},(t,e)=>{t.setTime(+t+e*xt)},(t,e)=>(e-t)/xt,t=>t.getMinutes());gd.range;const vd=Ie(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*xt)},(t,e)=>(e-t)/xt,t=>t.getUTCMinutes());vd.range;const yd=Ie(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Vt-t.getMinutes()*xt)},(t,e)=>{t.setTime(+t+e*Gt)},(t,e)=>(e-t)/Gt,t=>t.getHours());yd.range;const bd=Ie(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Gt)},(t,e)=>(e-t)/Gt,t=>t.getUTCHours());bd.range;const Ya=Ie(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*xt)/Zt,t=>t.getDate()-1);Ya.range;const Js=Ie(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Zt,t=>t.getUTCDate()-1);Js.range;const Ry=Ie(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Zt,t=>Math.floor(t/Zt));Ry.range;function cn(t){return Ie(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*xt)/pd)}const Xs=cn(0),us=cn(1),HO=cn(2),VO=cn(3),Un=cn(4),GO=cn(5),YO=cn(6);Xs.range;us.range;HO.range;VO.range;Un.range;GO.range;YO.range;function un(t){return Ie(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/pd)}const Zs=un(0),ds=un(1),JO=un(2),XO=un(3),Fn=un(4),ZO=un(5),QO=un(6);Zs.range;ds.range;JO.range;XO.range;Fn.range;ZO.range;QO.range;const xd=Ie(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());xd.range;const wd=Ie(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());wd.range;const Qt=Ie(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Qt.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Ie(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});Qt.range;const er=Ie(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());er.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Ie(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});er.range;function Ly(t,e,r,n,a,i){const s=[[Gr,1,Vt],[Gr,5,5*Vt],[Gr,15,15*Vt],[Gr,30,30*Vt],[i,1,xt],[i,5,5*xt],[i,15,15*xt],[i,30,30*xt],[a,1,Gt],[a,3,3*Gt],[a,6,6*Gt],[a,12,12*Gt],[n,1,Zt],[n,2,2*Zt],[r,1,pd],[e,1,Ip],[e,3,3*Ip],[t,1,Hl]];function o(d,c,h){const f=c<d;f&&([d,c]=[c,d]);const m=h&&typeof h.range=="function"?h:l(d,c,h),p=m?m.range(d,+c+1):[];return f?p.reverse():p}function l(d,c,h){const f=Math.abs(c-d)/h,m=rd(([,,y])=>y).right(s,f);if(m===s.length)return t.every(Qc(d/Hl,c/Hl,h));if(m===0)return cs.every(Math.max(Qc(d,c,h),1));const[p,g]=s[f/s[m-1][2]<s[m][2]/f?m-1:m];return p.every(g)}return[o,l]}const[eA,tA]=Ly(er,wd,Zs,Ry,bd,vd),[rA,nA]=Ly(Qt,xd,Xs,Ya,yd,gd);function Vl(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Gl(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function da(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function aA(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,i=t.days,s=t.shortDays,o=t.months,l=t.shortMonths,d=ha(a),c=fa(a),h=ha(i),f=fa(i),m=ha(s),p=fa(s),g=ha(o),y=fa(o),b=ha(l),x=fa(l),w={a:K,A:X,b:B,B:R,c:null,d:Up,e:Up,f:kA,g:RA,G:BA,H:SA,I:NA,j:PA,L:By,m:MA,M:OA,p:Y,q:$,Q:qp,s:zp,S:AA,u:EA,U:TA,V:CA,w:IA,W:DA,x:null,X:null,y:$A,Y:LA,Z:UA,"%":Wp},_={a:We,A:ur,b:te,B:Bt,c:null,d:Fp,e:Fp,f:zA,g:eE,G:rE,H:FA,I:WA,j:qA,L:Fy,m:KA,M:HA,p:Dr,q:aa,Q:qp,s:zp,S:VA,u:GA,U:YA,V:JA,w:XA,W:ZA,x:null,X:null,y:QA,Y:tE,Z:nE,"%":Wp},S={a:T,A:P,b:k,B:D,c:I,d:Lp,e:Lp,f:xA,g:Rp,G:$p,H:Bp,I:Bp,j:gA,L:bA,m:pA,M:vA,p:O,q:mA,Q:_A,s:jA,S:yA,u:cA,U:uA,V:dA,w:lA,W:hA,x:z,X:H,y:Rp,Y:$p,Z:fA,"%":wA};w.x=j(r,w),w.X=j(n,w),w.c=j(e,w),_.x=j(r,_),_.X=j(n,_),_.c=j(e,_);function j(L,V){return function(Z){var C=[],$e=-1,ce=0,Xe=L.length,Ze,Ut,dr;for(Z instanceof Date||(Z=new Date(+Z));++$e<Xe;)L.charCodeAt($e)===37&&(C.push(L.slice(ce,$e)),(Ut=Dp[Ze=L.charAt(++$e)])!=null?Ze=L.charAt(++$e):Ut=Ze==="e"?" ":"0",(dr=V[Ze])&&(Ze=dr(Z,Ut)),C.push(Ze),ce=$e+1);return C.push(L.slice(ce,$e)),C.join("")}}function N(L,V){return function(Z){var C=da(1900,void 0,1),$e=M(C,L,Z+="",0),ce,Xe;if($e!=Z.length)return null;if("Q"in C)return new Date(C.Q);if("s"in C)return new Date(C.s*1e3+("L"in C?C.L:0));if(V&&!("Z"in C)&&(C.Z=0),"p"in C&&(C.H=C.H%12+C.p*12),C.m===void 0&&(C.m="q"in C?C.q:0),"V"in C){if(C.V<1||C.V>53)return null;"w"in C||(C.w=1),"Z"in C?(ce=Gl(da(C.y,0,1)),Xe=ce.getUTCDay(),ce=Xe>4||Xe===0?ds.ceil(ce):ds(ce),ce=Js.offset(ce,(C.V-1)*7),C.y=ce.getUTCFullYear(),C.m=ce.getUTCMonth(),C.d=ce.getUTCDate()+(C.w+6)%7):(ce=Vl(da(C.y,0,1)),Xe=ce.getDay(),ce=Xe>4||Xe===0?us.ceil(ce):us(ce),ce=Ya.offset(ce,(C.V-1)*7),C.y=ce.getFullYear(),C.m=ce.getMonth(),C.d=ce.getDate()+(C.w+6)%7)}else("W"in C||"U"in C)&&("w"in C||(C.w="u"in C?C.u%7:"W"in C?1:0),Xe="Z"in C?Gl(da(C.y,0,1)).getUTCDay():Vl(da(C.y,0,1)).getDay(),C.m=0,C.d="W"in C?(C.w+6)%7+C.W*7-(Xe+5)%7:C.w+C.U*7-(Xe+6)%7);return"Z"in C?(C.H+=C.Z/100|0,C.M+=C.Z%100,Gl(C)):Vl(C)}}function M(L,V,Z,C){for(var $e=0,ce=V.length,Xe=Z.length,Ze,Ut;$e<ce;){if(C>=Xe)return-1;if(Ze=V.charCodeAt($e++),Ze===37){if(Ze=V.charAt($e++),Ut=S[Ze in Dp?V.charAt($e++):Ze],!Ut||(C=Ut(L,Z,C))<0)return-1}else if(Ze!=Z.charCodeAt(C++))return-1}return C}function O(L,V,Z){var C=d.exec(V.slice(Z));return C?(L.p=c.get(C[0].toLowerCase()),Z+C[0].length):-1}function T(L,V,Z){var C=m.exec(V.slice(Z));return C?(L.w=p.get(C[0].toLowerCase()),Z+C[0].length):-1}function P(L,V,Z){var C=h.exec(V.slice(Z));return C?(L.w=f.get(C[0].toLowerCase()),Z+C[0].length):-1}function k(L,V,Z){var C=b.exec(V.slice(Z));return C?(L.m=x.get(C[0].toLowerCase()),Z+C[0].length):-1}function D(L,V,Z){var C=g.exec(V.slice(Z));return C?(L.m=y.get(C[0].toLowerCase()),Z+C[0].length):-1}function I(L,V,Z){return M(L,e,V,Z)}function z(L,V,Z){return M(L,r,V,Z)}function H(L,V,Z){return M(L,n,V,Z)}function K(L){return s[L.getDay()]}function X(L){return i[L.getDay()]}function B(L){return l[L.getMonth()]}function R(L){return o[L.getMonth()]}function Y(L){return a[+(L.getHours()>=12)]}function $(L){return 1+~~(L.getMonth()/3)}function We(L){return s[L.getUTCDay()]}function ur(L){return i[L.getUTCDay()]}function te(L){return l[L.getUTCMonth()]}function Bt(L){return o[L.getUTCMonth()]}function Dr(L){return a[+(L.getUTCHours()>=12)]}function aa(L){return 1+~~(L.getUTCMonth()/3)}return{format:function(L){var V=j(L+="",w);return V.toString=function(){return L},V},parse:function(L){var V=N(L+="",!1);return V.toString=function(){return L},V},utcFormat:function(L){var V=j(L+="",_);return V.toString=function(){return L},V},utcParse:function(L){var V=N(L+="",!0);return V.toString=function(){return L},V}}}var Dp={"-":"",_:" ",0:"0"},Ue=/^\s*\d+/,iA=/^%/,sA=/[\\^$*+?|[\]().{}]/g;function ne(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(e)+a:a)}function oA(t){return t.replace(sA,"\\$&")}function ha(t){return new RegExp("^(?:"+t.map(oA).join("|")+")","i")}function fa(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function lA(t,e,r){var n=Ue.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function cA(t,e,r){var n=Ue.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function uA(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function dA(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function hA(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function $p(t,e,r){var n=Ue.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Rp(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function fA(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function mA(t,e,r){var n=Ue.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function pA(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Lp(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function gA(t,e,r){var n=Ue.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Bp(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function vA(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function yA(t,e,r){var n=Ue.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function bA(t,e,r){var n=Ue.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function xA(t,e,r){var n=Ue.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function wA(t,e,r){var n=iA.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function _A(t,e,r){var n=Ue.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function jA(t,e,r){var n=Ue.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Up(t,e){return ne(t.getDate(),e,2)}function SA(t,e){return ne(t.getHours(),e,2)}function NA(t,e){return ne(t.getHours()%12||12,e,2)}function PA(t,e){return ne(1+Ya.count(Qt(t),t),e,3)}function By(t,e){return ne(t.getMilliseconds(),e,3)}function kA(t,e){return By(t,e)+"000"}function MA(t,e){return ne(t.getMonth()+1,e,2)}function OA(t,e){return ne(t.getMinutes(),e,2)}function AA(t,e){return ne(t.getSeconds(),e,2)}function EA(t){var e=t.getDay();return e===0?7:e}function TA(t,e){return ne(Xs.count(Qt(t)-1,t),e,2)}function Uy(t){var e=t.getDay();return e>=4||e===0?Un(t):Un.ceil(t)}function CA(t,e){return t=Uy(t),ne(Un.count(Qt(t),t)+(Qt(t).getDay()===4),e,2)}function IA(t){return t.getDay()}function DA(t,e){return ne(us.count(Qt(t)-1,t),e,2)}function $A(t,e){return ne(t.getFullYear()%100,e,2)}function RA(t,e){return t=Uy(t),ne(t.getFullYear()%100,e,2)}function LA(t,e){return ne(t.getFullYear()%1e4,e,4)}function BA(t,e){var r=t.getDay();return t=r>=4||r===0?Un(t):Un.ceil(t),ne(t.getFullYear()%1e4,e,4)}function UA(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ne(e/60|0,"0",2)+ne(e%60,"0",2)}function Fp(t,e){return ne(t.getUTCDate(),e,2)}function FA(t,e){return ne(t.getUTCHours(),e,2)}function WA(t,e){return ne(t.getUTCHours()%12||12,e,2)}function qA(t,e){return ne(1+Js.count(er(t),t),e,3)}function Fy(t,e){return ne(t.getUTCMilliseconds(),e,3)}function zA(t,e){return Fy(t,e)+"000"}function KA(t,e){return ne(t.getUTCMonth()+1,e,2)}function HA(t,e){return ne(t.getUTCMinutes(),e,2)}function VA(t,e){return ne(t.getUTCSeconds(),e,2)}function GA(t){var e=t.getUTCDay();return e===0?7:e}function YA(t,e){return ne(Zs.count(er(t)-1,t),e,2)}function Wy(t){var e=t.getUTCDay();return e>=4||e===0?Fn(t):Fn.ceil(t)}function JA(t,e){return t=Wy(t),ne(Fn.count(er(t),t)+(er(t).getUTCDay()===4),e,2)}function XA(t){return t.getUTCDay()}function ZA(t,e){return ne(ds.count(er(t)-1,t),e,2)}function QA(t,e){return ne(t.getUTCFullYear()%100,e,2)}function eE(t,e){return t=Wy(t),ne(t.getUTCFullYear()%100,e,2)}function tE(t,e){return ne(t.getUTCFullYear()%1e4,e,4)}function rE(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Fn(t):Fn.ceil(t),ne(t.getUTCFullYear()%1e4,e,4)}function nE(){return"+0000"}function Wp(){return"%"}function qp(t){return+t}function zp(t){return Math.floor(+t/1e3)}var jn,qy,zy;aE({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function aE(t){return jn=aA(t),qy=jn.format,jn.parse,zy=jn.utcFormat,jn.utcParse,jn}function iE(t){return new Date(t)}function sE(t){return t instanceof Date?+t:+new Date(+t)}function _d(t,e,r,n,a,i,s,o,l,d){var c=ld(),h=c.invert,f=c.domain,m=d(".%L"),p=d(":%S"),g=d("%I:%M"),y=d("%I %p"),b=d("%a %d"),x=d("%b %d"),w=d("%B"),_=d("%Y");function S(j){return(l(j)<j?m:o(j)<j?p:s(j)<j?g:i(j)<j?y:n(j)<j?a(j)<j?b:x:r(j)<j?w:_)(j)}return c.invert=function(j){return new Date(h(j))},c.domain=function(j){return arguments.length?f(Array.from(j,sE)):f().map(iE)},c.ticks=function(j){var N=f();return t(N[0],N[N.length-1],j??10)},c.tickFormat=function(j,N){return N==null?S:d(N)},c.nice=function(j){var N=f();return(!j||typeof j.range!="function")&&(j=e(N[0],N[N.length-1],j??10)),j?f(Ay(N,j)):c},c.copy=function(){return Ga(c,_d(t,e,r,n,a,i,s,o,l,d))},c}function oE(){return St.apply(_d(rA,nA,Qt,xd,Xs,Ya,yd,gd,Gr,qy).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lE(){return St.apply(_d(eA,tA,er,wd,Zs,Js,bd,vd,Gr,zy).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Qs(){var t=0,e=1,r,n,a,i,s=tt,o=!1,l;function d(h){return h==null||isNaN(h=+h)?l:s(a===0?.5:(h=(i(h)-r)*a,o?Math.max(0,Math.min(1,h)):h))}d.domain=function(h){return arguments.length?([t,e]=h,r=i(t=+t),n=i(e=+e),a=r===n?0:1/(n-r),d):[t,e]},d.clamp=function(h){return arguments.length?(o=!!h,d):o},d.interpolator=function(h){return arguments.length?(s=h,d):s};function c(h){return function(f){var m,p;return arguments.length?([m,p]=f,s=h(m,p),d):[s(0),s(1)]}}return d.range=c(Yn),d.rangeRound=c(od),d.unknown=function(h){return arguments.length?(l=h,d):l},function(h){return i=h,r=h(t),n=h(e),a=r===n?0:1/(n-r),d}}function Cr(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Ky(){var t=Tr(Qs()(tt));return t.copy=function(){return Cr(t,Ky())},sr.apply(t,arguments)}function Hy(){var t=dd(Qs()).domain([1,10]);return t.copy=function(){return Cr(t,Hy()).base(t.base())},sr.apply(t,arguments)}function Vy(){var t=hd(Qs());return t.copy=function(){return Cr(t,Vy()).constant(t.constant())},sr.apply(t,arguments)}function jd(){var t=fd(Qs());return t.copy=function(){return Cr(t,jd()).exponent(t.exponent())},sr.apply(t,arguments)}function cE(){return jd.apply(null,arguments).exponent(.5)}function Gy(){var t=[],e=tt;function r(n){if(n!=null&&!isNaN(n=+n))return e((Ha(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(Nr),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>GM(t,i/n))},r.copy=function(){return Gy(e).domain(t)},sr.apply(r,arguments)}function eo(){var t=0,e=.5,r=1,n=1,a,i,s,o,l,d=tt,c,h=!1,f;function m(g){return isNaN(g=+g)?f:(g=.5+((g=+c(g))-i)*(n*g<n*i?o:l),d(h?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([t,e,r]=g,a=c(t=+t),i=c(e=+e),s=c(r=+r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,m):[t,e,r]},m.clamp=function(g){return arguments.length?(h=!!g,m):h},m.interpolator=function(g){return arguments.length?(d=g,m):d};function p(g){return function(y){var b,x,w;return arguments.length?([b,x,w]=y,d=wO(g,[b,x,w]),m):[d(0),d(.5),d(1)]}}return m.range=p(Yn),m.rangeRound=p(od),m.unknown=function(g){return arguments.length?(f=g,m):f},function(g){return c=g,a=g(t),i=g(e),s=g(r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,m}}function Yy(){var t=Tr(eo()(tt));return t.copy=function(){return Cr(t,Yy())},sr.apply(t,arguments)}function Jy(){var t=dd(eo()).domain([.1,1,10]);return t.copy=function(){return Cr(t,Jy()).base(t.base())},sr.apply(t,arguments)}function Xy(){var t=hd(eo());return t.copy=function(){return Cr(t,Xy()).constant(t.constant())},sr.apply(t,arguments)}function Sd(){var t=fd(eo());return t.copy=function(){return Cr(t,Sd()).exponent(t.exponent())},sr.apply(t,arguments)}function uE(){return Sd.apply(null,arguments).exponent(.5)}const va=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:ad,scaleDiverging:Yy,scaleDivergingLog:Jy,scaleDivergingPow:Sd,scaleDivergingSqrt:uE,scaleDivergingSymlog:Xy,scaleIdentity:Oy,scaleImplicit:eu,scaleLinear:My,scaleLog:Ey,scaleOrdinal:nd,scalePoint:XM,scalePow:md,scaleQuantile:Iy,scaleQuantize:Dy,scaleRadial:Cy,scaleSequential:Ky,scaleSequentialLog:Hy,scaleSequentialPow:jd,scaleSequentialQuantile:Gy,scaleSequentialSqrt:cE,scaleSequentialSymlog:Vy,scaleSqrt:zO,scaleSymlog:Ty,scaleThreshold:$y,scaleTime:oE,scaleUtc:lE,tickFormat:ky},Symbol.toStringTag,{value:"Module"}));var Ir=t=>t.chartData,Nd=A([Ir],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),Ja=(t,e,r,n)=>n?Nd(t):Ir(t);function Wn(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(ht(e)&&ht(r))return!0}return!1}function Kp(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function dE(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,i;if(ht(r))a=r;else if(typeof r=="function")return;if(ht(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(Wn(s))return s}}function hE(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Wn(n))return Kp(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,i]=t,s,o;if(a==="auto")e!=null&&(s=Math.min(...e));else if(q(a))s=a;else if(typeof a=="function")try{e!=null&&(s=a(e?.[0]))}catch{}else if(typeof a=="string"&&Dm.test(a)){var l=Dm.exec(a);if(l==null||e==null)s=void 0;else{var d=+l[1];s=e[0]-d}}else s=e?.[0];if(i==="auto")e!=null&&(o=Math.max(...e));else if(q(i))o=i;else if(typeof i=="function")try{e!=null&&(o=i(e?.[1]))}catch{}else if(typeof i=="string"&&$m.test(i)){var c=$m.exec(i);if(c==null||e==null)o=void 0;else{var h=+c[1];o=e[1]+h}}else o=e?.[1];var f=[s,o];if(Wn(f))return e==null?f:Kp(f,e,r)}}}var Jn=1e9,fE={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},kd,ve=!0,_t="[DecimalError] ",Qr=_t+"Invalid argument: ",Pd=_t+"Exponent out of range: ",Xn=Math.floor,qr=Math.pow,mE=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,lt,Le=1e7,pe=7,Zy=9007199254740991,hs=Xn(Zy/pe),U={};U.absoluteValue=U.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};U.comparedTo=U.cmp=function(t){var e,r,n,a,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(n=i.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(i.d[e]!==t.d[e])return i.d[e]>t.d[e]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};U.decimalPlaces=U.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*pe;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};U.dividedBy=U.div=function(t){return Jt(this,new this.constructor(t))};U.dividedToIntegerBy=U.idiv=function(t){var e=this,r=e.constructor;return he(Jt(e,new r(t),0,1),r.precision)};U.equals=U.eq=function(t){return!this.cmp(t)};U.exponent=function(){return Me(this)};U.greaterThan=U.gt=function(t){return this.cmp(t)>0};U.greaterThanOrEqualTo=U.gte=function(t){return this.cmp(t)>=0};U.isInteger=U.isint=function(){return this.e>this.d.length-2};U.isNegative=U.isneg=function(){return this.s<0};U.isPositive=U.ispos=function(){return this.s>0};U.isZero=function(){return this.s===0};U.lessThan=U.lt=function(t){return this.cmp(t)<0};U.lessThanOrEqualTo=U.lte=function(t){return this.cmp(t)<1};U.logarithm=U.log=function(t){var e,r=this,n=r.constructor,a=n.precision,i=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(lt))throw Error(_t+"NaN");if(r.s<1)throw Error(_t+(r.s?"NaN":"-Infinity"));return r.eq(lt)?new n(0):(ve=!1,e=Jt(Ba(r,i),Ba(t,i),i),ve=!0,he(e,a))};U.minus=U.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?tb(e,t):Qy(e,(t.s=-t.s,t))};U.modulo=U.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(_t+"NaN");return r.s?(ve=!1,e=Jt(r,t,0,1).times(t),ve=!0,r.minus(e)):he(new n(r),a)};U.naturalExponential=U.exp=function(){return eb(this)};U.naturalLogarithm=U.ln=function(){return Ba(this)};U.negated=U.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};U.plus=U.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Qy(e,t):tb(e,(t.s=-t.s,t))};U.precision=U.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Qr+t);if(e=Me(a)+1,n=a.d.length-1,r=n*pe+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};U.squareRoot=U.sqrt=function(){var t,e,r,n,a,i,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(_t+"NaN")}for(t=Me(o),ve=!1,a=Math.sqrt(+o),a==0||a==1/0?(e=Ct(o.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=Xn((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new l(e)):n=new l(a.toString()),r=l.precision,a=s=r+3;;)if(i=n,n=i.plus(Jt(o,i,s+2)).times(.5),Ct(i.d).slice(0,s)===(e=Ct(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),a==s&&e=="4999"){if(he(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(e!="9999")break;s+=4}return ve=!0,he(n,r)};U.times=U.mul=function(t){var e,r,n,a,i,s,o,l,d,c=this,h=c.constructor,f=c.d,m=(t=new h(t)).d;if(!c.s||!t.s)return new h(0);for(t.s*=c.s,r=c.e+t.e,l=f.length,d=m.length,l<d&&(i=f,f=m,m=i,s=l,l=d,d=s),i=[],s=l+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(e=0,a=l+n;a>n;)o=i[a]+m[n]*f[a-n-1]+e,i[a--]=o%Le|0,e=o/Le|0;i[a]=(i[a]+e)%Le|0}for(;!i[--s];)i.pop();return e?++r:i.shift(),t.d=i,t.e=r,ve?he(t,h.precision):t};U.toDecimalPlaces=U.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:($t(t,0,Jn),e===void 0?e=n.rounding:$t(e,0,8),he(r,t+Me(r)+1,e))};U.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=nn(n,!0):($t(t,0,Jn),e===void 0?e=a.rounding:$t(e,0,8),n=he(new a(n),t+1,e),r=nn(n,!0,t+1)),r};U.toFixed=function(t,e){var r,n,a=this,i=a.constructor;return t===void 0?nn(a):($t(t,0,Jn),e===void 0?e=i.rounding:$t(e,0,8),n=he(new i(a),t+Me(a)+1,e),r=nn(n.abs(),!1,t+Me(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};U.toInteger=U.toint=function(){var t=this,e=t.constructor;return he(new e(t),Me(t)+1,e.rounding)};U.toNumber=function(){return+this};U.toPower=U.pow=function(t){var e,r,n,a,i,s,o=this,l=o.constructor,d=12,c=+(t=new l(t));if(!t.s)return new l(lt);if(o=new l(o),!o.s){if(t.s<1)throw Error(_t+"Infinity");return o}if(o.eq(lt))return o;if(n=l.precision,t.eq(lt))return he(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,i=o.s,s){if((r=c<0?-c:c)<=Zy){for(a=new l(lt),e=Math.ceil(n/pe+4),ve=!1;r%2&&(a=a.times(o),Vp(a.d,e)),r=Xn(r/2),r!==0;)o=o.times(o),Vp(o.d,e);return ve=!0,t.s<0?new l(lt).div(a):he(a,n)}}else if(i<0)throw Error(_t+"NaN");return i=i<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,ve=!1,a=t.times(Ba(o,n+d)),ve=!0,a=eb(a),a.s=i,a};U.toPrecision=function(t,e){var r,n,a=this,i=a.constructor;return t===void 0?(r=Me(a),n=nn(a,r<=i.toExpNeg||r>=i.toExpPos)):($t(t,1,Jn),e===void 0?e=i.rounding:$t(e,0,8),a=he(new i(a),t,e),r=Me(a),n=nn(a,t<=r||r<=i.toExpNeg,t)),n};U.toSignificantDigits=U.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):($t(t,1,Jn),e===void 0?e=n.rounding:$t(e,0,8)),he(new n(r),t,e)};U.toString=U.valueOf=U.val=U.toJSON=U[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Me(t),r=t.constructor;return nn(t,e<=r.toExpNeg||e>=r.toExpPos)};function Qy(t,e){var r,n,a,i,s,o,l,d,c=t.constructor,h=c.precision;if(!t.s||!e.s)return e.s||(e=new c(t)),ve?he(e,h):e;if(l=t.d,d=e.d,s=t.e,a=e.e,l=l.slice(),i=s-a,i){for(i<0?(n=l,i=-i,o=d.length):(n=d,a=s,o=l.length),s=Math.ceil(h/pe),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=l.length,i=d.length,o-i<0&&(i=o,n=d,d=l,l=n),r=0;i;)r=(l[--i]=l[i]+d[i]+r)/Le|0,l[i]%=Le;for(r&&(l.unshift(r),++a),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=a,ve?he(e,h):e}function $t(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Qr+t)}function Ct(t){var e,r,n,a=t.length-1,i="",s=t[0];if(a>0){for(i+=s,e=1;e<a;e++)n=t[e]+"",r=pe-n.length,r&&(i+=mr(r)),i+=n;s=t[e],n=s+"",r=pe-n.length,r&&(i+=mr(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Jt=(function(){function t(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%Le|0,s=i/Le|0;return s&&n.unshift(s),n}function e(n,a,i,s){var o,l;if(i!=s)l=i>s?1:-1;else for(o=l=0;o<i;o++)if(n[o]!=a[o]){l=n[o]>a[o]?1:-1;break}return l}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Le+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,l,d,c,h,f,m,p,g,y,b,x,w,_,S,j,N,M,O=n.constructor,T=n.s==a.s?1:-1,P=n.d,k=a.d;if(!n.s)return new O(n);if(!a.s)throw Error(_t+"Division by zero");for(l=n.e-a.e,N=k.length,S=P.length,m=new O(T),p=m.d=[],d=0;k[d]==(P[d]||0);)++d;if(k[d]>(P[d]||0)&&--l,i==null?x=i=O.precision:s?x=i+(Me(n)-Me(a))+1:x=i,x<0)return new O(0);if(x=x/pe+2|0,d=0,N==1)for(c=0,k=k[0],x++;(d<S||c)&&x--;d++)w=c*Le+(P[d]||0),p[d]=w/k|0,c=w%k|0;else{for(c=Le/(k[0]+1)|0,c>1&&(k=t(k,c),P=t(P,c),N=k.length,S=P.length),_=N,g=P.slice(0,N),y=g.length;y<N;)g[y++]=0;M=k.slice(),M.unshift(0),j=k[0],k[1]>=Le/2&&++j;do c=0,o=e(k,g,N,y),o<0?(b=g[0],N!=y&&(b=b*Le+(g[1]||0)),c=b/j|0,c>1?(c>=Le&&(c=Le-1),h=t(k,c),f=h.length,y=g.length,o=e(h,g,f,y),o==1&&(c--,r(h,N<f?M:k,f))):(c==0&&(o=c=1),h=k.slice()),f=h.length,f<y&&h.unshift(0),r(g,h,y),o==-1&&(y=g.length,o=e(k,g,N,y),o<1&&(c++,r(g,N<y?M:k,y))),y=g.length):o===0&&(c++,g=[0]),p[d++]=c,o&&g[0]?g[y++]=P[_]||0:(g=[P[_]],y=1);while((_++<S||g[0]!==void 0)&&x--)}return p[0]||p.shift(),m.e=l,he(m,s?i+Me(m)+1:i)}})();function eb(t,e){var r,n,a,i,s,o,l=0,d=0,c=t.constructor,h=c.precision;if(Me(t)>16)throw Error(Pd+Me(t));if(!t.s)return new c(lt);for(ve=!1,o=h,s=new c(.03125);t.abs().gte(.1);)t=t.times(s),d+=5;for(n=Math.log(qr(2,d))/Math.LN10*2+5|0,o+=n,r=a=i=new c(lt),c.precision=o;;){if(a=he(a.times(t),o),r=r.times(++l),s=i.plus(Jt(a,r,o)),Ct(s.d).slice(0,o)===Ct(i.d).slice(0,o)){for(;d--;)i=he(i.times(i),o);return c.precision=h,e==null?(ve=!0,he(i,h)):i}i=s}}function Me(t){for(var e=t.e*pe,r=t.d[0];r>=10;r/=10)e++;return e}function Yl(t,e,r){if(e>t.LN10.sd())throw ve=!0,r&&(t.precision=r),Error(_t+"LN10 precision limit exceeded");return he(new t(t.LN10),e)}function mr(t){for(var e="";t--;)e+="0";return e}function Ba(t,e){var r,n,a,i,s,o,l,d,c,h=1,f=10,m=t,p=m.d,g=m.constructor,y=g.precision;if(m.s<1)throw Error(_t+(m.s?"NaN":"-Infinity"));if(m.eq(lt))return new g(0);if(e==null?(ve=!1,d=y):d=e,m.eq(10))return e==null&&(ve=!0),Yl(g,d);if(d+=f,g.precision=d,r=Ct(p),n=r.charAt(0),i=Me(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(t),r=Ct(m.d),n=r.charAt(0),h++;i=Me(m),n>1?(m=new g("0."+r),i++):m=new g(n+"."+r.slice(1))}else return l=Yl(g,d+2,y).times(i+""),m=Ba(new g(n+"."+r.slice(1)),d-f).plus(l),g.precision=y,e==null?(ve=!0,he(m,y)):m;for(o=s=m=Jt(m.minus(lt),m.plus(lt),d),c=he(m.times(m),d),a=3;;){if(s=he(s.times(c),d),l=o.plus(Jt(s,new g(a),d)),Ct(l.d).slice(0,d)===Ct(o.d).slice(0,d))return o=o.times(2),i!==0&&(o=o.plus(Yl(g,d+2,y).times(i+""))),o=Jt(o,new g(h),d),g.precision=y,e==null?(ve=!0,he(o,y)):o;o=l,a+=2}}function Hp(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=Xn(r/pe),t.d=[],n=(r+1)%pe,r<0&&(n+=pe),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=pe;n<a;)t.d.push(+e.slice(n,n+=pe));e=e.slice(n),n=pe-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),ve&&(t.e>hs||t.e<-hs))throw Error(Pd+r)}else t.s=0,t.e=0,t.d=[0];return t}function he(t,e,r){var n,a,i,s,o,l,d,c,h=t.d;for(s=1,i=h[0];i>=10;i/=10)s++;if(n=e-s,n<0)n+=pe,a=e,d=h[c=0];else{if(c=Math.ceil((n+1)/pe),i=h.length,c>=i)return t;for(d=i=h[c],s=1;i>=10;i/=10)s++;n%=pe,a=n-pe+s}if(r!==void 0&&(i=qr(10,s-a-1),o=d/i%10|0,l=e<0||h[c+1]!==void 0||d%i,l=r<4?(o||l)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?a>0?d/qr(10,s-a):0:h[c-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return l?(i=Me(t),h.length=1,e=e-i-1,h[0]=qr(10,(pe-e%pe)%pe),t.e=Xn(-e/pe)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=c,i=1,c--):(h.length=c+1,i=qr(10,pe-n),h[c]=a>0?(d/qr(10,s-a)%qr(10,a)|0)*i:0),l)for(;;)if(c==0){(h[0]+=i)==Le&&(h[0]=1,++t.e);break}else{if(h[c]+=i,h[c]!=Le)break;h[c--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(ve&&(t.e>hs||t.e<-hs))throw Error(Pd+Me(t));return t}function tb(t,e){var r,n,a,i,s,o,l,d,c,h,f=t.constructor,m=f.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new f(t),ve?he(e,m):e;if(l=t.d,h=e.d,n=e.e,d=t.e,l=l.slice(),s=d-n,s){for(c=s<0,c?(r=l,s=-s,o=h.length):(r=h,n=d,o=l.length),a=Math.max(Math.ceil(m/pe),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=l.length,o=h.length,c=a<o,c&&(o=a),a=0;a<o;a++)if(l[a]!=h[a]){c=l[a]<h[a];break}s=0}for(c&&(r=l,l=h,h=r,e.s=-e.s),o=l.length,a=h.length-o;a>0;--a)l[o++]=0;for(a=h.length;a>s;){if(l[--a]<h[a]){for(i=a;i&&l[--i]===0;)l[i]=Le-1;--l[i],l[a]+=Le}l[a]-=h[a]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(e.d=l,e.e=n,ve?he(e,m):e):new f(0)}function nn(t,e,r){var n,a=Me(t),i=Ct(t.d),s=i.length;return e?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+mr(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+mr(-a-1)+i,r&&(n=r-s)>0&&(i+=mr(n))):a>=s?(i+=mr(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+mr(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=mr(n))),t.s<0?"-"+i:i}function Vp(t,e){if(t.length>e)return t.length=e,!0}function rb(t){var e,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Qr+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return Hp(s,i.toString())}else if(typeof i!="string")throw Error(Qr+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,mE.test(i))Hp(s,i);else throw Error(Qr+i)}if(a.prototype=U,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=rb,a.config=a.set=pE,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function pE(t){if(!t||typeof t!="object")throw Error(_t+"Object expected");var e,r,n,a=["precision",1,Jn,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(Xn(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(Qr+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Qr+r+": "+n);return this}var kd=rb(fE);lt=new kd(1);const oe=kd;var gE=t=>t,nb={},ab=t=>t===nb,Gp=t=>function e(){return arguments.length===0||arguments.length===1&&ab(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},ib=(t,e)=>t===1?e:Gp(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==nb).length;return i>=t?e(...n):ib(t-i,Gp(function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];var d=n.map(c=>ab(c)?o.shift():c);return e(...d,...o)}))}),to=t=>ib(t.length,t),au=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},vE=to((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),yE=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return gE;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((o,l)=>l(o),i(...arguments))}},iu=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),sb=t=>{var e=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e&&a.every((s,o)=>{var l;return s===((l=e)===null||l===void 0?void 0:l[o])})||(e=a,r=t(...a)),r}};function ob(t){var e;return t===0?e=1:e=Math.floor(new oe(t).abs().log(10).toNumber())+1,e}function lb(t,e,r){for(var n=new oe(t),a=0,i=[];n.lt(e)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}to((t,e,r)=>{var n=+t,a=+e;return n+r*(a-n)});to((t,e,r)=>{var n=e-+t;return n=n||1/0,(r-t)/n});to((t,e,r)=>{var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});var cb=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},ub=(t,e,r)=>{if(t.lte(0))return new oe(0);var n=ob(t.toNumber()),a=new oe(10).pow(n),i=t.div(a),s=n!==1?.05:.1,o=new oe(Math.ceil(i.div(s).toNumber())).add(r).mul(s),l=o.mul(a);return e?new oe(l.toNumber()):new oe(Math.ceil(l.toNumber()))},bE=(t,e,r)=>{var n=new oe(1),a=new oe(t);if(!a.isint()&&r){var i=Math.abs(t);i<1?(n=new oe(10).pow(ob(t)-1),a=new oe(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new oe(Math.floor(t)))}else t===0?a=new oe(Math.floor((e-1)/2)):r||(a=new oe(Math.floor(t)));var s=Math.floor((e-1)/2),o=yE(vE(l=>a.add(new oe(l-s).mul(n)).toNumber()),au);return o(0,e)},db=function(e,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new oe(0),tickMin:new oe(0),tickMax:new oe(0)};var s=ub(new oe(r).sub(e).div(n-1),a,i),o;e<=0&&r>=0?o=new oe(0):(o=new oe(e).add(r).div(2),o=o.sub(new oe(o).mod(s)));var l=Math.ceil(o.sub(e).div(s).toNumber()),d=Math.ceil(new oe(r).sub(o).div(s).toNumber()),c=l+d+1;return c>n?db(e,r,n,a,i+1):(c<n&&(d=r>0?d+(n-c):d,l=r>0?l:l+(n-c)),{step:s,tickMin:o.sub(new oe(l).mul(s)),tickMax:o.add(new oe(d).mul(s))})};function xE(t){var[e,r]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,o]=cb([e,r]);if(s===-1/0||o===1/0){var l=o===1/0?[s,...au(0,n-1).map(()=>1/0)]:[...au(0,n-1).map(()=>-1/0),o];return e>r?iu(l):l}if(s===o)return bE(s,n,a);var{step:d,tickMin:c,tickMax:h}=db(s,o,i,a,0),f=lb(c,h.add(new oe(.1).mul(d)),d);return e>r?iu(f):f}function wE(t,e){var[r,n]=t,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=cb([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var o=Math.max(e,2),l=ub(new oe(s).sub(i).div(o-1),a,0),d=[...lb(new oe(i),new oe(s),l),s];return a===!1&&(d=d.map(c=>Math.round(c))),r>n?iu(d):d}var _E=sb(xE),jE=sb(wE),hb=t=>t.rootProps.maxBarSize,SE=t=>t.rootProps.barGap,fb=t=>t.rootProps.barCategoryGap,NE=t=>t.rootProps.barSize,Xa=t=>t.rootProps.stackOffset,Md=t=>t.options.chartName,Od=t=>t.rootProps.syncId,mb=t=>t.rootProps.syncMethod,Ad=t=>t.options.eventEmitter,Kt={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},st={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},ro=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},PE={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Kt.angleAxisId,includeHidden:!1,name:void 0,reversed:Kt.reversed,scale:Kt.scale,tick:Kt.tick,tickCount:void 0,ticks:void 0,type:Kt.type,unit:void 0},kE={allowDataOverflow:st.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:st.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:st.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:st.scale,tick:st.tick,tickCount:st.tickCount,ticks:void 0,type:st.type,unit:void 0},ME={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Kt.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Kt.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Kt.scale,tick:Kt.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},OE={allowDataOverflow:st.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:st.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:st.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:st.scale,tick:st.tick,tickCount:st.tickCount,ticks:void 0,type:"category",unit:void 0},Ed=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?ME:PE,Td=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?OE:kE,no=t=>t.polarOptions,Cd=A([nr,ar,Te],Qv),pb=A([no,Cd],(t,e)=>{if(t!=null)return Ye(t.innerRadius,e,0)}),gb=A([no,Cd],(t,e)=>{if(t!=null)return Ye(t.outerRadius,e,e*.8)}),AE=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},vb=A([no],AE);A([Ed,vb],ro);var yb=A([Cd,pb,gb],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});A([Td,yb],ro);var bb=A([Q,no,pb,gb,nr,ar],(t,e,r,n,a,i)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:s,cy:o,startAngle:l,endAngle:d}=e;return{cx:Ye(s,a,a/2),cy:Ye(o,i,i/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:d,clockWise:!1}}}),xe=(t,e)=>e,Za=(t,e,r)=>r;function Id(t){return t?.id}var De=t=>{var e=Q(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Zn=t=>t.tooltip.settings.axisId,Fe=t=>{var e=De(t),r=Zn(t);return Qa(t,e,r)},xb=A([Fe],t=>t?.dataKey);function wb(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return t.forEach(o=>{var l,d=(l=o.data)!==null&&l!==void 0?l:n;if(!(d==null||d.length===0)){var c=Id(o);d.forEach((h,f)=>{var m=i==null||a?f:String(ie(h,i,null)),p=ie(h,o.dataKey,0),g;s.has(m)?g=s.get(m):g={},Object.assign(g,{[c]:p}),s.set(m,g)})}}),Array.from(s.values())}function ao(t){return t.stackId!=null&&t.dataKey!=null}function Yp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function fs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yp(Object(r),!0).forEach(function(n){EE(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yp(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EE(t,e,r){return(e=TE(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TE(t){var e=CE(t,"string");return typeof e=="symbol"?e:e+""}function CE(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var su=[0,"auto"],at={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},_b=(t,e)=>t.cartesianAxis.xAxis[e],or=(t,e)=>{var r=_b(t,e);return r??at},it={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:su,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Ka},jb=(t,e)=>t.cartesianAxis.yAxis[e],lr=(t,e)=>{var r=jb(t,e);return r??it},xr={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Dd=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??xr},Pe=(t,e,r)=>{switch(e){case"xAxis":return or(t,r);case"yAxis":return lr(t,r);case"zAxis":return Dd(t,r);case"angleAxis":return Ed(t,r);case"radiusAxis":return Td(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},IE=(t,e,r)=>{switch(e){case"xAxis":return or(t,r);case"yAxis":return lr(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Qa=(t,e,r)=>{switch(e){case"xAxis":return or(t,r);case"yAxis":return lr(t,r);case"angleAxis":return Ed(t,r);case"radiusAxis":return Td(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Sb=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function $d(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var ei=t=>t.graphicalItems.cartesianItems,DE=A([xe,Za],$d),Rd=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),ti=A([ei,Pe,DE],Rd),Nb=A([ti],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(ao)),Pb=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),kb=A([ti],Pb),Ld=t=>t.map(e=>e.data).filter(Boolean).flat(1),$E=A([ti],Ld),Bd=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},Ud=A([$E,Ja],Bd),Fd=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:ie(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:ie(a,n)}))):t.map(n=>({value:n})),io=A([Ud,Pe,ti],Fd);function Mb(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function dn(t){return t.filter(e=>Dt(e)||e instanceof Date).map(Number).filter(e=>ut(e)===!1)}function RE(t,e,r){return!r||typeof e!="number"||ut(e)?[]:r.length?dn(r.flatMap(n=>{var a=ie(t,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!ht(i)||!ht(s)))return[e-i,e+s]})):[]}var LE=A([Nb,Ja,Fe],wb),Ob=(t,e,r)=>{var n={},a=e.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,o]=i,l=o.map(Id);return[s,{stackedData:qP(t,l,r),graphicalItems:o}]}))},ou=A([LE,Nb,Xa],Ob),Ab=(t,e,r)=>{var{dataStartIndex:n,dataEndIndex:a}=e;if(r!=="zAxis"){var i=GP(t,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},BE=A([ou,Ir,xe],Ab),Eb=(t,e,r,n,a)=>r.length>0?t.flatMap(i=>r.flatMap(s=>{var o,l,d=(o=n[s.id])===null||o===void 0?void 0:o.filter(h=>Mb(a,h)),c=ie(i,(l=e.dataKey)!==null&&l!==void 0?l:s.dataKey);return{value:c,errorDomain:RE(i,c,d)}})).filter(Boolean):e?.dataKey!=null?t.map(i=>({value:ie(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),so=t=>t.errorBars,Tb=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>Mb(r,n));A([kb,so,xe],Tb);var UE=A([Ud,Pe,kb,so,xe],Eb);function FE(t){var{value:e}=t;if(Dt(e)||e instanceof Date)return e}var Jp=t=>{var e=t.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=dn(e);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},WE=(t,e,r)=>{var n=t.map(FE).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&Kg(n))?vy(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Wd=t=>{var e;if(t==null||!("domain"in t))return su;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=dn(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:su},ms=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),o=Math.max(...i);return[s,o]}},Cb=t=>t.referenceElements.dots,Qn=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),qE=A([Cb,xe,Za],Qn),Ib=t=>t.referenceElements.areas,zE=A([Ib,xe,Za],Qn),Db=t=>t.referenceElements.lines,KE=A([Db,xe,Za],Qn),$b=(t,e)=>{var r=dn(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},HE=A(qE,xe,$b),Rb=(t,e)=>{var r=dn(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},VE=A([zE,xe],Rb),Lb=(t,e)=>{var r=dn(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},GE=A(KE,xe,Lb),YE=A(HE,GE,VE,(t,e,r)=>ms(t,r,e)),Bb=A([Pe],Wd),qd=(t,e,r,n,a,i,s)=>{var o=dE(e,t.allowDataOverflow);if(o!=null)return o;var l=i==="vertical"&&s==="xAxis"||i==="horizontal"&&s==="yAxis",d=l?ms(r,a,Jp(n)):ms(a,Jp(n));return hE(e,d,t.allowDataOverflow)},JE=A([Pe,Bb,BE,UE,YE,Q,xe],qd),XE=[0,1],zd=(t,e,r,n,a,i,s)=>{if(!((t==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:l}=t,d=Ar(e,i);return d&&o==null?vy(0,r.length):l==="category"?WE(n,t,d):a==="expand"?XE:s}},Kd=A([Pe,Q,Ud,io,Xa,xe,JE],zd),Ub=(t,e,r,n,a)=>{if(t!=null){var{scale:i,type:s}=t;if(i==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(Wa(i));return o in va?o:"point"}}},ea=A([Pe,Q,Sb,Md,xe],Ub);function ZE(t){if(t!=null){if(t in va)return va[t]();var e="scale".concat(Wa(t));if(e in va)return va[e]()}}function Hd(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=ZE(e);if(a!=null){var i=a.domain(r).range(n);return LP(i),i}}}var Vd=(t,e,r)=>{var n=Wd(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Wn(t))return _E(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Wn(t))return jE(t,e.tickCount,e.allowDecimals)}},Gd=A([Kd,Qa,ea],Vd),Yd=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&Wn(e)&&Array.isArray(r)&&r.length>0){var a=e[0],i=r[0],s=e[1],o=r[r.length-1];return[Math.min(a,i),Math.max(s,o)]}return e},QE=A([Pe,Kd,Gd,xe],Yd),e2=A(io,Pe,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(dn(t.map(o=>o.value))).sort((o,l)=>o-l);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),Fb=A(e2,Q,fb,Te,(t,e,r,n)=>n,(t,e,r,n,a)=>{if(!ht(t))return 0;var i=e==="vertical"?n.height:n.width;if(a==="gap")return t*i/2;if(a==="no-gap"){var s=Ye(r,t*i),o=t*i/2;return o-s-(o-s)/i*s}return 0}),t2=(t,e)=>{var r=or(t,e);return r==null||typeof r.padding!="string"?0:Fb(t,"xAxis",e,r.padding)},r2=(t,e)=>{var r=lr(t,e);return r==null||typeof r.padding!="string"?0:Fb(t,"yAxis",e,r.padding)},n2=A(or,t2,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),a2=A(lr,r2,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),i2=A([Te,n2,zs,qs,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[t.left+e.left,t.left+t.width-e.right]}),s2=A([Te,Q,a2,zs,qs,(t,e,r)=>r],(t,e,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),ri=(t,e,r,n)=>{var a;switch(e){case"xAxis":return i2(t,r,n);case"yAxis":return s2(t,r,n);case"zAxis":return(a=Dd(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return vb(t);case"radiusAxis":return yb(t,r);default:return}},Wb=A([Pe,ri],ro),ta=A([Pe,ea,QE,Wb],Hd);A([ti,so,xe],Tb);function qb(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var oo=(t,e)=>e,lo=(t,e,r)=>r,o2=A(Fs,oo,lo,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(qb)),l2=A(Ws,oo,lo,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(qb)),zb=(t,e)=>({width:t.width,height:e.height}),c2=(t,e)=>{var r=typeof e.width=="number"?e.width:Ka;return{width:r,height:t.height}},Kb=A(Te,or,zb),u2=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},d2=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},h2=A(ar,Te,o2,oo,lo,(t,e,r,n,a)=>{var i={},s;return r.forEach(o=>{var l=zb(e,o);s==null&&(s=u2(e,n,t));var d=n==="top"&&!a||n==="bottom"&&a;i[o.id]=s-Number(d)*l.height,s+=(d?-1:1)*l.height}),i}),f2=A(nr,Te,l2,oo,lo,(t,e,r,n,a)=>{var i={},s;return r.forEach(o=>{var l=c2(e,o);s==null&&(s=d2(e,n,t));var d=n==="left"&&!a||n==="right"&&a;i[o.id]=s-Number(d)*l.width,s+=(d?-1:1)*l.width}),i}),m2=(t,e)=>{var r=or(t,e);if(r!=null)return h2(t,r.orientation,r.mirror)},p2=A([Te,or,m2,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r?.[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),g2=(t,e)=>{var r=lr(t,e);if(r!=null)return f2(t,r.orientation,r.mirror)},v2=A([Te,lr,g2,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r?.[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),Hb=A(Te,lr,(t,e)=>{var r=typeof e.width=="number"?e.width:Ka;return{width:r,height:t.height}}),Xp=(t,e,r)=>{switch(e){case"xAxis":return Kb(t,r).width;case"yAxis":return Hb(t,r).height;default:return}},Vb=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,o=Ar(t,n),l=e.map(d=>d.value);if(s&&o&&i==="category"&&a&&Kg(l))return l}},Jd=A([Q,io,Pe,xe],Vb),Gb=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Ar(t,n);if(s&&(a==="number"||i!=="auto"))return e.map(o=>o.value)}},Xd=A([Q,io,Qa,xe],Gb),Zp=A([Q,IE,ea,ta,Jd,Xd,ri,Gd,xe],(t,e,r,n,a,i,s,o,l)=>{if(e==null)return null;var d=Ar(t,l);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:l,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:o,range:s,realScaleType:r,scale:n}}),y2=(t,e,r,n,a,i,s,o,l)=>{if(!(e==null||n==null)){var d=Ar(t,l),{type:c,ticks:h,tickCount:f}=e,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,p=c==="category"&&n.bandwidth?n.bandwidth()/m:0;p=l==="angleAxis"&&i!=null&&i.length>=2?Be(i[0]-i[1])*2*p:p;var g=h||a;if(g){var y=g.map((b,x)=>{var w=s?s.indexOf(b):b;return{index:x,coordinate:n(w)+p,value:b,offset:p}});return y.filter(b=>!ut(b.coordinate))}return d&&o?o.map((b,x)=>({coordinate:n(b)+p,value:b,index:x,offset:p})):n.ticks?n.ticks(f).map(b=>({coordinate:n(b)+p,value:b,offset:p})):n.domain().map((b,x)=>({coordinate:n(b)+p,value:s?s[b]:b,index:x,offset:p}))}},Yb=A([Q,Qa,ea,ta,Gd,ri,Jd,Xd,xe],y2),b2=(t,e,r,n,a,i,s)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var o=Ar(t,s),{tickCount:l}=e,d=0;return d=s==="angleAxis"&&n?.length>=2?Be(n[0]-n[1])*2*d:d,o&&i?i.map((c,h)=>({coordinate:r(c)+d,value:c,index:h,offset:d})):r.ticks?r.ticks(l).map(c=>({coordinate:r(c)+d,value:c,offset:d})):r.domain().map((c,h)=>({coordinate:r(c)+d,value:a?a[c]:c,index:h,offset:d}))}},Rt=A([Q,Qa,ta,ri,Jd,Xd,xe],b2),Lt=A(Pe,ta,(t,e)=>{if(!(t==null||e==null))return fs(fs({},t),{},{scale:e})}),x2=A([Pe,ea,Kd,Wb],Hd),w2=A((t,e,r)=>Dd(t,r),x2,(t,e)=>{if(!(t==null||e==null))return fs(fs({},t),{},{scale:e})}),_2=A([Q,Fs,Ws],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Jb=t=>t.options.defaultTooltipEventType,Xb=t=>t.options.validateTooltipEventTypes;function Zb(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function Zd(t,e){var r=Jb(t),n=Xb(t);return Zb(e,r,n)}function j2(t){return F(e=>Zd(e,t))}var Qb=(t,e)=>{var r,n=Number(e);if(!(ut(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},S2=t=>t.tooltip.settings,vr={active:!1,index:null,dataKey:void 0,coordinate:void 0},N2={itemInteraction:{click:vr,hover:vr},axisInteraction:{click:vr,hover:vr},keyboardInteraction:vr,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},ex=ft({name:"tooltip",initialState:N2,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var r=Yt(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:P2,removeTooltipEntrySettings:k2,setTooltipSettingsState:M2,setActiveMouseOverItemIndex:tx,mouseLeaveItem:O2,mouseLeaveChart:rx,setActiveClickItemIndex:A2,setMouseOverAxisIndex:nx,setMouseClickAxisIndex:E2,setSyncInteraction:lu,setKeyboardInteraction:cu}=ex.actions,T2=ex.reducer;function Qp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ki(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qp(Object(r),!0).forEach(function(n){C2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qp(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function C2(t,e,r){return(e=I2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I2(t){var e=D2(t,"string");return typeof e=="symbol"?e:e+""}function D2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $2(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function R2(t){return t.index!=null}var ax=(t,e,r,n)=>{if(e==null)return vr;var a=$2(t,e,r);if(a==null)return vr;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var i=t.settings.active===!0;if(R2(a)){if(i)return ki(ki({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return ki(ki({},vr),{},{coordinate:a.coordinate})},Qd=(t,e)=>{var r=t?.index;if(r==null)return null;var n=Number(r);if(!ht(n))return r;var a=0,i=1/0;return e.length>0&&(i=e.length-1),String(Math.max(a,Math.min(n,i)))},ix=(t,e,r,n,a,i,s,o)=>{if(!(i==null||o==null)){var l=s[0],d=l==null?void 0:o(l.positions,i);if(d!=null)return d;var c=a?.[Number(i)];if(c)switch(r){case"horizontal":return{x:c.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:c.coordinate}}}},sx=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=t.itemInteraction.hover.dataKey:a=t.itemInteraction.click.dataKey,a==null&&n!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},ni=t=>t.options.tooltipPayloadSearcher,ra=t=>t.tooltip;function e0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function t0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?e0(Object(r),!0).forEach(function(n){L2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function L2(t,e,r){return(e=B2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B2(t){var e=U2(t,"string");return typeof e=="symbol"?e:e+""}function U2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function F2(t,e){return t??e}var ox=(t,e,r,n,a,i,s)=>{if(!(e==null||i==null)){var{chartData:o,computedData:l,dataStartIndex:d,dataEndIndex:c}=r,h=[];return t.reduce((f,m)=>{var p,{dataDefinedOnItem:g,settings:y}=m,b=F2(g,o),x=Array.isArray(b)?ey(b,d,c):b,w=(p=y?.dataKey)!==null&&p!==void 0?p:n,_=y?.nameKey,S;if(n&&Array.isArray(x)&&!Array.isArray(x[0])&&s==="axis"?S=Hg(x,n,a):S=i(x,e,l,_),Array.isArray(S))S.forEach(N=>{var M=t0(t0({},y),{},{name:N.name,unit:N.unit,color:void 0,fill:void 0});f.push(Rm({tooltipEntrySettings:M,dataKey:N.dataKey,payload:N.payload,value:ie(N.payload,N.dataKey),name:N.name}))});else{var j;f.push(Rm({tooltipEntrySettings:y,dataKey:w,payload:S,value:ie(S,w),name:(j=ie(S,_))!==null&&j!==void 0?j:y?.name}))}return f},h)}},eh=A([Fe,Q,Sb,Md,De],Ub),W2=A([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),q2=A([De,Zn],$d),ai=A([W2,Fe,q2],Rd),z2=A([ai],t=>t.filter(ao)),K2=A([ai],Ld),na=A([K2,Ir],Bd),H2=A([z2,Ir,Fe],wb),th=A([na,Fe,ai],Fd),V2=A([Fe],Wd),G2=A([ai],t=>t.filter(ao)),Y2=A([H2,G2,Xa],Ob),J2=A([Y2,Ir,De],Ab),X2=A([ai],Pb),Z2=A([na,Fe,X2,so,De],Eb),Q2=A([Cb,De,Zn],Qn),eT=A([Q2,De],$b),tT=A([Ib,De,Zn],Qn),rT=A([tT,De],Rb),nT=A([Db,De,Zn],Qn),aT=A([nT,De],Lb),iT=A([eT,aT,rT],ms),sT=A([Fe,V2,J2,Z2,iT,Q,De],qd),lx=A([Fe,Q,na,th,Xa,De,sT],zd),oT=A([lx,Fe,eh],Vd),lT=A([Fe,lx,oT,De],Yd),cx=t=>{var e=De(t),r=Zn(t),n=!1;return ri(t,e,r,n)},ux=A([Fe,cx],ro),dx=A([Fe,eh,lT,ux],Hd),cT=A([Q,th,Fe,De],Vb),uT=A([Q,th,Fe,De],Gb),dT=(t,e,r,n,a,i,s,o)=>{if(e){var{type:l}=e,d=Ar(t,o);if(n){var c=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=l==="category"&&n.bandwidth?n.bandwidth()/c:0;return h=o==="angleAxis"&&a!=null&&a?.length>=2?Be(a[0]-a[1])*2*h:h,d&&s?s.map((f,m)=>({coordinate:n(f)+h,value:f,index:m,offset:h})):n.domain().map((f,m)=>({coordinate:n(f)+h,value:i?i[f]:f,index:m,offset:h}))}}},cr=A([Q,Fe,eh,dx,cx,cT,uT,De],dT),rh=A([Jb,Xb,S2],(t,e,r)=>Zb(r.shared,t,e)),hx=t=>t.tooltip.settings.trigger,nh=t=>t.tooltip.settings.defaultIndex,co=A([ra,rh,hx,nh],ax),tr=A([co,na],Qd),fx=A([cr,tr],Qb),mx=A([co],t=>{if(t)return t.dataKey}),px=A([ra,rh,hx,nh],sx),hT=A([nr,ar,Q,Te,cr,nh,px,ni],ix),fT=A([co,hT],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),mT=A([co],t=>t.active),pT=A([px,tr,Ir,xb,fx,ni,rh],ox),gT=A([pT],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function r0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function n0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?r0(Object(r),!0).forEach(function(n){vT(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):r0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vT(t,e,r){return(e=yT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yT(t){var e=bT(t,"string");return typeof e=="symbol"?e:e+""}function bT(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xT=()=>F(Fe),wT=()=>{var t=xT(),e=F(cr),r=F(dx);return Ca(n0(n0({},t),{},{scale:r}),e)},_T=()=>F(Md),ah=(t,e)=>e,gx=(t,e,r)=>r,ih=(t,e,r,n)=>n,jT=A(cr,t=>Ds(t,e=>e.coordinate)),sh=A([ra,ah,gx,ih],ax),vx=A([sh,na],Qd),ST=(t,e,r)=>{if(e!=null){var n=ra(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},yx=A([ra,ah,gx,ih],sx),ps=A([nr,ar,Q,Te,cr,ih,yx,ni],ix),NT=A([sh,ps],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),bx=A(cr,vx,Qb),PT=A([yx,vx,Ir,xb,bx,ni,ah],ox),kT=A([sh],t=>({isActive:t.active,activeIndex:t.index})),MT=(t,e,r,n,a,i,s,o)=>{if(!(!t||!e||!n||!a||!i)){var l=YP(t.chartX,t.chartY,e,r,o);if(l){var d=XP(l,e),c=$P(d,s,i,n,a),h=JP(e,i,c,l);return{activeIndex:String(c),activeCoordinate:h}}}};function uu(){return uu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},uu.apply(null,arguments)}function a0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Mi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?a0(Object(r),!0).forEach(function(n){OT(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OT(t,e,r){return(e=AT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AT(t){var e=ET(t,"string");return typeof e=="symbol"?e:e+""}function ET(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TT(t){var{coordinate:e,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:o,tooltipEventType:l,chartName:d}=t,c=e,h=r,f=n;if(!o||!c||d!=="ScatterChart"&&l!=="axis")return null;var m,p;if(d==="ScatterChart")m=c,p=Xk;else if(d==="BarChart")m=Zk(s,c,a,i),p=fy;else if(s==="radial"){var{cx:g,cy:y,radius:b,startAngle:x,endAngle:w}=my(c);m={cx:g,cy:y,startAngle:x,endAngle:w,innerRadius:b,outerRadius:b},p=gy}else m={points:EM(s,c,a)},p=Gs;var _=typeof o=="object"&&"className"in o?o.className:void 0,S=Mi(Mi(Mi(Mi({stroke:"#ccc",pointerEvents:"none"},a),m),ye(o,!1)),{},{payload:h,payloadIndex:f,className:ee("recharts-tooltip-cursor",_)});return v.isValidElement(o)?v.cloneElement(o,S):v.createElement(p,S)}function CT(t){var e=wT(),r=ay(),n=Hs(),a=_T();return v.createElement(TT,uu({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var xx=v.createContext(null),IT=()=>v.useContext(xx),Jl={exports:{}},i0;function DT(){return i0||(i0=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,d,c){this.fn=l,this.context=d,this.once=c||!1}function i(l,d,c,h,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var m=new a(c,h||l,f),p=r?r+d:d;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],m]:l._events[p].push(m):(l._events[p]=m,l._eventsCount++),l}function s(l,d){--l._eventsCount===0?l._events=new n:delete l._events[d]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var d=[],c,h;if(this._eventsCount===0)return d;for(h in c=this._events)e.call(c,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(c)):d},o.prototype.listeners=function(d){var c=r?r+d:d,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,p=new Array(m);f<m;f++)p[f]=h[f].fn;return p},o.prototype.listenerCount=function(d){var c=r?r+d:d,h=this._events[c];return h?h.fn?1:h.length:0},o.prototype.emit=function(d,c,h,f,m,p){var g=r?r+d:d;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,x,w;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,c),!0;case 3:return y.fn.call(y.context,c,h),!0;case 4:return y.fn.call(y.context,c,h,f),!0;case 5:return y.fn.call(y.context,c,h,f,m),!0;case 6:return y.fn.call(y.context,c,h,f,m,p),!0}for(w=1,x=new Array(b-1);w<b;w++)x[w-1]=arguments[w];y.fn.apply(y.context,x)}else{var _=y.length,S;for(w=0;w<_;w++)switch(y[w].once&&this.removeListener(d,y[w].fn,void 0,!0),b){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,c);break;case 3:y[w].fn.call(y[w].context,c,h);break;case 4:y[w].fn.call(y[w].context,c,h,f);break;default:if(!x)for(S=1,x=new Array(b-1);S<b;S++)x[S-1]=arguments[S];y[w].fn.apply(y[w].context,x)}}return!0},o.prototype.on=function(d,c,h){return i(this,d,c,h,!1)},o.prototype.once=function(d,c,h){return i(this,d,c,h,!0)},o.prototype.removeListener=function(d,c,h,f){var m=r?r+d:d;if(!this._events[m])return this;if(!c)return s(this,m),this;var p=this._events[m];if(p.fn)p.fn===c&&(!f||p.once)&&(!h||p.context===h)&&s(this,m);else{for(var g=0,y=[],b=p.length;g<b;g++)(p[g].fn!==c||f&&!p[g].once||h&&p[g].context!==h)&&y.push(p[g]);y.length?this._events[m]=y.length===1?y[0]:y:s(this,m)}return this},o.prototype.removeAllListeners=function(d){var c;return d?(c=r?r+d:d,this._events[c]&&s(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(Jl)),Jl.exports}var $T=DT();const RT=rr($T);var Ua=new RT,du="recharts.syncEvent.tooltip",s0="recharts.syncEvent.brush";function uo(t,e){if(e){var r=Number.parseInt(e,10);if(!ut(r))return t?.[r]}}var LT={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},wx=ft({name:"options",initialState:LT,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),BT=wx.reducer,{createEventEmitter:UT}=wx.actions;function FT(t){return t.tooltip.syncInteraction}var WT={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},_x=ft({name:"chartData",initialState:WT,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:o0,setDataStartEndIndexes:qT,setComputedData:Q4}=_x.actions,zT=_x.reducer,KT=["x","y"];function l0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Br(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?l0(Object(r),!0).forEach(function(n){HT(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HT(t,e,r){return(e=VT(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VT(t){var e=GT(t,"string");return typeof e=="symbol"?e:e+""}function GT(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YT(t,e){if(t==null)return{};var r,n,a=JT(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function JT(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var jx=()=>{};function XT(){var t=F(Od),e=F(Ad),r=be(),n=F(mb),a=F(cr),i=Hs(),s=Ks(),o=F(l=>l.rootProps.className);v.useEffect(()=>{if(t==null)return jx;var l=(d,c,h)=>{if(e!==h&&t===d){if(n==="index"){var f;if(s&&c!==null&&c!==void 0&&(f=c.payload)!==null&&f!==void 0&&f.coordinate){var m=c.payload.coordinate,{x:p,y:g}=m,y=YT(m,KT),b=Br(Br(Br({},y),typeof p=="number"&&{x:Math.max(s.x,Math.min(p,s.x+s.width))}),typeof g=="number"&&{y:Math.max(s.y,Math.min(g,s.y+s.height))}),x=Br(Br({},c),{},{payload:Br(Br({},c.payload),{},{coordinate:b})});r(x)}else r(c);return}if(a!=null){var w;if(typeof n=="function"){var _={activeTooltipIndex:c.payload.index==null?void 0:Number(c.payload.index),isTooltipActive:c.payload.active,activeIndex:c.payload.index==null?void 0:Number(c.payload.index),activeLabel:c.payload.label,activeDataKey:c.payload.dataKey,activeCoordinate:c.payload.coordinate},S=n(a,_);w=a[S]}else n==="value"&&(w=a.find(D=>String(D.value)===c.payload.label));var{coordinate:j}=c.payload;if(w==null||c.payload.active===!1||j==null||s==null){r(lu({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:N,y:M}=j,O=Math.min(N,s.x+s.width),T=Math.min(M,s.y+s.height),P={x:i==="horizontal"?w.coordinate:O,y:i==="horizontal"?T:w.coordinate},k=lu({active:c.payload.active,coordinate:P,dataKey:c.payload.dataKey,index:String(w.index),label:c.payload.label});r(k)}}};return Ua.on(du,l),()=>{Ua.off(du,l)}},[o,r,e,t,n,a,i,s])}function ZT(){var t=F(Od),e=F(Ad),r=be();v.useEffect(()=>{if(t==null)return jx;var n=(a,i,s)=>{e!==s&&t===a&&r(qT(i))};return Ua.on(s0,n),()=>{Ua.off(s0,n)}},[r,e,t])}function QT(){var t=be();v.useEffect(()=>{t(UT())},[t]),XT(),ZT()}function eC(t,e,r,n,a,i){var s=F(f=>ST(f,t,e)),o=F(Ad),l=F(Od),d=F(mb),c=F(FT),h=c?.active;v.useEffect(()=>{if(!h&&l!=null&&o!=null){var f=lu({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});Ua.emit(du,l,f,o)}},[h,r,s,a,n,o,l,d,i])}function c0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function u0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c0(Object(r),!0).forEach(function(n){tC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tC(t,e,r){return(e=rC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rC(t){var e=nC(t,"string");return typeof e=="symbol"?e:e+""}function nC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aC(t){return t.dataKey}function iC(t,e){return v.isValidElement(t)?v.cloneElement(t,e):typeof t=="function"?v.createElement(t,e):v.createElement(Ok,e)}var d0=[],sC={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!ir.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function yr(t){var e=Ce(t,sC),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:o,isAnimationActive:l,offset:d,payloadUniqBy:c,position:h,reverseDirection:f,useTranslate3d:m,wrapperStyle:p,cursor:g,shared:y,trigger:b,defaultIndex:x,portal:w,axisId:_}=e,S=be(),j=typeof x=="number"?String(x):x;v.useEffect(()=>{S(M2({shared:y,trigger:b,axisId:_,active:r,defaultIndex:j}))},[S,y,b,_,r,j]);var N=Ks(),M=ly(),O=j2(y),{activeIndex:T,isActive:P}=F(te=>kT(te,O,b,j)),k=F(te=>PT(te,O,b,j)),D=F(te=>bx(te,O,b,j)),I=F(te=>NT(te,O,b,j)),z=k,H=IT(),K=r??P,[X,B]=Mv([z,K]),R=O==="axis"?D:void 0;eC(O,b,I,R,T,K);var Y=w??H;if(Y==null)return null;var $=z??d0;K||($=d0),o&&$.length&&($=jv(z.filter(te=>te.value!=null&&(te.hide!==!0||e.includeHidden)),c,aC));var We=$.length>0,ur=v.createElement($k,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:l,active:K,coordinate:I,hasPayload:We,offset:d,position:h,reverseDirection:f,useTranslate3d:m,viewBox:N,wrapperStyle:p,lastBoundingBox:X,innerRef:B,hasPortalFromProps:!!w},iC(s,u0(u0({},e),{},{payload:$,label:R,active:K,coordinate:I,accessibilityLayer:M})));return v.createElement(v.Fragment,null,Jg.createPortal(ur,Y),K&&v.createElement(CT,{cursor:g,tooltipEventType:O,coordinate:I,payload:z,index:T}))}var Xl={},Zl={},Ql={},h0;function oC(){return h0||(h0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:i}={}){let s,o=null;const l=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),c=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},h=()=>{d&&c(),g()};let f=null;const m=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,h()},n)},p=()=>{f!==null&&(clearTimeout(f),f=null)},g=()=>{p(),s=void 0,o=null},y=()=>{c()},b=function(...x){if(a?.aborted)return;s=this,o=x;const w=f==null;m(),l&&w&&c()};return b.schedule=m,b.cancel=g,b.flush=y,a?.addEventListener("abort",g,{once:!0}),b}t.debounce=e})(Ql)),Ql}var f0;function lC(){return f0||(f0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oC();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:o=!0,maxWait:l}=i,d=Array(2);s&&(d[0]="leading"),o&&(d[1]="trailing");let c,h=null;const f=e.debounce(function(...g){c=n.apply(this,g),h=null},a,{edges:d}),m=function(...g){return l!=null&&(h===null&&(h=Date.now()),Date.now()-h>=l)?(c=n.apply(this,g),h=Date.now(),f.cancel(),f.schedule(),c):(f.apply(this,g),c)},p=()=>(f.flush(),c);return m.cancel=f.cancel,m.flush=p,m}t.debounce=r})(Zl)),Zl}var m0;function cC(){return m0||(m0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=lC();function r(n,a=0,i={}){const{leading:s=!0,trailing:o=!0}=i;return e.debounce(n,a,{leading:s,maxWait:a,trailing:o})}t.throttle=r})(Xl)),Xl}var ec,p0;function uC(){return p0||(p0=1,ec=cC().throttle),ec}var dC=uC();const hC=rr(dC);var ja=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function g0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?g0(Object(r),!0).forEach(function(n){fC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fC(t,e,r){return(e=mC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mC(t){var e=pC(t,"string");return typeof e=="symbol"?e:e+""}function pC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var br=v.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:o,maxHeight:l,children:d,debounce:c=0,id:h,className:f,onResize:m,style:p={}}=t,g=v.useRef(null),y=v.useRef();y.current=m,v.useImperativeHandle(e,()=>g.current);var[b,x]=v.useState({containerWidth:n.width,containerHeight:n.height}),w=v.useCallback((S,j)=>{x(N=>{var M=Math.round(S),O=Math.round(j);return N.containerWidth===M&&N.containerHeight===O?N:{containerWidth:M,containerHeight:O}})},[]);v.useEffect(()=>{var S=O=>{var T,{width:P,height:k}=O[0].contentRect;w(P,k),(T=y.current)===null||T===void 0||T.call(y,P,k)};c>0&&(S=hC(S,c,{trailing:!0,leading:!1}));var j=new ResizeObserver(S),{width:N,height:M}=g.current.getBoundingClientRect();return w(N,M),j.observe(g.current),()=>{j.disconnect()}},[w,c]);var _=v.useMemo(()=>{var{containerWidth:S,containerHeight:j}=b;if(S<0||j<0)return null;ja(Hr(a)||Hr(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),ja(!r||r>0,"The aspect(%s) must be greater than zero.",r);var N=Hr(a)?S:a,M=Hr(i)?j:i;return r&&r>0&&(N?M=N/r:M&&(N=M*r),l&&M>l&&(M=l)),ja(N>0||M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,N,M,a,i,s,o,r),v.Children.map(d,O=>v.cloneElement(O,{width:N,height:M,style:tc({width:N,height:M},O.props.style)}))},[r,d,i,l,o,s,b,a]);return v.createElement("div",{id:h?"".concat(h):void 0,className:ee("recharts-responsive-container",f),style:tc(tc({},p),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:l}),ref:g},v.createElement("div",{style:{width:0,height:0,overflow:"visible"}},_))}),hn=t=>null;hn.displayName="Cell";function gC(t,e,r){return(e=vC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vC(t){var e=yC(t,"string");return typeof e=="symbol"?e:e+""}function yC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bC{constructor(e){gC(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function v0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function xC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?v0(Object(r),!0).forEach(function(n){wC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wC(t,e,r){return(e=_C(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _C(t){var e=jC(t,"string");return typeof e=="symbol"?e:e+""}function jC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SC={cacheSize:2e3,enableCache:!0},Sx=xC({},SC),y0=new bC(Sx.cacheSize),NC={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},b0="recharts_measurement_span";function PC(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",i=e.fontStyle||"",s=e.letterSpacing||"",o=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}var x0=(t,e)=>{try{var r=document.getElementById(b0);r||(r=document.createElement("span"),r.setAttribute("id",b0),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,NC,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Sa=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||ir.isSsr)return{width:0,height:0};if(!Sx.enableCache)return x0(e,r);var n=PC(e,r),a=y0.get(n);if(a)return a;var i=x0(e,r);return y0.set(n,i),i},w0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,kC=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,MC=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Nx={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},OC=Object.keys(Nx),kn="NaN";function AC(t,e){return t*Nx[e]}class rt{static parse(e){var r,[,n,a]=(r=MC.exec(e))!==null&&r!==void 0?r:[];return new rt(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,ut(e)&&(this.unit=""),r!==""&&!kC.test(r)&&(this.num=NaN,this.unit=""),OC.includes(r)&&(this.num=AC(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new rt(NaN,""):new rt(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new rt(NaN,""):new rt(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new rt(NaN,""):new rt(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new rt(NaN,""):new rt(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ut(this.num)}}function Px(t){if(t.includes(kn))return kn;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,i]=(r=w0.exec(e))!==null&&r!==void 0?r:[],s=rt.parse(n??""),o=rt.parse(i??""),l=a==="*"?s.multiply(o):s.divide(o);if(l.isNaN())return kn;e=e.replace(w0,l.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,[,c,h,f]=(d=_0.exec(e))!==null&&d!==void 0?d:[],m=rt.parse(c??""),p=rt.parse(f??""),g=h==="+"?m.add(p):m.subtract(p);if(g.isNaN())return kn;e=e.replace(_0,g.toString())}return e}var j0=/\(([^()]*)\)/;function EC(t){for(var e=t,r;(r=j0.exec(e))!=null;){var[,n]=r;e=e.replace(j0,Px(n))}return e}function TC(t){var e=t.replace(/\s+/g,"");return e=EC(e),e=Px(e),e}function CC(t){try{return TC(t)}catch{return kn}}function rc(t){var e=CC(t.slice(5,-1));return e===kn?"":e}var IC=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],DC=["dx","dy","angle","className","breakAll"];function hu(){return hu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},hu.apply(null,arguments)}function S0(t,e){if(t==null)return{};var r,n,a=$C(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function $C(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var kx=/[ \f\n\r\t\v\u2028\u2029]+/,Mx=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];le(e)||(r?a=e.toString().split(""):a=e.toString().split(kx));var i=a.map(o=>({word:o,width:Sa(o,n).width})),s=r?0:Sa(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},RC=(t,e,r,n,a)=>{var{maxLines:i,children:s,style:o,breakAll:l}=t,d=q(i),c=s,h=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return P.reduce((k,D)=>{var{word:I,width:z}=D,H=k[k.length-1];if(H&&(n==null||a||H.width+z+r<Number(n)))H.words.push(I),H.width+=z+r;else{var K={words:[I],width:z};k.push(K)}return k},[])},f=h(e),m=T=>T.reduce((P,k)=>P.width>k.width?P:k);if(!d||a)return f;var p=f.length>i||m(f).width>Number(n);if(!p)return f;for(var g="…",y=T=>{var P=c.slice(0,T),k=Mx({breakAll:l,style:o,children:P+g}).wordsWithComputedWidth,D=h(k),I=D.length>i||m(D).width>Number(n);return[I,D]},b=0,x=c.length-1,w=0,_;b<=x&&w<=c.length-1;){var S=Math.floor((b+x)/2),j=S-1,[N,M]=y(j),[O]=y(S);if(!N&&!O&&(b=S+1),N&&O&&(x=S-1),!N&&O){_=M;break}w++}return _||f},N0=t=>{var e=le(t)?[]:t.toString().split(kx);return[{words:e}]},LC=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=t;if((e||r)&&!ir.isSsr){var o,l,d=Mx({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:c,spaceWidth:h}=d;o=c,l=h}else return N0(n);return RC({breakAll:i,children:n,maxLines:s,style:a},o,l,e,r)}return N0(n)},P0="#808080",ho=v.forwardRef((t,e)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:l="end",fill:d=P0}=t,c=S0(t,IC),h=v.useMemo(()=>LC({breakAll:c.breakAll,children:c.children,maxLines:c.maxLines,scaleToFit:s,style:c.style,width:c.width}),[c.breakAll,c.children,c.maxLines,s,c.style,c.width]),{dx:f,dy:m,angle:p,className:g,breakAll:y}=c,b=S0(c,DC);if(!Dt(r)||!Dt(n)||h.length===0)return null;var x=r+(q(f)?f:0),w=n+(q(m)?m:0),_;switch(l){case"start":_=rc("calc(".concat(i,")"));break;case"middle":_=rc("calc(".concat((h.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:_=rc("calc(".concat(h.length-1," * -").concat(a,")"));break}var S=[];if(s){var j=h[0].width,{width:N}=c;S.push("scale(".concat(q(N)?N/j:1,")"))}return p&&S.push("rotate(".concat(p,", ").concat(x,", ").concat(w,")")),S.length&&(b.transform=S.join(" ")),v.createElement("text",hu({},ye(b,!0),{ref:e,x,y:w,className:ee("recharts-text",g),textAnchor:o,fill:d.includes("url")?P0:d}),h.map((M,O)=>{var T=M.words.join(y?"":" ");return v.createElement("tspan",{x,dy:O===0?_:a,key:"".concat(T,"-").concat(O)},T)}))});ho.displayName="Text";var BC=["labelRef"];function UC(t,e){if(t==null)return{};var r,n,a=FC(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function FC(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function k0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Se(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?k0(Object(r),!0).forEach(function(n){WC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WC(t,e,r){return(e=qC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qC(t){var e=zC(t,"string");return typeof e=="symbol"?e:e+""}function zC(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ht(){return Ht=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ht.apply(null,arguments)}var Ox=v.createContext(null),KC=t=>{var{x:e,y:r,width:n,height:a,children:i}=t,s=v.useMemo(()=>({x:e,y:r,width:n,height:a}),[e,r,n,a]);return v.createElement(Ox.Provider,{value:s},i)},Ax=()=>{var t=v.useContext(Ox),e=Ks();return t||e},HC=v.createContext(null),VC=()=>{var t=v.useContext(HC),e=F(bb);return t||e},GC=t=>{var{value:e,formatter:r}=t,n=le(t.children)?e:t.children;return typeof r=="function"?r(n):n},oh=t=>t!=null&&typeof t=="function",YC=(t,e)=>{var r=Be(e-t),n=Math.min(Math.abs(e-t),360);return r*n},JC=(t,e,r,n,a)=>{var{offset:i,className:s}=t,{cx:o,cy:l,innerRadius:d,outerRadius:c,startAngle:h,endAngle:f,clockWise:m}=a,p=(d+c)/2,g=YC(h,f),y=g>=0?1:-1,b,x;switch(e){case"insideStart":b=h+y*i,x=m;break;case"insideEnd":b=f-y*i,x=!m;break;case"end":b=f+y*i,x=m;break;default:throw new Error("Unsupported position ".concat(e))}x=g<=0?x:!x;var w=ke(o,l,p,b),_=ke(o,l,p,b+(x?1:-1)*359),S="M".concat(w.x,",").concat(w.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(x?0:1,`,
    `).concat(_.x,",").concat(_.y),j=le(t.id)?Aa("recharts-radial-line-"):t.id;return v.createElement("text",Ht({},n,{dominantBaseline:"central",className:ee("recharts-radial-bar-label",s)}),v.createElement("defs",null,v.createElement("path",{id:j,d:S})),v.createElement("textPath",{xlinkHref:"#".concat(j)},r))},XC=(t,e,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:o,endAngle:l}=t,d=(o+l)/2;if(r==="outside"){var{x:c,y:h}=ke(n,a,s+e,d);return{x:c,y:h,textAnchor:c>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var f=(i+s)/2,{x:m,y:p}=ke(n,a,f,d);return{x:m,y:p,textAnchor:"middle",verticalAnchor:"middle"}},Ex=t=>"cx"in t&&q(t.cx),ZC=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,i;r!=null&&!Ex(r)&&(i=r);var{x:s,y:o,width:l,height:d}=e,c=d>=0?1:-1,h=c*n,f=c>0?"end":"start",m=c>0?"start":"end",p=l>=0?1:-1,g=p*n,y=p>0?"end":"start",b=p>0?"start":"end";if(a==="top"){var x={x:s+l/2,y:o-c*n,textAnchor:"middle",verticalAnchor:f};return Se(Se({},x),i?{height:Math.max(o-i.y,0),width:l}:{})}if(a==="bottom"){var w={x:s+l/2,y:o+d+h,textAnchor:"middle",verticalAnchor:m};return Se(Se({},w),i?{height:Math.max(i.y+i.height-(o+d),0),width:l}:{})}if(a==="left"){var _={x:s-g,y:o+d/2,textAnchor:y,verticalAnchor:"middle"};return Se(Se({},_),i?{width:Math.max(_.x-i.x,0),height:d}:{})}if(a==="right"){var S={x:s+l+g,y:o+d/2,textAnchor:b,verticalAnchor:"middle"};return Se(Se({},S),i?{width:Math.max(i.x+i.width-S.x,0),height:d}:{})}var j=i?{width:l,height:d}:{};return a==="insideLeft"?Se({x:s+g,y:o+d/2,textAnchor:b,verticalAnchor:"middle"},j):a==="insideRight"?Se({x:s+l-g,y:o+d/2,textAnchor:y,verticalAnchor:"middle"},j):a==="insideTop"?Se({x:s+l/2,y:o+h,textAnchor:"middle",verticalAnchor:m},j):a==="insideBottom"?Se({x:s+l/2,y:o+d-h,textAnchor:"middle",verticalAnchor:f},j):a==="insideTopLeft"?Se({x:s+g,y:o+h,textAnchor:b,verticalAnchor:m},j):a==="insideTopRight"?Se({x:s+l-g,y:o+h,textAnchor:y,verticalAnchor:m},j):a==="insideBottomLeft"?Se({x:s+g,y:o+d-h,textAnchor:b,verticalAnchor:f},j):a==="insideBottomRight"?Se({x:s+l-g,y:o+d-h,textAnchor:y,verticalAnchor:f},j):a&&typeof a=="object"&&(q(a.x)||Hr(a.x))&&(q(a.y)||Hr(a.y))?Se({x:s+Ye(a.x,l),y:o+Ye(a.y,d),textAnchor:"end",verticalAnchor:"end"},j):Se({x:s+l/2,y:o+d/2,textAnchor:"middle",verticalAnchor:"middle"},j)},QC={offset:5};function pr(t){var e=Ce(t,QC),{viewBox:r,position:n,value:a,children:i,content:s,className:o="",textBreakAll:l,labelRef:d}=e,c=VC(),h=Ax(),f=n==="center"?h:c??h,m=r||f;if(!m||le(a)&&le(i)&&!v.isValidElement(s)&&typeof s!="function")return null;var p=Se(Se({},e),{},{viewBox:m});if(v.isValidElement(s)){var{labelRef:g}=p,y=UC(p,BC);return v.cloneElement(s,y)}var b;if(typeof s=="function"){if(b=v.createElement(s,p),v.isValidElement(b))return b}else b=GC(e);var x=Ex(m),w=ye(e,!0);if(x&&(n==="insideStart"||n==="insideEnd"||n==="end"))return JC(e,n,b,w,m);var _=x?XC(m,e.offset,e.position):ZC(e,m);return v.createElement(ho,Ht({ref:d,className:ee("recharts-label",o)},w,_,{breakAll:l}),b)}pr.displayName="Label";var eI=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?v.createElement(pr,Ht({key:"label-implicit"},n)):Dt(t)?v.createElement(pr,Ht({key:"label-implicit",value:t},n)):v.isValidElement(t)?t.type===pr?v.cloneElement(t,Se({key:"label-implicit"},n)):v.createElement(pr,Ht({key:"label-implicit",content:t},n)):oh(t)?v.createElement(pr,Ht({key:"label-implicit",content:t},n)):t&&typeof t=="object"?v.createElement(pr,Ht({},t,{key:"label-implicit"},n)):null};function tI(t){var{label:e}=t,r=Ax();return eI(e,r)||null}var nc={},ac={},M0;function rI(){return M0||(M0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(ac)),ac}var ic={},O0;function nI(){return O0||(O0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(ic)),ic}var A0;function aI(){return A0||(A0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=rI(),r=nI(),n=Wu();function a(i){if(n.isArrayLike(i))return e.last(r.toArray(i))}t.last=a})(nc)),nc}var sc,E0;function iI(){return E0||(E0=1,sc=aI().last),sc}var sI=iI();const oI=rr(sI);var lI=["valueAccessor"],cI=["dataKey","clockWise","id","textBreakAll"];function gs(){return gs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gs.apply(null,arguments)}function T0(t,e){if(t==null)return{};var r,n,a=uI(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function uI(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var dI=t=>Array.isArray(t.value)?oI(t.value):t.value,Tx=v.createContext(void 0),lh=Tx.Provider,Cx=v.createContext(void 0),hI=Cx.Provider;function fI(){return v.useContext(Tx)}function mI(){return v.useContext(Cx)}function Ii(t){var{valueAccessor:e=dI}=t,r=T0(t,lI),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,o=T0(r,cI),l=fI(),d=mI(),c=l||d;return!c||!c.length?null:v.createElement(_e,{className:"recharts-label-list"},c.map((h,f)=>{var m,p=le(n)?e(h,f):ie(h&&h.payload,n),g=le(i)?{}:{id:"".concat(i,"-").concat(f)};return v.createElement(pr,gs({},ye(h,!0),o,g,{fill:(m=r.fill)!==null&&m!==void 0?m:h.fill,parentViewBox:h.parentViewBox,value:p,textBreakAll:s,viewBox:h.viewBox,key:"label-".concat(f),index:f}))}))}Ii.displayName="LabelList";function fo(t){var{label:e}=t;return e?e===!0?v.createElement(Ii,{key:"labelList-implicit"}):v.isValidElement(e)||oh(e)?v.createElement(Ii,{key:"labelList-implicit",content:e}):typeof e=="object"?v.createElement(Ii,gs({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}function fu(){return fu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fu.apply(null,arguments)}var Ix=t=>{var{cx:e,cy:r,r:n,className:a}=t,i=ee("recharts-dot",a);return e===+e&&r===+r&&n===+n?v.createElement("circle",fu({},jt(t),Du(t),{className:i,cx:e,cy:r,r:n})):null},Dx=t=>t.graphicalItems.polarItems,pI=A([xe,Za],$d),ch=A([Dx,Pe,pI],Rd),gI=A([ch],Ld),uh=A([gI,Nd],Bd),vI=A([uh,Pe,ch],Fd),yI=A([uh,Pe,ch],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var i,s=ie(n,(i=e.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):e?.dataKey!=null?t.map(n=>({value:ie(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]}))),C0=()=>{},bI=A([Pe,Bb,C0,yI,C0,Q,xe],qd),$x=A([Pe,Q,uh,vI,Xa,xe,bI],zd),xI=A([$x,Pe,ea],Vd);A([Pe,$x,xI,xe],Yd);var wI={radiusAxis:{},angleAxis:{}},Rx=ft({name:"polarAxis",initialState:wI,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:e6,removeRadiusAxis:t6,addAngleAxis:r6,removeAngleAxis:n6}=Rx.actions,_I=Rx.reducer;function I0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function D0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?I0(Object(r),!0).forEach(function(n){jI(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jI(t,e,r){return(e=SI(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SI(t){var e=NI(t,"string");return typeof e=="symbol"?e:e+""}function NI(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PI=(t,e)=>e,dh=A([Dx,PI],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),kI=[],hh=(t,e,r)=>r?.length===0?kI:r,Lx=A([Nd,dh,hh],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if(e?.data!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>D0(D0({},e.presentationProps),i.props))),a!=null)return a}}),MI=A([Lx,dh,hh],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var i,s=ie(n,e.nameKey,e.name),o;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=e.fill,{value:Er(s,e.dataKey),color:o,payload:n,type:e.legendType}})}),OI=A([Lx,dh,hh,Te],(t,e,r,n)=>{if(!(e==null||t==null))return PD({offset:n,pieSettings:e,displayedData:t,cells:r})}),oc={},$0;function AI(){return $0||($0=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(oc)),oc}var lc,R0;function EI(){return R0||(R0=1,lc=AI().isPlainObject),lc}var TI=EI();const CI=rr(TI);function L0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function B0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?L0(Object(r),!0).forEach(function(n){II(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):L0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function II(t,e,r){return(e=DI(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DI(t){var e=$I(t,"string");return typeof e=="symbol"?e:e+""}function $I(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vs(){return vs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vs.apply(null,arguments)}var U0=(t,e,r,n,a)=>{var i=r-n,s;return s="M ".concat(t,",").concat(e),s+="L ".concat(t+r,",").concat(e),s+="L ".concat(t+r-i/2,",").concat(e+a),s+="L ".concat(t+r-i/2-n,",").concat(e+a),s+="L ".concat(t,",").concat(e," Z"),s},RI={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},LI=t=>{var e=Ce(t,RI),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:o}=e,{animationEasing:l,animationDuration:d,animationBegin:c,isUpdateAnimationActive:h}=e,f=v.useRef(),[m,p]=v.useState(-1),g=v.useRef(a),y=v.useRef(i),b=v.useRef(s),x=v.useRef(r),w=v.useRef(n),_=Gn(t,"trapezoid-");if(v.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var I=f.current.getTotalLength();I&&p(I)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var S=ee("recharts-trapezoid",o);if(!h)return v.createElement("g",null,v.createElement("path",vs({},ye(e,!0),{className:S,d:U0(r,n,a,i,s)})));var j=g.current,N=y.current,M=b.current,O=x.current,T=w.current,P="0px ".concat(m===-1?1:m,"px"),k="".concat(m,"px 0px"),D=cy(["strokeDasharray"],d,l);return v.createElement(Vn,{animationId:_,key:_,canBegin:m>0,duration:d,easing:l,isActive:h,begin:c},I=>{var z=we(j,a,I),H=we(N,i,I),K=we(M,s,I),X=we(O,r,I),B=we(T,n,I);f.current&&(g.current=z,y.current=H,b.current=K,x.current=X,w.current=B);var R=I>0?{transition:D,strokeDasharray:k}:{strokeDasharray:P};return v.createElement("path",vs({},ye(e,!0),{className:S,d:U0(X,B,z,H,K),ref:f,style:B0(B0({},R),e.style)}))})},BI=["option","shapeType","propTransformer","activeClassName","isActive"];function UI(t,e){if(t==null)return{};var r,n,a=FI(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function FI(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function F0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F0(Object(r),!0).forEach(function(n){WI(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WI(t,e,r){return(e=qI(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qI(t){var e=zI(t,"string");return typeof e=="symbol"?e:e+""}function zI(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KI(t,e){return ys(ys({},e),t)}function HI(t,e){return t==="symbols"}function W0(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return v.createElement(fy,r);case"trapezoid":return v.createElement(LI,r);case"sector":return v.createElement(gy,r);case"symbols":if(HI(e))return v.createElement(Is,r);break;default:return null}}function VI(t){return v.isValidElement(t)?t.props:t}function bs(t){var{option:e,shapeType:r,propTransformer:n=KI,activeClassName:a="recharts-active-shape",isActive:i}=t,s=UI(t,BI),o;if(v.isValidElement(e))o=v.cloneElement(e,ys(ys({},s),VI(e)));else if(typeof e=="function")o=e(s);else if(CI(e)&&typeof e!="boolean"){var l=n(e,s);o=v.createElement(W0,{shapeType:r,elementProps:l})}else{var d=s;o=v.createElement(W0,{shapeType:r,elementProps:d})}return i?v.createElement(_e,{className:a},o):o}var mo=(t,e)=>{var r=be();return(n,a)=>i=>{t?.(n,a,i),r(tx({activeIndex:String(a),activeDataKey:e,activeCoordinate:n.tooltipPosition}))}},po=t=>{var e=be();return(r,n)=>a=>{t?.(r,n,a),e(O2())}},go=(t,e)=>{var r=be();return(n,a)=>i=>{t?.(n,a,i),r(A2({activeIndex:String(a),activeDataKey:e,activeCoordinate:n.tooltipPosition}))}};function vo(t){var{fn:e,args:r}=t,n=be(),a=Je();return v.useEffect(()=>{if(!a){var i=e(r);return n(P2(i)),()=>{n(k2(i))}}},[e,r,n,a]),null}var Bx=()=>{};function fh(t){var{legendPayload:e}=t,r=be(),n=Je();return v.useEffect(()=>n?Bx:(r(sy(e)),()=>{r(oy(e))}),[r,n,e]),null}function GI(t){var{legendPayload:e}=t,r=be(),n=F(Q);return v.useEffect(()=>n!=="centric"&&n!=="radial"?Bx:(r(sy(e)),()=>{r(oy(e))}),[r,n,e]),null}var cc,YI=()=>{var[t]=v.useState(()=>Aa("uid-"));return t},JI=(cc=Nw.useId)!==null&&cc!==void 0?cc:YI;function XI(t,e){var r=JI();return e||(t?"".concat(t,"-").concat(r):r)}var ZI=v.createContext(void 0),yo=t=>{var{id:e,type:r,children:n}=t,a=XI("recharts-".concat(r),e);return v.createElement(ZI.Provider,{value:a},n(a))},QI={cartesianItems:[],polarItems:[]},Ux=ft({name:"graphicalItems",initialState:QI,reducers:{addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:r,next:n}=e.payload,a=Yt(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},removeCartesianGraphicalItem(t,e){var r=Yt(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var r=Yt(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:eD,replaceCartesianGraphicalItem:tD,removeCartesianGraphicalItem:rD,addPolarGraphicalItem:nD,removePolarGraphicalItem:aD}=Ux.actions,iD=Ux.reducer;function mh(t){var e=be(),r=v.useRef(null);return v.useEffect(()=>{r.current===null?e(eD(t)):r.current!==t&&e(tD({prev:r.current,next:t})),r.current=t},[e,t]),v.useEffect(()=>()=>{r.current&&(e(rD(r.current)),r.current=null)},[e]),null}function sD(t){var e=be();return v.useEffect(()=>(e(nD(t)),()=>{e(aD(t))}),[e,t]),null}var oD=["onMouseEnter","onClick","onMouseLeave"],lD=["id"],cD=["id"];function ph(t,e){if(t==null)return{};var r,n,a=uD(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function uD(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function q0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ge(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?q0(Object(r),!0).forEach(function(n){dD(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):q0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dD(t,e,r){return(e=hD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hD(t){var e=fD(t,"string");return typeof e=="symbol"?e:e+""}function fD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kr(){return kr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kr.apply(null,arguments)}function mD(t){var e=v.useMemo(()=>As(t.children,hn),[t.children]),r=F(n=>MI(n,t.id,e));return r==null?null:v.createElement(GI,{legendPayload:r})}function pD(t){var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:l,tooltipType:d}=t;return{dataDefinedOnItem:n.map(c=>c.tooltipPayload),positions:n.map(c=>c.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:e,nameKey:r,name:Er(o,e),hide:l,type:d,color:s,unit:""}}}var gD=(t,e)=>t>e?"start":t<e?"end":"middle",vD=(t,e,r)=>Ye(typeof e=="function"?e(t):e,r,r*.8),yD=(t,e,r)=>{var{top:n,left:a,width:i,height:s}=e,o=Qv(i,s),l=a+Ye(t.cx,i,i/2),d=n+Ye(t.cy,s,s/2),c=Ye(t.innerRadius,o,0),h=vD(r,t.outerRadius,o),f=t.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:l,cy:d,innerRadius:c,outerRadius:h,maxRadius:f}},bD=(t,e)=>{var r=Be(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function xD(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var wD=(t,e)=>{if(v.isValidElement(t))return v.cloneElement(t,e);if(typeof t=="function")return t(e);var r=ee("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return v.createElement(Gs,kr({},e,{type:"linear",className:r}))},_D=(t,e,r)=>{if(v.isValidElement(t))return v.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),v.isValidElement(n)))return n;var a=ee("recharts-pie-label-text",xD(t));return v.createElement(ho,kr({},e,{alignmentBaseline:"middle",className:a}),n)};function jD(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!e)return null;var o=jt(r),l=ye(a,!1),d=ye(i,!1),c=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,h=e.map((f,m)=>{var p=(f.startAngle+f.endAngle)/2,g=ke(f.cx,f.cy,f.outerRadius+c,p),y=ge(ge(ge(ge({},o),f),{},{stroke:"none"},l),{},{index:m,textAnchor:gD(g.x,f.cx)},g),b=ge(ge(ge(ge({},o),f),{},{fill:"none",stroke:f.fill},d),{},{index:m,points:[ke(f.cx,f.cy,f.outerRadius,p),g],key:"line"});return v.createElement(_e,{key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(m)},i&&wD(i,b),_D(a,y,ie(f,s)))});return v.createElement(_e,{className:"recharts-pie-labels"},h)}function SD(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?v.createElement(fo,{label:a}):v.createElement(jD,{sectors:e,props:r,showLabels:n})}function ND(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a}=t,i=F(tr),{onMouseEnter:s,onClick:o,onMouseLeave:l}=a,d=ph(a,oD),c=mo(s,a.dataKey),h=po(l),f=go(o,a.dataKey);return e==null||e.length===0?null:v.createElement(v.Fragment,null,e.map((m,p)=>{if(m?.startAngle===0&&m?.endAngle===0&&e.length!==1)return null;var g=r&&String(p)===i,y=i?n:null,b=g?r:y,x=ge(ge({},m),{},{stroke:m.stroke,tabIndex:-1,[Ju]:p,[Xu]:a.dataKey});return v.createElement(_e,kr({tabIndex:-1,className:"recharts-pie-sector"},Hn(d,m,p),{onMouseEnter:c(m,p),onMouseLeave:h(m,p),onClick:f(m,p),key:"sector-".concat(m?.startAngle,"-").concat(m?.endAngle,"-").concat(m.midAngle,"-").concat(p)}),v.createElement(bs,kr({option:b,isActive:g,shapeType:"sector"},x)))}))}function PD(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:i}=t,{cornerRadius:s,startAngle:o,endAngle:l,dataKey:d,nameKey:c,tooltipType:h}=r,f=Math.abs(r.minAngle),m=bD(o,l),p=Math.abs(m),g=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,y=n.filter(j=>ie(j,d,0)!==0).length,b=(p>=360?y:y-1)*g,x=p-y*f-b,w=n.reduce((j,N)=>{var M=ie(N,d,0);return j+(q(M)?M:0)},0),_;if(w>0){var S;_=n.map((j,N)=>{var M=ie(j,d,0),O=ie(j,c,N),T=yD(r,i,j),P=(q(M)?M:0)/w,k,D=ge(ge({},j),a&&a[N]&&a[N].props);N?k=S.endAngle+Be(m)*g*(M!==0?1:0):k=o;var I=k+Be(m)*((M!==0?f:0)+P*x),z=(k+I)/2,H=(T.innerRadius+T.outerRadius)/2,K=[{name:O,value:M,payload:D,dataKey:d,type:h}],X=ke(T.cx,T.cy,H,z);return S=ge(ge(ge(ge({},r.presentationProps),{},{percent:P,cornerRadius:s,name:O,tooltipPayload:K,midAngle:z,middleRadius:H,tooltipPosition:X},D),T),{},{value:M,startAngle:k,endAngle:I,payload:D,paddingAngle:Be(m)*g}),S})}return _}function kD(t){var{showLabels:e,sectors:r,children:n}=t,a=v.useMemo(()=>!e||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,e]);return v.createElement(hI,{value:e?a:void 0},n)}function MD(t){var{props:e,previousSectorsRef:r}=t,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o,activeShape:l,inactiveShape:d,onAnimationStart:c,onAnimationEnd:h}=e,f=Gn(e,"recharts-pie-"),m=r.current,[p,g]=v.useState(!1),y=v.useCallback(()=>{typeof h=="function"&&h(),g(!1)},[h]),b=v.useCallback(()=>{typeof c=="function"&&c(),g(!0)},[c]);return v.createElement(kD,{showLabels:!p,sectors:n},v.createElement(Vn,{animationId:f,begin:i,duration:s,isActive:a,easing:o,onAnimationStart:b,onAnimationEnd:y,key:f},x=>{var w=[],_=n&&n[0],S=_?.startAngle;return n?.forEach((j,N)=>{var M=m&&m[N],O=N>0?en(j,"paddingAngle",0):0;if(M){var T=we(M.endAngle-M.startAngle,j.endAngle-j.startAngle,x),P=ge(ge({},j),{},{startAngle:S+O,endAngle:S+T+O});w.push(P),S=P.endAngle}else{var{endAngle:k,startAngle:D}=j,I=we(0,k-D,x),z=ge(ge({},j),{},{startAngle:S+O,endAngle:S+I+O});w.push(z),S=z.endAngle}}),r.current=w,v.createElement(_e,null,v.createElement(ND,{sectors:w,activeShape:l,inactiveShape:d,allOtherPieProps:e}))}),v.createElement(SD,{showLabels:!p,sectors:n,props:e}),e.children)}var OD={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!ir.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function AD(t){var{id:e}=t,r=ph(t,lD),{hide:n,className:a,rootTabIndex:i}=t,s=v.useMemo(()=>As(t.children,hn),[t.children]),o=F(c=>OI(c,e,s)),l=v.useRef(null),d=ee("recharts-pie",a);return n||o==null?(l.current=null,v.createElement(_e,{tabIndex:i,className:d})):v.createElement(v.Fragment,null,v.createElement(vo,{fn:pD,args:ge(ge({},t),{},{sectors:o})}),v.createElement(_e,{tabIndex:i,className:d},v.createElement(MD,{props:ge(ge({},r),{},{sectors:o}),previousSectorsRef:l})))}function Fx(t){var e=Ce(t,OD),{id:r}=e,n=ph(e,cD),a=jt(n);return v.createElement(yo,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(sD,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),v.createElement(mD,kr({},n,{id:i})),v.createElement(AD,kr({},n,{id:i}))))}Fx.displayName="Pie";function z0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function K0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?z0(Object(r),!0).forEach(function(n){ED(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):z0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ED(t,e,r){return(e=TD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TD(t){var e=CD(t,"string");return typeof e=="symbol"?e:e+""}function CD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ID={xAxis:{},yAxis:{},zAxis:{}},Wx=ft({name:"cartesianAxis",initialState:ID,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload;t.yAxis[r]&&(t.yAxis[r]=K0(K0({},t.yAxis[r]),{},{width:n}))}}}),{addXAxis:DD,removeXAxis:$D,addYAxis:RD,removeYAxis:LD,addZAxis:BD,removeZAxis:UD,updateYAxisWidth:FD}=Wx.actions,WD=Wx.reducer,qD=A([Te],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),zD=A([qD,nr,ar],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),gh=()=>F(zD),KD=()=>F(gT);function H0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function V0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?H0(Object(r),!0).forEach(function(n){HD(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HD(t,e,r){return(e=VD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VD(t){var e=GD(t,"string");return typeof e=="symbol"?e:e+""}function GD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YD=t=>{var{point:e,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=t;if(a===!1||e.x==null||e.y==null)return null;var s=V0(V0({index:r,dataKey:i,cx:e.x,cy:e.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},ye(a,!1)),Du(a)),o;return v.isValidElement(a)?o=v.cloneElement(a,s):typeof a=="function"?o=a(s):o=v.createElement(Ix,s),v.createElement(_e,{className:"recharts-active-dot"},o)};function JD(t){var{points:e,mainColor:r,activeDot:n,itemDataKey:a}=t,i=F(tr),s=KD();if(e==null||s==null)return null;var o=e.find(l=>s.includes(l.payload));return le(o)?null:YD({point:o,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var XD="Invariant failed";function ZD(t,e){throw new Error(XD)}var QD=["x","y"];function mu(){return mu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mu.apply(null,arguments)}function G0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ma(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G0(Object(r),!0).forEach(function(n){e$(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function e$(t,e,r){return(e=t$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t$(t){var e=r$(t,"string");return typeof e=="symbol"?e:e+""}function r$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function n$(t,e){if(t==null)return{};var r,n,a=a$(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function a$(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function i$(t,e){var{x:r,y:n}=t,a=n$(t,QD),i="".concat(r),s=parseInt(i,10),o="".concat(n),l=parseInt(o,10),d="".concat(e.height||a.height),c=parseInt(d,10),h="".concat(e.width||a.width),f=parseInt(h,10);return ma(ma(ma(ma(ma({},e),a),s?{x:s}:{}),l?{y:l}:{}),{},{height:c,width:f,name:e.name,radius:e.radius})}function vh(t){return v.createElement(bs,mu({shapeType:"rectangle",propTransformer:i$,activeClassName:"recharts-active-bar"},t))}var s$=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(q(e))return e;var i=q(n)||le(n);return i?e(n,a):(i||ZD(),r)}},o$={},qx=ft({name:"errorBars",initialState:o$,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:a6,replaceErrorBar:i6,removeErrorBar:s6}=qx.actions,l$=qx.reducer,c$=["children"];function u$(t,e){if(t==null)return{};var r,n,a=d$(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function d$(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var h$={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},f$=v.createContext(h$);function yh(t){var{children:e}=t,r=u$(t,c$);return v.createElement(f$.Provider,{value:r},e)}function bo(t,e){var r,n,a=F(d=>or(d,t)),i=F(d=>lr(d,e)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:at.allowDataOverflow,o=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:it.allowDataOverflow,l=s||o;return{needClip:l,needClipX:s,needClipY:o}}function bh(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=gh(),{needClipX:i,needClipY:s,needClip:o}=bo(e,r);if(!o)return null;var{x:l,y:d,width:c,height:h}=a;return v.createElement("clipPath",{id:"clipPath-".concat(n)},v.createElement("rect",{x:i?l:l-c/2,y:s?d:d-h/2,width:i?c:c*2,height:s?h:h*2}))}var m$=["onMouseEnter","onMouseLeave","onClick"],p$=["value","background","tooltipPosition"],g$=["id"],v$=["onMouseEnter","onClick","onMouseLeave"];function Mr(){return Mr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mr.apply(null,arguments)}function Y0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function et(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Y0(Object(r),!0).forEach(function(n){y$(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Y0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function y$(t,e,r){return(e=b$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b$(t){var e=x$(t,"string");return typeof e=="symbol"?e:e+""}function x$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xs(t,e){if(t==null)return{};var r,n,a=w$(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function w$(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _$=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:i}=t;return[{inactive:i,dataKey:e,type:a,color:n,value:Er(r,e),payload:t}]};function j$(t){var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:o}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:Er(i,e),hide:s,type:t.tooltipType,color:t.fill,unit:o}}}function S$(t){var e=F(tr),{data:r,dataKey:n,background:a,allOtherBarProps:i}=t,{onMouseEnter:s,onMouseLeave:o,onClick:l}=i,d=xs(i,m$),c=mo(s,n),h=po(o),f=go(l,n);if(!a||r==null)return null;var m=ye(a,!1);return v.createElement(v.Fragment,null,r.map((p,g)=>{var{value:y,background:b,tooltipPosition:x}=p,w=xs(p,p$);if(!b)return null;var _=c(p,g),S=h(p,g),j=f(p,g),N=et(et(et(et(et({option:a,isActive:String(g)===e},w),{},{fill:"#eee"},b),m),Hn(d,p,g)),{},{onMouseEnter:_,onMouseLeave:S,onClick:j,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return v.createElement(vh,Mr({key:"background-bar-".concat(N.index)},N))}))}function N$(t){var{showLabels:e,children:r,rects:n}=t,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return et(et({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return v.createElement(lh,{value:e?a:void 0},r)}function P$(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=t,o=F(tr),l=F(mx),d=r&&String(i)===o&&(l==null||s===l),c=d?r:e;return v.createElement(vh,Mr({},n,a,{isActive:d,option:c,index:i,dataKey:s}))}function k$(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:i}=t;return v.createElement(vh,Mr({},r,n,{isActive:!1,option:e,index:a,dataKey:i}))}function M$(t){var{data:e,props:r}=t,n=jt(r),{id:a}=n,i=xs(n,g$),{shape:s,dataKey:o,activeBar:l}=r,{onMouseEnter:d,onClick:c,onMouseLeave:h}=r,f=xs(r,v$),m=mo(d,o),p=po(h),g=go(c,o);return e?v.createElement(v.Fragment,null,e.map((y,b)=>v.createElement(_e,Mr({className:"recharts-bar-rectangle"},Hn(f,y,b),{onMouseEnter:m(y,b),onMouseLeave:p(y,b),onClick:g(y,b),key:"rectangle-".concat(y?.x,"-").concat(y?.y,"-").concat(y?.value,"-").concat(b)}),l?v.createElement(P$,{shape:s,activeBar:l,baseProps:i,entry:y,index:b,dataKey:o}):v.createElement(k$,{shape:s,baseProps:i,entry:y,index:b,dataKey:o})))):null}function O$(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l,onAnimationEnd:d,onAnimationStart:c}=e,h=r.current,f=Gn(e,"recharts-bar-"),[m,p]=v.useState(!1),g=!m,y=v.useCallback(()=>{typeof d=="function"&&d(),p(!1)},[d]),b=v.useCallback(()=>{typeof c=="function"&&c(),p(!0)},[c]);return v.createElement(N$,{showLabels:g,rects:n},v.createElement(Vn,{animationId:f,begin:s,duration:o,isActive:i,easing:l,onAnimationEnd:y,onAnimationStart:b,key:f},x=>{var w=x===1?n:n?.map((_,S)=>{var j=h&&h[S];if(j)return et(et({},_),{},{x:we(j.x,_.x,x),y:we(j.y,_.y,x),width:we(j.width,_.width,x),height:we(j.height,_.height,x)});if(a==="horizontal"){var N=we(0,_.height,x);return et(et({},_),{},{y:_.y+_.height-N,height:N})}var M=we(0,_.width,x);return et(et({},_),{},{width:M})});return x>0&&(r.current=w??null),w==null?null:v.createElement(_e,null,v.createElement(M$,{props:e,data:w}))}),v.createElement(fo,{label:e.label}),e.children)}function A$(t){var e=v.useRef(null);return v.createElement(O$,{previousRectanglesRef:e,props:t})}var zx=0,E$=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:ie(t,e)}};class T$ extends v.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:o,background:l,id:d}=this.props;if(e||r==null)return null;var c=ee("recharts-bar",a),h=d;return v.createElement(_e,{className:c,id:d},o&&v.createElement("defs",null,v.createElement(bh,{clipPathId:h,xAxisId:i,yAxisId:s})),v.createElement(_e,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(h,")"):void 0},v.createElement(S$,{data:r,dataKey:n,background:l,allOtherBarProps:this.props}),v.createElement(A$,this.props)))}}var C$={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!ir.isSsr,legendType:"rect",minPointSize:zx,xAxisId:0,yAxisId:0};function I$(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:l,animationEasing:d,isAnimationActive:c}=t,{needClip:h}=bo(e,r),f=Hs(),m=Je(),p=As(t.children,hn),g=F(x=>l5(x,e,r,m,t.id,p));if(f!=="vertical"&&f!=="horizontal")return null;var y,b=g?.[0];return b==null||b.height==null||b.width==null?y=0:y=f==="vertical"?b.height/2:b.width/2,v.createElement(yh,{xAxisId:e,yAxisId:r,data:g,dataPointFormatter:E$,errorBarOffset:y},v.createElement(T$,Mr({},t,{layout:f,needClip:h,data:g,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:l,animationEasing:d,isAnimationActive:c})))}function D$(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:o,xAxisTicks:l,yAxisTicks:d,stackedData:c,displayedData:h,offset:f,cells:m,parentViewBox:p}=t,g=e==="horizontal"?o:s,y=c?g.scale.domain():null,b=KP({numericAxis:g});return h.map((x,w)=>{var _,S,j,N,M,O;c?_=BP(c[w],y):(_=ie(x,r),Array.isArray(_)||(_=[b,_]));var T=s$(n,zx)(_[1],w);if(e==="horizontal"){var P,[k,D]=[o.scale(_[0]),o.scale(_[1])];S=Im({axis:s,ticks:l,bandSize:i,offset:a.offset,entry:x,index:w}),j=(P=D??k)!==null&&P!==void 0?P:void 0,N=a.size;var I=k-D;if(M=ut(I)?0:I,O={x:S,y:f.top,width:N,height:f.height},Math.abs(T)>0&&Math.abs(M)<Math.abs(T)){var z=Be(M||T)*(Math.abs(T)-Math.abs(M));j-=z,M+=z}}else{var[H,K]=[s.scale(_[0]),s.scale(_[1])];if(S=H,j=Im({axis:o,ticks:d,bandSize:i,offset:a.offset,entry:x,index:w}),N=K-H,M=a.size,O={x:f.left,y:j,width:f.width,height:M},Math.abs(T)>0&&Math.abs(N)<Math.abs(T)){var X=Be(N||T)*(Math.abs(T)-Math.abs(N));N+=X}}if(S==null||j==null||N==null||M==null)return null;var B=et(et({},x),{},{x:S,y:j,width:N,height:M,value:c?_:_[1],payload:x,background:O,tooltipPosition:{x:S+N/2,y:j+M/2},parentViewBox:p},m&&m[w]&&m[w].props);return B}).filter(Boolean)}function $$(t){var e=Ce(t,C$),r=Je();return v.createElement(yo,{id:e.id,type:"bar"},n=>v.createElement(v.Fragment,null,v.createElement(fh,{legendPayload:_$(e)}),v.createElement(vo,{fn:j$,args:e}),v.createElement(mh,{type:"bar",id:n,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:zP(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:r}),v.createElement(I$,Mr({},e,{id:n}))))}var Mn=v.memo($$);Mn.displayName="Bar";function J0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Oi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?J0(Object(r),!0).forEach(function(n){R$(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function R$(t,e,r){return(e=L$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L$(t){var e=B$(t,"string");return typeof e=="symbol"?e:e+""}function B$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var U$=(t,e)=>e,F$=(t,e,r)=>r,W$=(t,e,r,n)=>n,q$=(t,e,r,n,a)=>a,ii=A([ei,q$],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),z$=A([ii],t=>t?.maxBarSize),K$=(t,e,r,n,a,i)=>i,X0=(t,e,r)=>{var n=r??t;if(!le(n))return Ye(n,e,0)},H$=A([Q,ei,U$,F$,W$],(t,e,r,n,a)=>e.filter(i=>t==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),V$=(t,e,r,n)=>{var a=Q(t);return a==="horizontal"?ou(t,"yAxis",r,n):ou(t,"xAxis",e,n)},G$=(t,e,r)=>{var n=Q(t);return n==="horizontal"?Xp(t,"xAxis",e):Xp(t,"yAxis",r)},Y$=(t,e,r)=>{var n={},a=t.filter(ao),i=t.filter(d=>d.stackId==null),s=a.reduce((d,c)=>(d[c.stackId]||(d[c.stackId]=[]),d[c.stackId].push(c),d),n),o=Object.entries(s).map(d=>{var[c,h]=d,f=h.map(p=>p.dataKey),m=X0(e,r,h[0].barSize);return{stackId:c,dataKeys:f,barSize:m}}),l=i.map(d=>{var c=[d.dataKey].filter(f=>f!=null),h=X0(e,r,d.barSize);return{stackId:void 0,dataKeys:c,barSize:h}});return[...o,...l]},J$=A([H$,NE,G$],Y$),X$=(t,e,r,n,a)=>{var i,s,o=ii(t,e,r,n,a);if(o!=null){var l=Q(t),d=hb(t),{maxBarSize:c}=o,h=le(c)?d:c,f,m;return l==="horizontal"?(f=Lt(t,"xAxis",e,n),m=Rt(t,"xAxis",e,n)):(f=Lt(t,"yAxis",r,n),m=Rt(t,"yAxis",r,n)),(i=(s=Ca(f,m,!0))!==null&&s!==void 0?s:h)!==null&&i!==void 0?i:0}},Kx=(t,e,r,n)=>{var a=Q(t),i,s;return a==="horizontal"?(i=Lt(t,"xAxis",e,n),s=Rt(t,"xAxis",e,n)):(i=Lt(t,"yAxis",r,n),s=Rt(t,"yAxis",r,n)),Ca(i,s)};function Z$(t,e,r,n,a){var i=n.length;if(!(i<1)){var s=Ye(t,r,0,!0),o,l=[];if(ht(n[0].barSize)){var d=!1,c=r/i,h=n.reduce((b,x)=>b+(x.barSize||0),0);h+=(i-1)*s,h>=r&&(h-=(i-1)*s,s=0),h>=r&&c>0&&(d=!0,c*=.9,h=i*c);var f=(r-h)/2>>0,m={offset:f-s,size:0};o=n.reduce((b,x)=>{var w,_={stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:m.offset+m.size+s,size:d?c:(w=x.barSize)!==null&&w!==void 0?w:0}},S=[...b,_];return m=S[S.length-1].position,S},l)}else{var p=Ye(e,r,0,!0);r-2*p-(i-1)*s<=0&&(s=0);var g=(r-2*p-(i-1)*s)/i;g>1&&(g>>=0);var y=ht(a)?Math.min(g,a):g;o=n.reduce((b,x,w)=>[...b,{stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:p+(g+s)*w+(g-y)/2,size:y}}],l)}return o}}var Q$=(t,e,r,n,a,i,s)=>{var o=le(s)?e:s,l=Z$(r,n,a!==i?a:i,t,o);return a!==i&&l!=null&&(l=l.map(d=>Oi(Oi({},d),{},{position:Oi(Oi({},d.position),{},{offset:d.position.offset-a/2})}))),l},e5=A([J$,hb,SE,fb,X$,Kx,z$],Q$),t5=(t,e,r,n)=>Lt(t,"xAxis",e,n),r5=(t,e,r,n)=>Lt(t,"yAxis",r,n),n5=(t,e,r,n)=>Rt(t,"xAxis",e,n),a5=(t,e,r,n)=>Rt(t,"yAxis",r,n),i5=A([e5,ii],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),s5=(t,e)=>{var r=Id(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},o5=A([V$,ii],s5),l5=A([Te,Zu,t5,r5,n5,a5,i5,Q,Ja,Kx,o5,ii,K$],(t,e,r,n,a,i,s,o,l,d,c,h,f)=>{var{chartData:m,dataStartIndex:p,dataEndIndex:g}=l;if(!(h==null||s==null||e==null||o!=="horizontal"&&o!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:y}=h,b;if(y!=null&&y.length>0?b=y:b=m?.slice(p,g+1),b!=null)return D$({layout:o,barSettings:h,pos:s,parentViewBox:e,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:c,displayedData:b,offset:t,cells:f})}}),Hx=t=>{var{chartData:e}=t,r=be(),n=Je();return v.useEffect(()=>n?()=>{}:(r(o0(e)),()=>{r(o0(void 0))}),[e,r,n]),null},Z0={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Vx=ft({name:"brush",initialState:Z0,reducers:{setBrushSettings(t,e){return e.payload==null?Z0:e.payload}}}),{setBrushSettings:o6}=Vx.actions,c5=Vx.reducer;function u5(t,e,r){return(e=d5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d5(t){var e=h5(t,"string");return typeof e=="symbol"?e:e+""}function h5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xh{static create(e){return new xh(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(e)+i}default:return this.scale(e)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}u5(xh,"EPS",1e-4);function f5(t){return(t%180+180)%180}var m5=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=f5(a),s=i*Math.PI/180,o=Math.atan(n/r),l=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(l)},p5={dots:[],areas:[],lines:[]},Gx=ft({name:"referenceElements",initialState:p5,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Yt(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Yt(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Yt(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:l6,removeDot:c6,addArea:u6,removeArea:d6,addLine:h6,removeLine:f6}=Gx.actions,g5=Gx.reducer,v5=v.createContext(void 0),y5=t=>{var{children:e}=t,[r]=v.useState("".concat(Aa("recharts"),"-clip")),n=gh();if(n==null)return null;var{x:a,y:i,width:s,height:o}=n;return v.createElement(v5.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:a,y:i,height:o,width:s}))),e)};function qn(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function Yx(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],a=0;a<t.length;a+=e)n.push(t[a]);return n}function b5(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return m5(n,r)}function x5(t,e,r){var n=r==="width",{x:a,y:i,width:s,height:o}=t;return e===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function ws(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var i=r();return t*(e-t*i/2-n)>=0&&t*(e+t*i/2-a)<=0}function w5(t,e){return Yx(t,e+1)}function _5(t,e,r,n,a){for(var i=(n||[]).slice(),{start:s,end:o}=e,l=0,d=1,c=s,h=function(){var p=n?.[l];if(p===void 0)return{v:Yx(n,d)};var g=l,y,b=()=>(y===void 0&&(y=r(p,g)),y),x=p.coordinate,w=l===0||ws(t,x,b,c,o);w||(l=0,c=s,d+=1),w&&(c=x+t*(b()/2+a),l+=d)},f;d<=i.length;)if(f=h(),f)return f.v;return[]}function Q0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function He(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Q0(Object(r),!0).forEach(function(n){j5(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function j5(t,e,r){return(e=S5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S5(t){var e=N5(t,"string");return typeof e=="symbol"?e:e+""}function N5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function P5(t,e,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:o}=e,{end:l}=e,d=function(f){var m=i[f],p,g=()=>(p===void 0&&(p=r(m,f)),p);if(f===s-1){var y=t*(m.coordinate+t*g()/2-l);i[f]=m=He(He({},m),{},{tickCoord:y>0?m.coordinate-y*t:m.coordinate})}else i[f]=m=He(He({},m),{},{tickCoord:m.coordinate});var b=ws(t,m.tickCoord,g,o,l);b&&(l=m.tickCoord-t*(g()/2+a),i[f]=He(He({},m),{},{isShow:!0}))},c=s-1;c>=0;c--)d(c);return i}function k5(t,e,r,n,a,i){var s=(n||[]).slice(),o=s.length,{start:l,end:d}=e;if(i){var c=n[o-1],h=r(c,o-1),f=t*(c.coordinate+t*h/2-d);s[o-1]=c=He(He({},c),{},{tickCoord:f>0?c.coordinate-f*t:c.coordinate});var m=ws(t,c.tickCoord,()=>h,l,d);m&&(d=c.tickCoord-t*(h/2+a),s[o-1]=He(He({},c),{},{isShow:!0}))}for(var p=i?o-1:o,g=function(x){var w=s[x],_,S=()=>(_===void 0&&(_=r(w,x)),_);if(x===0){var j=t*(w.coordinate-t*S()/2-l);s[x]=w=He(He({},w),{},{tickCoord:j<0?w.coordinate-j*t:w.coordinate})}else s[x]=w=He(He({},w),{},{tickCoord:w.coordinate});var N=ws(t,w.tickCoord,S,l,d);N&&(l=w.tickCoord+t*(S()/2+a),s[x]=He(He({},w),{},{isShow:!0}))},y=0;y<p;y++)g(y);return s}function wh(t,e,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:o,interval:l,tickFormatter:d,unit:c,angle:h}=t;if(!a||!a.length||!n)return[];if(q(l)||ir.isSsr){var f;return(f=w5(a,q(l)?l:0))!==null&&f!==void 0?f:[]}var m=[],p=o==="top"||o==="bottom"?"width":"height",g=c&&p==="width"?Sa(c,{fontSize:e,letterSpacing:r}):{width:0,height:0},y=(w,_)=>{var S=typeof d=="function"?d(w.value,_):w.value;return p==="width"?b5(Sa(S,{fontSize:e,letterSpacing:r}),g,h):Sa(S,{fontSize:e,letterSpacing:r})[p]},b=a.length>=2?Be(a[1].coordinate-a[0].coordinate):1,x=x5(i,b,p);return l==="equidistantPreserveStart"?_5(b,x,y,a,s):(l==="preserveStart"||l==="preserveStartEnd"?m=k5(b,x,y,a,s,l==="preserveStartEnd"):m=P5(b,x,y,a,s),m.filter(w=>w.isShow))}var M5=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=t,s=0;if(e){e.forEach(c=>{if(c){var h=c.getBoundingClientRect();h.width>s&&(s=h.width)}});var o=r?r.getBoundingClientRect().width:0,l=a+i,d=s+l+o+(r?n:0);return Math.round(d)}return 0},O5=["axisLine","width","height","className","hide","ticks"],A5=["viewBox"],E5=["viewBox"];function pu(t,e){if(t==null)return{};var r,n,a=T5(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function T5(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function an(){return an=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},an.apply(null,arguments)}function eg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ee(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eg(Object(r),!0).forEach(function(n){C5(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function C5(t,e,r){return(e=I5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I5(t){var e=D5(t,"string");return typeof e=="symbol"?e:e+""}function D5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _h={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function $5(t){var{x:e,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:o,otherSvgProps:l}=t;if(!o)return null;var d=Ee(Ee(Ee({},l),ye(o,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var c=+(i==="top"&&!s||i==="bottom"&&s);d=Ee(Ee({},d),{},{x1:e,y1:r+c*a,x2:e+n,y2:r+c*a})}else{var h=+(i==="left"&&!s||i==="right"&&s);d=Ee(Ee({},d),{},{x1:e+h*n,y1:r,x2:e+h*n,y2:r+a})}return v.createElement("line",an({},d,{className:ee("recharts-cartesian-axis-line",en(o,"className"))}))}function R5(t,e,r,n,a,i,s,o,l){var d,c,h,f,m,p,g=o?-1:1,y=t.tickSize||s,b=q(t.tickCoord)?t.tickCoord:t.coordinate;switch(i){case"top":d=c=t.coordinate,f=r+ +!o*a,h=f-g*y,p=h-g*l,m=b;break;case"left":h=f=t.coordinate,c=e+ +!o*n,d=c-g*y,m=d-g*l,p=b;break;case"right":h=f=t.coordinate,c=e+ +o*n,d=c+g*y,m=d+g*l,p=b;break;default:d=c=t.coordinate,f=r+ +o*a,h=f+g*y,p=h+g*l,m=b;break}return{line:{x1:d,y1:h,x2:c,y2:f},tick:{x:m,y:p}}}function L5(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function B5(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function U5(t){var{option:e,tickProps:r,value:n}=t,a,i=ee(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(e))a=v.cloneElement(e,Ee(Ee({},r),{},{className:i}));else if(typeof e=="function")a=e(Ee(Ee({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(s=ee(s,e?.className)),a=v.createElement(ho,an({},r,{className:s}),n)}return a}function F5(t){var{ticks:e=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:o,tickTextProps:l,orientation:d,mirror:c,x:h,y:f,width:m,height:p,tickSize:g,tickMargin:y,fontSize:b,letterSpacing:x,getTicksConfig:w,events:_}=t,S=wh(Ee(Ee({},w),{},{ticks:e}),b,x),j=L5(d,c),N=B5(d,c),M=jt(w),O=ye(r,!1),T=Ee(Ee({},M),{},{fill:"none"},ye(n,!1)),P=S.map((k,D)=>{var{line:I,tick:z}=R5(k,h,f,m,p,d,g,c,y),H=Ee(Ee(Ee(Ee({textAnchor:j,verticalAnchor:N},M),{},{stroke:"none",fill:a},O),z),{},{index:D,payload:k,visibleTicksCount:S.length,tickFormatter:i,padding:o},l);return v.createElement(_e,an({className:"recharts-cartesian-axis-tick",key:"tick-".concat(k.value,"-").concat(k.coordinate,"-").concat(k.tickCoord)},Hn(_,k,D)),n&&v.createElement("line",an({},T,I,{className:ee("recharts-cartesian-axis-tick-line",en(n,"className"))})),r&&v.createElement(U5,{option:r,tickProps:H,value:"".concat(typeof i=="function"?i(k.value,D):k.value).concat(s||"")}))});return P.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},P):null}var W5=v.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:o}=t,l=pu(t,O5),[d,c]=v.useState(""),[h,f]=v.useState(""),m=v.useRef([]);v.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var g;return M5({ticks:m.current,label:(g=t.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var p=v.useCallback(g=>{if(g){var y=g.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=Array.from(y);var b=y[0];if(b){var x=window.getComputedStyle(b),w=x.fontSize,_=x.letterSpacing;(w!==d||_!==h)&&(c(w),f(_))}}},[d,h]);return s||n!=null&&n<=0||a!=null&&a<=0?null:v.createElement(_e,{className:ee("recharts-cartesian-axis",i),ref:p},v.createElement($5,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:jt(t)}),v.createElement(F5,{ticks:o,tick:t.tick,tickLine:t.tickLine,stroke:t.stroke,tickFormatter:t.tickFormatter,unit:t.unit,padding:t.padding,tickTextProps:t.tickTextProps,orientation:t.orientation,mirror:t.mirror,x:t.x,y:t.y,width:t.width,height:t.height,tickSize:t.tickSize,tickMargin:t.tickMargin,fontSize:d,letterSpacing:h,getTicksConfig:t,events:l}),v.createElement(KC,{x:t.x,y:t.y,width:t.width,height:t.height},v.createElement(tI,{label:t.label}),t.children))}),q5=v.memo(W5,(t,e)=>{var{viewBox:r}=t,n=pu(t,A5),{viewBox:a}=e,i=pu(e,E5);return qn(r,a)&&qn(n,i)}),jh=v.forwardRef((t,e)=>{var r=Ce(t,_h);return v.createElement(q5,an({},r,{ref:e}))});jh.displayName="CartesianAxis";var z5=["x1","y1","x2","y2","key"],K5=["offset"],H5=["xAxisId","yAxisId"],V5=["xAxisId","yAxisId"];function tg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ve(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tg(Object(r),!0).forEach(function(n){G5(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function G5(t,e,r){return(e=Y5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y5(t){var e=J5(t,"string");return typeof e=="symbol"?e:e+""}function J5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yr(){return Yr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yr.apply(null,arguments)}function _s(t,e){if(t==null)return{};var r,n,a=X5(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function X5(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Z5=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:o}=t;return v.createElement("rect",{x:n,y:a,ry:o,width:i,height:s,stroke:"none",fill:e,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function Jx(t,e){var r;if(v.isValidElement(t))r=v.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var{x1:n,y1:a,x2:i,y2:s,key:o}=e,l=_s(e,z5),d=jt(l),{offset:c}=d,h=_s(d,K5);r=v.createElement("line",Yr({},h,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:o}))}return r}function Q5(t){var{x:e,width:r,horizontal:n=!0,horizontalPoints:a}=t;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=t,o=_s(t,H5),l=a.map((d,c)=>{var h=Ve(Ve({},o),{},{x1:e,y1:d,x2:e+r,y2:d,key:"line-".concat(c),index:c});return Jx(n,h)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function eR(t){var{y:e,height:r,vertical:n=!0,verticalPoints:a}=t;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=t,o=_s(t,V5),l=a.map((d,c)=>{var h=Ve(Ve({},o),{},{x1:d,y1:e,x2:d,y2:e+r,key:"line-".concat(c),index:c});return Jx(n,h)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function tR(t){var{horizontalFill:e,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:o,horizontal:l=!0}=t;if(!l||!e||!e.length)return null;var d=o.map(h=>Math.round(h+a-a)).sort((h,f)=>h-f);a!==d[0]&&d.unshift(0);var c=d.map((h,f)=>{var m=!d[f+1],p=m?a+s-h:d[f+1]-h;if(p<=0)return null;var g=f%e.length;return v.createElement("rect",{key:"react-".concat(f),y:h,x:n,height:p,width:i,stroke:"none",fill:e[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},c)}function rR(t){var{vertical:e=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:o,verticalPoints:l}=t;if(!e||!r||!r.length)return null;var d=l.map(h=>Math.round(h+a-a)).sort((h,f)=>h-f);a!==d[0]&&d.unshift(0);var c=d.map((h,f)=>{var m=!d[f+1],p=m?a+s-h:d[f+1]-h;if(p<=0)return null;var g=f%r.length;return v.createElement("rect",{key:"react-".concat(f),x:h,y:i,width:p,height:o,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},c)}var nR=(t,e)=>{var{xAxis:r,width:n,height:a,offset:i}=t;return ty(wh(Ve(Ve(Ve({},_h),r),{},{ticks:ry(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,e)},aR=(t,e)=>{var{yAxis:r,width:n,height:a,offset:i}=t;return ty(wh(Ve(Ve(Ve({},_h),r),{},{ticks:ry(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,e)},iR={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function wr(t){var e=Qu(),r=ed(),n=ay(),a=Ve(Ve({},Ce(t,iR)),{},{x:q(t.x)?t.x:n.left,y:q(t.y)?t.y:n.top,width:q(t.width)?t.width:n.width,height:q(t.height)?t.height:n.height}),{xAxisId:i,yAxisId:s,x:o,y:l,width:d,height:c,syncWithTicks:h,horizontalValues:f,verticalValues:m}=a,p=Je(),g=F(O=>Zp(O,"xAxis",i,p)),y=F(O=>Zp(O,"yAxis",s,p));if(!q(d)||d<=0||!q(c)||c<=0||!q(o)||o!==+o||!q(l)||l!==+l)return null;var b=a.verticalCoordinatesGenerator||nR,x=a.horizontalCoordinatesGenerator||aR,{horizontalPoints:w,verticalPoints:_}=a;if((!w||!w.length)&&typeof x=="function"){var S=f&&f.length,j=x({yAxis:y?Ve(Ve({},y),{},{ticks:S?f:y.ticks}):void 0,width:e,height:r,offset:n},S?!0:h);ja(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(w=j)}if((!_||!_.length)&&typeof b=="function"){var N=m&&m.length,M=b({xAxis:g?Ve(Ve({},g),{},{ticks:N?m:g.ticks}):void 0,width:e,height:r,offset:n},N?!0:h);ja(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof M,"]")),Array.isArray(M)&&(_=M)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(Z5,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),v.createElement(tR,Yr({},a,{horizontalPoints:w})),v.createElement(rR,Yr({},a,{verticalPoints:_})),v.createElement(Q5,Yr({},a,{offset:n,horizontalPoints:w,xAxis:g,yAxis:y})),v.createElement(eR,Yr({},a,{offset:n,verticalPoints:_,xAxis:g,yAxis:y})))}wr.displayName="CartesianGrid";var Xx=(t,e,r,n)=>Lt(t,"xAxis",e,n),Zx=(t,e,r,n)=>Rt(t,"xAxis",e,n),Qx=(t,e,r,n)=>Lt(t,"yAxis",r,n),ew=(t,e,r,n)=>Rt(t,"yAxis",r,n),sR=A([Q,Xx,Qx,Zx,ew],(t,e,r,n,a)=>Ar(t,"xAxis")?Ca(e,n,!1):Ca(r,a,!1)),oR=(t,e,r,n,a)=>a;function lR(t){return t.type==="line"}var cR=A([ei,oR],(t,e)=>t.filter(lR).find(r=>r.id===e)),uR=A([Q,Xx,Qx,Zx,ew,cR,sR,Ja],(t,e,r,n,a,i,s,o)=>{var{chartData:l,dataStartIndex:d,dataEndIndex:c}=o;if(!(i==null||e==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:h,data:f}=i,m;if(f!=null&&f.length>0?m=f:m=l?.slice(d,c+1),m!=null)return TR({layout:t,xAxis:e,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:h,bandSize:s,displayedData:m})}}),dR=["id"],hR=["type","layout","connectNulls","needClip"],fR=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function rg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ot(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rg(Object(r),!0).forEach(function(n){mR(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mR(t,e,r){return(e=pR(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pR(t){var e=gR(t,"string");return typeof e=="symbol"?e:e+""}function gR(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sh(t,e){if(t==null)return{};var r,n,a=vR(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vR(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function sn(){return sn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sn.apply(null,arguments)}var yR=t=>{var{dataKey:e,name:r,stroke:n,legendType:a,hide:i}=t;return[{inactive:i,dataKey:e,type:a,color:n,value:Er(r,e),payload:t}]};function bR(t){var{dataKey:e,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:o,unit:l}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:e,nameKey:void 0,name:Er(s,e),hide:o,type:t.tooltipType,color:t.stroke,unit:l}}}var tw=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function xR(t,e){for(var r=t.length%2!==0?[...t,0]:t,n=[],a=0;a<e;++a)n=[...n,...r];return n}var wR=(t,e,r)=>{var n=r.reduce((h,f)=>h+f);if(!n)return tw(e,t);for(var a=Math.floor(t/n),i=t%n,s=e-t,o=[],l=0,d=0;l<r.length;d+=r[l],++l)if(d+r[l]>i){o=[...r.slice(0,l),i-d];break}var c=o.length%2===0?[0,s]:[s];return[...xR(r,a),...o,...c].map(h=>"".concat(h,"px")).join(", ")};function _R(t,e){var r;if(v.isValidElement(t))r=v.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var n=ee("recharts-line-dot",typeof t!="boolean"?t.className:"");r=v.createElement(Ix,sn({},e,{className:n}))}return r}function jR(t,e){return t==null?!1:e?!0:t.length===1}function SR(t){var{clipPathId:e,points:r,props:n}=t,{dot:a,dataKey:i,needClip:s}=n;if(!jR(r,a))return null;var{id:o}=n,l=Sh(n,dR),d=Yg(a),c=jt(l),h=ye(a,!0),f=r.map((p,g)=>{var y=ot(ot(ot({key:"dot-".concat(g),r:3},c),h),{},{index:g,cx:p.x,cy:p.y,dataKey:i,value:p.value,payload:p.payload,points:r});return _R(a,y)}),m={clipPath:s?"url(#clipPath-".concat(d?"":"dots-").concat(e,")"):void 0};return v.createElement(_e,sn({className:"recharts-line-dots",key:"dots"},m),f)}function NR(t){var{showLabels:e,children:r,points:n}=t,a=v.useMemo(()=>n?.map(i=>{var s={x:i.x,y:i.y,width:0,height:0};return ot(ot({},s),{},{value:i.value,payload:i.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return v.createElement(lh,{value:e?a:null},r)}function ng(t){var{clipPathId:e,pathRef:r,points:n,strokeDasharray:a,props:i}=t,{type:s,layout:o,connectNulls:l,needClip:d}=i,c=Sh(i,hR),h=ot(ot({},ye(c,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(e,")"):void 0,points:n,type:s,layout:o,connectNulls:l,strokeDasharray:a??i.strokeDasharray});return v.createElement(v.Fragment,null,n?.length>1&&v.createElement(Gs,sn({},h,{pathRef:r})),v.createElement(SR,{points:n,clipPathId:e,props:i}))}function PR(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function kR(t){var{clipPathId:e,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=t,{points:s,strokeDasharray:o,isAnimationActive:l,animationBegin:d,animationDuration:c,animationEasing:h,animateNewValues:f,width:m,height:p,onAnimationEnd:g,onAnimationStart:y}=r,b=a.current,x=Gn(r,"recharts-line-"),[w,_]=v.useState(!1),S=!w,j=v.useCallback(()=>{typeof g=="function"&&g(),_(!1)},[g]),N=v.useCallback(()=>{typeof y=="function"&&y(),_(!0)},[y]),M=PR(n.current),O=i.current;return v.createElement(NR,{points:s,showLabels:S},r.children,v.createElement(Vn,{animationId:x,begin:d,duration:c,isActive:l,easing:h,onAnimationEnd:j,onAnimationStart:N,key:x},T=>{var P=we(O,M+O,T),k=Math.min(P,M),D;if(l)if(o){var I="".concat(o).split(/[,\s]+/gim).map(K=>parseFloat(K));D=wR(k,M,I)}else D=tw(M,k);else D=o==null?void 0:String(o);if(b){var z=b.length/s.length,H=T===1?s:s.map((K,X)=>{var B=Math.floor(X*z);if(b[B]){var R=b[B];return ot(ot({},K),{},{x:we(R.x,K.x,T),y:we(R.y,K.y,T)})}return f?ot(ot({},K),{},{x:we(m*2,K.x,T),y:we(p/2,K.y,T)}):ot(ot({},K),{},{x:K.x,y:K.y})});return a.current=H,v.createElement(ng,{props:r,points:H,clipPathId:e,pathRef:n,strokeDasharray:D})}return T>0&&M>0&&(a.current=s,i.current=k),v.createElement(ng,{props:r,points:s,clipPathId:e,pathRef:n,strokeDasharray:D})}),v.createElement(fo,{label:r.label}))}function MR(t){var{clipPathId:e,props:r}=t,n=v.useRef(null),a=v.useRef(0),i=v.useRef(null);return v.createElement(kR,{props:r,clipPathId:e,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var OR=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:ie(t.payload,e)});class AR extends v.Component{render(){var e,{hide:r,dot:n,points:a,className:i,xAxisId:s,yAxisId:o,top:l,left:d,width:c,height:h,id:f,needClip:m}=this.props;if(r)return null;var p=ee("recharts-line",i),g=f,{r:y=3,strokeWidth:b=2}=(e=ye(n,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},x=Yg(n),w=y*2+b;return v.createElement(v.Fragment,null,v.createElement(_e,{className:p},m&&v.createElement("defs",null,v.createElement(bh,{clipPathId:g,xAxisId:s,yAxisId:o}),!x&&v.createElement("clipPath",{id:"clipPath-dots-".concat(g)},v.createElement("rect",{x:d-w/2,y:l-w/2,width:c+w,height:h+w}))),v.createElement(yh,{xAxisId:s,yAxisId:o,data:a,dataPointFormatter:OR,errorBarOffset:0},v.createElement(MR,{props:this.props,clipPathId:g}))),v.createElement(JD,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var rw={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!ir.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function ER(t){var e=Ce(t,rw),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:o,dot:l,hide:d,isAnimationActive:c,label:h,legendType:f,xAxisId:m,yAxisId:p,id:g}=e,y=Sh(e,fR),{needClip:b}=bo(m,p),x=gh(),w=Hs(),_=Je(),S=F(T=>uR(T,m,p,_,g));if(w!=="horizontal"&&w!=="vertical"||S==null||x==null)return null;var{height:j,width:N,x:M,y:O}=x;return v.createElement(AR,sn({},y,{id:g,connectNulls:o,dot:l,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:c,hide:d,label:h,legendType:f,xAxisId:m,yAxisId:p,points:S,layout:w,height:j,width:N,left:M,top:O,needClip:b}))}function TR(t){var{layout:e,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:o,displayedData:l}=t;return l.map((d,c)=>{var h=ie(d,s);if(e==="horizontal"){var f=Qi({axis:r,ticks:a,bandSize:o,entry:d,index:c}),m=le(h)?null:n.scale(h);return{x:f,y:m,value:h,payload:d}}var p=le(h)?null:r.scale(h),g=Qi({axis:n,ticks:i,bandSize:o,entry:d,index:c});return p==null||g==null?null:{x:p,y:g,value:h,payload:d}}).filter(Boolean)}function CR(t){var e=Ce(t,rw),r=Je();return v.createElement(yo,{id:e.id,type:"line"},n=>v.createElement(v.Fragment,null,v.createElement(fh,{legendPayload:yR(e)}),v.createElement(vo,{fn:bR,args:e}),v.createElement(mh,{type:"line",id:n,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,hide:e.hide,isPanorama:r}),v.createElement(ER,sn({},e,{id:n}))))}var gu=v.memo(CR);gu.displayName="Line";function nw(t,e,r){return(e=IR(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IR(t){var e=DR(t,"string");return typeof e=="symbol"?e:e+""}function DR(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $R(t){var e=be();return v.useEffect(()=>(e(BD(t)),()=>{e(UD(t))}),[t,e]),null}class xo extends v.Component{render(){return v.createElement($R,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:xr.allowDuplicatedCategory,allowDataOverflow:xr.allowDataOverflow,reversed:xr.reversed,includeHidden:xr.includeHidden})}}nw(xo,"displayName","ZAxis");nw(xo,"defaultProps",{zAxisId:0,range:xr.range,scale:xr.scale,type:xr.type});var RR=["option","isActive"];function Na(){return Na=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Na.apply(null,arguments)}function LR(t,e){if(t==null)return{};var r,n,a=BR(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function BR(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function UR(t){var{option:e,isActive:r}=t,n=LR(t,RR);return typeof e=="string"?v.createElement(bs,Na({option:v.createElement(Is,Na({type:e},n)),isActive:r,shapeType:"symbols"},n)):v.createElement(bs,Na({option:e,isActive:r,shapeType:"symbols"},n))}var FR=(t,e,r,n,a,i,s)=>Lt(t,"xAxis",e,s),WR=(t,e,r,n,a,i,s)=>Rt(t,"xAxis",e,s),qR=(t,e,r,n,a,i,s)=>Lt(t,"yAxis",r,s),zR=(t,e,r,n,a,i,s)=>Rt(t,"yAxis",r,s),KR=(t,e,r,n)=>w2(t,"zAxis",n,!1),HR=(t,e,r,n,a)=>a,VR=(t,e,r,n,a,i)=>i,GR=(t,e,r,n,a,i,s)=>Ja(t,e,r,s),YR=A([ei,HR],(t,e)=>t.filter(r=>r.type==="scatter").find(r=>r.id===e)),JR=A([GR,FR,WR,qR,zR,KR,YR,VR],(t,e,r,n,a,i,s,o)=>{var{chartData:l,dataStartIndex:d,dataEndIndex:c}=t;if(s!=null){var h;if(s?.data!=null&&s.data.length>0?h=s.data:h=l?.slice(d,c+1),!(h==null||e==null||n==null||r==null||a==null||r?.length===0||a?.length===0))return u3({displayedData:h,xAxis:e,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:r,yAxisTicks:a,cells:o})}}),XR=["onMouseEnter","onClick","onMouseLeave"],ZR=["id"],QR=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function vu(t,e){if(t==null)return{};var r,n,a=e3(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function e3(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function on(){return on=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},on.apply(null,arguments)}function ag(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ge(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ag(Object(r),!0).forEach(function(n){t3(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ag(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function t3(t,e,r){return(e=r3(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r3(t){var e=n3(t,"string");return typeof e=="symbol"?e:e+""}function n3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var a3=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:i}=t;return[{inactive:i,dataKey:e,type:a,color:n,value:Er(r,e),payload:t}]};function i3(t){var{points:e,props:r}=t,{line:n,lineType:a,lineJointType:i}=r;if(!n)return null;var s=jt(r),o=ye(n,!1),l,d;if(a==="joint")l=e.map(y=>({x:y.cx,y:y.cy}));else if(a==="fitting"){var{xmin:c,xmax:h,a:f,b:m}=Mj(e),p=y=>f*y+m;l=[{x:c,y:p(c)},{x:h,y:p(h)}]}var g=Ge(Ge(Ge({},s),{},{fill:"none",stroke:s&&s.fill},o),{},{points:l});return v.isValidElement(n)?d=v.cloneElement(n,g):typeof n=="function"?d=n(g):d=v.createElement(Gs,on({},g,{type:i})),v.createElement(_e,{className:"recharts-scatter-line",key:"recharts-scatter-line"},d)}function s3(t){var{showLabels:e,points:r,children:n}=t,a=Ks(),i=v.useMemo(()=>r?.map(s=>{var o={x:s.x,y:s.y,width:s.width,height:s.height};return Ge(Ge({},o),{},{value:void 0,payload:s.payload,viewBox:o,parentViewBox:a,fill:void 0})}),[a,r]);return v.createElement(lh,{value:e?i:null},n)}function o3(t){var{points:e,allOtherScatterProps:r}=t,{shape:n,activeShape:a,dataKey:i}=r,s=F(tr),{onMouseEnter:o,onClick:l,onMouseLeave:d}=r,c=vu(r,XR),h=mo(o,r.dataKey),f=po(d),m=go(l,r.dataKey);if(e==null)return null;var{id:p}=r,g=vu(r,ZR),y=jt(g);return v.createElement(v.Fragment,null,v.createElement(i3,{points:e,props:g}),e.map((b,x)=>{var w=a&&s===String(x),_=w?a:n,S=Ge(Ge(Ge({key:"symbol-".concat(x)},y),b),{},{[Ju]:x,[Xu]:String(i)});return v.createElement(_e,on({className:"recharts-scatter-symbol"},Hn(c,b,x),{onMouseEnter:h(b,x),onMouseLeave:f(b,x),onClick:m(b,x),key:"symbol-".concat(b?.cx,"-").concat(b?.cy,"-").concat(b?.size,"-").concat(x)}),v.createElement(UR,on({option:_,isActive:w},S)))}))}function l3(t){var{previousPointsRef:e,props:r}=t,{points:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o}=r,l=e.current,d=Gn(r,"recharts-scatter-"),[c,h]=v.useState(!1),f=v.useCallback(()=>{h(!1)},[]),m=v.useCallback(()=>{h(!0)},[]),p=!c;return v.createElement(s3,{showLabels:p,points:n},r.children,v.createElement(Vn,{animationId:d,begin:i,duration:s,isActive:a,easing:o,onAnimationEnd:f,onAnimationStart:m,key:d},g=>{var y=g===1?n:n?.map((b,x)=>{var w=l&&l[x];if(w){var _=fi(w.cx,b.cx),S=fi(w.cy,b.cy),j=fi(w.size,b.size);return Ge(Ge({},b),{},{cx:_(g),cy:S(g),size:j(g)})}var N=fi(0,b.size);return Ge(Ge({},b),{},{size:N(g)})});return g>0&&(e.current=y),v.createElement(_e,null,v.createElement(o3,{points:y,allOtherScatterProps:r,showLabels:p}))}),v.createElement(fo,{label:r.label}))}function c3(t){var{dataKey:e,points:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:o,tooltipType:l}=t;return{dataDefinedOnItem:r?.map(d=>d.tooltipPayload),positions:r?.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:a,fill:i,nameKey:void 0,dataKey:e,name:Er(s,e),hide:o,type:l,color:i,unit:""}}}function u3(t){var{displayedData:e,xAxis:r,yAxis:n,zAxis:a,scatterSettings:i,xAxisTicks:s,yAxisTicks:o,cells:l}=t,d=le(r.dataKey)?i.dataKey:r.dataKey,c=le(n.dataKey)?i.dataKey:n.dataKey,h=a&&a.dataKey,f=a?a.range:xo.defaultProps.range,m=f&&f[0],p=r.scale.bandwidth?r.scale.bandwidth():0,g=n.scale.bandwidth?n.scale.bandwidth():0;return e.map((y,b)=>{var x=ie(y,d),w=ie(y,c),_=!le(h)&&ie(y,h)||"-",S=[{name:le(r.dataKey)?i.name:r.name||r.dataKey,unit:r.unit||"",value:x,payload:y,dataKey:d,type:i.tooltipType},{name:le(n.dataKey)?i.name:n.name||n.dataKey,unit:n.unit||"",value:w,payload:y,dataKey:c,type:i.tooltipType}];_!=="-"&&S.push({name:a.name||a.dataKey,unit:a.unit||"",value:_,payload:y,dataKey:h,type:i.tooltipType});var j=Qi({axis:r,ticks:s,bandSize:p,entry:y,index:b,dataKey:d}),N=Qi({axis:n,ticks:o,bandSize:g,entry:y,index:b,dataKey:c}),M=_!=="-"?a.scale(_):m,O=Math.sqrt(Math.max(M,0)/Math.PI);return Ge(Ge({},y),{},{cx:j,cy:N,x:j-O,y:N-O,width:2*O,height:2*O,size:M,node:{x,y:w,z:_},tooltipPayload:S,tooltipPosition:{x:j,y:N},payload:y},l&&l[b]&&l[b].props)})}var d3=(t,e,r)=>({x:t.cx,y:t.cy,value:r==="x"?+t.node.x:+t.node.y,errorVal:ie(t,e)});function h3(t){var{hide:e,points:r,className:n,needClip:a,xAxisId:i,yAxisId:s,id:o}=t,l=v.useRef(null);if(e)return null;var d=ee("recharts-scatter",n),c=o;return v.createElement(_e,{className:d,clipPath:a?"url(#clipPath-".concat(c,")"):null,id:o},a&&v.createElement("defs",null,v.createElement(bh,{clipPathId:c,xAxisId:i,yAxisId:s})),v.createElement(yh,{xAxisId:i,yAxisId:s,data:r,dataPointFormatter:d3,errorBarOffset:0},v.createElement(_e,{key:"recharts-scatter-symbols"},v.createElement(l3,{props:t,previousPointsRef:l}))))}var aw={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!ir.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function f3(t){var e=Ce(t,aw),{animationBegin:r,animationDuration:n,animationEasing:a,hide:i,isAnimationActive:s,legendType:o,lineJointType:l,lineType:d,shape:c,xAxisId:h,yAxisId:f,zAxisId:m}=e,p=vu(e,QR),{needClip:g}=bo(h,f),y=v.useMemo(()=>As(t.children,hn),[t.children]),b=Je(),x=F(w=>JR(w,h,f,m,t.id,y,b));return g==null||x==null?null:v.createElement(v.Fragment,null,v.createElement(vo,{fn:c3,args:Ge(Ge({},t),{},{points:x})}),v.createElement(h3,on({},p,{xAxisId:h,yAxisId:f,zAxisId:m,lineType:d,lineJointType:l,legendType:o,shape:c,hide:i,isAnimationActive:s,animationBegin:r,animationDuration:n,animationEasing:a,points:x,needClip:g})))}function m3(t){var e=Ce(t,aw),r=Je();return v.createElement(yo,{id:e.id,type:"scatter"},n=>v.createElement(v.Fragment,null,v.createElement(fh,{legendPayload:a3(e)}),v.createElement(mh,{type:"scatter",id:n,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:e.zAxisId,dataKey:e.dataKey,hide:e.hide,name:e.name,tooltipType:e.tooltipType,isPanorama:r}),v.createElement(f3,on({},e,{id:n}))))}var yu=v.memo(m3);yu.displayName="Scatter";var p3=["dangerouslySetInnerHTML","ticks"],g3=["id"],v3=["domain"],y3=["domain"];function bu(){return bu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bu.apply(null,arguments)}function js(t,e){if(t==null)return{};var r,n,a=b3(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function b3(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function x3(t){var e=be();return v.useEffect(()=>(e(DD(t)),()=>{e($D(t))}),[t,e]),null}var w3=t=>{var{xAxisId:e,className:r}=t,n=F(Zu),a=Je(),i="xAxis",s=F(y=>ta(y,i,e,a)),o=F(y=>Yb(y,i,e,a)),l=F(y=>Kb(y,e)),d=F(y=>p2(y,e)),c=F(y=>_b(y,e));if(l==null||d==null||c==null)return null;var{dangerouslySetInnerHTML:h,ticks:f}=t,m=js(t,p3),{id:p}=c,g=js(c,g3);return v.createElement(jh,bu({},m,g,{scale:s,x:d.x,y:d.y,width:l.width,height:l.height,className:ee("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:o}))},_3={allowDataOverflow:at.allowDataOverflow,allowDecimals:at.allowDecimals,allowDuplicatedCategory:at.allowDuplicatedCategory,height:at.height,hide:!1,mirror:at.mirror,orientation:at.orientation,padding:at.padding,reversed:at.reversed,scale:at.scale,tickCount:at.tickCount,type:at.type,xAxisId:0},j3=t=>{var e,r,n,a,i,s=Ce(t,_3);return v.createElement(v.Fragment,null,v.createElement(x3,{interval:(e=s.interval)!==null&&e!==void 0?e:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(w3,s))},S3=(t,e)=>{var{domain:r}=t,n=js(t,v3),{domain:a}=e,i=js(e,y3);return qn(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:qn({domain:r},{domain:a}):!1},_r=v.memo(j3,S3);_r.displayName="XAxis";var N3=["dangerouslySetInnerHTML","ticks"],P3=["id"],k3=["domain"],M3=["domain"];function xu(){return xu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xu.apply(null,arguments)}function Ss(t,e){if(t==null)return{};var r,n,a=O3(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function O3(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function A3(t){var e=be();return v.useEffect(()=>(e(RD(t)),()=>{e(LD(t))}),[t,e]),null}var E3=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,i=v.useRef(null),s=v.useRef(null),o=F(Zu),l=Je(),d=be(),c="yAxis",h=F(S=>ta(S,c,e,l)),f=F(S=>Hb(S,e)),m=F(S=>v2(S,e)),p=F(S=>Yb(S,c,e,l)),g=F(S=>jb(S,e));if(v.useLayoutEffect(()=>{if(!(n!=="auto"||!f||oh(a)||v.isValidElement(a)||g==null)){var S=i.current;if(S){var j=S.getCalculatedWidth();Math.round(f.width)!==Math.round(j)&&d(FD({id:e,width:j}))}}},[p,f,d,a,e,n,g]),f==null||m==null||g==null)return null;var{dangerouslySetInnerHTML:y,ticks:b}=t,x=Ss(t,N3),{id:w}=g,_=Ss(g,P3);return v.createElement(jh,xu({},x,_,{ref:i,labelRef:s,scale:h,x:m.x,y:m.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:ee("recharts-".concat(c," ").concat(c),r),viewBox:o,ticks:p}))},T3={allowDataOverflow:it.allowDataOverflow,allowDecimals:it.allowDecimals,allowDuplicatedCategory:it.allowDuplicatedCategory,hide:!1,mirror:it.mirror,orientation:it.orientation,padding:it.padding,reversed:it.reversed,scale:it.scale,tickCount:it.tickCount,type:it.type,width:it.width,yAxisId:0},C3=t=>{var e,r,n,a,i,s=Ce(t,T3);return v.createElement(v.Fragment,null,v.createElement(A3,{interval:(e=s.interval)!==null&&e!==void 0?e:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(E3,s))},I3=(t,e)=>{var{domain:r}=t,n=Ss(t,k3),{domain:a}=e,i=Ss(e,M3);return qn(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:qn({domain:r},{domain:a}):!1},jr=v.memo(C3,I3);jr.displayName="YAxis";var uc={exports:{}},dc={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ig;function D3(){if(ig)return dc;ig=1;var t=Ps();function e(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,a=t.useRef,i=t.useEffect,s=t.useMemo,o=t.useDebugValue;return dc.useSyncExternalStoreWithSelector=function(l,d,c,h,f){var m=a(null);if(m.current===null){var p={hasValue:!1,value:null};m.current=p}else p=m.current;m=s(function(){function y(S){if(!b){if(b=!0,x=S,S=h(S),f!==void 0&&p.hasValue){var j=p.value;if(f(j,S))return w=j}return w=S}if(j=w,r(x,S))return j;var N=h(S);return f!==void 0&&f(j,N)?(x=S,j):(x=S,w=N)}var b=!1,x,w,_=c===void 0?null:c;return[function(){return y(d())},_===null?void 0:function(){return y(_())}]},[d,c,h,f]);var g=n(l,m[0],m[1]);return i(function(){p.hasValue=!0,p.value=g},[g]),o(g),g},dc}var sg;function $3(){return sg||(sg=1,uc.exports=D3()),uc.exports}$3();function R3(t){t()}function L3(){let t=null,e=null;return{clear(){t=null,e=null},notify(){R3(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var og={notify(){},get:()=>[]};function B3(t,e){let r,n=og,a=0,i=!1;function s(g){c();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),h())}}function o(){n.notify()}function l(){p.onStateChange&&p.onStateChange()}function d(){return i}function c(){a++,r||(r=t.subscribe(l),n=L3())}function h(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=og)}function f(){i||(i=!0,c())}function m(){i&&(i=!1,h())}const p={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:d,trySubscribe:f,tryUnsubscribe:m,getListeners:()=>n};return p}var U3=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",F3=U3(),W3=()=>typeof navigator<"u"&&navigator.product==="ReactNative",q3=W3(),z3=()=>F3||q3?v.useLayoutEffect:v.useEffect,K3=z3(),H3=Symbol.for("react-redux-context"),V3=typeof globalThis<"u"?globalThis:{};function G3(){if(!v.createContext)return{};const t=V3[H3]??=new Map;let e=t.get(v.createContext);return e||(e=v.createContext(null),t.set(v.createContext,e)),e}var Y3=G3();function J3(t){const{children:e,context:r,serverState:n,store:a}=t,i=v.useMemo(()=>{const l=B3(a);return{store:a,subscription:l,getServerState:n?()=>n:void 0}},[a,n]),s=v.useMemo(()=>a.getState(),[a]);K3(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==a.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,s]);const o=r||Y3;return v.createElement(o.Provider,{value:i},e)}var X3=J3,Z3=(t,e)=>e,Nh=A([Z3,Q,bb,De,ux,cr,jT,Te],MT),Ph=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},iw=wt("mouseClick"),sw=za();sw.startListening({actionCreator:iw,effect:(t,e)=>{var r=t.payload,n=Nh(e.getState(),Ph(r));n?.activeIndex!=null&&e.dispatch(E2({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var wu=wt("mouseMove"),ow=za();ow.startListening({actionCreator:wu,effect:(t,e)=>{var r=t.payload,n=e.getState(),a=Zd(n,n.tooltip.settings.shared),i=Nh(n,Ph(r));a==="axis"&&(i?.activeIndex!=null?e.dispatch(nx({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):e.dispatch(rx()))}});var lg={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},lw=ft({name:"rootProps",initialState:lg,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:lg.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),Q3=lw.reducer,{updateOptions:eL}=lw.actions,cw=ft({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:tL}=cw.actions,rL=cw.reducer,uw=wt("keyDown"),dw=wt("focus"),kh=za();kh.startListening({actionCreator:uw,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=t.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Qd(a,na(r))),o=cr(r);if(i==="Enter"){var l=ps(r,"axis","hover",String(a.index));e.dispatch(cu({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:l}));return}var d=_2(r),c=d==="left-to-right"?1:-1,h=i==="ArrowRight"?1:-1,f=s+h*c;if(!(o==null||f>=o.length||f<0)){var m=ps(r,"axis","hover",String(f));e.dispatch(cu({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:m}))}}}}});kh.startListening({actionCreator:dw,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=ps(r,"axis","hover",String(i));e.dispatch(cu({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var yt=wt("externalEvent"),hw=za();hw.startListening({actionCreator:yt,effect:(t,e)=>{if(t.payload.handler!=null){var r=e.getState(),n={activeCoordinate:fT(r),activeDataKey:mx(r),activeIndex:tr(r),activeLabel:fx(r),activeTooltipIndex:tr(r),isTooltipActive:mT(r)};t.payload.handler(n,t.payload.reactEvent)}}});var nL=A([ra],t=>t.tooltipItemPayloads),aL=A([nL,ni,(t,e,r)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(o=>o.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=e(i,r);return s}}}),fw=wt("touchMove"),mw=za();mw.startListening({actionCreator:fw,effect:(t,e)=>{var r=t.payload,n=e.getState(),a=Zd(n,n.tooltip.settings.shared);if(a==="axis"){var i=Nh(n,Ph({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&e.dispatch(nx({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,o=r.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var d=l.getAttribute(Ju),c=(s=l.getAttribute(Xu))!==null&&s!==void 0?s:void 0,h=aL(e.getState(),d,c);e.dispatch(tx({activeDataKey:c,activeIndex:d,activeCoordinate:h}))}}});var iL=Av({brush:c5,cartesianAxis:WD,chartData:zT,errorBars:l$,graphicalItems:iD,layout:jP,legend:fk,options:BT,polarAxis:_I,polarOptions:rL,referenceElements:g5,rootProps:Q3,tooltip:T2}),sL=function(e){return GN({reducer:iL,preloadedState:e,middleware:r=>r({serializableCheck:!1}).concat([sw.middleware,ow.middleware,kh.middleware,hw.middleware,mw.middleware]),devTools:ir.devToolsEnabled})};function pw(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=Je(),i=v.useRef(null);if(a)return r;i.current==null&&(i.current=sL(e));var s=zu;return v.createElement(X3,{context:s,store:i.current},r)}function gw(t){var{layout:e,width:r,height:n,margin:a}=t,i=be(),s=Je();return v.useEffect(()=>{s||(i(xP(e)),i(wP({width:r,height:n})),i(bP(a)))},[i,s,e,r,n,a]),null}function vw(t){var e=be();return v.useEffect(()=>{e(eL(t))},[e,t]),null}var oL=["children"];function lL(t,e){if(t==null)return{};var r,n,a=cL(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function cL(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Ns(){return Ns=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ns.apply(null,arguments)}var uL={width:"100%",height:"100%"},dL=v.forwardRef((t,e)=>{var r=Qu(),n=ed(),a=ly();if(!Ln(r)||!Ln(n))return null;var{children:i,otherAttributes:s,title:o,desc:l}=t,d,c;return typeof s.tabIndex=="number"?d=s.tabIndex:d=a?0:void 0,typeof s.role=="string"?c=s.role:c=a?"application":void 0,v.createElement($u,Ns({},s,{title:o,desc:l,role:c,tabIndex:d,width:r,height:n,style:uL,ref:e}),i)}),hL=t=>{var{children:e}=t,r=F(zs);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return v.createElement($u,{width:n,height:a,x:s,y:i},e)},cg=v.forwardRef((t,e)=>{var{children:r}=t,n=lL(t,oL),a=Je();return a?v.createElement(hL,null,r):v.createElement(dL,Ns({ref:e},n),r)});function fL(){var t=be(),[e,r]=v.useState(null),n=F(ZP);return v.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),i=a.width/e.offsetWidth;ht(i)&&i!==n&&t(_P(i))}},[e,t,n]),r}function ug(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function mL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ug(Object(r),!0).forEach(function(n){pL(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ug(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pL(t,e,r){return(e=gL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gL(t){var e=vL(t,"string");return typeof e=="symbol"?e:e+""}function vL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yL=v.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:l,onMouseEnter:d,onMouseLeave:c,onMouseMove:h,onMouseUp:f,onTouchEnd:m,onTouchMove:p,onTouchStart:g,style:y,width:b}=t,x=be(),[w,_]=v.useState(null),[S,j]=v.useState(null);QT();var N=fL(),M=v.useCallback($=>{N($),typeof e=="function"&&e($),_($),j($)},[N,e,_,j]),O=v.useCallback($=>{x(iw($)),x(yt({handler:i,reactEvent:$}))},[x,i]),T=v.useCallback($=>{x(wu($)),x(yt({handler:d,reactEvent:$}))},[x,d]),P=v.useCallback($=>{x(rx()),x(yt({handler:c,reactEvent:$}))},[x,c]),k=v.useCallback($=>{x(wu($)),x(yt({handler:h,reactEvent:$}))},[x,h]),D=v.useCallback(()=>{x(dw())},[x]),I=v.useCallback($=>{x(uw($.key))},[x]),z=v.useCallback($=>{x(yt({handler:s,reactEvent:$}))},[x,s]),H=v.useCallback($=>{x(yt({handler:o,reactEvent:$}))},[x,o]),K=v.useCallback($=>{x(yt({handler:l,reactEvent:$}))},[x,l]),X=v.useCallback($=>{x(yt({handler:f,reactEvent:$}))},[x,f]),B=v.useCallback($=>{x(yt({handler:g,reactEvent:$}))},[x,g]),R=v.useCallback($=>{x(fw($)),x(yt({handler:p,reactEvent:$}))},[x,p]),Y=v.useCallback($=>{x(yt({handler:m,reactEvent:$}))},[x,m]);return v.createElement(xx.Provider,{value:w},v.createElement(Xg.Provider,{value:S},v.createElement("div",{className:ee("recharts-wrapper",n),style:mL({position:"relative",cursor:"default",width:b,height:a},y),onClick:O,onContextMenu:z,onDoubleClick:H,onFocus:D,onKeyDown:I,onMouseDown:K,onMouseEnter:T,onMouseLeave:P,onMouseMove:k,onMouseUp:X,onTouchEnd:Y,onTouchMove:R,onTouchStart:B,ref:M},r)))}),bL=["children","className","width","height","style","compact","title","desc"];function xL(t,e){if(t==null)return{};var r,n,a=wL(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function wL(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var yw=v.forwardRef((t,e)=>{var{children:r,className:n,width:a,height:i,style:s,compact:o,title:l,desc:d}=t,c=xL(t,bL),h=jt(c);return o?v.createElement(cg,{otherAttributes:h,title:l,desc:d},r):v.createElement(yL,{className:n,style:s,width:a,height:i,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},v.createElement(cg,{otherAttributes:h,title:l,desc:d,ref:e},v.createElement(y5,null,r)))}),_L=["width","height"];function _u(){return _u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_u.apply(null,arguments)}function jL(t,e){if(t==null)return{};var r,n,a=SL(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function SL(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var NL={top:5,right:5,bottom:5,left:5},PL={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:NL,reverseStackOrder:!1,syncMethod:"index"},Mh=v.forwardRef(function(e,r){var n,a=Ce(e.categoricalChartProps,PL),{width:i,height:s}=a,o=jL(a,_L);if(!Ln(i)||!Ln(s))return null;var{chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:c,tooltipPayloadSearcher:h,categoricalChartProps:f}=e,m={chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:c,tooltipPayloadSearcher:h,eventEmitter:void 0};return v.createElement(pw,{preloadedState:{options:m},reduxStoreName:(n=f.id)!==null&&n!==void 0?n:l},v.createElement(Hx,{chartData:f.data}),v.createElement(gw,{width:i,height:s,layout:a.layout,margin:a.margin}),v.createElement(vw,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(yw,_u({},o,{width:i,height:s,ref:r})))}),kL=["axis"],ML=v.forwardRef((t,e)=>v.createElement(Mh,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:kL,tooltipPayloadSearcher:uo,categoricalChartProps:t,ref:e})),OL=["axis","item"],ya=v.forwardRef((t,e)=>v.createElement(Mh,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:OL,tooltipPayloadSearcher:uo,categoricalChartProps:t,ref:e}));function AL(t){var e=be();return v.useEffect(()=>{e(tL(t))},[e,t]),null}var EL=["width","height","layout"];function ju(){return ju=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ju.apply(null,arguments)}function TL(t,e){if(t==null)return{};var r,n,a=CL(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function CL(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var IL={top:5,right:5,bottom:5,left:5},DL={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:IL,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},$L=v.forwardRef(function(e,r){var n,a=Ce(e.categoricalChartProps,DL),{width:i,height:s,layout:o}=a,l=TL(a,EL);if(!Ln(i)||!Ln(s))return null;var{chartName:d,defaultTooltipEventType:c,validateTooltipEventTypes:h,tooltipPayloadSearcher:f}=e,m={chartName:d,defaultTooltipEventType:c,validateTooltipEventTypes:h,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(pw,{preloadedState:{options:m},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},v.createElement(Hx,{chartData:a.data}),v.createElement(gw,{width:i,height:s,layout:o,margin:a.margin}),v.createElement(vw,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(AL,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),v.createElement(yw,ju({width:i,height:s},l,{ref:r})))}),RL=["item"],LL={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},BL=v.forwardRef((t,e)=>{var r=Ce(t,LL);return v.createElement($L,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:RL,tooltipPayloadSearcher:uo,categoricalChartProps:r,ref:e})}),UL=["item"],FL=v.forwardRef((t,e)=>v.createElement(Mh,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:UL,tooltipPayloadSearcher:uo,categoricalChartProps:t,ref:e}));const dg=["#1e40af","#dc2626","#059669","#d97706","#7c3aed","#db2777","#1e3a8a","#3b82f6"];function WL({dataset:t}){const e=bj(t),r=t.classes&&t.classes.length>0,n=a=>{const i=Array.from(new Set(a.map(o=>typeof o=="number"?Number(o):String(o))));if(i.length<=12)return!0;const s=a.filter(o=>typeof o=="number");return!!(s.length===a.length&&s.every(l=>Math.abs(l-Math.round(l))<1e-6)&&i.length<=24)};return u.jsxs("div",{className:"space-y-6",children:[r&&e.length>0&&u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(wo,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),u.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"クラス分布"})]}),u.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["各クラスのデータ数と割合を確認できます。",u.jsx("br",{}),u.jsx("span",{className:"text-xs text-gray-600",children:"💡 バランスが良いと機械学習の精度が向上しやすくなります"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx("div",{children:u.jsx(br,{width:"100%",height:250,children:u.jsxs(ya,{data:e,children:[u.jsx(wr,{strokeDasharray:"3 3"}),u.jsx(_r,{dataKey:"class"}),u.jsx(jr,{}),u.jsx(yr,{}),u.jsx(Mn,{dataKey:"count",fill:"#1e40af"})]})})}),u.jsx("div",{children:u.jsx(br,{width:"100%",height:250,children:u.jsxs(BL,{children:[u.jsx(Fx,{data:e,dataKey:"count",nameKey:"class",cx:"50%",cy:"50%",outerRadius:80,label:a=>`${a.class}: ${a.count}`,children:e.map((a,i)=>u.jsx(hn,{fill:dg[i%dg.length]},`cell-${i}`))}),u.jsx(yr,{}),u.jsx(Vs,{})]})})})]}),u.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-3",children:e.map((a,i)=>u.jsxs("div",{className:"bg-blue-50 p-3 rounded border text-center",style:{borderColor:"var(--gold)"},children:[u.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:a.class}),u.jsx("div",{className:"text-2xl font-bold",style:{color:"var(--accent-strong)"},children:a.count}),u.jsxs("div",{className:"text-xs",style:{color:"var(--gold)"},children:[(a.count/t.train.length*100).toFixed(1),"%"]})]},i))})]}),!r&&u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(wo,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),u.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"目的変数の分布"})]}),u.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["予測したい値（目的変数）の分布を確認できます。",u.jsx("br",{}),u.jsx("span",{className:"text-xs text-gray-600",children:"💡 正規分布に近い形だと回帰モデルの精度が向上しやすくなります"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:[t.labelName,"の分布"]}),u.jsx(br,{width:"100%",height:250,children:u.jsxs(ya,{data:(()=>{const i=(t.raw?.train?.map(o=>o.label)??t.train.map(o=>o.label)).filter(o=>typeof o=="number");return i.length===0?[]:df(i,15)})(),children:[u.jsx(wr,{strokeDasharray:"3 3"}),u.jsx(_r,{dataKey:"bin",angle:-45,textAnchor:"end",height:80,tick:{fontSize:10},tickFormatter:a=>{const i=t.raw?.featureUnits?.[t.featureNames.length]||"";return i?`${Math.round(a)}${i}`:Ne(a)}}),u.jsx(jr,{}),u.jsx(yr,{formatter:a=>Ne(a),labelFormatter:a=>{const i=t.raw?.featureUnits?.[t.featureNames.length]||"";return i?`${t.labelName}: ${Math.round(a)}${i}`:`${t.labelName}: ${Ne(a)}`}}),u.jsx(Mn,{dataKey:"count",fill:"#1e40af"})]})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:"基本統計"}),u.jsx("div",{className:"space-y-3",children:(()=>{const i=(t.raw?.train?.map(m=>m.label)??t.train.map(m=>m.label)).filter(m=>typeof m=="number");if(i.length===0)return null;const s=i.sort((m,p)=>m-p),o=s.reduce((m,p)=>m+p,0)/s.length,l=s[Math.floor(s.length/2)],d=s[0],c=s[s.length-1],h=t.raw?.featureUnits?.[t.featureNames.length]||"",f=m=>h?`${Math.round(m*10)/10}${h}`:Ne(m);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"bg-blue-50 p-3 rounded border",style:{borderColor:"var(--gold)"},children:[u.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:"平均値"}),u.jsx("div",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:f(o)})]}),u.jsxs("div",{className:"bg-blue-50 p-3 rounded border",style:{borderColor:"var(--gold)"},children:[u.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:"中央値"}),u.jsx("div",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:f(l)})]}),u.jsxs("div",{className:"bg-blue-50 p-3 rounded border",style:{borderColor:"var(--gold)"},children:[u.jsx("div",{className:"text-xs mb-1",style:{color:"var(--accent-strong)"},children:"範囲"}),u.jsxs("div",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:[f(d)," - ",f(c)]})]})]})})()})]})]})]}),u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(wo,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),u.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"特徴量の分布"})]}),u.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["各特徴量の値の分布を確認できます。カテゴリ変数は棒グラフ、連続変数はヒストグラムで表示されます。",u.jsx("br",{}),u.jsx("span",{className:"text-xs text-gray-600",children:"💡 正規分布に近い形だと機械学習の精度が向上しやすくなります"})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.featureNames.map((a,i)=>{const s=t.raw?.train?.map(c=>c.features[i])??t.train.map(c=>c.features[i]);if(n(s)){const c=new Map;for(const f of s){const m=typeof f=="number"?String(f):f;c.set(m,(c.get(m)||0)+1)}const h=Array.from(c.entries()).sort((f,m)=>f[0].localeCompare(m[0])).map(([f,m])=>({category:f,count:m}));return u.jsxs("div",{className:"bg-blue-50 p-4 rounded border",style:{borderColor:"var(--gold)"},children:[u.jsxs("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:[a,"（カテゴリ）"]}),u.jsx(br,{width:"100%",height:220,children:u.jsxs(ya,{data:h,children:[u.jsx(wr,{strokeDasharray:"3 3"}),u.jsx(_r,{dataKey:"category",angle:-45,textAnchor:"end",height:80,tick:{fontSize:10}}),u.jsx(jr,{}),u.jsx(yr,{formatter:f=>Ne(f)}),u.jsx(Mn,{dataKey:"count",fill:"#d4af37"})]})})]},i)}const d=df(s,15);return u.jsxs("div",{className:"bg-blue-50 p-4 rounded border",style:{borderColor:"var(--gold)"},children:[u.jsx("h4",{className:"text-sm font-bold mb-3 text-center",style:{color:"var(--accent-strong)"},children:a}),u.jsx(br,{width:"100%",height:200,children:u.jsxs(ya,{data:d,children:[u.jsx(wr,{strokeDasharray:"3 3"}),u.jsx(_r,{dataKey:"bin",angle:-45,textAnchor:"end",height:80,tick:{fontSize:10}}),u.jsx(jr,{}),u.jsx(yr,{formatter:c=>Ne(c)}),u.jsx(Mn,{dataKey:"count",fill:"#d4af37"})]})})]},i)})})]})]})}function qL({dataset:t}){const e=yj(t),r=a=>a>.7?"bg-red-600":a>.5?"bg-red-500":a>.3?"bg-orange-400":a>.1?"bg-yellow-300":a>-.1?"bg-gray-200":a>-.3?"bg-blue-300":a>-.5?"bg-blue-400":a>-.7?"bg-blue-500":"bg-blue-600",n=a=>Math.abs(a)>.5?"text-white":"text-gray-900";return u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-teal-600",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(Di,{className:"w-5 h-5 text-teal-900"}),u.jsx("h3",{className:"text-lg font-bold text-teal-900",children:"相関行列"})]}),u.jsxs("div",{className:"mb-4 text-sm text-teal-800",children:[u.jsx("p",{children:"特徴量間の相関係数を表示しています。色が濃いほど強い関係があることを表します。"}),u.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1 text-xs",children:[u.jsx("li",{children:"0.7以上は強い正の相関：一方が大きいともう一方も大きくなりやすい"}),u.jsx("li",{children:"-0.7以下は強い負の相関：一方が大きいともう一方は小さくなりやすい"}),u.jsx("li",{children:"-0.1〜0.1はほぼ相関なし：関係は弱い（例外もあります）"})]}),u.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-4 h-4 bg-red-600 rounded"}),u.jsx("span",{className:"text-xs",children:"強い正の相関 (0.7~1.0)"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"}),u.jsx("span",{className:"text-xs",children:"相関なし (-0.1~0.1)"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded"}),u.jsx("span",{className:"text-xs",children:"強い負の相関 (-1.0~-0.7)"})]})]})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full border-collapse",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"border-2 border-teal-300 bg-teal-50 p-2"}),t.featureNames.map((a,i)=>u.jsx("th",{className:"border-2 border-teal-300 bg-teal-50 p-2 text-xs font-bold text-teal-900",children:a.slice(0,6)},i))]})}),u.jsx("tbody",{children:e.map((a,i)=>u.jsxs("tr",{children:[u.jsx("td",{className:"border-2 border-teal-300 bg-teal-50 p-2 text-xs font-bold text-teal-900",children:t.featureNames[i].slice(0,6)}),a.map((s,o)=>u.jsx("td",{className:`border-2 border-teal-300 p-2 text-center ${r(s)} ${n(s)}`,children:u.jsx("span",{className:"text-xs font-bold",children:s.toFixed(2)})},o))]},i))})]})}),u.jsxs("div",{className:"mt-4 bg-teal-50 p-4 rounded border border-teal-300",children:[u.jsx("h4",{className:"text-sm font-bold text-teal-900 mb-2",children:"相関係数の解釈"}),u.jsxs("ul",{className:"text-xs text-teal-800 space-y-1",children:[u.jsxs("li",{children:["• ",u.jsx("strong",{children:"1.0"}),": 完全な正の相関（一方が増えれば他方も増える）"]}),u.jsxs("li",{children:["• ",u.jsx("strong",{children:"0.0"}),": 相関なし（関係性がない）"]}),u.jsxs("li",{children:["• ",u.jsx("strong",{children:"-1.0"}),": 完全な負の相関（一方が増えれば他方は減る）"]}),u.jsx("li",{children:"• 対角線上の1.0は自分自身との相関を示します"})]})]})]})}const zL=(t,e)=>{if(t==="classification"&&e){if(e.includes("中国")||e.includes("南蛮")||e.includes("朝鮮")||e.includes("日本"))return["#DC143C","#228B22","#DAA520","#4B0082"];if(e.includes("槍兵")||e.includes("弓兵")||e.includes("鉄砲隊")||e.includes("騎馬隊"))return["#8B4513","#DC143C","#228B22","#DAA520"];if(e.includes("敗北")||e.includes("勝利"))return["#DC143C","#228B22"];if(e.includes("低い")||e.includes("中程度")||e.includes("高い"))return["#8B4513","#DAA520","#228B22"];if(e.includes("危険")||e.includes("注意")||e.includes("安全"))return["#DC143C","#DAA520","#228B22"]}return["#8B4513","#DC143C","#228B22","#DAA520","#4B0082","#B22222","#2F4F4F","#CD853F"]};function KL({dataset:t}){const e=t.raw?.train?.length?t.raw.train:t.train,r=Math.min(e.length,200),n=e.slice(0,r),a=t.classes&&t.classes.length>0;if(!t||!n||n.length===0)return u.jsx("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:u.jsx("div",{className:"text-center text-gray-500",children:"データが読み込まれていません"})});const i=zL(a?"classification":"regression",t.classes),s=[];for(let l=0;l<t.featureNames.length;l++)for(let d=l+1;d<t.featureNames.length;d++)s.push([l,d]);const o=s.slice(0,6);return u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(fc,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),u.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--accent-strong)"},children:"散布図行列（主要な特徴量ペア）"})]}),u.jsxs("div",{className:"text-sm mb-4",style:{color:"var(--accent-strong)"},children:["特徴量間の関係性を視覚的に確認できます。",a?"色分けはクラスを表しています。":"色の濃さは目的変数の値を表しています。",u.jsx("br",{}),u.jsxs("span",{className:"text-xs text-gray-600",children:["💡 ",a?"直線的な関係があれば線形モデル、曲線的な関係があれば非線形モデルが適しています":"特徴量と目的変数の関係を確認し、予測に有効な特徴量を見つけましょう"]}),u.jsx("br",{}),u.jsxs("span",{className:"text-xs text-gray-500",children:["🎨 戦国時代テーマの色で表示：",a?"各クラスが異なる色で表示されます":"回帰問題は茶色系で表示されます"]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(([l,d],c)=>{const h=n.map(P=>{const k=(t.raw,P.features[l]),D=(t.raw,P.features[d]);let I;return a&&typeof P.label=="string"?I=t.classes?.indexOf(P.label)??0:I=Number(P.label),{x:k,y:D,label:I,value:I}});if(h.length===0)return u.jsxs("div",{className:"p-3 rounded border",style:{background:"linear-gradient(135deg, #f8f4e6 0%, #f0e6d2 100%)",borderColor:"var(--gold)",borderWidth:"2px"},children:[u.jsxs("h4",{className:"text-xs font-bold mb-2 text-center",style:{color:"var(--accent-strong)"},children:[t.featureNames[l]," vs ",t.featureNames[d]]}),u.jsx("div",{className:"text-center text-gray-500 text-xs",children:"データがありません"})]},c);const f=h.map(P=>P.x),m=h.map(P=>P.y),p=[...new Set(f)],g=[...new Set(m)];if(p.length===1&&g.length===1)return u.jsxs("div",{className:"p-3 rounded border",style:{background:"linear-gradient(135deg, #f8f4e6 0%, #f0e6d2 100%)",borderColor:"var(--gold)",borderWidth:"2px"},children:[u.jsxs("h4",{className:"text-xs font-bold mb-2 text-center",style:{color:"var(--accent-strong)"},children:[t.featureNames[l]," vs ",t.featureNames[d]]}),u.jsx("div",{className:"text-center text-gray-500 text-xs",children:"データの変化がありません"})]},c);const y=f.length>0?Math.min(...f):0,b=f.length>0?Math.max(...f):1,x=m.length>0?Math.min(...m):0,w=m.length>0?Math.max(...m):1,_=b-y,S=w-x,j=_>0?_*.1:.1,N=S>0?S*.1:.1,M=_===0?[y-.1,y+.1]:[Math.max(0,y-j),b+j],O=S===0?[x-.1,x+.1]:[Math.max(0,x-N),w+N],T=a?[...new Set(h.map(P=>P.label))].sort():[0];return u.jsxs("div",{className:"p-3 rounded border",style:{background:"linear-gradient(135deg, #f8f4e6 0%, #f0e6d2 100%)",borderColor:"var(--gold)",borderWidth:"2px"},children:[u.jsxs("h4",{className:"text-xs font-bold mb-2 text-center",style:{color:"var(--accent-strong)"},children:[t.featureNames[l]," vs ",t.featureNames[d]]}),u.jsx(br,{width:"100%",height:180,children:u.jsxs(FL,{margin:{top:5,right:5,bottom:5,left:5},children:[u.jsx(wr,{strokeDasharray:"3 3",stroke:"#8B4513",strokeOpacity:.3}),u.jsx(_r,{type:"number",dataKey:"x",name:t.featureNames[l],domain:M,tick:{fontSize:10,fill:"#8B4513"},axisLine:{stroke:"#8B4513"},tickLine:{stroke:"#8B4513"},tickFormatter:P=>{const k=t.raw?.featureUnits?.[l]||"";return k?k==="m/s"?`${Math.round(P*10)/10}${k}`:k==="m"?`${Math.round(P*10)/10}${k}`:k==="隻"?`${Math.round(P)}${k}`:k==="点"?`${Math.round(P)}${k}`:k==="段階"?`${Math.round(P)}${k}`:k==="文"?`${Math.round(P)}${k}`:k==="年"?`${Math.round(P)}${k}`:k==="歳"?`${Math.round(P)}${k}`:k==="℃"?`${Math.round(P)}${k}`:k==="mm"?`${Math.round(P)}${k}`:k==="時間"?`${Math.round(P)}h`:k==="kg"?`${Math.round(P)}${k}`:k==="両"?`${Math.round(P)}${k}`:k==="石"?`${Math.round(P)}${k}`:`${Math.round(P)}${k}`:Ne(P).toString()}}),u.jsx(jr,{type:"number",dataKey:"y",name:t.featureNames[d],domain:O,tick:{fontSize:10,fill:"#8B4513"},axisLine:{stroke:"#8B4513"},tickLine:{stroke:"#8B4513"},tickFormatter:P=>{const k=t.raw?.featureUnits?.[d]||"";return k?k==="m/s"?`${Math.round(P*10)/10}${k}`:k==="m"?`${Math.round(P*10)/10}${k}`:k==="隻"?`${Math.round(P)}${k}`:k==="点"?`${Math.round(P)}${k}`:k==="段階"?`${Math.round(P)}${k}`:k==="文"?`${Math.round(P)}${k}`:k==="年"?`${Math.round(P)}${k}`:k==="歳"?`${Math.round(P)}${k}`:k==="℃"?`${Math.round(P)}${k}`:k==="mm"?`${Math.round(P)}${k}`:k==="時間"?`${Math.round(P)}h`:k==="kg"?`${Math.round(P)}${k}`:k==="両"?`${Math.round(P)}${k}`:k==="石"?`${Math.round(P)}${k}`:`${Math.round(P)}${k}`:Ne(P).toString()}}),u.jsx(xo,{range:[50,50]}),u.jsx(yr,{cursor:{strokeDasharray:"3 3"},content:({active:P,payload:k})=>{if(P&&k&&k.length){const D=k[0].payload;return u.jsxs("div",{className:"bg-white p-3 border rounded shadow-lg text-xs",style:{borderColor:"var(--gold)"},children:[u.jsxs("p",{className:"font-medium",style:{color:"var(--accent-strong)"},children:[t.featureNames[l],": ",(()=>{const I=t.raw?.featureUnits?.[l]||"";return I?`${Math.round(D.x)}${I}`:Ne(D.x)})()]}),u.jsxs("p",{className:"font-medium",style:{color:"var(--accent-strong)"},children:[t.featureNames[d],": ",(()=>{const I=t.raw?.featureUnits?.[d]||"";return I?`${Math.round(D.y)}${I}`:Ne(D.y)})()]}),a?u.jsxs("p",{className:"font-bold",style:{color:"var(--gold)"},children:["クラス: ",t.classes[D.label]]}):u.jsxs("p",{className:"font-bold",style:{color:"var(--gold)"},children:[t.labelName,": ",(()=>{const I=t.raw?.featureUnits?.[t.featureNames.length]||"";return I?`${Math.round(D.value)}${I}`:Ne(D.value)})()]})]})}return null}}),a?T.map((P,k)=>{const D=h.filter(I=>I.label===P);return D.length>0?u.jsx(yu,{name:t.classes?t.classes[P]:`グループ ${P}`,data:D,fill:i[k%i.length],stroke:i[k%i.length],strokeWidth:2,fillOpacity:.8,r:4},P):null}):h.length>0?u.jsx(yu,{data:h,fill:i[0],fillOpacity:.8,stroke:i[1]||i[0],strokeWidth:2,r:4}):null]})})]},c)})}),s.length>6&&u.jsxs("div",{className:"mt-4 text-center text-sm",style:{color:"var(--accent-strong)"},children:["主要な",o.length,"組の特徴量ペアを表示しています （全",s.length,"組）"]})]})}function HL(t){const e=[...t.train,...t.test],r=t.featureNames.length,n=Array.from({length:r},(s,o)=>{const l=e.map(m=>m.features[o]),c=l.reduce((m,p)=>m+p,0)/l.length,h=l.reduce((m,p)=>m+Math.pow(p-c,2),0)/l.length,f=Math.sqrt(h);return{min:Math.min(...l),max:Math.max(...l),mean:c,std:f}}),a=[];e.forEach((s,o)=>{s.features.forEach((l,d)=>{const{mean:c,std:h}=n[d];Math.abs((l-c)/h)>3&&a.push({index:o,featureIndex:d,value:l})})});let i;return t.classes&&(i={},e.forEach(s=>{const o=typeof s.label=="number"&&t.classes?t.classes[s.label]:String(s.label);i[o]=(i[o]||0)+1})),{outliers:a.slice(0,20),missingValues:0,classBalance:i,featureRanges:n}}function VL(t){const e=[],r=[...t.train,...t.test],n=t.featureNames.map((a,i)=>{const s=r.map(h=>h.features[i]),l=s.reduce((h,f)=>h+f,0)/s.length,d=s.reduce((h,f)=>h+Math.pow(f-l,2),0)/s.length,c=Math.sqrt(d);return{mean:l,std:c}});return r.forEach((a,i)=>{let s=0;a.features.forEach((o,l)=>{const{mean:d,std:c}=n[l];Math.abs((o-d)/c)>2.5&&s++}),s>=2&&e.push(i)}),e}function GL(t,e){const r=[];if(t.outliers.length>0&&r.push(`外れ値が${t.outliers.length}個検出されました。これらのデータポイントを確認し、削除または補正を検討してください。`),t.classBalance){const i=Object.values(t.classBalance),s=Math.max(...i),o=Math.min(...i),l=s/o;l>3&&r.push(`クラスの不均衡が検出されました（最大比率: ${l.toFixed(1)}:1）。サンプリング手法の適用を検討してください。`)}t.featureRanges.forEach((i,s)=>{i.std<.01&&r.push(`特徴量「${e.featureNames[s]}」の分散が非常に小さいです。この特徴量は予測にあまり寄与しない可能性があります。`)});const a=YL(e).filter(i=>Math.abs(i.correlation)>.9&&i.feature1!==i.feature2);return a.length>0&&r.push(`高い相関を持つ特徴量のペアが${a.length}個見つかりました。多重共線性の可能性があります。`),r.length===0&&r.push("データの品質は良好です。このままモデルの学習を進めましょう。"),r}function YL(t){const e=[],r=[...t.train,...t.test],n=t.featureNames.length;for(let a=0;a<n;a++)for(let i=a+1;i<n;i++){const s=r.map(p=>p.features[a]),o=r.map(p=>p.features[i]),l=s.reduce((p,g)=>p+g,0)/s.length,d=o.reduce((p,g)=>p+g,0)/o.length;let c=0,h=0,f=0;for(let p=0;p<s.length;p++){const g=s[p]-l,y=o[p]-d;c+=g*y,h+=g*g,f+=y*y}const m=c/Math.sqrt(h*f);e.push({feature1:a,feature2:i,correlation:m})}return e}function bw({dataset:t}){const[e,r]=v.useState("overview"),n=v.useMemo(()=>HL(t),[t]),a=v.useMemo(()=>VL(t),[t]),i=v.useMemo(()=>GL(n,t),[n,t]),s=[{id:"overview",label:"データの中身",icon:_o,description:"実際のデータを見てみよう"},{id:"statistics",label:"数値の特徴",icon:Tn,description:"平均・最大・ばらつきを確認"},{id:"distribution",label:"値の広がり",icon:Ei,description:"どの値が多いかヒストグラムで確認"},{id:"correlation",label:"関係性",icon:Di,description:"特徴同士の相関を見る"},{id:"scatter",label:"散らばり具合",icon:fc,description:"2つの特徴の関係を見る"},{id:"insights",label:"AIの洞察",icon:On,description:"データから分かること"}];return u.jsxs("div",{className:"rounded-xl shadow-lg border-2 overflow-hidden",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"p-4 rounded-t-xl",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx(_o,{className:"w-5 h-5 text-yellow-400"}),u.jsx("h3",{className:"text-lg font-bold text-white",children:"データを調べよう"})]}),u.jsx("p",{className:"text-sm text-yellow-200",children:"データをよく観察して、パターンや特徴を見つけよう！"})]}),u.jsx("div",{className:"border-b bg-slate-50",style:{borderColor:"var(--gold)"},children:u.jsx("div",{className:"flex space-x-2 p-3 overflow-x-auto",children:s.map(o=>{const l=o.icon;return u.jsxs("button",{onClick:()=>r(o.id),className:`flex flex-col items-center space-y-1 px-4 py-3 rounded-lg transition-all whitespace-nowrap min-w-[120px] border-2 ${e===o.id?"shadow-md scale-105 font-bold bg-yellow-400 text-blue-900 border-yellow-500":"hover:bg-blue-100 text-slate-600 border-slate-300"}`,children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(l,{className:"w-4 h-4"}),u.jsx("span",{className:"text-sm font-medium",children:o.label})]}),u.jsx("span",{className:"text-xs opacity-80",children:o.description})]},o.id)})})}),u.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-slate-50 to-gray-50 border-b",style:{borderColor:"var(--gold)"},children:[e==="overview"&&u.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[u.jsx(Su,{className:"w-5 h-5 mt-1 text-yellow-500"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-lg",children:"見方のコツ"}),u.jsx("div",{className:"text-base",children:"単位や桁を確認し、常識的な値かをチェック。生データ（raw）があれば比較して理解を深めよう。"})]})]}),e==="distribution"&&u.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[u.jsx(Ei,{className:"w-5 h-5 mt-1 text-yellow-500"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),u.jsx("div",{className:"text-base",children:t.classes&&t.classes.length>0?"山型＝自然な分布。片寄りや二峰性のときは前処理（正規化/標準化）を検討しよう。":"目的変数が正規分布に近いと回帰モデルの精度が向上しやすくなります。"}),u.jsxs("div",{className:"text-sm text-blue-700 mt-2",children:["💡 ",t.classes&&t.classes.length>0?"新問題例：毛利氏の風速は正規分布、加賀の信者数は偏りがある、長宗我部氏の戦果は3つのクラスに分かれる":"回帰問題例：甲斐の産出量、越後の収穫量、出羽の輸送効率など、目的変数の分布を確認しよう"]})]})]}),e==="correlation"&&u.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[u.jsx(Di,{className:"w-5 h-5 mt-1 text-yellow-500"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),u.jsx("div",{className:"text-base",children:"相関の高い特徴は有力候補。同じ情報の重複は減らしてシンプルに。"})]})]}),e==="scatter"&&u.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[u.jsx(fc,{className:"w-5 h-5 mt-1 text-yellow-500"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),u.jsx("div",{className:"text-base",children:t.classes&&t.classes.length>0?"直線/曲線の形が見えたら、それに合うモデル（線形/非線形）を選ぼう。":"特徴量と目的変数の関係を確認し、予測に有効な特徴量を見つけよう。"}),u.jsxs("div",{className:"text-sm text-blue-700 mt-2",children:["💡 ",t.classes&&t.classes.length>0?"新問題例：毛利氏の海戦では風速と船数、加賀の布教では人口密度と経済状況、長宗我部氏の戦略では兵力と装備の関係を確認しよう":"回帰問題例：甲斐の産出量では労働者数と気温、越後の収穫量では降水量と日照時間、出羽の輸送効率では距離と標高の関係を確認しよう"]})]})]}),e==="statistics"&&u.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[u.jsx(Tn,{className:"w-5 h-5 mt-1 text-yellow-500"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-lg",children:"読み取りポイント"}),u.jsx("div",{className:"text-base",children:"平均±標準偏差の範囲が常識的か、外れ値が多すぎないかを確認しよう。"})]})]}),e==="insights"&&u.jsxs("div",{className:"text-base text-blue-900 flex items-start space-x-3",children:[u.jsx(On,{className:"w-5 h-5 mt-1 text-yellow-500"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-lg",children:"次の一手"}),u.jsx("div",{className:"text-base",children:"必要に応じて前処理タブで正規化/標準化を試し、相関の高い特徴を中心に選んでみよう。"})]})]})]}),u.jsxs("div",{className:"p-6",children:[e==="overview"&&u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-300 shadow-sm",children:[u.jsx("div",{className:"text-lg font-bold text-blue-900 mb-2",children:"データ数"}),u.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:["訓練: ",t.train.length," / テスト: ",t.test.length]})]}),u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-300 shadow-sm",children:[u.jsx("div",{className:"text-lg font-bold text-blue-900 mb-3",children:"特徴量"}),u.jsx("div",{className:"space-y-2",children:t.featureNames.map((o,l)=>u.jsxs("div",{className:"text-base text-blue-800 flex items-center",children:[u.jsx("span",{className:"w-3 h-3 bg-blue-600 rounded-full mr-3"}),o]},l))})]}),t.classes&&u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-300 shadow-sm",children:[u.jsx("div",{className:"text-lg font-bold text-blue-900 mb-3",children:"クラス"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:t.classes.map((o,l)=>u.jsx("span",{className:"px-3 py-2 bg-blue-200 text-blue-900 text-base rounded-lg font-bold",children:o},l))})]}),t.raw&&u.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border-2 border-slate-300 shadow-sm",children:[u.jsx("div",{className:"text-lg font-bold text-slate-900 mb-3",children:"生データ（前処理前）"}),u.jsx("div",{className:"overflow-x-auto bg-white rounded-lg border-2 border-slate-200",children:u.jsxs("table",{className:"w-full text-base",children:[u.jsx("thead",{className:"bg-slate-100",children:u.jsxs("tr",{className:"border-b-2 border-slate-300",children:[t.featureNames.map((o,l)=>u.jsxs("th",{className:"px-3 py-3 text-left text-slate-900 font-bold",children:[o,t.raw?.featureUnits?.[l]&&u.jsxs("span",{className:"text-slate-600 ml-1",children:["(",t.raw.featureUnits[l],")"]})]},l)),u.jsx("th",{className:"px-3 py-3 text-left text-slate-900 font-bold",children:"ラベル"})]})}),u.jsx("tbody",{className:"bg-white",children:t.raw.train.slice(0,5).map((o,l)=>u.jsxs("tr",{className:"border-b border-slate-200 hover:bg-slate-50",children:[o.features.map((d,c)=>u.jsx("td",{className:"px-3 py-3 text-slate-900",children:typeof d=="number"?Ne(d):d},c)),u.jsx("td",{className:"px-3 py-3 text-slate-900 font-bold",children:Array.isArray(t.classes)&&typeof o.label=="number"?t.classes[o.label]??o.label:o.label})]},l))})]})})]})]}),e==="statistics"&&u.jsx(xj,{dataset:t}),e==="distribution"&&u.jsx(WL,{dataset:t}),e==="correlation"&&u.jsx(qL,{dataset:t}),e==="scatter"&&u.jsx(KL,{dataset:t}),e==="insights"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border-2 border-amber-400",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(On,{className:"w-5 h-5 text-amber-700"}),u.jsx("h4",{className:"text-lg font-bold text-amber-900",children:"データ改善の提案"})]}),u.jsx("div",{className:"space-y-2",children:i.map((o,l)=>u.jsxs("div",{className:"flex items-start space-x-2 text-sm text-amber-800",children:[u.jsx(Pr,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),u.jsx("span",{children:o})]},l))})]}),n.classBalance&&u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-400",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(Ei,{className:"w-5 h-5 text-blue-700"}),u.jsx("h4",{className:"text-lg font-bold text-blue-900",children:"クラスバランス"})]}),u.jsx("div",{className:"space-y-2",children:Object.entries(n.classBalance).map(([o,l])=>{const d=Object.values(n.classBalance).reduce((h,f)=>h+f,0),c=(l/d*100).toFixed(1);return u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{className:"font-medium text-blue-900",children:o}),u.jsxs("span",{className:"text-blue-700",children:[l,"件 (",c,"%)"]})]}),u.jsx("div",{className:"h-3 bg-blue-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all",style:{width:`${c}%`}})})]},o)})})]}),n.outliers.length>0&&u.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border-2 border-red-400",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(mc,{className:"w-5 h-5 text-red-700"}),u.jsx("h4",{className:"text-lg font-bold text-red-900",children:"外れ値の検出"})]}),u.jsxs("p",{className:"text-sm text-red-800 mb-3",children:[n.outliers.length,"個の外れ値が検出されました（表示上限20個）。これらは通常のパターンから大きく外れたデータポイントです。"]}),u.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:n.outliers.slice(0,10).map((o,l)=>u.jsxs("div",{className:"bg-white p-2 rounded border border-red-300 text-xs",children:[u.jsxs("span",{className:"font-medium text-red-900",children:["データ#",o.index+1]}),u.jsxs("span",{className:"text-red-700 ml-2",children:[t.featureNames[o.featureIndex],": ",o.value.toFixed(3)]})]},l))})]}),a.length>0&&u.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border-2 border-orange-400",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(mc,{className:"w-5 h-5 text-orange-700"}),u.jsx("h4",{className:"text-lg font-bold text-orange-900",children:"異常データの検出"})]}),u.jsxs("p",{className:"text-sm text-orange-800",children:[a.length,"個の異常なデータポイントが検出されました。複数の特徴量で同時に異常な値を持つデータです。"]})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border-2 border-green-400",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(_o,{className:"w-5 h-5 text-green-700"}),u.jsx("h4",{className:"text-lg font-bold text-green-900",children:"データ品質スコア"})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-green-800",children:"完全性"}),u.jsx("span",{className:"font-bold text-green-900",children:"100%"})]}),u.jsx("div",{className:"h-2 bg-green-200 rounded-full",children:u.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:"100%"}})})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-green-800",children:"バランス"}),u.jsx("span",{className:"font-bold text-green-900",children:n.classBalance?(()=>{const o=Object.values(n.classBalance),l=Math.max(...o);return`${(Math.min(...o)/l*100).toFixed(0)}%`})():"100%"})]}),u.jsx("div",{className:"h-2 bg-green-200 rounded-full",children:u.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:n.classBalance?(()=>{const o=Object.values(n.classBalance),l=Math.max(...o);return`${(Math.min(...o)/l*100).toFixed(0)}%`})():"100%"}})})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[u.jsx("span",{className:"text-green-800",children:"異常値の少なさ"}),u.jsxs("span",{className:"font-bold text-green-900",children:[((t.train.length+t.test.length-n.outliers.length)/(t.train.length+t.test.length)*100).toFixed(0),"%"]})]}),u.jsx("div",{className:"h-2 bg-green-200 rounded-full",children:u.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:`${((t.train.length+t.test.length-n.outliers.length)/(t.train.length+t.test.length)*100).toFixed(0)}%`}})})]})]})]}),u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-400",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(Pr,{className:"w-5 h-5 text-blue-700"}),u.jsx("h4",{className:"text-lg font-bold text-blue-900",children:"データの特徴分析"})]}),u.jsx("div",{className:"space-y-2",children:u.jsxs("div",{className:"text-sm text-blue-800",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"データサイズ:"})," ",t.train.length+t.test.length,"件"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"特徴量数:"})," ",t.featureNames.length,"個"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"問題タイプ:"})," ",t.classes?"分類問題":"回帰問題"]}),t.classes&&u.jsxs("p",{children:[u.jsx("strong",{children:"クラス数:"})," ",t.classes.length,"個"]})]})})]})]})]})]})}function JL(t){const e=t.featureNames.length,r=Array(e).fill(1/0),n=Array(e).fill(-1/0),a=t.raw?.train?.length?t.raw:{train:t.train,test:t.test};a.train.forEach(s=>{for(let o=0;o<e;o++){const l=s.features[o];r[o]=Math.min(r[o],l),n[o]=Math.max(n[o],l)}});const i=s=>({features:s.features.map((o,l)=>{const d=n[l]-r[l];return!isFinite(d)||d===0?0:(o-r[l])/d}),label:s.label});return{train:a.train.map(i),test:a.test.map(i),featureNames:t.featureNames,labelName:t.labelName,classes:t.classes,raw:t.raw}}function xw({dataset:t,onPreprocess:e}){const[r,n]=v.useState("none"),[a,i]=v.useState([]);function s(c,h){const f={},m=h.filter(g=>{const y=c.train.slice(0,20).map(w=>w.features[g]),b=new Set(y.map(w=>String(w))),x=b.size<=5&&y.every(w=>{const _=String(w);return isNaN(Number(_))||Number.isInteger(Number(_))});return console.log(`特徴量 ${g}: ユニーク値数=${b.size}, カテゴリ判定=${x}`),x});console.log("カテゴリ変数として処理される特徴量:",m),c.train.forEach(g=>{g.features.forEach((y,b)=>{if(!m.includes(b))return;const x=String(y);f[b]||(f[b]=new Map),f[b].has(x)||f[b].set(x,f[b].size)})}),c.test.forEach(g=>{g.features.forEach((y,b)=>{if(!m.includes(b))return;const x=String(y);f[b]||(f[b]=new Map),f[b].has(x)||f[b].set(x,f[b].size)})});const p=g=>({features:g.features.map((y,b)=>{if(!m.includes(b))return y;const x=String(y);return f[b].get(x)??0}),label:g.label});return{...c,train:c.train.map(p),test:c.test.map(p)}}const o=v.useMemo(()=>r==="encode"?s(t,a):r==="normalize"?JL(t):t,[r,t,a]),d=v.useMemo(()=>r==="none"?t.raw||t:o,[r,t,o])||t;return u.jsxs("div",{className:"rounded-xl shadow-lg border-2 overflow-hidden",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"p-4 rounded-t-xl",style:{background:"linear-gradient(to right, var(--accent-strong), var(--accent))"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx(ks,{className:"w-5 h-5",style:{color:"var(--gold)"}}),u.jsx("h3",{className:"text-lg font-bold text-white",children:"データの前処理"})]}),u.jsx("p",{className:"text-sm text-white/85",children:"生データを機械学習に適した形に整えよう（EDAで生データも確認できます）"})]}),u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("button",{onClick:()=>n("none"),className:`flex items-center justify-between p-4 rounded-lg border-2 ${r==="none"?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(jo,{className:"w-5 h-5 text-gray-800"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-gray-900",children:"前処理なし"}),u.jsx("div",{className:"text-xs text-gray-600",children:"元のスケールのまま使う"})]})]}),r==="none"&&u.jsx(So,{className:"w-5 h-5 text-yellow-600"})]}),u.jsxs("button",{onClick:()=>n("encode"),className:`flex items-center justify-between p-4 rounded-lg border-2 ${r==="encode"?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(jo,{className:"w-5 h-5 text-gray-800"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-gray-900",children:"カテゴリ数値化"}),u.jsx("div",{className:"text-xs text-gray-600",children:"カテゴリを整数IDに符号化（ラベルエンコード）"})]})]}),r==="encode"&&u.jsx(So,{className:"w-5 h-5 text-yellow-600"})]}),u.jsxs("button",{onClick:()=>n("normalize"),className:`flex items-center justify-between p-4 rounded-lg border-2 ${r==="normalize"?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(jo,{className:"w-5 h-5 text-gray-800"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-gray-900",children:"正規化（0-1）"}),u.jsx("div",{className:"text-xs text-gray-600",children:"各特徴量を0〜1に揃える"})]})]}),r==="normalize"&&u.jsx(So,{className:"w-5 h-5 text-yellow-600"})]})]}),r==="encode"&&u.jsxs("div",{className:"text-sm text-gray-700",children:[u.jsx("div",{className:"font-semibold mb-2",children:"数値化する特徴量を選択（カテゴリ → 整数）"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:t.featureNames.map((c,h)=>u.jsx("button",{onClick:()=>i(f=>f.includes(h)?f.filter(m=>m!==h):[...f,h]),className:`px-3 py-1 rounded border ${a.includes(h)?"bg-emerald-100 border-emerald-400 text-emerald-800":"bg-white border-gray-300 text-gray-700"}`,children:c},h))})]}),u.jsxs("div",{className:"text-sm",children:[u.jsx("div",{className:"font-semibold mb-2 text-gray-900",children:"プレビュー（先頭5件）"}),d&&d.train&&d.train.length>0?u.jsx("div",{className:"overflow-x-auto rounded bg-white border-2 border-gray-200 shadow-sm",children:u.jsxs("table",{className:"w-full text-sm",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{className:"border-b border-gray-200",children:[d.featureNames.map((c,h)=>u.jsx("th",{className:"px-3 py-3 text-left font-semibold text-gray-900",children:c},h)),u.jsx("th",{className:"px-3 py-3 text-left font-semibold text-gray-900",children:"ラベル"})]})}),u.jsx("tbody",{className:"bg-white",children:d.train.slice(0,5).map((c,h)=>u.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[c.features.map((f,m)=>u.jsx("td",{className:"px-3 py-3 text-gray-800",children:typeof f=="number"?f.toFixed(3):f},m)),u.jsx("td",{className:"px-3 py-3 font-medium text-gray-900",children:typeof c.label=="number"?c.label.toFixed(3):c.label})]},h))})]})}):u.jsxs("div",{className:"p-4 bg-gray-100 rounded border-2 border-gray-200 text-center text-gray-600",children:[u.jsx("div",{className:"mb-2",children:"データを読み込み中..."}),u.jsx("div",{className:"text-xs text-gray-500",children:"データの読み込みに時間がかかっています。しばらくお待ちください。"})]})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{onClick:()=>e(o),className:"text-white px-8 py-3 rounded-lg font-bold shadow-lg transition-all",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))"},children:"前処理を適用して次へ"})})]})]})}function ww({dataset:t,selectedFeatures:e,onFeaturesChange:r}){const n=s=>{e.includes(s)?r(e.filter(o=>o!==s)):r([...e,s].sort((o,l)=>o-l))},a=()=>{r(t.featureNames.map((s,o)=>o))},i=s=>{const o=t.train.map(f=>f.features[s]),d=o.reduce((f,m)=>f+m,0)/o.length,c=o.reduce((f,m)=>f+Math.pow(m-d,2),0)/o.length,h=Math.sqrt(c);return{mean:d,std:h,min:Math.min(...o),max:Math.max(...o)}};return u.jsxs("div",{className:"rounded-xl shadow-lg border-2 overflow-hidden",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"p-6",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%)"},children:[u.jsx("h3",{className:"text-2xl font-bold text-white",children:"使う特徴を選ぼう"}),u.jsx("p",{className:"text-lg mt-2 text-yellow-200",children:"予測に役立ちそうな特徴を選びます。最低1つは選んでください。"})]}),u.jsxs("div",{className:"p-8",children:[u.jsx("div",{className:"mb-8 p-6 rounded-lg border-2 bg-slate-50",style:{borderColor:"var(--gold)"},children:u.jsxs("div",{className:"flex items-start space-x-4",children:[u.jsx(On,{className:"w-6 h-6 flex-shrink-0 mt-1 text-yellow-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-lg leading-relaxed mb-3 text-blue-900",children:u.jsx("span",{className:"font-bold",children:"特徴選択のポイント："})}),u.jsxs("ul",{className:"text-base space-y-2 text-blue-800",children:[u.jsx("li",{children:"• 値のばらつき（標準偏差）が大きい特徴は予測に役立つことが多い"}),u.jsx("li",{children:"• すべての特徴を使うと、逆に精度が下がることもある"}),u.jsx("li",{children:"• まずは全部使ってみて、少しずつ減らして試してみよう"})]})]})]})}),u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{className:"text-lg text-blue-900",children:["選択中: ",u.jsx("span",{className:"font-bold text-blue-700",children:e.length})," / ",t.featureNames.length]}),u.jsx("button",{onClick:a,className:"text-lg font-bold transition-colors text-blue-600 hover:text-blue-800 px-4 py-2 rounded-lg border-2 border-blue-300 hover:border-blue-500",children:"すべて選択"})]}),u.jsx("div",{className:"space-y-4",children:t.featureNames.map((s,o)=>{const l=e.includes(o),d=i(o);return u.jsx("button",{onClick:()=>n(o),className:`w-full text-left p-6 rounded-lg border-2 transition-all ${l?"bg-yellow-50 shadow-lg border-yellow-400":"bg-slate-50 hover:bg-blue-50 border-slate-300"}`,children:u.jsxs("div",{className:"flex items-start space-x-4",children:[u.jsx("div",{className:"flex-shrink-0 mt-1",children:l?u.jsx(pg,{className:"w-8 h-8 text-yellow-500"}):u.jsx(Pw,{className:"w-8 h-8 text-slate-400"})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h4",{className:`text-xl font-bold ${l?"text-blue-900":"text-slate-600"}`,children:s}),l&&u.jsx("span",{className:"text-sm px-3 py-1 rounded-full font-bold bg-blue-600 text-white",children:"使用中"})]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-base",children:[u.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[u.jsx("span",{className:"font-bold",children:"平均:"})," ",Ne(d.mean)]}),u.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[u.jsx("span",{className:"font-bold",children:"ばらつき:"})," ",Ne(d.std)]}),u.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[u.jsx("span",{className:"font-bold",children:"最小:"})," ",Ne(d.min)]}),u.jsxs("div",{className:l?"text-blue-800":"text-slate-500",children:[u.jsx("span",{className:"font-bold",children:"最大:"})," ",Ne(d.max)]})]})]})]})},o)})}),e.length===0&&u.jsx("div",{className:"mt-6 bg-red-50 p-6 rounded-lg border-2 border-red-200",children:u.jsx("p",{className:"text-lg text-red-800 text-center font-bold",children:"少なくとも1つの特徴を選んでください"})})]})]})}function _w({progress:t}){return t?u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-green-600 animate-pulse",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(Oh,{className:"w-5 h-5 text-green-900"}),u.jsx("h3",{className:"text-lg font-bold text-green-900",children:"訓練中..."})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-300",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-green-900",children:"進捗"}),u.jsxs("span",{className:"text-lg font-bold text-green-800",children:[t.epoch||0," / ",t.total||100,t.progress&&` (${t.progress}%)`]})]}),u.jsx("div",{className:"w-full bg-green-200 rounded-full h-3 overflow-hidden",children:u.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-full transition-all duration-300",style:{width:`${t.progress||Math.min((t.epoch||0)/(t.total||100)*100,100)}%`}})}),t.message&&u.jsx("div",{className:"mt-2 text-sm text-green-700 text-center",children:t.message})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-300",children:[u.jsx("div",{className:"text-xs font-medium text-green-900 mb-1",children:"損失"}),u.jsx("div",{className:"text-xl font-bold text-green-800",children:t.loss?.toFixed(4)||"0.0000"})]}),(t.accuracy||0)>0&&u.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-300",children:[u.jsx("div",{className:"text-xs font-medium text-green-900 mb-1",children:"精度"}),u.jsxs("div",{className:"text-xl font-bold text-green-800",children:[((t.accuracy||0)*100).toFixed(1),"%"]})]})]}),(t.elapsed||t.eta)&&u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-300",children:[u.jsx("div",{className:"text-xs font-medium text-blue-900 mb-1",children:"経過時間"}),u.jsx("div",{className:"text-lg font-bold text-blue-800",children:t.elapsed?`${(t.elapsed/1e3).toFixed(1)}s`:"N/A"})]}),u.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-300",children:[u.jsx("div",{className:"text-xs font-medium text-blue-900 mb-1",children:"残り時間"}),u.jsx("div",{className:"text-lg font-bold text-blue-800",children:t.eta?`${(t.eta/1e3).toFixed(1)}s`:"N/A"})]})]})]})]}):u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-green-600 animate-pulse",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(Oh,{className:"w-5 h-5 text-green-900"}),u.jsx("h3",{className:"text-lg font-bold text-green-900",children:"訓練中..."})]}),u.jsx("div",{className:"text-center text-green-700",children:"学習を開始しています..."})]})}function XL({modelType:t,parameters:e,onParametersChange:r,onClose:n}){const[a,i]=v.useState(e),s=b=>{switch(b){case"logistic_regression":return{learning_rate:.01,max_iterations:1e3,regularization:.1,solver:"lbfgs"};case"linear_regression":return{learning_rate:.01,max_iterations:1e3,regularization:.1};case"neural_network":return{learning_rate:.01,max_iterations:100,hidden_layers:2,hidden_units:16,dropout_rate:.2,activation:"relu",optimizer:"adam"};case"knn":return{k:5,distance_metric:"euclidean",weights:"uniform"};case"random_forest":return{n_estimators:100,max_depth:10,min_samples_split:2,min_samples_leaf:1,max_features:"sqrt"};case"svm":return{C:1,kernel:"rbf",gamma:"scale",degree:3};default:return{}}},o=(b,x)=>({logistic_regression:{learning_rate:"学習率: モデルの学習速度を制御します（0.001-1.0）",max_iterations:"最大反復回数: 学習の最大回数（100-10000）",regularization:"正則化: 過学習を防ぐ強度（0.0-1.0）",solver:"ソルバー: 最適化アルゴリズム"},linear_regression:{learning_rate:"学習率: モデルの学習速度を制御します（0.001-1.0）",max_iterations:"最大反復回数: 学習の最大回数（100-10000）",regularization:"正則化: 過学習を防ぐ強度（0.0-1.0）"},neural_network:{learning_rate:"学習率: モデルの学習速度を制御します（0.001-1.0）",max_iterations:"エポック数: 学習の回数（10-1000）",hidden_layers:"隠れ層数: ニューラルネットワークの層数（1-5）",hidden_units:"隠れユニット数: 各層のニューロン数（4-128）",dropout_rate:"ドロップアウト率: 過学習防止の強度（0.0-0.8）",activation:"活性化関数: ニューロンの活性化方法",optimizer:"オプティマイザー: 最適化アルゴリズム"},knn:{k:"近傍数: 予測に使用する近いデータの数（1-20）",distance_metric:"距離指標: データ間の距離計算方法",weights:"重み付け: 近傍データの重み付け方法"},random_forest:{n_estimators:"決定木数: 使用する決定木の数（10-500）",max_depth:"最大深度: 各決定木の最大の深さ（1-20）",min_samples_split:"分割最小サンプル数: ノード分割に必要な最小サンプル数（2-20）",min_samples_leaf:"葉最小サンプル数: 葉ノードの最小サンプル数（1-10）",max_features:"最大特徴数: 各分割で考慮する特徴数"},svm:{C:"正則化パラメータ: 誤分類の許容度（0.1-100）",kernel:"カーネル: データの変換方法",gamma:"ガンマ: カーネルの影響範囲（scale, auto, 数値）",degree:"次数: 多項式カーネルの次数（1-10）"}})[x]?.[b]||"",l=(b,x)=>{const w=["learning_rate","max_iterations","regularization","k","n_estimators","max_depth","min_samples_split","min_samples_leaf","C","degree","hidden_layers","hidden_units","dropout_rate"],_=["solver","activation","optimizer","distance_metric","weights","kernel","gamma","max_features"];return w.includes(b)?"number":_.includes(b)?"select":"text"},d=(b,x)=>({logistic_regression:{solver:["lbfgs","liblinear","newton-cg","sag","saga"]},neural_network:{activation:["relu","sigmoid","tanh","linear"],optimizer:["adam","sgd","rmsprop","adagrad"]},knn:{distance_metric:["euclidean","manhattan","minkowski"],weights:["uniform","distance"]},random_forest:{max_features:["sqrt","log2","auto","0.5","0.8"]},svm:{kernel:["rbf","linear","poly","sigmoid"],gamma:["scale","auto","0.001","0.01","0.1","1.0"]}})[x]?.[b]||[],c=(b,x)=>({logistic_regression:{learning_rate:{min:.001,max:1,step:.001},max_iterations:{min:100,max:1e4,step:100},regularization:{min:0,max:1,step:.01}},linear_regression:{learning_rate:{min:.001,max:1,step:.001},max_iterations:{min:100,max:1e4,step:100},regularization:{min:0,max:1,step:.01}},neural_network:{learning_rate:{min:.001,max:1,step:.001},max_iterations:{min:10,max:1e3,step:10},hidden_layers:{min:1,max:5,step:1},hidden_units:{min:4,max:128,step:4},dropout_rate:{min:0,max:.8,step:.1}},knn:{k:{min:1,max:20,step:1}},random_forest:{n_estimators:{min:10,max:500,step:10},max_depth:{min:1,max:20,step:1},min_samples_split:{min:2,max:20,step:1},min_samples_leaf:{min:1,max:10,step:1}},svm:{C:{min:.1,max:100,step:.1},degree:{min:1,max:10,step:1}}})[x]?.[b]||{min:0,max:100,step:1};v.useEffect(()=>{const b=s(t);i({...b,...e})},[t,e]);const h=(b,x)=>{const w={...a,[b]:x};i(w)},f=()=>{r(a),n()},m=()=>{const b=s(t);i(b)},p={logistic_regression:"ロジスティック回帰",linear_regression:"線形回帰",neural_network:"ニューラルネットワーク",knn:"k近傍法",random_forest:"ランダムフォレスト",svm:"サポートベクターマシン"}[t]||t,g=s(t),y=Object.entries(g);return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[u.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ks,{className:"w-6 h-6"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold",children:"ハイパーパラメータ設定"}),u.jsx("p",{className:"text-blue-100",children:p})]})]}),u.jsx("button",{onClick:n,className:"text-white hover:text-gray-200 transition-colors",children:u.jsx(kw,{className:"w-6 h-6"})})]})}),u.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(([b,x])=>{const w=l(b),_=o(b,t),S=a[b]??x;return u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-1",children:b.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),u.jsx("p",{className:"text-xs text-gray-600 mb-2",children:_})]}),w==="number"?u.jsxs("div",{children:[u.jsx("input",{type:"number",value:S,onChange:j=>h(b,parseFloat(j.target.value)||0),min:c(b,t).min,max:c(b,t).max,step:c(b,t).step,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),u.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[u.jsx("span",{children:c(b,t).min}),u.jsx("span",{children:c(b,t).max})]})]}):w==="select"?u.jsx("select",{value:S,onChange:j=>h(b,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:d(b,t).map(j=>u.jsx("option",{value:j,children:j},j))}):u.jsx("input",{type:"text",value:S,onChange:j=>h(b,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]},b)})})}),u.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-between items-center border-t border-gray-200",children:[u.jsxs("button",{onClick:m,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[u.jsx(Mw,{className:"w-4 h-4"}),u.jsx("span",{children:"デフォルトに戻す"})]}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:n,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"キャンセル"}),u.jsx("button",{onClick:f,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"保存"})]})]})]})})}function ZL({problemId:t,problemTitle:e,problemDescription:r,dataset:n,difficulty:a,timeLimit:i,onBack:s,isMultiplayer:o=!1,participants:l=[],roomId:d="default-room",username:c}){const h=Tt.getCurrentUser(),f=c||h?.username||"プレイヤー",[m,p]=v.useState(null),[g,y]=v.useState(null),[b,x]=v.useState([]),w=[{id:"logistic_regression",name:"ロジスティック回帰"},{id:"linear_regression",name:"線形回帰"},{id:"neural_network",name:"ニューラルネットワーク"}],[_,S]=v.useState("logistic_regression"),[j,N]=v.useState({}),[M,O]=v.useState(!1),[T,P]=v.useState(!1),[k,D]=v.useState(null),[I,z]=v.useState(null),[H,K]=v.useState("data"),[X,B]=v.useState(null),[R,Y]=v.useState(!1),[$,We]=v.useState(null),[ur,te]=v.useState(null),[Bt,Dr]=v.useState(null),[aa,L]=v.useState(!1),[V,Z]=v.useState(["accuracy"]),[C,$e]=v.useState({trainRatio:.7,validationRatio:.2,testRatio:.1,randomSeed:42,stratified:!0});v.useEffect(()=>{if(p(n),y(n),n.featureNames&&n.featureNames.length>0){const W=n.featureNames.slice(0,Math.min(3,n.featureNames.length)).map((ue,mt)=>mt);x(W)}B({id:t,title:e,description:r||"",problemType:n.classes&&n.classes.length>2?"multiclass_classification":n.classes&&n.classes.length===2?"binary_classification":"regression",difficulty:a||"medium",timeLimit:i||3600,dataset:{data:[...n.train,...n.test],train:n.train,test:n.test,validation:n.test,featureNames:n.featureNames,labelName:n.labelName,classes:n.classes||[],problemType:n.classes&&n.classes.length>0?"classification":"regression",defaultMetric:n.classes&&n.classes.length>0?"accuracy":"mae",description:r||"",metric:n.classes&&n.classes.length>0?"accuracy":"mae"},metric:n.classes&&n.classes.length>0?"accuracy":"mae",constraints:{maxFeatures:n.featureNames.length,maxTrainingTime:i||3600,maxSubmissions:100,allowedModels:["logistic_regression","linear_regression","neural_network"]},startTime:new Date,endTime:new Date(Date.now()+10080*60*1e3),participantCount:0,submissionCount:0})},[n,t,e,r,a,i]);const ce=async()=>{if(console.log("=== 学習開始 ==="),console.log("データセット:",!!g),console.log("特徴量:",b),console.log("モデル:",_),console.log("パラメータ:",j),!g){te("前処理データがありません");return}if(b.length===0){te("特徴量が選択されていません");return}try{P(!0),te(null),D(null);const ue=Lh.getRecommendedParameters(_,1),mt=Object.keys(j).length>0?j:ue;console.log("最終パラメータ:",mt);const Nt={modelType:_,parameters:mt,selectedFeatures:b,evaluationMetrics:V,dataSplit:{trainRatio:C.trainRatio,validationRatio:C.validationRatio,testRatio:C.testRatio,randomSeed:C.randomSeed,stratified:C.stratified}};console.log("学習設定:",Nt);const ae=await Rh.trainModel(g,Nt,Ft=>{console.log("学習進捗:",{epoch:Ft.epoch,total:Ft.total,message:Ft.message,loss:Ft.loss,accuracy:Ft.accuracy,progress:Ft.progress}),D(Ft)});console.log("学習結果:",ae),z(ae.result),Dr(ae.model),K("evaluation"),console.log("学習完了 - 評価ステップに移動")}catch(W){console.error("学習エラー:",W),te(`学習に失敗しました: ${W.message}`)}finally{P(!1)}},Xe=async()=>{if(console.log("=== 評価開始 ==="),console.log("コンペティション問題:",!!X),console.log("前処理データ:",!!g),console.log("特徴量:",b),console.log("モデル:",_),!g){te("前処理データがありません");return}if(b.length===0){te("特徴量が選択されていません");return}try{te(null),L(!0);const ue=Lh.getRecommendedParameters(_,1),mt=Object.keys(j).length>0?j:ue,Nt={modelType:_,parameters:mt,selectedFeatures:b,evaluationMetrics:V,dataSplit:{trainRatio:C.trainRatio,validationRatio:C.validationRatio,testRatio:C.testRatio,randomSeed:C.randomSeed,stratified:C.stratified}};console.log("評価設定:",Nt);const ae=await Rh.trainModel(g,Nt);console.log("評価結果:",ae);const Ft={validationScore:ae.result.accuracy,testScore:ae.result.accuracy,metrics:{accuracy:ae.result.accuracy,precision:ae.result.precision||0,recall:ae.result.recall||0,f1_score:ae.result.f1_score||0,mae:ae.result.mae||0,mse:ae.result.mse||0,rmse:ae.result.rmse||0},predictions:ae.result.predictions.map($r=>typeof $r=="string"?parseFloat($r):$r),actual:ae.result.actual.map($r=>typeof $r=="string"?parseFloat($r):$r),trainingTime:ae.trainingTime/1e3,modelComplexity:ae.result.accuracy,config:Nt};We(Ft),z({accuracy:ae.result.accuracy,training_time:ae.trainingTime/1e3,precision:ae.result.precision,recall:ae.result.recall,f1_score:ae.result.f1_score,predictions:ae.result.predictions,actual:ae.result.actual}),Dr(ae.model),K("submission"),console.log("評価完了 - 提出ステップに移動")}catch(W){console.error("評価エラー:",W),te(`評価に失敗しました: ${W.message}`)}finally{L(!1)}},Ze=async()=>{if(console.log("=== 提出開始 ==="),console.log("評価結果:",!!$),console.log("学習済みモデル:",!!Bt),!$){te("評価結果がありません。先に評価を実行してください。");return}if(!Bt){te("学習済みモデルがありません。先に学習を実行してください。");return}try{Y(!0),te(null);const W=Tt.getCurrentUser();if(!W)throw new Error("ユーザーがログインしていません");console.log("提出ユーザー:",W.username);const ue={problemId:X?.id||t,userId:W.id,username:W.username,selectedFeatures:b,modelType:_,parameters:j,preprocessing:{},teamId:void 0,teamMembers:void 0,evaluationResult:$,score:Math.round($.validationScore*100)};console.log("提出データ:",ue);const mt=await fj.submitResult(ue.problemId,ue.userId,ue.username,ue.selectedFeatures,ue.modelType,ue.parameters,ue.preprocessing,ue.teamId,ue.teamMembers,ue.evaluationResult,ue.score);console.log("提出完了:",mt);try{const ae=await Ti.getLeaderboard(t);console.log("リーダーボードを更新しました:",ae)}catch(ae){console.error("リーダーボード更新エラー:",ae)}const Nt={won:$.validationScore>=.7,score:Math.round($.validationScore*100),modelType:_,problemType:X?.problemType||"unknown"};Tt.updateBattleResult(Nt.won,Nt.score),console.log("提出完了 - リーダーボードに反映")}catch(W){console.error("提出エラー:",W),te(`提出に失敗しました: ${W.message}`)}finally{Y(!1)}},Ut=()=>{const W=["data","preprocessing","features","model","evaluation","submission"];return(W.indexOf(H)+1)/W.length*100},dr=()=>{const W=["data","preprocessing","features","model","evaluation","submission"],ue=W.indexOf(H);ue<W.length-1&&K(W[ue+1])},ia=()=>{const W=["data","preprocessing","features","model","evaluation","submission"],ue=W.indexOf(H);ue>0&&K(W[ue-1])};return u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900",children:[u.jsx("div",{className:"bg-black bg-opacity-20 backdrop-blur-sm border-b border-white border-opacity-20",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{onClick:s,className:"p-2 rounded-lg bg-white bg-opacity-10 hover:bg-opacity-20 transition-colors",children:u.jsx(zr,{className:"w-6 h-6 text-white"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:e}),u.jsx("p",{className:"text-white text-opacity-80",children:"オンライン対戦"})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-white",children:[Math.round(Ut()),"%"]}),u.jsx("div",{className:"text-sm text-yellow-200",children:"進捗"})]}),o&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-white",children:l.length}),u.jsx("div",{className:"text-sm text-yellow-200",children:"参加者"})]})]})]})})}),u.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[u.jsx("div",{className:"lg:col-span-1",children:u.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-20",children:[u.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"ステップ"}),u.jsx("div",{className:"space-y-2",children:[{id:"data",name:"データ探索",icon:Su},{id:"preprocessing",name:"前処理",icon:ks},{id:"features",name:"特徴量選択",icon:Pr},{id:"model",name:"モデル学習",icon:pc},{id:"evaluation",name:"評価",icon:Cn},{id:"submission",name:"提出",icon:Ow}].map(W=>{const ue=W.icon,mt=H===W.id,Nt=["data","preprocessing","features","model","evaluation","submission"].indexOf(H)>["data","preprocessing","features","model","evaluation","submission"].indexOf(W.id);return u.jsxs("button",{onClick:()=>K(W.id),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${mt?"bg-yellow-500 text-black":Nt?"bg-green-500 text-white":"bg-white bg-opacity-10 text-white hover:bg-opacity-20"}`,children:[u.jsx(ue,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:W.name})]},W.id)})})]})}),u.jsx("div",{className:"lg:col-span-3",children:u.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-8 border border-white border-opacity-20",children:[ur&&u.jsx("div",{className:"mb-6 p-4 bg-red-500 bg-opacity-20 border border-red-500 rounded-lg",children:u.jsx("p",{className:"text-red-200",children:ur})}),H==="data"&&m&&u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"データ探索"}),u.jsx(bw,{dataset:m}),u.jsx("div",{className:"mt-6 flex justify-end",children:u.jsxs("button",{onClick:dr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",u.jsx(zt,{className:"w-5 h-5 inline ml-2"})]})})]}),H==="preprocessing"&&u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"前処理"}),u.jsx(xw,{dataset:m,onPreprocess:y}),u.jsxs("div",{className:"mt-6 flex justify-between",children:[u.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),u.jsxs("button",{onClick:dr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",u.jsx(zt,{className:"w-5 h-5 inline ml-2"})]})]})]}),H==="features"&&g&&u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"特徴量選択"}),u.jsx(ww,{dataset:g,selectedFeatures:b,onFeaturesChange:x}),u.jsxs("div",{className:"mt-6 flex justify-between",children:[u.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),u.jsxs("button",{onClick:dr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",u.jsx(zt,{className:"w-5 h-5 inline ml-2"})]})]})]}),H==="model"&&u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"モデル学習"}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-white font-medium mb-2",children:"モデルタイプ"}),u.jsx("select",{value:_,onChange:W=>S(W.target.value),className:"w-full p-3 bg-white bg-opacity-10 border border-white border-opacity-20 rounded-lg text-white",children:w.map(W=>u.jsx("option",{value:W.id,className:"bg-gray-800",children:W.name},W.id))})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("button",{onClick:()=>O(!M),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:M?"パラメータを隠す":"パラメータを設定"}),M&&u.jsx("div",{className:"mt-4",children:u.jsx(XL,{modelType:_,parameters:j,onParametersChange:N,onClose:()=>O(!1)})})]}),u.jsx("div",{className:"flex justify-center",children:u.jsx("button",{onClick:ce,disabled:T,className:`px-8 py-4 rounded-lg font-bold text-lg transition-colors ${T?"bg-gray-500 cursor-not-allowed":"bg-green-500 hover:bg-green-600 text-white"}`,children:T?"学習中...":"学習開始"})}),T&&k&&u.jsx("div",{className:"mt-6",children:u.jsx(_w,{progress:k})}),I&&u.jsxs("div",{className:"mt-6 p-4 bg-white bg-opacity-10 rounded-lg",children:[u.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"学習結果"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[Math.round(I.accuracy*100),"%"]}),u.jsx("div",{className:"text-sm text-white",children:"精度"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[I.training_time.toFixed(2),"s"]}),u.jsx("div",{className:"text-sm text-white",children:"学習時間"})]})]})]}),u.jsxs("div",{className:"mt-6 flex justify-between",children:[u.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),I&&u.jsxs("button",{onClick:dr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",u.jsx(zt,{className:"w-5 h-5 inline ml-2"})]})]})]}),H==="evaluation"&&u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"評価"}),u.jsxs("div",{className:"mb-6 p-4 bg-white bg-opacity-10 rounded-lg",children:[u.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"評価指標を選択"}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:["accuracy","precision","recall","f1_score","mae","mse","rmse"].map(W=>u.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[u.jsx("input",{type:"checkbox",checked:V.includes(W),onChange:ue=>{ue.target.checked?Z([...V,W]):Z(V.filter(mt=>mt!==W))},className:"rounded"}),u.jsx("span",{className:"text-sm",children:W})]},W))})]}),u.jsxs("div",{className:"mb-6 p-4 bg-white bg-opacity-10 rounded-lg",children:[u.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"データ分割設定"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-white text-sm mb-1",children:"学習データ比率"}),u.jsx("input",{type:"range",min:"0.5",max:"0.9",step:"0.1",value:C.trainRatio,onChange:W=>$e({...C,trainRatio:parseFloat(W.target.value),validationRatio:(1-parseFloat(W.target.value))*.5,testRatio:(1-parseFloat(W.target.value))*.5}),className:"w-full"}),u.jsxs("div",{className:"text-white text-sm",children:[Math.round(C.trainRatio*100),"%"]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-white text-sm mb-1",children:"ランダムシード"}),u.jsx("input",{type:"number",value:C.randomSeed,onChange:W=>$e({...C,randomSeed:parseInt(W.target.value)||42}),className:"w-full p-2 bg-white bg-opacity-10 border border-white border-opacity-20 rounded text-white"})]})]}),u.jsx("div",{className:"mt-2",children:u.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[u.jsx("input",{type:"checkbox",checked:C.stratified,onChange:W=>$e({...C,stratified:W.target.checked}),className:"rounded"}),u.jsx("span",{className:"text-sm",children:"層化サンプリングを使用"})]})})]}),aa?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-400 mx-auto mb-4"}),u.jsx("p",{className:"text-white text-lg",children:"評価中..."})]}):u.jsx("div",{className:"text-center",children:u.jsx("button",{onClick:Xe,className:"px-8 py-4 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg text-lg transition-colors",children:"評価実行"})}),$&&u.jsxs("div",{className:"mt-6 p-6 bg-white bg-opacity-10 rounded-lg",children:[u.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"評価結果"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[Math.round($.validationScore*100),"%"]}),u.jsx("div",{className:"text-sm text-white",children:"スコア"})]}),V.map(W=>u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[Math.round(($.metrics[W]||0)*100),"%"]}),u.jsx("div",{className:"text-sm text-white",children:W})]},W))]}),u.jsxs("div",{className:"mt-4 text-sm text-white",children:[u.jsxs("div",{children:["データ分割: 学習",Math.round(C.trainRatio*100),"% / 検証",Math.round(C.validationRatio*100),"% / テスト",Math.round(C.testRatio*100),"%"]}),u.jsxs("div",{children:["ランダムシード: ",C.randomSeed]}),u.jsxs("div",{children:["層化サンプリング: ",C.stratified?"有効":"無効"]})]})]}),u.jsxs("div",{className:"mt-6 flex justify-between",children:[u.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),$&&u.jsxs("button",{onClick:dr,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg transition-colors",children:["次へ ",u.jsx(zt,{className:"w-5 h-5 inline ml-2"})]})]})]}),H==="submission"&&u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"提出"}),$?u.jsxs("div",{children:[u.jsxs("div",{className:"mb-6 p-6 bg-white bg-opacity-10 rounded-lg",children:[u.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"提出内容"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-xl font-bold text-yellow-400",children:[Math.round($.validationScore*100),"%"]}),u.jsx("div",{className:"text-sm text-white",children:"スコア"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-xl font-bold text-yellow-400",children:_}),u.jsx("div",{className:"text-sm text-white",children:"モデル"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-xl font-bold text-yellow-400",children:b.length}),u.jsx("div",{className:"text-sm text-white",children:"特徴量数"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-xl font-bold text-yellow-400",children:f}),u.jsx("div",{className:"text-sm text-white",children:"ユーザー"})]})]})]}),u.jsx("div",{className:"text-center",children:u.jsx("button",{onClick:Ze,disabled:R,className:`px-8 py-4 rounded-lg font-bold text-lg transition-colors ${R?"bg-gray-500 cursor-not-allowed":"bg-green-500 hover:bg-green-600 text-white"}`,children:R?"提出中...":"リーダーボードに提出"})}),$&&u.jsx("div",{className:"mt-6 p-4 bg-green-500 bg-opacity-20 border border-green-500 rounded-lg",children:u.jsx("p",{className:"text-green-200 text-center",children:"提出が完了しました！"})})]}):u.jsx("div",{className:"text-center py-8",children:u.jsx("p",{className:"text-white text-lg",children:"評価を先に実行してください"})}),u.jsxs("div",{className:"mt-6 flex justify-between",children:[u.jsx("button",{onClick:ia,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors",children:"戻る"}),u.jsx("button",{onClick:s,className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-lg transition-colors",children:"完了"})]})]})]})})]})})]})}class Ai{static WEEKLY_PROBLEMS_KEY="weekly_problems";static CURRENT_WEEK_KEY="current_week_problem";static generateWeeklyProblems(){console.log("週次問題を生成中...");const e=[],r=new Date;r.setDate(r.getDate()-(r.getDay()||7)+1);const n=[{title:"現代株価予測チャレンジ",description:"過去の株価データから将来の株価を予測し、投資戦略を提案する",dataset:"modern_stock_prediction",difficulty:"easy",category:"金融分析"},{title:"感情分析マスター",description:"テキストデータから感情を分析し、ユーザーの満足度を予測する",dataset:"modern_sentiment_analysis",difficulty:"easy",category:"自然言語処理"},{title:"画像分類エキスパート",description:"画像データを分類し、物体認識の精度を競う",dataset:"modern_image_classification",difficulty:"medium",category:"コンピュータビジョン"},{title:"推薦システム最適化",description:"ユーザーの行動データから最適な推薦を提案する",dataset:"modern_recommendation",difficulty:"medium",category:"推薦システム"},{title:"不正検出システム",description:"取引データから不正なパターンを検出し、セキュリティを向上させる",dataset:"modern_fraud_detection",difficulty:"hard",category:"セキュリティ"}];for(let a=0;a<12;a++){const i=new Date(r);i.setDate(i.getDate()+a*7);const s=new Date(i);s.setDate(s.getDate()+6);const o=n[a%n.length],l={id:`weekly_${a+1}`,title:`${o.title} (第${a+1}週)`,description:o.description,dataset:o.dataset,difficulty:o.difficulty,category:o.category,startDate:i.toISOString(),endDate:s.toISOString(),isActive:a===0,publicLeaderboard:[],privateLeaderboard:[],timeLimit:10080*60};console.log(`週次問題 ${a+1} を生成:`,l),e.push(l)}return e}static getCurrentWeeklyProblem(){return this.getWeeklyProblems().find(n=>n.isActive)||null}static getWeeklyProblems(){const e=localStorage.getItem(this.WEEKLY_PROBLEMS_KEY);if(e)return JSON.parse(e);const r=this.generateWeeklyProblems();return localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(r)),r}static updateWeeklyProblems(){const e=this.getWeeklyProblems(),r=new Date;e.forEach(n=>{const a=new Date(n.startDate),i=new Date(n.endDate);n.isActive=r>=a&&r<=i}),localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e))}static async updateProblemLeaderboard(e){const r=this.getWeeklyProblems(),n=r.find(a=>a.id===e);if(n)try{const a=await Ma.getProblemLeaderboard(e,10,!1);n.publicLeaderboard=a;const i=await Ma.getProblemLeaderboard(e,10,!0);n.privateLeaderboard=i,localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(r))}catch(a){console.error("リーダーボード更新エラー:",a)}}static forceUpdateCurrentProblem(){localStorage.removeItem(this.WEEKLY_PROBLEMS_KEY),localStorage.removeItem(this.CURRENT_WEEK_KEY);const e=this.generateWeeklyProblems();return localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e)),e.length>0?(e[0].isActive=!0,localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e)),console.log("週次問題をリセット:",e[0]),e[0]):null}static updateWeeklyProblemsRealtime(){const e=this.getWeeklyProblems(),r=new Date;if(e.length===0)return this.generateWeeklyProblems(),this.getCurrentWeeklyProblem();const n=new Date("2024-01-01T00:00:00Z"),a=Math.floor((r.getTime()-n.getTime())/(10080*60*1e3)),i=a%e.length;if(e.forEach(s=>s.isActive=!1),e[i]){e[i].isActive=!0;const s=new Date(n.getTime()+a*7*24*60*60*1e3),o=new Date(s.getTime()+10080*60*1e3);return e[i].startDate=s.toISOString(),e[i].endDate=o.toISOString(),localStorage.setItem(this.WEEKLY_PROBLEMS_KEY,JSON.stringify(e)),console.log(`週次問題を自動更新: 週${a+1}`,e[i]),e[i]}return null}static isProblemActive(e){const r=this.getWeeklyProblems().find(s=>s.id===e);if(!r)return!1;const n=new Date,a=new Date(r.startDate),i=new Date(r.endDate);return n>=a&&n<=i}static getProblemTimeRemaining(e){const r=this.getWeeklyProblems().find(d=>d.id===e);if(!r)return"終了";const n=new Date,i=new Date(r.endDate).getTime()-n.getTime();if(i<=0)return"終了";const s=Math.floor(i/(1e3*60*60*24)),o=Math.floor(i%(1e3*60*60*24)/(1e3*60*60)),l=Math.floor(i%(1e3*60*60)/(1e3*60));return s>0?`${s}日${o}時間`:o>0?`${o}時間${l}分`:`${l}分`}}function QL({roomId:t,userId:e,username:r,isMultiplayer:n=!1}){const[a,i]=v.useState(!1),[s,o]=v.useState(new Map),[l,d]=v.useState([]),[c,h]=v.useState("waiting"),[f,m]=v.useState(null),[p,g]=v.useState([]);v.useEffect(()=>{console.log("useRealtimeBattle初期化:",{roomId:t,userId:e,username:r});const O=()=>{console.log("リアルタイム接続完了"),i(!0),m(null),setTimeout(()=>{se.joinRoom(t,r)},100)},T=()=>{console.log("リアルタイム接続切断"),i(!1)},P=k=>{console.error("リアルタイム接続エラー:",k),m(k.message||"接続エラーが発生しました")};return se.on("connected",O),se.on("disconnected",T),se.on("error",P),se.connect(e,t),()=>{se.off("connected",O),se.off("disconnected",T),se.off("error",P),se.disconnect()}},[t,e,r]),v.useEffect(()=>{const O=T=>{o(P=>{const k=new Map(P);return k.set(T.userId,T),k})};return se.on("participant_update",O),()=>{se.off("participant_update",O)}},[]),v.useEffect(()=>{const O=T=>{d(P=>[...P,T])};return se.on("chat_message",O),()=>{se.off("chat_message",O)}},[]),v.useEffect(()=>{const O=()=>{h("active")},T=()=>{h("finished")};return se.on("battle_start",O),se.on("battle_end",T),()=>{se.off("battle_start",O),se.off("battle_end",T)}},[]);const y=v.useCallback((O,T,P=!1)=>{se.sendProgress(O,T,P)},[]),b=v.useCallback(O=>{se.sendChatMessage(O)},[]),x=v.useCallback(()=>{se.startBattle(t)},[t]),w=v.useCallback(O=>{se.endBattle(t,O)},[t]),_=v.useCallback(async(O=!1,T)=>{try{const P=await Ma.getLeaderboard(10,O,T);g(P),console.log("リーダーボード更新:",P)}catch(P){console.error("リーダーボード更新エラー:",P)}},[]);v.useEffect(()=>{_(!1,n?"team":"individual")},[_,n]);const S=v.useCallback(()=>Array.from(s.values()),[s]),j=v.useCallback(()=>s.get(e),[s,e]),N=v.useCallback(async O=>{try{console.log("ルーム参加:",O),await se.joinRoom(O,r),m(null)}catch(T){console.error("ルーム参加エラー:",T),m("ルームの参加に失敗しました")}},[r]),M=v.useCallback(async()=>{try{console.log("ルーム退出"),await se.leaveRoom(t)}catch(O){console.error("ルーム退出エラー:",O)}},[t]);return{isConnected:a,participants:S(),myProgress:j(),chatMessages:l,battleStatus:c,error:f,leaderboard:p,sendProgress:y,sendChatMessage:b,joinRoom:N,leaveRoom:M,startBattle:x,endBattle:w,updateLeaderboard:_}}function re(t,e){const r=Math.random(),n=Math.random();return Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n)*e+t}function e4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(1e3,Math.min(1e6,re(1e5,5e4))),a=Math.max(.01,Math.min(.5,re(.2,.1))),i=Math.max(-.3,Math.min(.3,re(0,.1))),s=Math.max(0,Math.min(100,re(50,20))),o=Math.max(-2,Math.min(2,re(0,.5))),l=Math.max(5,Math.min(50,re(20,10))),d=100,c=n/1e5*.1+(a-.2)*50+i*30+(s-50)/100*20+o*10+(20-l)/20*15+re(0,5),h=Math.max(10,d+c);e.push({features:[Math.round(n),Math.round(a*100)/100,Math.round(i*100)/100,Math.round(s),Math.round(o*100)/100,Math.round(l)],label:Math.round(h*100)/100}),t.push({features:[(n-1e3)/999e3,(a-.01)/.49,(i+.3)/.6,s/100,(o+2)/4,(l-5)/45],label:(h-10)/200})}return{data:t,raw:e,featureNames:["出来高","ボラティリティ","モメンタム","RSI","MACD","PER"],featureUnits:["株","","","","",""],problemType:"regression",description:"株価予測問題。出来高、ボラティリティ、モメンタム、RSI、MACD、PERから翌日の株価を予測します。",difficulty:"medium",targetName:"株価",targetUnit:"円"}}function t4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(0,Math.min(60,re(30,15))),a=Math.max(20,Math.min(120,re(70,25))),i=Math.max(0,Math.min(8e3,re(3e3,2e3))),s=Math.random()<.5?0:1,o=Math.random()<.8?1:0,l=Math.random()<.3?1:0,c=(60-n)/60*.3+(a-20)/100*.2+(1-s)*.2+(1-o)*.15+(1-l)*.1+re(0,.1)>.5;e.push({features:[Math.round(n),Math.round(a),Math.round(i),s,o,l],label:c?"離脱":"継続"}),t.push({features:[n/60,(a-20)/100,i/8e3,s,o,l],label:c?1:0})}return{data:t,raw:e,featureNames:["在籍期間","月額料金","総料金","契約タイプ","インターネットサービス","テクニカルサポート"],featureUnits:["月","ドル","ドル","","",""],problemType:"classification",description:"顧客離脱予測問題。在籍期間、料金、契約タイプ、サービス利用状況から顧客の離脱を予測します。",difficulty:"medium",targetName:"離脱",targetUnit:"離脱/継続",classes:["継続","離脱"]}}function r4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(500,Math.min(5e3,re(2e3,800))),a=Math.max(1,Math.min(6,Math.round(re(3,1)))),i=Math.max(1,Math.min(4,Math.round(re(2,.5)))),s=Math.max(0,Math.min(50,re(15,10))),o=Math.max(1,Math.min(10,re(6,2))),l=Math.max(1,Math.min(10,re(7,2))),c=2e5+(n-1e3)*100+(a-2)*1e4+(i-1)*15e3+(50-s)*2e3+(o-5)*2e4+(l-5)*15e3+re(0,3e4);e.push({features:[Math.round(n),a,i,Math.round(s),Math.round(o),Math.round(l)],label:Math.round(c)}),t.push({features:[(n-500)/4500,(a-1)/5,(i-1)/3,s/50,(o-1)/9,(l-1)/9],label:(c-1e5)/5e5})}return{data:t,raw:e,featureNames:["面積","寝室数","浴室数","築年数","立地スコア","学校評価"],featureUnits:["平方フィート","室","室","年","点","点"],problemType:"regression",description:"住宅価格予測問題。面積、寝室数、浴室数、築年数、立地、学校評価から住宅価格を予測します。",difficulty:"easy",targetName:"価格",targetUnit:"ドル"}}function n4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(10,Math.min(200,re(50,30))),a=Math.max(0,Math.min(20,re(5,3))),i=Math.max(0,Math.min(20,re(3,2))),s=Math.max(0,Math.min(10,re(1,2))),o=Math.max(0,Math.min(5,re(.5,1))),l=Math.max(0,Math.min(1,re(.1,.1))),d=(a-i)/20*.4+(s-o)/10*.2+l*.2+(n-50)/150*.1+re(0,.1),c=d>.1?"positive":d<-.1?"negative":"neutral";e.push({features:[Math.round(n),Math.round(a),Math.round(i),Math.round(s),Math.round(o),Math.round(l*100)/100],label:c}),t.push({features:[(n-10)/190,a/20,i/20,s/10,o/5,l],label:c==="positive"?1:c==="negative"?0:.5})}return{data:t,raw:e,featureNames:["単語数","ポジティブ単語","ネガティブ単語","感嘆符数","疑問符数","大文字比率"],featureUnits:["語","語","語","個","個",""],problemType:"classification",description:"感情分析問題。テキストの特徴量から感情（ポジティブ/ネガティブ/ニュートラル）を予測します。",difficulty:"hard",targetName:"感情",targetUnit:"ポジティブ/ネガティブ/ニュートラル",classes:["negative","neutral","positive"]}}function a4(){const t=[],e=[];for(let r=0;r<500;r++){const n=Math.max(0,Math.min(1e5,re(3e4,15e3))),a=Math.max(10,Math.min(100,re(50,20))),i=Math.max(10,Math.min(100,re(45,15))),s=Math.max(0,Math.min(1,re(.5,.2))),o=Math.max(0,Math.min(1,re(.6,.2))),l=Math.max(0,Math.min(1e3,re(200,100))),c=1e4+n/1e3*.5+(100-a)*50+(i-a)*20+s*5e3+o*3e3+l/10*10+re(0,2e3);e.push({features:[Math.round(n),Math.round(a),Math.round(i),Math.round(s*100)/100,Math.round(o*100)/100,Math.round(l)],label:Math.round(c)}),t.push({features:[n/1e5,(a-10)/90,(i-10)/90,s,o,l/1e3],label:(c-5e3)/2e4})}return{data:t,raw:e,featureNames:["広告予算","価格","競合価格","季節性","経済指標","SNS言及数"],featureUnits:["ドル","ドル","ドル","","","件"],problemType:"regression",description:"売上予測問題。広告予算、価格、競合価格、季節性、経済指標、SNS言及数から売上を予測します。",difficulty:"hard",targetName:"売上",targetUnit:"ドル"}}function i4(t){return[e4,t4,r4,n4,a4].map(r=>r())}const s4=async t=>{const e=i4();switch(t){case"modern_stock_prediction":return e[0];case"modern_sentiment_analysis":return e[1];case"modern_image_classification":return e[2];case"modern_customer_churn":return e[3];case"modern_housing_price":return e[4];default:return e[0]}},o4=async t=>{try{if(Ke.getProblem(t.id)){console.log("問題は既に登録されています:",t.id);return}await Ke.createProblem(t.id,t.title,t.description,t.dataset.data,t.dataset.featureNames,t.dataset.targetName,t.dataset.problemType,t.dataset.classes),console.log("コンペティション問題を登録しました:",t.id)}catch(e){console.error("問題登録エラー:",e)}};function l4({onBack:t}){const[e,r]=v.useState(null),[n,a]=v.useState(!1),[i,s]=v.useState(""),[o,l]=v.useState(!0),[d,c]=v.useState(null),[h,f]=v.useState("individual"),[m,p]=v.useState(null),[g,y]=v.useState(3600),[b,x]=v.useState(!1),[w,_]=v.useState([]),[S,j]=v.useState(0),N=Tt.getCurrentUser(),{participants:M,chatMessages:O,leaderboard:T,sendChatMessage:P,joinRoom:k}=QL({roomId:i||"default",userId:N?.id||"",username:N?.username||"",isMultiplayer:!0});v.useEffect(()=>{D()},[]),v.useEffect(()=>{let R;return b&&m&&(R=setInterval(()=>{const Y=Math.floor((Date.now()-m)/1e3),$=Math.max(0,3600-Y);y($),$===0&&(x(!1),p(null))},1e3)),()=>{R&&clearInterval(R)}},[b,m]);const D=async()=>{try{l(!0),Ai.updateWeeklyProblems();const R=Ai.getCurrentWeeklyProblem();if(R){const Y=await s4(R.dataset),$={...R,dataset:Y};r($),await o4($);const We=`weekly_${R.id}_multiplayer`;s(We),await k(We)}else c("利用可能な問題がありません")}catch(R){console.error("問題読み込みエラー:",R),c(`問題の読み込みに失敗しました: ${R instanceof Error?R.message:"Unknown error"}`)}finally{l(!1)}},I=()=>{!e||!N||(p(Date.now()),x(!0),y(3600),j(0),_([]),a(!0))},z=R=>{console.log("バトル完了:",R),_(Y=>[...Y,R]),j(100),x(!1),a(!1)},H=R=>{const Y=Math.floor(R/3600),$=Math.floor(R%3600/60),We=R%60;return`${Y.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}:${We.toString().padStart(2,"0")}`},K=()=>{a(!1),x(!1),p(null),D()};if(n&&e&&N)return u.jsx(ZL,{problemId:e.id,problemTitle:e.title,problemDescription:e.description,dataset:{train:e.dataset?.data||[],test:e.dataset?.data?.slice(0,Math.floor((e.dataset?.data?.length||0)*.3))||[],featureNames:e.dataset?.featureNames||[],labelName:e.dataset?.targetName||"target",classes:e.dataset?.classes||[]},difficulty:e.difficulty,timeLimit:3600,onComplete:R=>{console.log("マルチプレイヤーバトル完了:",R),z(R)},isMultiplayer:h==="team",roomId:i,userId:N.id,username:N.username,onBack:K});if(o)return u.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-yellow-400 mx-auto mb-4"}),u.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"読み込み中..."})]})})});if(d)return u.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsx("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:u.jsxs("div",{className:"p-8 text-center",children:[u.jsx("h2",{className:"text-3xl font-bold text-red-900 mb-4",children:"エラーが発生しました"}),u.jsx("p",{className:"text-lg text-red-700 mb-6",children:d}),u.jsx("button",{onClick:t,className:"bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700 transition-colors",children:"ホームに戻る"})]})})})});if(!e)return u.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsx("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:u.jsxs("div",{className:"p-8 text-center",children:[u.jsx("h2",{className:"text-3xl font-bold text-blue-900 mb-4",children:"今週の問題はありません"}),u.jsx("p",{className:"text-lg text-blue-700 mb-6",children:"来週の新しい問題をお待ちください。"}),u.jsx("button",{onClick:t,className:"bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors",children:"ホームに戻る"})]})})})});Ai.getProblemTimeRemaining(e.id);const X=Ai.isProblemActive(e.id),B=Array.from(M.values());return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:u.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:u.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/20 overflow-hidden",children:[u.jsx("div",{className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 p-6",children:u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("button",{onClick:t,className:"flex items-center space-x-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl",children:[u.jsx(gg,{className:"w-5 h-5"}),u.jsx("span",{children:"ホームに戻る"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:"マルチプレイヤー戦"}),u.jsx("p",{className:"text-white/80 text-lg",children:"他のプレイヤーと協力して問題を解決"})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-white/80 font-bold text-lg",children:"残り時間"}),u.jsx("div",{className:"text-white text-3xl font-mono",children:b?H(g):"00:00:00"}),b&&u.jsx("div",{className:"text-green-300 text-sm font-bold",children:"⚡ バトル進行中"})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-6",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[u.jsxs("div",{className:"bg-gradient-to-br from-white/20 to-white/10 backdrop-blur-sm rounded-2xl p-8 border border-white/30 shadow-xl",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl shadow-lg",children:u.jsx(Pr,{className:"w-8 h-8 text-white"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:e.title}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("span",{className:"bg-blue-500/20 text-blue-200 px-4 py-2 rounded-full text-sm font-bold border border-blue-400/30",children:e.category}),u.jsx("span",{className:"bg-green-500/20 text-green-200 px-4 py-2 rounded-full text-sm font-bold border border-green-400/30",children:e.difficulty}),u.jsx("span",{className:"bg-purple-500/20 text-purple-200 px-4 py-2 rounded-full text-sm font-bold border border-purple-400/30",children:e.dataset?.problemType||"Unknown"})]})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-sm text-white/70 font-medium",children:"ステータス"}),u.jsx("div",{className:`font-bold text-lg ${X?"text-green-400":"text-red-400"}`,children:X?"🟢 アクティブ":"🔴 終了"})]})]}),u.jsx("p",{className:"text-white/90 text-lg mb-6 leading-relaxed",children:e.description}),e.dataset&&u.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 mb-6 border border-white/20",children:[u.jsxs("h4",{className:"font-bold text-white text-lg mb-4 flex items-center",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full mr-3"}),"データセット情報"]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-300",children:e.dataset.featureNames?.length||0}),u.jsx("div",{className:"text-sm text-white/70",children:"特徴量数"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-green-300",children:e.dataset.data?.length||0}),u.jsx("div",{className:"text-sm text-white/70",children:"サンプル数"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-lg font-bold text-purple-300",children:e.dataset.problemType||"Unknown"}),u.jsx("div",{className:"text-sm text-white/70",children:"問題タイプ"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-lg font-bold text-orange-300",children:e.dataset.difficulty||"Unknown"}),u.jsx("div",{className:"text-sm text-white/70",children:"難易度"})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center",children:[u.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full mr-3"}),"参加モードを選択"]}),u.jsxs("div",{className:"flex space-x-4",children:[u.jsxs("button",{onClick:()=>f("individual"),className:`px-8 py-4 rounded-xl font-bold transition-all duration-300 flex items-center space-x-3 ${h==="individual"?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg transform scale-105":"bg-white/10 text-white/70 hover:bg-white/20 hover:text-white"}`,children:[u.jsx(No,{className:"w-6 h-6"}),u.jsx("span",{children:"個人で参加"})]}),u.jsxs("button",{onClick:()=>f("team"),className:`px-8 py-4 rounded-xl font-bold transition-all duration-300 flex items-center space-x-3 ${h==="team"?"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg transform scale-105":"bg-white/10 text-white/70 hover:bg-white/20 hover:text-white"}`,children:[u.jsx(No,{className:"w-6 h-6"}),u.jsx("span",{children:"チームで参加"})]})]})]}),b&&u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("span",{className:"text-lg font-bold text-white",children:"進捗"}),u.jsxs("span",{className:"text-xl font-bold text-yellow-300",children:[S,"%"]})]}),u.jsx("div",{className:"w-full bg-white/20 rounded-full h-4 overflow-hidden",children:u.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 h-4 rounded-full transition-all duration-500 shadow-lg",style:{width:`${S}%`}})})]}),u.jsx("button",{onClick:I,disabled:!X||b,className:`w-full py-4 px-8 rounded-xl font-bold text-lg transition-all duration-300 ${X&&!b?"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white shadow-lg hover:shadow-xl transform hover:scale-105":"bg-gray-500/50 text-gray-300 cursor-not-allowed"}`,children:b?"⚡ バトル進行中...":X?"🚀 マルチプレイヤー戦を開始":"❌ 問題終了"})]}),w.length>0&&u.jsxs("div",{className:"bg-gradient-to-br from-green-500/20 to-emerald-500/20 backdrop-blur-sm rounded-2xl p-6 border border-green-400/30 mb-6 shadow-xl",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"p-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl shadow-lg",children:u.jsx(Cn,{className:"w-6 h-6 text-white"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:"🏆 バトル結果"})]}),u.jsx("div",{className:"space-y-4",children:w.map((R,Y)=>u.jsxs("div",{className:"bg-white/10 backdrop-blur-sm p-4 rounded-xl border border-white/20 hover:bg-white/20 transition-all duration-300",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsxs("span",{className:"text-white font-bold text-lg",children:["提出 #",Y+1]}),u.jsxs("span",{className:"text-yellow-300 font-bold text-xl",children:[R.score?(R.score*100).toFixed(1):"N/A","%"]})]}),u.jsxs("div",{className:"text-sm text-white/80 flex space-x-4",children:[u.jsxs("span",{children:["🤖 モデル: ",R.modelType||"Unknown"]}),u.jsxs("span",{children:["⏱️ 時間: ",R.trainingTime?`${R.trainingTime}ms`:"N/A"]})]})]},Y))})]}),u.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-indigo-500/20 backdrop-blur-sm rounded-2xl p-6 border border-blue-400/30 shadow-xl",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl shadow-lg",children:u.jsx(No,{className:"w-6 h-6 text-white"})}),u.jsxs("h3",{className:"text-2xl font-bold text-white",children:["👥 参加者 (",B.length,"人)"]})]}),u.jsx("div",{className:"space-y-3",children:B.map(R=>u.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/10 backdrop-blur-sm rounded-xl border border-white/20 hover:bg-white/20 transition-all duration-300",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg",children:R.username.charAt(0).toUpperCase()}),u.jsx("span",{className:"font-bold text-white text-lg",children:R.username})]}),u.jsx("div",{className:"text-sm text-white/80 font-medium",children:R.isReady?"✅ 準備完了":"⏳ 準備中"})]},R.userId))})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-pink-500/20 backdrop-blur-sm rounded-2xl p-6 border border-purple-400/30 shadow-xl",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl shadow-lg",children:u.jsx(Aw,{className:"w-6 h-6 text-white"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:"💬 チャット"})]}),u.jsx("div",{className:"h-64 overflow-y-auto border border-white/20 rounded-xl p-4 mb-4 bg-white/5 backdrop-blur-sm",children:O.length===0?u.jsx("p",{className:"text-white/60 text-center py-8",children:"まだメッセージはありません。"}):O.map((R,Y)=>u.jsxs("div",{className:"mb-3 p-3 bg-white/10 rounded-lg border border-white/20",children:[u.jsx("div",{className:"font-bold text-blue-300 text-sm",children:R.username}),u.jsx("div",{className:"text-white/90",children:R.message})]},Y))}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("input",{type:"text",placeholder:"メッセージを入力...",className:"flex-1 px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/20 transition-all duration-300",onKeyPress:R=>{if(R.key==="Enter"){const Y=R.target;Y.value.trim()&&(P(Y.value.trim()),Y.value="")}}}),u.jsx("button",{onClick:()=>{const R=document.querySelector('input[type="text"]');R.value.trim()&&(P(R.value.trim()),R.value="")},className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:u.jsx(Ew,{className:"w-5 h-5"})})]})]}),u.jsxs("div",{className:"bg-gradient-to-br from-yellow-500/20 to-orange-500/20 backdrop-blur-sm rounded-2xl p-6 border border-yellow-400/30 shadow-xl",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"p-2 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl shadow-lg",children:u.jsx(Cn,{className:"w-6 h-6 text-white"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:"🏆 リーダーボード"})]}),u.jsx("div",{className:"space-y-3",children:T.length===0?u.jsx("p",{className:"text-white/60 text-center py-8",children:"まだ提出がありません。"}):T.map((R,Y)=>u.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/10 backdrop-blur-sm rounded-xl border border-white/20 hover:bg-white/20 transition-all duration-300",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg",children:R.rank}),u.jsxs("div",{children:[u.jsx("span",{className:"font-bold text-white text-lg",children:R.username}),u.jsx("div",{className:"text-sm text-white/70",children:R.modelType})]})]}),u.jsxs("span",{className:"font-bold text-yellow-300 text-xl",children:[(R.score*100).toFixed(1),"%"]})]},Y))})]})]})]})]})})})}function c4({onBack:t}){return u.jsx(l4,{onBack:t})}function u4(){const{user:t,regions:e,progress:r,setCurrentView:n}=Ms(),[a,i]=v.useState(!1);if(!t)return null;const o=Tt.getCurrentUser()?.username||t.shogun_name||"プレイヤー",l=Object.values(r).filter(c=>c.is_completed).length,d=Object.values(r).reduce((c,h)=>c+h.stars,0);return a?u.jsx(c4,{onBack:()=>i(!1)}):u.jsx("div",{className:"min-h-screen p-8",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"rounded-lg shadow-2xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:[u.jsx("div",{className:"p-6",style:{background:"linear-gradient(to right, var(--accent-strong), var(--accent))"},children:u.jsx("h1",{className:"text-4xl font-bold text-white text-center tracking-wide",children:"samurAI - 機械学習で天下統一"})}),u.jsx("div",{className:"p-6 md:p-12",children:u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[u.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-6 md:p-8 shadow-xl border-2",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 space-y-2 sm:space-y-0",children:[u.jsxs("h2",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:[o,"様"]}),u.jsx("span",{className:"text-lg md:text-2xl font-bold text-white px-4 py-2 rounded-full border-2 self-start sm:self-auto",style:{background:"var(--accent-strong)",borderColor:"var(--gold)"},children:t.title})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-2 md:gap-4 mt-6",children:[u.jsxs("div",{className:"text-center p-3 md:p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:[u.jsx("div",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:t.level}),u.jsx("div",{className:"text-xs md:text-sm mt-1",style:{color:"var(--ink-light)"},children:"レベル"})]}),u.jsxs("div",{className:"text-center p-3 md:p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:[l,"/",e.length]}),u.jsx("div",{className:"text-xs md:text-sm mt-1",style:{color:"var(--ink-light)"},children:"地域制覇"})]}),u.jsxs("div",{className:"text-center p-3 md:p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:[u.jsx("div",{className:"text-2xl md:text-3xl font-bold",style:{color:"var(--ink)"},children:d}),u.jsx("div",{className:"text-xs md:text-sm mt-1",style:{color:"var(--ink-light)"},children:"獲得星数"})]})]}),u.jsx("div",{className:"mt-6 rounded-full h-6 border-2 overflow-hidden",style:{background:"var(--silver-light)",borderColor:"var(--gold)"},children:u.jsx("div",{className:"h-full transition-all duration-500",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))",width:`${Math.min(t.total_xp%1e3/10,100)}%`}})}),u.jsxs("div",{className:"text-center text-sm mt-2",style:{color:"var(--ink-light)"},children:["経験値: ",t.total_xp," / ",Math.ceil(t.total_xp/1e3)*1e3]})]}),u.jsx("button",{onClick:()=>{console.log("日本地図ボタンがクリックされました"),n("map")},className:"w-full text-white p-8 rounded-lg shadow-xl border-4 transition-all transform hover:scale-105 group",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))",borderColor:"var(--gold)"},children:u.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[u.jsx(Tw,{className:"w-16 h-16 group-hover:rotate-12 transition-transform"}),u.jsxs("div",{className:"text-left",children:[u.jsx("div",{className:"text-3xl font-bold",children:"日本地図を開く"}),u.jsx("div",{className:"text-xl mt-2",style:{color:"var(--gold-light)"},children:"各地の課題に挑戦しよう"})]})]})})]}),u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl p-4 shadow-lg border-2",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(gg,{className:"w-5 h-5",style:{color:"var(--accent-strong)"}}),u.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--ink)"},children:"オンライン対戦"})]}),u.jsx("p",{className:"text-xs leading-relaxed mb-3",style:{color:"var(--ink-light)"},children:"週次問題で他のプレイヤーと競い合おう！"}),u.jsx("button",{onClick:()=>i(!0),className:"w-full text-white py-2 px-3 rounded-lg font-medium transition-all transform hover:scale-105 shadow-md text-sm",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))"},children:"⚔️ オンライン対戦"})]})})]})})]})})})}const d4={kyoto:{x:46,y:62,name:"京都",daimyo:"足利将軍家"},sakai:{x:45,y:67,name:"堺",daimyo:"商人自治"},kai:{x:58,y:55,name:"甲斐",daimyo:"武田信玄"},echigo:{x:62,y:47,name:"越後",daimyo:"上杉謙信"},owari:{x:53,y:63,name:"尾張",daimyo:"織田信長"},satsuma:{x:20,y:85,name:"薩摩",daimyo:"島津義弘"},hizen:{x:17,y:73,name:"肥前",daimyo:"鍋島直茂"},sagami:{x:64,y:62,name:"相模",daimyo:"北条氏康"},dewa:{x:74,y:35,name:"出羽",daimyo:"最上義光"},morioka:{x:72,y:25,name:"盛岡",daimyo:"南部信直"},sendai:{x:72,y:43,name:"仙台",daimyo:"伊達政宗"},kanazawa:{x:54,y:49,name:"金沢",daimyo:"前田利家"},takamatsu:{x:38,y:68,name:"高松",daimyo:"生駒親正"},kumamoto:{x:23,y:81,name:"熊本",daimyo:"加藤清正"},yamaguchi:{x:26,y:67,name:"長門",daimyo:"毛利元就"},kaga:{x:52,y:57,name:"加賀",daimyo:"一向一揆"},tosa:{x:35,y:74,name:"土佐",daimyo:"長宗我部元親"}},h4={kyoto:{dx:-8,dy:8},sakai:{dx:-14,dy:18},kai:{dx:10,dy:10},echigo:{dx:10,dy:-2},owari:{dx:12,dy:24},sagami:{dx:18,dy:14},hizen:{dx:6,dy:8},satsuma:{dx:0,dy:6},dewa:{dx:6,dy:-4},morioka:{dx:8,dy:-6},sendai:{dx:12,dy:-2},kanazawa:{dx:-4,dy:6},takamatsu:{dx:-8,dy:12},kumamoto:{dx:4,dy:8},yamaguchi:{dx:-6,dy:4},kaga:{dx:2,dy:-2},tosa:{dx:-4,dy:10},modern_stock_prediction:{dx:-20,dy:-20},modern_sentiment_analysis:{dx:-15,dy:-15},modern_image_classification:{dx:-10,dy:-10},modern_recommendation:{dx:-5,dy:-5},modern_fraud_detection:{dx:0,dy:0}};function f4(){const{user:t,regions:e,progress:r,setCurrentView:n,setSelectedRegion:a,loading:i}=Ms(),[s,o]=v.useState(null);if(console.log("JapanMap render:",{user:!!t,regions:e.length,progress:Object.keys(r).length,loading:i}),i)return u.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-yellow-400 mx-auto mb-4"}),u.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"読み込み中..."})]})})});if(!t)return u.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"ユーザーが認証されていません"}),u.jsx("p",{className:"text-lg text-yellow-200 mt-4",children:"ホーム画面に戻ってユーザー認証を行ってください"})]})})});const l=f=>{const m=r[f];m&&m.is_unlocked&&(a(f),n("challenge"))},d=f=>{o(f)},c=Object.values(r).filter(f=>f.is_completed).length,h=Object.values(r).filter(f=>f.is_unlocked).length;return u.jsx("div",{className:"min-h-screen p-4 md:p-8",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:[u.jsxs("div",{className:"p-6",style:{background:"linear-gradient(to right, var(--accent-strong), var(--accent))"},children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("button",{onClick:()=>n("home"),className:"flex items-center space-x-2 text-yellow-100 hover:text-white transition-colors bg-white/10 px-4 py-2 rounded-lg backdrop-blur-sm",children:[u.jsx(zr,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:"ホームに戻る"})]}),u.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-yellow-100 text-center flex-1",children:"全国の課題マップ"}),u.jsx("div",{className:"w-32"})]}),u.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-8",children:[u.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg px-6 py-3 text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-white",children:[c,"/",e.length]}),u.jsx("div",{className:"text-sm text-blue-100",children:"クリア済み"})]}),u.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg px-6 py-3 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-white",children:h}),u.jsx("div",{className:"text-sm text-blue-100",children:"挑戦可能"})]})]})]}),u.jsxs("div",{className:"p-6 md:p-12",children:[u.jsx("div",{className:"mb-8 text-center",children:u.jsx("p",{className:"text-gray-700 text-lg",children:"日本地図上のピンをクリックして、各地域の課題を確認しよう！"})}),u.jsxs("div",{className:"relative rounded-2xl border-4 border-[var(--gold)] shadow-2xl overflow-hidden mb-8",style:{background:"rgba(10,18,36,0.06)"},children:[u.jsx("div",{className:"absolute inset-0 opacity-30 pointer-events-none",style:{backgroundImage:"linear-gradient(0deg, transparent 24%, rgba(139,105,20,0.08) 25%, rgba(139,105,20,0.08) 26%, transparent 27%, transparent 74%, rgba(139,105,20,0.08) 75%, rgba(139,105,20,0.08) 76%, transparent 77%, transparent),                        linear-gradient(90deg, transparent 24%, rgba(139,105,20,0.08) 25%, rgba(139,105,20,0.08) 26%, transparent 27%, transparent 74%, rgba(139,105,20,0.08) 75%, rgba(139,105,20,0.08) 76%, transparent 77%, transparent)",backgroundSize:"50px 50px"}}),u.jsx("div",{className:"absolute inset-0 opacity-15 pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(214,193,113,0.35), transparent 60%)"}}),u.jsxs("div",{className:"relative w-full h-[900px] md:h-[1100px]",children:[u.jsx("div",{className:"absolute inset-0 z-0",children:u.jsx("img",{src:"./japan-map.png",onError:f=>{f.currentTarget.src="./japan-oldmap.png/Gemini_Generated_Image_9k83oi9k83oi9k83.png"},alt:"日本地図",className:"w-full h-full object-cover",style:{transform:"translateX(-3%) scale(1.25)",transformOrigin:"50% 42%",filter:"saturate(0.95) contrast(1.02)",pointerEvents:"none"}})}),u.jsx("div",{className:"absolute inset-0 z-30",children:e.map(f=>{const m=d4[f.id];if(!m)return null;const p=r[f.id],g=p?.is_unlocked||!1,y=p?.is_completed||!1,b=p?.stars||0,x=h4[f.id]||{dx:0,dy:0};return u.jsxs("div",{className:"absolute group cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full",style:{left:`${m.x}%`,top:`${m.y}%`,transform:`translate(-50%, -50%) translate(${x.dx}px, ${x.dy}px)`},onClick:()=>d(f.id),role:"button",tabIndex:0,"aria-label":`${m.name} - ${y?"クリア済み":g?"挑戦可能":"ロック中"}`,onKeyDown:w=>{(w.key==="Enter"||w.key===" ")&&d(f.id)},children:[u.jsx("div",{className:"absolute w-3 h-3 bg-black/30 rounded-full blur-sm translate-x-1 translate-y-1"}),u.jsxs("div",{className:`relative w-8 h-8 rounded-full border-2 shadow-lg transition-all duration-300 group-hover:scale-110 group-hover:shadow-xl ${y?"bg-gradient-to-br from-[#5fbad1] via-[#6ad6e2] to-[#7fe0da] border-[#e7f0f3]":g?"bg-gradient-to-br from-[#3a8fb7] via-[#4fa3c3] to-[#6bb7d1] border-[#e7f0f3]":"bg-gradient-to-br from-[#9aa7b1] via-[#8d99a6] to-[#7c8794] border-[#e7f0f3]"} border-white/60`,children:[u.jsx("div",{className:"absolute inset-0.5 rounded-full bg-white/20"}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:y?u.jsx(pg,{className:"w-4 h-4 text-white drop-shadow-lg"}):g?u.jsx(Ah,{className:"w-4 h-4 text-white drop-shadow-lg"}):u.jsx(Cw,{className:"w-4 h-4 text-white drop-shadow-lg"})}),y&&b>0&&u.jsx("div",{className:"absolute -top-2 -right-2 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-full w-4 h-4 flex items-center justify-center shadow-lg border border-white",children:u.jsx("span",{className:"text-white text-[8px] font-bold",children:b})}),g&&!y&&u.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-400 animate-ping opacity-40"}),u.jsx("div",{className:"absolute inset-0 rounded-full bg-white/30 animate-pulse"})]}),u.jsx("div",{className:`absolute top-7 left-1/2 -translate-x-1/2 whitespace-nowrap px-2 py-0.5 rounded-full text-[11px] font-medium transition-all duration-300 group-hover:scale-105 shadow-md border ${g?"bg-gradient-to-r from-[#2e6f9e] to-[#3e8bb9] text-white border-[#cfe3ec]":"bg-gradient-to-r from-gray-500 to-gray-600 text-white border-gray-300"}`,children:m.name}),u.jsx("div",{className:`hidden sm:block absolute top-12 left-1/2 -translate-x-1/2 whitespace-nowrap px-1.5 py-0.5 rounded-full text-[9px] font-medium transition-all duration-300 group-hover:scale-105 shadow-sm border ${g?"bg-gradient-to-r from-[#e6f2f7] to-[#d9eef6] text-[#0a192f] border-[#cfe3ec]":"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-600 border-gray-200"}`,children:m.daimyo})]},f.id)})}),u.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-sm rounded-xl px-4 py-3 text-sm text-gray-700 shadow-lg border border-white/50",children:[u.jsx("div",{className:"font-bold text-gray-800 mb-2 text-center",children:"凡例"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-400 to-cyan-500 rounded-full shadow-sm border border-blue-300"}),u.jsx("span",{className:"text-xs",children:"挑戦可能"})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full shadow-sm border border-green-300"}),u.jsx("span",{className:"text-xs",children:"クリア済み"})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-gray-400 to-gray-500 rounded-full shadow-sm border border-gray-300"}),u.jsx("span",{className:"text-xs",children:"ロック中"})]})]})]})]})]}),s&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-2xl border-2 shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",style:{borderColor:"var(--gold)"},children:u.jsx("div",{className:"p-6",children:(()=>{const f=e.find(x=>x.id===s),m=r[s],p=m?.is_unlocked||!1,g=m?.is_completed||!1,y=m?.stars||0,b=m?.best_accuracy||0;return f?u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:`p-3 rounded-xl ${p?"bg-blue-100":"bg-gray-200"}`,children:u.jsx(Ah,{className:`w-8 h-8 ${p?"text-blue-600":"text-gray-500"}`})}),u.jsxs("div",{children:[u.jsx("h3",{className:`text-2xl font-bold ${p?"text-gray-900":"text-gray-600"}`,children:f.name}),u.jsx("p",{className:`text-lg ${p?"text-blue-600":"text-gray-500"}`,children:f.daimyo})]})]}),u.jsx("button",{onClick:()=>o(null),className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:`p-4 rounded-xl ${p?"bg-blue-50 border border-blue-200":"bg-gray-100 border border-gray-200"}`,children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-600",children:"地域の説明"}),u.jsx("p",{className:`text-base leading-relaxed ${p?"text-gray-700":"text-gray-500"}`,children:f.description})]}),u.jsxs("div",{className:`p-4 rounded-xl ${p?"bg-yellow-50 border border-yellow-200":"bg-gray-100 border border-gray-200"}`,children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-600",children:"課題の内容"}),u.jsx("p",{className:`text-base ${p?"text-gray-800":"text-gray-500"}`,children:f.problem_description})]}),u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"難易度:"}),u.jsx("div",{className:"flex space-x-1",children:[...Array(5)].map((x,w)=>u.jsx("div",{className:`w-3 h-5 rounded-sm ${w<f.difficulty?p?"bg-orange-400":"bg-gray-400":"bg-gray-200"}`},w))})]}),g&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Iw,{className:"w-5 h-5 text-yellow-500"}),u.jsxs("span",{className:"text-lg font-bold text-gray-700",children:[(b*100).toFixed(0),"%"]}),u.jsx("div",{className:"flex space-x-1",children:[...Array(3)].map((x,w)=>u.jsx("span",{className:`text-xl ${w<y?"text-yellow-400":"text-gray-300"}`,children:"★"},w))})]})]}),p?u.jsx("button",{onClick:()=>{l(f.id),o(null)},className:`w-full py-4 rounded-xl font-bold text-lg transition-all ${g?"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white":"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white shadow-md hover:shadow-lg"}`,children:g?"再挑戦する":"挑戦する"}):u.jsx("div",{className:"bg-gray-200 text-gray-500 py-4 rounded-xl text-center font-medium text-lg",children:"前の課題をクリアしよう"})]})]}):null})()})})}),u.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-6 border-2 border-blue-200",children:u.jsxs("div",{className:"flex items-start space-x-4",children:[u.jsx("div",{className:"bg-blue-500 text-white rounded-full p-3",children:u.jsx(vg,{className:"w-6 h-6"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"進め方のヒント"}),u.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"1."}),u.jsx("span",{children:"地図上のピンをクリックして地域の詳細を確認しよう"})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"2."}),u.jsx("span",{children:"最初は簡単な課題から始めよう"})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"3."}),u.jsx("span",{children:"データをよく観察して、特徴を見つけよう"})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"4."}),u.jsx("span",{children:"いろいろなモデルを試して、比べてみよう"})]})]})]})]})})]})]})})})}function je(t){const e=[...t];for(let r=e.length-1;r>0;r--){const n=Math.floor(Math.random()*(r+1));[e[r],e[n]]=[e[n],e[r]]}return e}function E(t,e){const r=Math.random(),n=Math.random();return Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n)*e+t}function hg(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(1200,Math.min(1600,E(1400,100))),s=Math.max(1,Math.min(10,E(6,2))),o=Math.max(1,Math.min(10,E(6,2))),l=Math.max(1,Math.min(10,E(6,2))),c=s/10*.4+o/10*.3+l/10*.2+(1600-i)/400*.1+E(0,.1)>.5;e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l)],label:c?1:0}),t.push({features:[Math.min(1,(i-1200)/400),s/10,o/10,l/10],label:c?1:0})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["年代","職人技","材質","古色"],classes:["贋作","本物"],labelName:"真贋",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["年代","職人技","材質","古色"],featureUnits:["年","点","点","点"]}}}function m4(){const t=[],e=[],r=["中国","南蛮","朝鮮","日本"];for(let i=0;i<300;i++){const s=Math.floor(Math.random()*4);let o,l,d,c;switch(s){case 0:o=Math.min(10,Math.max(1,E(8,1))),l=Math.min(10,Math.max(1,E(8,1))),d=Math.min(10,Math.max(1,E(7,1))),c=Math.min(500,Math.max(50,E(300,50)));break;case 1:o=Math.min(10,Math.max(1,E(6,1))),l=Math.min(10,Math.max(1,E(3,1))),d=Math.min(10,Math.max(1,E(5,1))),c=Math.min(500,Math.max(50,E(400,50)));break;case 2:o=Math.min(10,Math.max(1,E(7,1))),l=Math.min(10,Math.max(1,E(6,1))),d=Math.min(10,Math.max(1,E(8,1))),c=Math.min(500,Math.max(50,E(200,50)));break;case 3:default:o=Math.min(10,Math.max(1,E(6,1))),l=Math.min(10,Math.max(1,E(7,1))),d=Math.min(10,Math.max(1,E(6,1))),c=Math.min(500,Math.max(50,E(250,50)));break}e.push({features:[Math.round(o),Math.round(l),Math.round(d),Math.round(c)],label:r[s]}),t.push({features:[o/10,l/10,d/10,c/500],label:s})}const n=je(t),a=Math.floor(t.length*.7);return{train:n.slice(0,a),test:n.slice(a),featureNames:["材質","装飾","職人技","価格"],classes:r,labelName:"産地",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["材質","装飾","職人技","価格"],featureUnits:["点","点","点","文"]}}}function p4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(5,Math.min(100,E(50,20))),s=Math.max(1,Math.min(15,E(8,3))),o=Math.max(-5,Math.min(30,E(15,8))),l=Math.max(0,Math.min(300,E(100,40))),d=Math.max(1,Math.min(8,E(5,2))),c=Math.max(1,Math.min(8,E(5,2))),f=i/100*.3+s/15*.25+d/8*.2+c/8*.15+(1-Math.abs(o-15)/25)*.05+(1-l/300)*.05+E(0,.1)>.5;e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l),Math.round(d),Math.round(c)],label:f?"成功":"失敗"}),t.push({features:[i/100,s/15,(o+5)/35,l/300,d/8,c/8],label:f?1:0})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["労働者数","経験値","気温","降水量","機具の質","鉱石の品質"],classes:[],labelName:"産出量",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["労働者数","経験値","気温","降水量","機具の質","鉱石の品質"],featureUnits:["人","年","℃","mm","点","点"]}}}function g4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(10,Math.min(30,E(20,5))),s=Math.max(50,Math.min(300,E(150,50))),o=Math.max(100,Math.min(300,E(200,50))),l=Math.max(1,Math.min(10,E(5,2))),d=Math.max(1,Math.min(10,E(5,2))),c=Math.max(0,Math.min(50,E(25,15))),h=100,f=(i-10)/20,m=(s-50)/250,p=(o-100)/200,g=(l-1)/9,y=(d-1)/9,b=c/50,x=h+f*30+m*40+p*35+g*25+y*20+b*15+(Math.random()-.5)*20;a<5&&console.log(`上杉謙信問題 サンプル ${a+1}:`,{temperature:i,rainfall:s,sunshine:o,soilQuality:l,seedQuality:d,fertilizer:c,harvestYield:x,normalizedLabel:x/200}),e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l),Math.round(d),Math.round(c)],label:Math.round(x*10)/10}),t.push({features:[(i-10)/20,(s-50)/250,(o-100)/200,(l-1)/9,(d-1)/9,c/50],label:x/200}),a<5&&console.log(`正規化後 サンプル ${a+1}:`,{features:[(i-10)/20,(s-50)/250,(o-100)/200,(l-1)/9,(d-1)/9,c/50],label:x/200})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["気温","降水量","日照時間","土壌の質","種子の質","肥料の量"],classes:[],labelName:"収穫量",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["気温","降水量","日照時間","土壌の質","種子の質","肥料の量"],featureUnits:["℃","mm","時間","点","点","kg"]}}}function v4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(16,Math.min(50,E(25,8))),s=Math.max(1,Math.min(10,E(6,2))),o=Math.max(1,Math.min(10,E(5,2))),l=Math.max(1,Math.min(10,E(5,2))),d=Math.max(0,Math.min(20,E(3,4))),c=Math.max(1,Math.min(5,E(3,1))),h=i<20?1.1:i>40?.9:1,f=Math.min(10,Math.max(1,s*h)),m=Math.min(10,Math.max(1,o*h)),p=(f+m)/20,g=l/10,y=d/20,b=c/5,w=(p*.35+g*.25+y*.25+b*.15)*100+E(0,10);e.push({features:[Math.round(i),Math.round(f),Math.round(m),Math.round(l),Math.round(d),Math.round(c)],label:Math.round(w*10)/10}),t.push({features:[(i-16)/34,(f-1)/9,(m-1)/9,(l-1)/9,d/20,(c-1)/4],label:w/100})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["年齢","筋力","敏捷性","知力","戦闘経験","社会階級"],classes:["槍兵","弓兵","鉄砲隊","騎馬隊"],labelName:"役職",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["年齢","筋力","敏捷性","知力","戦闘経験","社会階級"],featureUnits:["歳","点","点","点","年","段階"]}}}function y4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(0,Math.min(20,E(8,4))),s=Math.max(0,Math.min(5,E(2,1))),o=Math.max(5,Math.min(50,E(20,10))),l=Math.max(1,Math.min(10,E(6,2))),d=Math.max(1,Math.min(8,E(5,2))),c=Math.max(1,Math.min(5,E(3,1))),h=i>15?.7:i<3?.8:1,f=s>3?.6:s<1?.9:1,m=Math.log(o)/Math.log(50),p=l/10,g=d/8,y=c<=2?1:c===3?.8:c===4?.6:.4,x=h*f*m*p*g*y>.5;e.push({features:[Math.round(i*10)/10,Math.round(s*10)/10,Math.round(o),Math.round(l),Math.round(d),Math.round(c)],label:x?1:0}),t.push({features:[i/20,s/5,o/50,l/10,d/8,c/5],label:x?1:0})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["風速","波高","船数","乗組員経験","武器の質","天候"],classes:["敗北","勝利"],labelName:"戦果",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["風速","波高","船数","乗組員経験","武器の質","天候"],featureUnits:["m/s","m","隻","点","点","段階"]}}}function b4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(0,E(.6,.2))),s=Math.min(1,Math.max(0,E(.7,.15))),o=Math.max(800,Math.min(1400,E(1200,100))),l=Math.min(1,Math.max(0,E(.65,.2))),d=Math.min(1,Math.max(0,E(.5,.25))),c=Math.min(1,Math.max(0,E(.6,.2))),h=(i+s)/2,f=(l+d)/2,m=Math.exp(-Math.pow(o-1200,2)/2e4),p=h*.3+f*.3+m*.2+c*.2;let g=0;p>.8?g=2:p>.6&&(g=1);const y=["下級","中級","上級"];e.push({features:[Math.round(i*10)/10,Math.round(s*10)/10,Math.round(o),Math.round(l*10)/10,Math.round(d*10)/10,Math.round(c*10)/10],label:y[g]}),t.push({features:[i,s,o/1500,l,d,c],label:g})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["粘土の品質","釉薬の品質","焼成温度","陶工の技能","装飾の美しさ","厚さの均一性"],classes:["下級","中級","上級"],labelName:"等級",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["粘土の品質","釉薬の品質","焼成温度","陶工の技能","装飾の美しさ","厚さの均一性"],featureUnits:["","","℃","","",""]}}}function x4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(1e3,Math.min(1e4,E(5e3,2e3))),s=Math.min(1,Math.max(0,E(.6,.2))),o=Math.min(1,Math.max(0,E(.7,.15))),l=Math.min(1,Math.max(0,E(.5,.25))),d=Math.min(1,Math.max(0,E(.6,.2))),c=Math.min(1,Math.max(0,E(.6,.2))),h=(s+o+l+d+c)/5,f=Math.log(i/1e3)/10,m=s*o*.1,p=Math.min(1,Math.max(0,h+f+m));let g=0;p>.75?g=2:p>.5&&(g=1);const y=["低い","中程度","高い"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*10)/10,Math.round(c*10)/10],label:y[g]}),t.push({features:[i/1e4,s,o,l,d,c],label:g})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["人口","商業の発達度","農業の発達度","統治の質","政治安定性","立地の良さ"],classes:["低い","中程度","高い"],labelName:"繁栄度",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["人口","商業の発達度","農業の発達度","統治の質","政治安定性","立地の良さ"],featureUnits:["人","","","","",""]}}}function w4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(10,Math.min(100,E(50,20))),s=Math.max(100,Math.min(500,E(300,100))),o=Math.min(1,Math.max(0,E(.6,.2))),l=Math.min(1,Math.max(0,E(.5,.25))),d=Math.min(1,Math.max(0,E(.6,.2))),c=Math.random(),h=Math.exp(-i/50),f=Math.exp(-s/1e3),m=o,p=Math.pow(l,1.5),g=1-Math.abs(c-.5)*.3,y=h*f*m*p*g*d;e.push({features:[Math.round(i),Math.round(s),Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*10)/10,Math.round(c*100)/100],label:Math.round(y*1e3)/1e3}),t.push({features:[i/100,s/1e3,o,l,d,c],label:y})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["距離","標高","天候の良さ","道路の質","荷物の価値","季節"],classes:[],labelName:"輸送効率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["距離","標高","天候の良さ","道路の質","荷物の価値","季節"],featureUnits:["km","m","","","",""]}}}function _4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(0,E(.6,.2))),s=Math.max(3,Math.min(15,E(8,3))),o=Math.min(1,Math.max(0,E(.7,.15))),l=Math.min(1,Math.max(0,E(.6,.2))),d=Math.random(),c=Math.max(0,Math.min(5,E(2,1))),h=Math.pow(i,1.2),f=Math.exp(-Math.pow(s-8,2)/20),m=o,p=Math.pow(l,.8),g=1-Math.abs(d-.5)*.4,y=Math.exp(-c/3),b=h*f*m*p*g*y*(.7+Math.random()*.6);e.push({features:[Math.round(i*10)/10,Math.round(s),Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*100)/100,Math.round(c)],label:Math.round(b*1e3)/1e3}),t.push({features:[i,s/15,o,l,d,c/5],label:b})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["血統スコア","年齢","健康状態","飼育環境","季節","交配回数"],classes:[],labelName:"繁殖成功率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["血統スコア","年齢","健康状態","飼育環境","季節","交配回数"],featureUnits:["","年","","","","回"]}}}function j4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(5,Math.min(35,E(20,8))),s=Math.max(0,Math.min(400,E(150,50))),o=Math.max(50,Math.min(300,E(200,40))),l=Math.min(1,Math.max(0,E(.6,.2))),d=Math.min(1,Math.max(0,E(.5,.25))),c=Math.random(),h=Math.exp(-Math.pow(i-22,2)/100),f=Math.exp(-Math.pow(s-150,2)/5e3),m=Math.min(1,o/200),p=Math.pow(l*d,.7),g=1-Math.abs(c-.3)*.5,y=h*f*m*p*g*(.6+Math.random()*.8);e.push({features:[Math.round(i),Math.round(s),Math.round(o),Math.round(l*10)/10,Math.round(d*10)/10,Math.round(c*100)/100],label:Math.round(y*1e3)/1e3}),t.push({features:[i/35,s/400,o/300,l,d,c],label:y})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["気温","降水量","日照時間","土壌水分","肥料量","植え付け時期"],classes:[],labelName:"収穫量",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["気温","降水量","日照時間","土壌水分","肥料量","植え付け時期"],featureUnits:["℃","mm","時間","","",""]}}}function S4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(.8,E(.95,.05))),s=Math.max(800,Math.min(1200,E(1e3,100))),o=Math.min(1,Math.max(0,E(.4,.2))),l=Math.max(50,Math.min(200,E(120,30))),d=Math.min(1,Math.max(0,E(.7,.2))),c=Math.max(2,Math.min(12,E(6,2))),h=Math.pow(i,2),f=Math.exp(-Math.pow(s-1e3,2)/2e4),m=Math.exp(-Math.pow(o-.4,2)/.2),p=Math.exp(-Math.pow(l-120,2)/2e3),g=Math.pow(d,1.5),y=Math.exp(-Math.pow(c-6,2)/8),b=h*f*m*p*g*y;let x=0;b>.8?x=3:b>.6?x=2:b>.4&&(x=1);const w=["下級","中級","上級","最高級"];e.push({features:[Math.round(i*1e3)/1e3,Math.round(s),Math.round(o*10)/10,Math.round(l),Math.round(d*10)/10,Math.round(c)],label:w[x]}),t.push({features:[i,s/1200,o,l/200,d,c/12],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["金の純度","温度","湿度","圧延回数","職人経験","作業時間"],classes:["下級","中級","上級","最高級"],labelName:"品質等級",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["金の純度","温度","湿度","圧延回数","職人経験","作業時間"],featureUnits:["","℃","","回","","時間"]}}}function N4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(0,Math.min(30,E(10,5))),s=Math.max(0,Math.min(5,E(1.5,.8))),o=Math.max(0,Math.min(5,E(2,1))),l=Math.min(1,Math.max(0,E(.5,.3))),d=Math.max(980,Math.min(1030,E(1013,15))),c=Math.random(),h=Math.exp(-i/15),f=Math.exp(-s/2),m=Math.exp(-o/3),p=1-l*.3,g=Math.exp(-Math.pow(d-1013,2)/200),y=1-Math.abs(c-.5)*.4,b=h*f*m*p*g*y;let x=0;b>.7?x=2:b>.4&&(x=1);const w=["危険","注意","安全"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d),Math.round(c*100)/100],label:w[x]}),t.push({features:[i/30,s/5,o/5,l,d/1030,c],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["風速","波高","海流速度","雲量","気圧","潮汐"],classes:["危険","注意","安全"],labelName:"安全性",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["風速","波高","海流速度","雲量","気圧","潮汐"],featureUnits:["m/s","m","m/s","","hPa",""]}}}function P4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.min(1,Math.max(0,E(.6,.2))),s=Math.max(.1,Math.min(2,E(.8,.3))),o=Math.min(1,Math.max(0,E(.7,.15))),l=Math.min(1,Math.max(0,E(.4,.2))),d=Math.max(60,Math.min(90,E(75,8))),c=Math.max(.5,Math.min(3,E(1.5,.5))),h=Math.pow(i,1.5),f=Math.exp(-Math.pow(s-.8,2)/.2),m=Math.pow(o,1.2),p=Math.exp(-Math.pow(l-.4,2)/.1),g=Math.exp(-Math.pow(d-75,2)/50),y=Math.pow(c,.8),b=h*f*m*p*g*y*(.6+Math.random()*.8);e.push({features:[Math.round(i*10)/10,Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d),Math.round(c*10)/10],label:Math.round(b*1e3)/1e3}),t.push({features:[i,s/2,o,l,d/90,c/3],label:b})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["石の硬さ","石の大きさ","積み方","モルタル量","角度","基礎の深さ"],classes:[],labelName:"強度",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["石の硬さ","石の大きさ","積み方","モルタル量","角度","基礎の深さ"],featureUnits:["","m","","","度","m"]}}}function k4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(0,Math.min(30,E(10,5))),s=Math.max(0,Math.min(5,E(1.5,.8))),o=Math.max(5,Math.min(50,E(20,10))),l=Math.max(50,Math.min(500,E(200,100))),d=Math.max(1,Math.min(20,E(8,4))),c=Math.random(),h=Math.exp(-i/15),f=Math.exp(-s/2),m=Math.log(o)/10,p=Math.log(l)/20,g=Math.exp(-d/10),y=1-Math.abs(c-.5)*.3,b=h*f*m*p*g*y*(.5+Math.random()*.5);let x=0;b>.7?x=2:b>.4&&(x=1);const w=["敗北","引き分け","勝利"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o),Math.round(l),Math.round(d),Math.round(c*24)],label:w[x]}),t.push({features:[i/30,s/5,o/50,l/500,d/20,c],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["風速","波高","船数","兵数","距離","時間"],classes:["敗北","引き分け","勝利"],labelName:"戦果",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["風速","波高","船数","兵数","距離","時間"],featureUnits:["m/s","m","隻","人","km","時"]}}}function M4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(10,Math.min(200,E(80,30))),s=Math.min(1,Math.max(0,E(.6,.2))),o=Math.min(1,Math.max(0,E(.4,.25))),l=Math.min(1,Math.max(0,E(.3,.2))),d=Math.min(1,Math.max(0,E(.5,.25))),c=Math.random(),h=Math.log(i)/10,f=Math.pow(s,.8),m=Math.exp(-o/2),p=Math.exp(-l/3),g=Math.pow(d,1.2),y=1-Math.abs(c-.5)*.4,b=h*f*m*p*g*y*(.3+Math.random()*.7),x=Math.max(0,Math.round(b*100));e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d*10)/10,Math.round(c*100)/100],label:x}),t.push({features:[i/200,s,o,l,d,c],label:b})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["人口密度","経済状況","教育レベル","既存宗教","交通便","季節"],classes:[],labelName:"信者獲得数",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["人口密度","経済状況","教育レベル","既存宗教","交通便","季節"],featureUnits:["人/km²","","","","",""]}}}function O4(){const t=[],e=[];for(let a=0;a<300;a++){const i=Math.max(100,Math.min(2e3,E(800,300))),s=Math.min(1,Math.max(0,E(.6,.2))),o=Math.min(1,Math.max(0,E(.5,.25))),l=Math.min(1,Math.max(0,E(.6,.2))),d=Math.max(50,Math.min(1500,E(600,250))),c=Math.min(1,Math.max(0,E(.7,.15))),h=Math.log(i)/15,f=Math.pow(s,1.3),m=Math.pow(o,.9),p=l,g=Math.exp(-d/1e3),y=Math.pow(c,1.1),b=h*f*m*p*g*y*(.4+Math.random()*.6);let x=0;b>.8?x=2:b>.5&&(x=1);const w=["失敗","部分成功","完全成功"];e.push({features:[Math.round(i),Math.round(s*10)/10,Math.round(o*10)/10,Math.round(l*10)/10,Math.round(d),Math.round(c*10)/10],label:w[x]}),t.push({features:[i/2e3,s,o,l,d/1500,c],label:x})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["兵力","装備","地形","天候","敵兵力","補給"],classes:["失敗","部分成功","完全成功"],labelName:"戦略結果",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["兵力","装備","地形","天候","敵兵力","補給"],featureUnits:["人","","","","人",""]}}}function A4(t){switch(t){case"kyoto":return hg();case"sakai":return m4();case"kai":return p4();case"echigo":return g4();case"owari":return v4();case"satsuma":return y4();case"hizen":return b4();case"sagami":return x4();case"dewa":return w4();case"morioka":return _4();case"sendai":return j4();case"kanazawa":return S4();case"takamatsu":return N4();case"kumamoto":return P4();case"yamaguchi":return k4();case"kaga":return M4();case"tosa":return O4();case"modern_stock_prediction":return E4();case"modern_sentiment_analysis":return T4();case"modern_image_classification":return C4();case"modern_recommendation":return I4();case"modern_fraud_detection":return D4();default:return hg()}}function E4(){const t=[],e=[];for(let a=0;a<1e3;a++){const i=Math.max(100,Math.min(1e3,E(500,150))),s=Math.max(1e3,Math.min(1e6,E(1e5,5e4))),o=Math.max(1e6,Math.min(1e9,E(1e7,5e6))),l=Math.max(5,Math.min(50,E(20,8))),d=Math.min(1,Math.max(0,E(.3,.2))),c=E(.05,.15),h=Math.min(.5,Math.max(-.2,E(.1,.1))),f=E(0,.05)+c*.3+h*.2;e.push({features:[Math.round(i*100)/100,Math.round(s),Math.round(o),Math.round(l*10)/10,Math.round(d*100)/100,Math.round(c*1e3)/1e3,Math.round(h*1e3)/1e3],label:Math.round(f*1e4)/1e4}),t.push({features:[i/1e3,s/1e6,o/1e9,l/50,d,c,h],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["始値","出来高","時価総額","PER","負債比率","売上成長率","利益率"],labelName:"株価変化率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["始値","出来高","時価総額","PER","負債比率","売上成長率","利益率"],featureUnits:["円","株","円","","","",""]}}}function T4(){const t=[],e=[];for(let a=0;a<2e3;a++){const i=Math.max(5,Math.min(100,E(30,15))),s=Math.min(i,Math.floor(Math.random()*5)),o=Math.min(i-s,Math.floor(Math.random()*5)),l=i-s-o,d=Math.floor(Math.random()*3),c=Math.floor(Math.random()*2),h=Math.min(1,Math.random()*.3);let f=0;s>o&&s>l?f=2:l>s&&l>o&&(f=1);const m=["ネガティブ","ニュートラル","ポジティブ"];e.push({features:[i,s,o,l,d,c,Math.round(h*100)/100],label:m[f]}),t.push({features:[i/100,s/i,o/i,l/i,d/i,c/i,h],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["単語数","ポジティブ単語比率","ネガティブ単語比率","ニュートラル単語比率","感嘆符比率","疑問符比率","大文字比率"],classes:["ネガティブ","ニュートラル","ポジティブ"],labelName:"感情",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["単語数","ポジティブ単語比率","ネガティブ単語比率","ニュートラル単語比率","感嘆符比率","疑問符比率","大文字比率"],featureUnits:["語","","","","","",""]}}}function C4(){const t=[],e=[],r=["猫","犬","車","飛行機","建物","花","食べ物","人物"];for(let i=0;i<1500;i++){const s=Math.min(1,Math.max(0,E(.5,.2))),o=Math.min(1,Math.max(0,E(.5,.2))),l=Math.min(1,Math.max(0,E(.6,.3))),d=Math.min(1,Math.max(0,E(.4,.2))),c=Math.min(1,Math.max(0,E(.5,.3))),h=Math.min(1,Math.max(0,E(.6,.3))),f=Math.max(.5,Math.min(2,E(1,.3)));let m=0;s>.7&&l>.6?m=6:d>.6&&c>.5?m=0:h>.7&&f>1.5?m=2:s<.4&&d>.5?m=4:m=Math.floor(Math.random()*r.length),e.push({features:[Math.round(s*100)/100,Math.round(o*100)/100,Math.round(l*100)/100,Math.round(d*100)/100,Math.round(c*100)/100,Math.round(h*100)/100,Math.round(f*100)/100],label:r[m]}),t.push({features:[s,o,l,d,c,h,f],label:m})}const n=je(t),a=Math.floor(t.length*.7);return{train:n.slice(0,a),test:n.slice(a),featureNames:["明度","コントラスト","色彩豊かさ","エッジ密度","テクスチャ複雑さ","対称性","アスペクト比"],classes:r,labelName:"画像タイプ",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["明度","コントラスト","色彩豊かさ","エッジ密度","テクスチャ複雑さ","対称性","アスペクト比"],featureUnits:["","","","","","",""]}}}function I4(){const t=[],e=[];for(let a=0;a<3e3;a++){const i=Math.max(18,Math.min(80,E(35,15))),s=Math.max(200,Math.min(1e3,E(500,200))),o=Math.min(1,Math.max(0,E(.6,.3))),l=Math.max(10,Math.min(1e3,E(200,150))),d=Math.min(5,Math.max(1,E(3.5,1))),c=Math.floor(Math.random()*10),h=Math.min(1,Math.max(0,E(.5,.3))),f=Math.min(1,Math.max(0,o*.3+d/5*.2+h*.2+s/1e3*.1+l/1e3*-.1+E(0,.1)));e.push({features:[i,Math.round(s),Math.round(o*100)/100,Math.round(l),Math.round(d*10)/10,c,Math.round(h*100)/100],label:Math.round(f*1e3)/1e3}),t.push({features:[i/80,s/1e3,o,l/1e3,d/5,c/10,h],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["ユーザー年齢","ユーザー収入","ユーザー活動度","アイテム価格","アイテム評価","アイテムカテゴリ","アイテム人気度"],labelName:"購入確率",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["ユーザー年齢","ユーザー収入","ユーザー活動度","アイテム価格","アイテム評価","アイテムカテゴリ","アイテム人気度"],featureUnits:["歳","万円","","円","","",""]}}}function D4(){const t=[],e=[];for(let a=0;a<5e3;a++){const i=Math.max(1,Math.min(1e5,E(5e3,3e3))),s=Math.floor(Math.random()*24),o=Math.floor(Math.random()*7),l=Math.floor(Math.random()*100),d=Math.floor(Math.random()*20),c=Math.min(1,Math.max(0,E(.7,.3))),h=Math.floor(Math.random()*5),f=Math.random()<.02?1:0;let m=i,p=s,g=l;f===1&&(m=Math.max(5e4,i*2),p=Math.random()<.5?2:3,g=Math.floor(Math.random()*10)),e.push({features:[Math.round(m),p,o,g,d,Math.round(c*100)/100,h],label:f===1?"不正":"正常"}),t.push({features:[m/1e5,p/24,o/7,g/100,d/20,c,h/5],label:f})}const r=je(t),n=Math.floor(t.length*.7);return{train:r.slice(0,n),test:r.slice(n),featureNames:["取引金額","時間","曜日","地域","店舗タイプ","ユーザー履歴","デバイスタイプ"],classes:["正常","不正"],labelName:"不正検出",raw:{train:e.slice(0,Math.floor(e.length*.7)),test:e.slice(Math.floor(e.length*.7)),featureNames:["取引金額","時間","曜日","地域","店舗タイプ","ユーザー履歴","デバイスタイプ"],featureUnits:["円","時","","","","",""]}}}class $4{static detectOverfitting(e,r,n=.1){const a=e-r;return a>.2?{isOverfitting:!0,severity:"high",message:"⚠️ 過学習が発生しています。モデルが複雑すぎる可能性があります。",suggestions:["モデルを簡素化してください","正則化を試してください","より多くのデータを集めてください","特徴量の数を減らしてください"]}:a>.1?{isOverfitting:!0,severity:"medium",message:"⚠️ 過学習の可能性があります。注意深く監視してください。",suggestions:["交差検証を実施してください","モデルの複雑さを確認してください","テストデータでの性能を監視してください"]}:{isOverfitting:!1,severity:"low",message:"✅ 適切な学習状態です。",suggestions:["現在のモデルは適切です"]}}}const hc=[{id:"logistic_regression",name:"ロジスティック回帰",description:"Yes/Noの判断に強いAI",category:"classification",difficulty:"簡単",detailedDescription:"データを2つのグループに分ける直線を引くAI。境界線を学習して、新しいデータがどちらのグループに属するかを判断します。",tips:["💡 例：戦で勝つか負けるか、商品が売れるか売れないかを予測","⚡ 計算が速く、結果が分かりやすい","🎯 直線で分けられる問題に最適","⚠️ 複雑な曲線的な関係は苦手"],useCases:"戦略の成功/失敗、商品の売上予測、病気の診断など",params:{learning_rate:{default:.01,min:.001,max:.1,step:.001,label:"学習速度",description:"AIが学習する速さ。大きすぎると学習が不安定になり、小さすぎると時間がかかる",tips:"0.01が一般的な値。問題が複雑な場合は0.001、シンプルな場合は0.05を試してみよう"},max_iterations:{default:100,min:50,max:500,step:10,label:"学習回数",description:"何回練習するか。多いほど精度が上がるが、時間がかかる",tips:"100回で十分な場合が多い。精度が足りない場合は200-300回に増やしてみよう"}}},{id:"linear_regression",name:"線形回帰",description:"数値を予測するAI",category:"regression",difficulty:"簡単",detailedDescription:"データの傾向を直線で表現し、新しいデータの値を予測するAI。特徴量と目的変数の関係を学習します。",tips:["💡 例：気温から収穫量を予測、人口から税収を予測","📈 「これが増えれば、あれも増える」という関係を見つける","⚡ 計算が速く、結果が分かりやすい","⚠️ 直線的な関係でない場合は精度が下がる"],useCases:"収穫量予測、売上予測、価格予測、需要予測など",params:{learning_rate:{default:.01,min:.001,max:.1,step:.001,label:"学習速度",description:"AIが学習する速さ。大きすぎると学習が不安定になり、小さすぎると時間がかかる",tips:"0.01が一般的な値。データが少ない場合は0.001、多い場合は0.05を試してみよう"},max_iterations:{default:100,min:50,max:500,step:10,label:"学習回数",description:"何回練習するか。多いほど精度が上がるが、時間がかかる",tips:"100回で十分な場合が多い。複雑なデータの場合は200-300回に増やしてみよう"}}},{id:"knn",name:"k近傍法",description:"似ているデータを探すAI",category:"classification",difficulty:"普通",detailedDescription:"新しいデータの周りにあるk個の最も近いデータを探し、それらの多数決で判断するAI。距離を計算して近いデータを見つけます。",tips:["💡 例：似たような条件の戦いの結果を参考に判断","🔍 データの形が複雑でも対応できる","⚡ 学習は不要で、すぐに予測できる","⚠️ データが多いと計算に時間がかかる"],useCases:"戦略の分類、商品のカテゴリ分け、顧客の行動予測など",params:{k:{default:5,min:1,max:20,step:1,label:"近くの数",description:"参考にする近くのデータの数。奇数にすると多数決で決まりやすくなる",tips:"5が一般的な値。データが少ない場合は3、多い場合は7-9を試してみよう。偶数だと同数になることがあるので奇数がおすすめ"}}},{id:"neural_network",name:"ニューラルネットワーク",description:"複雑な問題に強いAI",category:"classification",difficulty:"難しい",detailedDescription:"人間の脳の仕組みをまねたAI。複雑なパターンを学習して、高度な判断ができます。",tips:["🧠 例：複雑な画像認識、自然言語処理、高度な予測","⚡ 複雑な関係性を学習できる","🎯 大量のデータがある場合に威力を発揮","⚠️ 設定が複雑で、過学習しやすい"],useCases:"画像認識、音声認識、翻訳、高度な予測など",params:{learning_rate:{default:.01,min:.001,max:.1,step:.001,label:"学習速度",description:"AIが学習する速さ。ニューラルネットワークでは特に重要",tips:"0.01が一般的。複雑な問題は0.001、シンプルな問題は0.05を試してみよう"},max_iterations:{default:100,min:50,max:500,step:10,label:"学習回数",description:"何回練習するか。ニューラルネットワークは時間がかかる",tips:"100回から始めて、精度が足りない場合は200-300回に増やそう"}}},{id:"ensemble",name:"アンサンブル学習",description:"複数のAIを組み合わせた強力なAI",category:"both",difficulty:"難しい",detailedDescription:"複数の異なるモデルを組み合わせて、より正確な予測を行う手法です。各モデルの長所を活かして、単体では難しい問題も解決できます。",tips:["🤝 例：複数の専門家の意見をまとめる","⚡ 単体のモデルより高い精度を実現","🎯 多様性のあるモデルを組み合わせると効果的","⚠️ 計算量が多く、解釈が困難"],useCases:"高精度な予測が必要な場合、複雑な問題の解決など",params:{n_estimators:{default:10,min:5,max:50,step:1,label:"モデル数",description:"組み合わせるモデルの数。多いほど精度が上がるが、計算量も増える",tips:"10個が一般的。問題が簡単な場合は5個、複雑な場合は20-30個を試してみよう"},voting_method:{default:0,min:0,max:1,step:1,label:"投票方法",description:"0: 多数決、1: 重み付き平均",tips:"分類問題は多数決、回帰問題は重み付き平均が一般的"}}},{id:"random_forest",name:"ランダムフォレスト",description:"多数の決定木を組み合わせたAI",category:"both",difficulty:"中程度",detailedDescription:"複数の決定木をランダムに作成し、それらの結果をまとめて予測する手法です。過学習に強く、特徴量の重要度も分かります。",tips:["🌳 例：多数の専門家が独立して判断し、その結果をまとめる","⚡ 過学習に強く、安定した性能","🎯 特徴量の重要度が分かる","⚠️ 大量のデータが必要"],useCases:"特徴量の重要度を知りたい場合、安定した予測が必要な場合など",params:{n_trees:{default:100,min:10,max:500,step:10,label:"木の数",description:"作成する決定木の数。多いほど精度が上がるが、計算量も増える",tips:"100本が一般的。問題が簡単な場合は50本、複雑な場合は200-300本を試してみよう"},max_depth:{default:10,min:3,max:20,step:1,label:"木の深さ",description:"各決定木の最大の深さ。深いほど複雑なパターンを学習できるが、過学習しやすくなる",tips:"10が一般的。データが少ない場合は5-8、大量のデータがある場合は15-20を試してみよう"}}},{id:"svm",name:"サポートベクターマシン",description:"境界線を最適化するAI",category:"classification",difficulty:"中程度",detailedDescription:"データを分ける境界線を最適化する手法です。マージン（余裕）を最大化することで、汎化性能の高いモデルを作ります。",tips:["📏 例：2つのグループを最も明確に分ける線を引く","⚡ 高次元データに強い","🎯 少ないデータでも高い性能","⚠️ 大量のデータには向かない"],useCases:"高次元データの分類、少ないデータでの学習など",params:{kernel:{default:0,min:0,max:2,step:1,label:"カーネル",description:"0: 線形、1: 多項式、2: RBF",tips:"線形データは線形、非線形データはRBFが一般的"},c:{default:1,min:.1,max:10,step:.1,label:"正則化パラメータ",description:"誤分類の許容度。小さいほど誤分類を許容し、大きいほど厳密に分類",tips:"1が一般的。過学習している場合は0.1、未学習の場合は10を試してみよう"}}}];function R4({selectedModel:t,parameters:e,onModelChange:r,onParametersChange:n,regionType:a}){const[i,s]=v.useState(null),[o,l]=v.useState(!1),d=hc.filter(p=>a==="classification"?p.category==="classification":a==="regression"?p.category==="regression":!0),c=hc.find(p=>p.id===t)||d[0],h=(p,g)=>{n({...e,[p]:g})},f=p=>{s(p),l(!0)},m=()=>{s(null),l(!1)};return u.jsxs("div",{className:"rounded-lg p-6 shadow-lg border-2",style:{background:"var(--ink-white)",borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(Eh,{className:"w-5 h-5",style:{color:"var(--gold)"}}),u.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--ink)"},children:"AIモデルを選ぼう"})]}),u.jsx("p",{className:"text-sm mb-4",style:{color:"var(--ink-light)"},children:"問題に合ったAIの種類を選んで、設定を調整しよう！"}),u.jsxs("div",{className:"mb-6 p-4 rounded-lg border-2",style:{background:"var(--silver-light)",borderColor:"var(--accent-strong)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"var(--accent)"}}),u.jsx("span",{className:"text-sm font-bold",style:{color:"var(--ink)"},children:"問題タイプ別のヒント"})]}),a==="classification"?u.jsxs("div",{className:"text-sm",style:{color:"var(--ink-light)"},children:[u.jsxs("p",{className:"mb-2",children:["📊 ",u.jsx("strong",{children:"分類問題"}),"：データをグループに分ける問題です"]}),u.jsx("p",{className:"text-xs",style:{color:"var(--ink-light)"},children:"例：戦で勝つか負けるか、商品が売れるか売れないか、病気か健康か"})]}):a==="regression"?u.jsxs("div",{className:"text-sm",style:{color:"var(--ink-light)"},children:[u.jsxs("p",{className:"mb-2",children:["📈 ",u.jsx("strong",{children:"回帰問題"}),"：数値を予測する問題です"]}),u.jsx("p",{className:"text-xs",style:{color:"var(--ink-light)"},children:"例：収穫量、売上金額、価格、温度、人口など"})]}):u.jsxs("div",{className:"text-sm",style:{color:"var(--ink-light)"},children:[u.jsxs("p",{className:"mb-2",children:["🤔 ",u.jsx("strong",{children:"問題タイプを確認"}),"：まずデータを確認して問題の種類を把握しましょう"]}),u.jsx("p",{className:"text-xs",style:{color:"var(--ink-light)"},children:"分類：グループ分け、回帰：数値予測"})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-lg font-bold mb-3 text-blue-900",children:"AIモデルの種類"}),u.jsx("div",{className:"space-y-3",children:d.map(p=>u.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg border-2 cursor-pointer transition-all ${t===p.id?"shadow-lg bg-yellow-50 border-yellow-400":"hover:bg-blue-50 border-slate-300"}`,onClick:()=>r(p.id),children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${t===p.id?"bg-blue-600 border-blue-600":"border-slate-400"}`,children:t===p.id&&u.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-lg text-blue-900",children:p.name}),u.jsx("div",{className:"text-sm text-blue-700",children:p.description})]})]}),u.jsx("button",{onClick:g=>{g.stopPropagation(),f(p.id)},className:"p-2 rounded-full hover:bg-gray-100 transition-colors",title:"詳細情報を見る",children:u.jsx(vg,{className:"w-4 h-4",style:{color:"var(--ink-light)"}})})]},p.id))})]}),u.jsxs("div",{className:"p-4 rounded-lg border",style:{background:"var(--silver-light)",borderColor:"var(--accent-strong)"},children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[u.jsx(ks,{className:"w-4 h-4",style:{color:"var(--accent-strong)"}}),u.jsx("h4",{className:"text-sm font-bold",style:{color:"var(--ink)"},children:"AIの設定を調整"})]}),u.jsx("p",{className:"text-xs mb-3",style:{color:"var(--ink-light)"},children:"スライダーを動かして、AIの動作を調整しよう"}),u.jsx("div",{className:"space-y-4",children:Object.entries(c.params).map(([p,g])=>{const y=e[p]??g.default;return u.jsxs("div",{className:"p-3 rounded-lg border",style:{background:"var(--ink-white)",borderColor:"var(--accent-strong)"},children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("label",{className:"text-sm font-medium",style:{color:"var(--ink)"},children:g.label||p}),u.jsx("span",{className:"text-sm font-bold px-2 py-1 rounded",style:{color:"var(--accent-strong)",background:"var(--silver-light)"},children:y})]}),u.jsx("p",{className:"text-xs mb-2",style:{color:"var(--ink-light)"},children:g.description}),g.tips&&u.jsxs("div",{className:"text-xs p-2 rounded border-l-2 mb-2",style:{color:"var(--accent-strong)",background:"var(--silver-light)",borderColor:"var(--accent)"},children:["💡 ",g.tips]}),u.jsx("input",{type:"range",min:g.min,max:g.max,step:g.step,value:y,onChange:b=>h(p,Number(b.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer",style:{background:"rgba(30,58,138,0.15)",accentColor:"var(--accent-strong)"}}),u.jsxs("div",{className:"flex justify-between text-xs mt-1 text-gray-600",children:[u.jsx("span",{children:"小さい"}),u.jsx("span",{children:"大きい"})]})]},p)})})]})]}),i&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fadeIn",children:u.jsx("div",{className:`bg-white rounded-2xl border-2 shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transform transition-all duration-500 ${o?"scale-100 opacity-100 rotate-0":"scale-95 opacity-0 rotate-2"}`,style:{borderColor:"var(--gold)"},children:u.jsx("div",{className:"p-6",children:(()=>{const p=hc.find(g=>g.id===i);return p?u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"p-3 rounded-xl bg-blue-100",children:u.jsx(Eh,{className:"w-8 h-8 text-blue-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:p.name}),u.jsx("p",{className:"text-lg text-blue-600",children:p.description})]})]}),u.jsx("button",{onClick:m,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),u.jsxs("div",{className:"mb-6 animate-slideInUp",style:{animationDelay:"0.3s"},children:[u.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-3",children:"詳しい説明"}),u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[u.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:p.detailedDescription}),u.jsxs("div",{className:"mb-4",children:[u.jsx("h5",{className:"text-sm font-bold text-gray-800 mb-2",children:"📋 使用例"}),u.jsx("p",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded border-l-4 border-blue-400",children:p.useCases})]}),u.jsxs("div",{children:[u.jsx("h5",{className:"text-sm font-bold text-gray-800 mb-2",children:"💡 ヒントとコツ"}),u.jsx("div",{className:"space-y-2",children:p.tips.map((g,y)=>u.jsx("div",{className:"text-sm text-gray-600 bg-yellow-50 p-2 rounded border-l-2 border-yellow-300",children:g},y))})]})]})]}),u.jsxs("div",{className:"mb-6 animate-slideInUp",style:{animationDelay:"0.4s"},children:[u.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-3",children:"設定パラメータ"}),u.jsx("div",{className:"space-y-4",children:Object.entries(p.params).map(([g,y])=>u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"font-medium text-gray-900",children:y.label}),u.jsxs("span",{className:"text-sm text-gray-600 bg-white px-3 py-1 rounded border font-bold",children:["現在値: ",e[g]??y.default]})]}),u.jsx("p",{className:"text-sm text-gray-700 mb-3 leading-relaxed",children:y.description}),y.tips&&u.jsxs("div",{className:"bg-blue-50 p-3 rounded border-l-4 border-blue-400 mb-3",children:[u.jsx("div",{className:"text-xs font-bold text-blue-800 mb-1",children:"💡 調整のコツ"}),u.jsx("p",{className:"text-xs text-blue-700",children:y.tips})]}),u.jsxs("div",{className:"text-xs text-gray-500 bg-white/50 px-3 py-2 rounded border",children:[u.jsx("span",{className:"font-medium",children:"範囲:"})," ",y.min," ～ ",y.max,u.jsx("span",{className:"ml-2 font-medium",children:"ステップ:"})," ",y.step]})]},g))})]}),u.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl animate-slideInUp",style:{animationDelay:"0.6s"},children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"難易度:"}),u.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${p.difficulty==="簡単"?"bg-green-100 text-green-800":p.difficulty==="普通"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:p.difficulty})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"タイプ:"}),u.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${p.category==="classification"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:p.category==="classification"?"分類":"回帰"})]})]})}),u.jsx("div",{className:"mt-6 flex justify-end animate-slideInUp",style:{animationDelay:"0.7s"},children:u.jsx("button",{onClick:m,className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg",children:"閉じる"})})]}):null})()})})})]})}function L4({featureImportance:t}){const e=t.map(n=>({name:n.featureName,importance:n.importance*100})),r=["#16a34a","#22c55e","#4ade80","#86efac","#bbf7d0"];return u.jsxs("div",{className:"bg-white/95 rounded-lg p-6 shadow-lg border-2 border-green-600",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(Ei,{className:"w-5 h-5 text-green-900"}),u.jsx("h3",{className:"text-lg font-bold text-green-900",children:"特徴量の重要度"})]}),u.jsx("p",{className:"text-sm text-green-800 mb-4",children:"各特徴量がモデルの予測にどれだけ影響を与えているかを示します。重要度が高い特徴量ほど、予測精度の向上に貢献しています。"}),u.jsx(br,{width:"100%",height:300,children:u.jsxs(ya,{data:e,layout:"vertical",margin:{top:5,right:30,left:100,bottom:5},children:[u.jsx(wr,{strokeDasharray:"3 3",stroke:"#d1fae5"}),u.jsx(_r,{type:"number",domain:[0,100],stroke:"#166534"}),u.jsx(jr,{type:"category",dataKey:"name",stroke:"#166534"}),u.jsx(yr,{contentStyle:{backgroundColor:"#f0fdf4",border:"2px solid #16a34a",borderRadius:"8px"},formatter:n=>`${n.toFixed(1)}%`}),u.jsx(Mn,{dataKey:"importance",radius:[0,8,8,0],children:e.map((n,a)=>u.jsx(hn,{fill:r[a%r.length]},`cell-${a}`))})]})}),u.jsx("div",{className:"mt-4 space-y-2",children:u.jsx("div",{className:"bg-green-50 p-3 rounded border border-green-300",children:u.jsxs("p",{className:"text-sm text-green-900",children:[u.jsx("span",{className:"font-bold",children:"ヒント："}),"重要度の低い特徴量を除外することで、モデルがシンプルになり、過学習を防ぐことができます。"]})})})]})}function B4({confusionMatrix:t,classes:e}){const r=t.flat().reduce((o,l)=>o+l,0),n=Math.max(...t.flat()),a=o=>{const l=o/n;return l>.7?"bg-green-600 text-white":l>.4?"bg-green-400 text-green-900":l>.1?"bg-green-200 text-green-900":"bg-green-50 text-green-700"},s=e.map((l,d)=>{const c=t[d][d],h=t.reduce((y,b,x)=>y+(x!==d?b[d]:0),0),f=t[d].reduce((y,b,x)=>y+(x!==d?b:0),0),m=c/(c+h)||0,p=c/(c+f)||0,g=2*(m*p)/(m+p)||0;return{class:e[d],precision:m,recall:p,f1:g}});return u.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-blue-300",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(Di,{className:"w-5 h-5 text-blue-700"}),u.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"予測の正確さを見てみよう"})]}),u.jsx("p",{className:"text-sm text-gray-700 mb-4 leading-relaxed",children:"モデルが「正しく予測できた数」を表にしたものです。左上から右下への斜め線の数字が大きいほど、よく当たっています。"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("div",{className:"inline-block min-w-full",children:[u.jsxs("div",{className:"flex items-end mb-2",children:[u.jsx("div",{className:"w-20"}),u.jsxs("div",{className:"flex-1 text-center",children:[u.jsx("div",{className:"text-sm font-bold text-blue-900 mb-1",children:"予測値"}),u.jsx("div",{className:"flex justify-center space-x-1",children:e.map((o,l)=>u.jsx("div",{className:"w-20 text-xs font-medium text-blue-800 px-1",children:o},l))})]})]}),u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex flex-col justify-center mr-2",children:u.jsx("div",{className:"text-sm font-bold text-blue-900 mb-1 -rotate-90 origin-center whitespace-nowrap",style:{width:"80px",transform:"rotate(-90deg) translateX(-20px)"},children:"実際の値"})}),u.jsx("div",{className:"flex flex-col space-y-1",children:t.map((o,l)=>u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx("div",{className:"w-16 text-xs font-medium text-blue-800 text-right pr-2",children:e[l]}),u.jsx("div",{className:"flex space-x-1",children:o.map((d,c)=>u.jsx("div",{className:`w-20 h-12 flex items-center justify-center rounded font-bold transition-all hover:scale-110 ${a(d)}`,children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-lg",children:d}),u.jsxs("div",{className:"text-xs opacity-75",children:[(d/r*100).toFixed(0),"%"]})]})},c))})]},l))})]})]})}),u.jsxs("div",{className:"mt-6 space-y-3",children:[u.jsx("h4",{className:"text-sm font-bold text-blue-900",children:"クラス別の性能指標"}),s.map((o,l)=>u.jsxs("div",{className:"bg-blue-50 p-3 rounded border border-blue-300",children:[u.jsx("div",{className:"text-sm font-bold text-blue-900 mb-2",children:o.class}),u.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-blue-700",children:"適合率"}),u.jsxs("div",{className:"font-bold text-blue-900",children:[(o.precision*100).toFixed(1),"%"]}),u.jsx("div",{className:"h-2 bg-blue-200 rounded-full mt-1",children:u.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${o.precision*100}%`}})})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-blue-700",children:"再現率"}),u.jsxs("div",{className:"font-bold text-blue-900",children:[(o.recall*100).toFixed(1),"%"]}),u.jsx("div",{className:"h-2 bg-blue-200 rounded-full mt-1",children:u.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${o.recall*100}%`}})})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-blue-700",children:"F1スコア"}),u.jsxs("div",{className:"font-bold text-blue-900",children:[(o.f1*100).toFixed(1),"%"]}),u.jsx("div",{className:"h-2 bg-blue-200 rounded-full mt-1",children:u.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${o.f1*100}%`}})})]})]})]},l))]}),u.jsx("div",{className:"mt-4 bg-amber-50 p-3 rounded border border-amber-400",children:u.jsxs("p",{className:"text-sm text-amber-900",children:[u.jsx("span",{className:"font-bold",children:"ヒント："}),"適合率は「予測が正しい確率」、再現率は「見逃しの少なさ」を表します。 両方のバランスを取ることが重要です。"]})})]})}function U4({accuracy:t,requiredAccuracy:e,modelType:r}){const n=t>=e,a=e-t,s=(()=>{const o=[];return n?o.push({icon:Pr,title:"素晴らしい！",description:"AIの設定が完璧だったね！他の地域の課題にも挑戦してみよう。",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"}):(a>.2&&o.push({icon:Dw,title:"データをよく観察しよう",description:"グラフや表を見て、データの特徴やパターンを見つけてみよう。何か気づくことはないかな？",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}),(r==="logistic_regression"||r==="linear_regression")&&o.push({icon:Tn,title:"学習速度を調整してみよう",description:"学習速度が速すぎると、AIがうまく学習できないことがあるよ。少し遅くしてみよう。",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"}),r==="knn"&&o.push({icon:Pr,title:"近くのデータ数を変えてみよう",description:"k近傍法では、参考にする近くのデータの数が重要だよ。3〜7の間で試してみよう。",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"}),o.push({icon:On,title:"特徴選択を見直してみよう",description:"選んだ特徴が本当に答えに関係しているかな？他の特徴も試してみよう。",color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200"})),o})();return u.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-6 border-2 border-yellow-300 shadow-lg",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(On,{className:"w-6 h-6 text-yellow-600"}),u.jsx("h3",{className:"text-lg font-bold text-yellow-900",children:"学習のヒント"})]}),u.jsx("div",{className:"space-y-3",children:s.map((o,l)=>{const d=o.icon;return u.jsx("div",{className:`p-4 rounded-lg border-2 ${o.bgColor} ${o.borderColor}`,children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(d,{className:`w-5 h-5 mt-0.5 ${o.color}`}),u.jsxs("div",{children:[u.jsx("h4",{className:`font-semibold ${o.color} mb-1`,children:o.title}),u.jsx("p",{className:"text-sm text-gray-700",children:o.description})]})]})},l)})}),!n&&u.jsx("div",{className:"mt-4 p-3 bg-orange-100 rounded-lg border border-orange-300",children:u.jsxs("p",{className:"text-sm text-orange-800",children:[u.jsx("strong",{children:"💡 コツ："})," 間違えても大丈夫！何度でも挑戦できるから、いろいろな設定を試してみよう。 データをよく観察することが一番大切だよ！"]})})]})}function F4({result:t,dataset:e,requiredAccuracy:r,modelType:n}){const a=t.accuracy>=r,i=t.predictions.slice(0,20).map((o,l)=>({index:l+1,predicted:Number(o),actual:Number(t.actual[l])})),s=e.featureNames;return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:`rounded-lg p-6 shadow-lg border-4 ${a?"bg-gradient-to-br from-green-100 to-green-50 border-green-600":"bg-gradient-to-br from-orange-100 to-orange-50 border-orange-600"}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Cn,{className:`w-8 h-8 ${a?"text-green-700":"text-orange-700"}`}),u.jsxs("div",{children:[u.jsx("h3",{className:`text-2xl font-bold ${a?"text-green-900":"text-orange-900"}`,children:a?"🎉 成功！課題クリア！":"💪 もう少し！"}),u.jsx("p",{className:`text-sm ${a?"text-green-700":"text-orange-700"}`,children:a?"AIの予測がとても正確でした！":"設定を調整してもう一度挑戦してみよう！"})]})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:`text-4xl font-bold ${a?"text-green-700":"text-orange-700"}`,children:[(t.accuracy*100).toFixed(1),"%"]}),u.jsx("div",{className:`text-sm ${a?"text-green-600":"text-orange-600"}`,children:"正解率"})]})]}),u.jsxs("div",{className:"bg-white/60 p-4 rounded-lg",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"必要精度"}),u.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[(r*100).toFixed(0),"%"]})]}),u.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden relative",children:[u.jsx("div",{className:"absolute top-0 left-0 h-full border-r-2 border-red-500",style:{left:`${r*100}%`}}),u.jsx("div",{className:`h-full transition-all duration-1000 ${a?"bg-gradient-to-r from-green-500 to-green-600":"bg-gradient-to-r from-orange-400 to-orange-500"}`,style:{width:`${Math.min(t.accuracy*100,100)}%`}})]})]})]}),u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-indigo-600",children:[u.jsx("h4",{className:"text-lg font-bold text-indigo-900 mb-3",children:"学習条件の要約"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"モデル"}),u.jsx("div",{className:"font-semibold text-gray-900",children:n||"—"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"使用した特徴量"}),u.jsx("div",{className:"font-semibold text-gray-900 truncate",title:s.join(", "),children:s.join(", ")})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-600",children:"訓練時間"}),u.jsxs("div",{className:"font-semibold text-gray-900",children:[t.training_time,"秒"]})]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-blue-600",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx(Pr,{className:"w-4 h-4 text-blue-700"}),u.jsx("span",{className:"text-xs font-medium text-blue-900",children:"精度"})]}),u.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[(t.accuracy*100).toFixed(1),"%"]})]}),t.precision!==void 0&&u.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-purple-600",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx(Tn,{className:"w-4 h-4 text-purple-700"}),u.jsx("span",{className:"text-xs font-medium text-purple-900",children:"適合率"})]}),u.jsxs("div",{className:"text-2xl font-bold text-purple-800",children:[(t.precision*100).toFixed(1),"%"]})]}),t.recall!==void 0&&u.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-pink-600",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx(Tn,{className:"w-4 h-4 text-pink-700"}),u.jsx("span",{className:"text-xs font-medium text-pink-900",children:"再現率"})]}),u.jsxs("div",{className:"text-2xl font-bold text-pink-800",children:[(t.recall*100).toFixed(1),"%"]})]}),u.jsxs("div",{className:"bg-white/90 rounded-lg p-4 shadow border-2 border-gray-600",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx($w,{className:"w-4 h-4 text-gray-700"}),u.jsx("span",{className:"text-xs font-medium text-gray-900",children:"訓練時間"})]}),u.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[t.training_time,"秒"]})]})]}),t.confusion_matrix&&e.classes&&u.jsx(B4,{confusionMatrix:t.confusion_matrix,classes:e.classes}),t.feature_importance&&t.feature_importance.length>0&&u.jsx(L4,{featureImportance:t.feature_importance}),u.jsxs("div",{className:"bg-white/90 rounded-lg p-6 shadow-lg border-2 border-teal-600",children:[u.jsx("h4",{className:"text-lg font-bold text-teal-900 mb-4",children:"予測 vs 実測値（最初の20件）"}),u.jsx(br,{width:"100%",height:300,children:u.jsxs(ML,{data:i,children:[u.jsx(wr,{strokeDasharray:"3 3"}),u.jsx(_r,{dataKey:"index",label:{value:"サンプル",position:"insideBottom",offset:-5}}),u.jsx(jr,{label:{value:"値",angle:-90,position:"insideLeft"}}),u.jsx(yr,{}),u.jsx(gu,{type:"monotone",dataKey:"actual",stroke:"#059669",strokeWidth:2,name:"実測値"}),u.jsx(gu,{type:"monotone",dataKey:"predicted",stroke:"#dc2626",strokeWidth:2,name:"予測値",strokeDasharray:"5 5"})]})})]}),e.classes&&u.jsxs("div",{className:"bg-amber-50 p-6 rounded-lg border-2 border-amber-600",children:[u.jsx("h4",{className:"text-lg font-bold text-amber-900 mb-3",children:"アドバイス"}),u.jsx("ul",{className:"space-y-2 text-sm text-amber-800",children:t.accuracy<r?u.jsxs(u.Fragment,{children:[u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"💡"}),u.jsx("span",{children:"パラメータを調整してみましょう。学習率を変更すると結果が改善するかもしれません。"})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"💡"}),u.jsx("span",{children:"別のモデルを試してみるのも良い方法です。"})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"💡"}),u.jsx("span",{children:"イテレーション数を増やすと、より良い結果が得られることがあります。"})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"🎉"}),u.jsx("span",{children:"素晴らしい！課題をクリアしました。次の地域に挑戦しましょう！"})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"mr-2",children:"⭐"}),u.jsx("span",{children:"より高い精度を目指して、さらなる改善に挑戦してみてください。"})]})]})})]}),u.jsx(U4,{accuracy:t.accuracy,requiredAccuracy:r,modelType:n||""})]})}function W4(){const{user:t,regions:e,progress:r,selectedRegion:n,setCurrentView:a,refreshProgress:i}=Ms(),[s,o]=v.useState(null),[l,d]=v.useState(null),[c,h]=v.useState(null),[f,m]=v.useState([]),[p,g]=v.useState("logistic_regression"),[y,b]=v.useState({}),[x,w]=v.useState(!1),[_,S]=v.useState(null),[j,N]=v.useState(null),[M,O]=v.useState("data"),[T,P]=v.useState([]),[k,D]=v.useState(""),I=e.find(B=>B.id===n),z=n?r[n]:null;v.useEffect(()=>{if(n&&I){console.log("Loading dataset for region:",n);const B=A4(n);console.log("Dataset loaded:",{hasData:!!B,trainLength:B?.train?.length,hasRaw:!!B?.raw,featureNames:B?.featureNames}),d(B),o(B),h(B),m([]),N(null),S(null),O("data"),I.problem_type==="classification"?(B.classes?.length||2)>2?g("neural_network"):g("logistic_regression"):I.problem_type==="regression"?g("linear_regression"):g("logistic_regression"),P([]),D(""),b({})}},[n,I]),v.useEffect(()=>{if(c)if(f.length>0){const B=Y=>({features:f.map($=>Y.features[$]),label:Y.label}),R={train:c.train.map(B),test:c.test.map(B),featureNames:f.map(Y=>c.featureNames[Y]),labelName:c.labelName,classes:c.classes,raw:c.raw};o(R)}else o(c)},[f,c]);const H=B=>{h(B),o(B),O("features")},K=async()=>{if(!(!s||!t||!n)){w(!0),N(null),S(null),O("train");try{const B=$i(p),R=s.train||s.data||[],Y=s.test||[];if(console.log("学習データ:",{trainingDataLength:R.length,testDataLength:Y.length,datasetKeys:Object.keys(s)}),R.length===0)throw new Error("学習データがありません");await B.train(R,y,te=>{S(te)});const $=B.evaluate(Y.length>0?Y:R);N($);const We=$4.detectOverfitting($.accuracy,$.accuracy);We.isOverfitting&&P([We.message,...We.suggestions]),await Jw({user_id:t.id,region_id:n,model_type:p,parameters:y,accuracy:$.accuracy,precision:$.precision||null,recall:$.recall||null,f1_score:$.f1_score||null,training_time:$.training_time});const ur=z?.best_accuracy||0;if($.accuracy>ur){let te=0;const Bt=I?.required_accuracy||.8;$.accuracy>=Bt&&(te=1,$.accuracy>=Bt+.05&&(te=2),$.accuracy>=Bt+.1&&(te=3));const Dr=$.accuracy>=Bt;if(await Nu(t.id,n,{is_completed:Dr,best_accuracy:$.accuracy,stars:te,attempts:(z?.attempts||0)+1,last_attempt_at:new Date().toISOString()}),Dr){const aa=e.filter(L=>L.unlock_condition===n);for(const L of aa)await Gw(t.id,L.id)}await i()}O("result")}catch(B){console.error("Training failed:",B)}finally{w(!1)}}};if(!I||!s||!l||!c)return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-100 to-blue-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Th,{className:"w-12 h-12 animate-spin text-blue-500 mx-auto mb-4"}),u.jsx("p",{className:"text-lg text-gray-700",children:"読み込み中..."})]})});const X=[{id:"data",label:"データを見る",icon:Su,completed:M!=="data"},{id:"preprocessing",label:"前処理",icon:Ch,completed:M==="features"||M==="model"||M==="train"||M==="result"},{id:"features",label:"特徴を選ぶ",icon:Ch,completed:M==="model"||M==="train"||M==="result"},{id:"model",label:"モデルを選ぶ",icon:Rw,completed:M==="train"||M==="result"},{id:"train",label:"学習する",icon:pc,completed:M==="result"},{id:"result",label:"結果を見る",icon:Cn,completed:!1}];return u.jsx("div",{className:"min-h-screen",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-6xl mx-auto",children:u.jsxs("div",{className:"rounded-2xl shadow-xl overflow-hidden border-4",style:{borderColor:"var(--gold)",background:"var(--ink-white)"},children:[u.jsxs("div",{className:"p-6",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%)"},children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("button",{onClick:()=>a("map"),className:"flex items-center space-x-2 text-white hover:text-yellow-200 transition-colors bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg backdrop-blur-sm border border-white/20",children:[u.jsx(zr,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:"マップに戻る"})]}),u.jsxs("div",{className:"text-center flex-1",children:[u.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-white",children:[I.name,"の課題"]}),u.jsx("p",{className:"text-lg mt-2 text-yellow-200",children:I.daimyo})]}),u.jsx("div",{className:"w-32"})]}),u.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap md:space-x-4",children:X.map((B,R)=>{const Y=B.icon,$=M===B.id,We=B.completed||$;return u.jsxs("div",{className:"flex items-center",children:[u.jsxs("button",{onClick:()=>We&&O(B.id),disabled:!We,className:`flex items-center space-x-2 px-3 md:px-4 py-2 rounded-lg transition-all border-2 ${$?"bg-yellow-400 shadow-lg scale-105 text-blue-900":B.completed?"bg-yellow-200 text-blue-800 hover:bg-yellow-300 border-yellow-300":"bg-white/10 text-white/60 cursor-not-allowed border-white/20"}`,style:{borderColor:$||B.completed?"#fbbf24":void 0},children:[u.jsx(Y,{className:"w-4 h-4 md:w-5 md:h-5"}),u.jsx("span",{className:"text-sm md:text-base font-medium hidden sm:inline",children:B.label})]}),R<X.length-1&&u.jsx(zt,{className:"w-4 h-4 md:w-5 md:h-5 text-yellow-200 mx-1 hidden md:block"})]},B.id)})})]}),u.jsxs("div",{className:"p-6 md:p-8",children:[u.jsxs("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-slate-50 rounded-xl p-4 md:p-6 border-2 border-blue-200 shadow-lg",children:[u.jsxs("h2",{className:"text-xl font-bold text-blue-900 mb-3 flex items-center",children:[u.jsx("span",{className:"w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center text-blue-900 font-bold mr-3",children:"!"}),"課題の説明"]}),u.jsx("p",{className:"text-blue-800 leading-relaxed mb-4 text-lg",children:I.problem_description}),u.jsxs("div",{className:"flex items-center space-x-6 text-base",children:[u.jsxs("div",{className:"flex items-center space-x-2 bg-yellow-100 px-4 py-3 rounded-lg",children:[u.jsx("span",{className:"text-blue-700 font-bold",children:"目標:"}),u.jsxs("span",{className:"font-bold text-blue-900 text-lg",children:["正解率 ",(I.required_accuracy*100).toFixed(0),"% 以上"]})]}),z?.best_accuracy&&z.best_accuracy>0&&u.jsxs("div",{className:"flex items-center space-x-2 bg-slate-100 px-4 py-3 rounded-lg",children:[u.jsx("span",{className:"text-blue-700 font-bold",children:"自己ベスト:"}),u.jsxs("span",{className:"font-bold text-blue-900 text-lg",children:[(z.best_accuracy*100).toFixed(1),"%"]})]})]})]}),M==="data"&&u.jsxs("div",{className:"space-y-6",children:[u.jsx(bw,{dataset:l}),u.jsx("div",{className:"flex justify-end",children:u.jsxs("button",{onClick:()=>O("preprocessing"),className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-2 border-yellow-400 text-lg",children:[u.jsx("span",{children:"次へ：前処理"}),u.jsx(zt,{className:"w-6 h-6"})]})})]}),M==="preprocessing"&&l&&u.jsxs("div",{className:"space-y-6",children:[u.jsx(xw,{dataset:l,onPreprocess:H}),u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("button",{onClick:()=>O("data"),className:"flex items-center space-x-2 text-slate-600 hover:text-slate-800 px-6 py-4 rounded-lg font-medium transition-colors border-2 border-slate-300 hover:border-slate-400 text-lg",children:[u.jsx(zr,{className:"w-6 h-6"}),u.jsx("span",{children:"戻る：データを見る"})]}),u.jsxs("button",{onClick:()=>O("features"),className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-2 border-yellow-400 text-lg",children:[u.jsx("span",{children:"前処理なしで次へ：特徴を選ぶ"}),u.jsx(zt,{className:"w-6 h-6"})]})]})]}),M==="features"&&c&&u.jsxs("div",{className:"space-y-6",children:[u.jsx(ww,{dataset:c,selectedFeatures:f,onFeaturesChange:m}),u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("button",{onClick:()=>O("data"),className:"flex items-center space-x-2 text-slate-600 hover:text-slate-800 px-6 py-4 rounded-lg font-medium transition-colors border-2 border-slate-300 hover:border-slate-400 text-lg",children:[u.jsx(zr,{className:"w-6 h-6"}),u.jsx("span",{children:"戻る：データを見る"})]}),u.jsxs("button",{onClick:()=>O("model"),disabled:f.length===0,className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-2 border-yellow-400 text-lg",children:[u.jsx("span",{children:"次へ：モデルを選ぶ"}),u.jsx(zt,{className:"w-6 h-6"})]})]})]}),M==="model"&&u.jsxs("div",{className:"space-y-6",children:[u.jsx(R4,{regionType:I.problem_type,selectedModel:p,parameters:y,onModelChange:g,onParametersChange:b}),u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("button",{onClick:()=>O("features"),className:"flex items-center space-x-2 text-slate-600 hover:text-slate-800 px-6 py-4 rounded-lg font-medium transition-colors border-2 border-slate-300 hover:border-slate-400 text-lg",children:[u.jsx(zr,{className:"w-6 h-6"}),u.jsx("span",{children:"戻る：特徴を選ぶ"})]}),u.jsxs("button",{onClick:K,disabled:x,className:"flex items-center space-x-2 text-white px-8 py-4 rounded-lg font-bold shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 border-2 border-blue-600 text-lg",children:[u.jsx(pc,{className:"w-6 h-6"}),u.jsx("span",{children:"学習を開始"})]})]})]}),M==="train"&&u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-8 border-2 border-blue-200",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx(Th,{className:"w-16 h-16 animate-spin text-blue-500 mx-auto mb-4"}),u.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"学習中..."}),u.jsx("p",{className:"text-gray-600",children:"モデルがデータから学んでいます。しばらくお待ちください。"})]}),_&&u.jsx(_w,{progress:_})]})}),M==="result"&&j&&u.jsxs("div",{className:"space-y-6",children:[u.jsx(F4,{result:j,dataset:s,requiredAccuracy:I.required_accuracy,modelType:p}),T.length>0&&u.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-6",children:[u.jsxs("h3",{className:"text-lg font-bold text-red-800 mb-3 flex items-center",children:[u.jsx("span",{className:"w-6 h-6 mr-2",children:"⚠️"}),"安全性チェック"]}),u.jsx("ul",{className:"space-y-2",children:T.map((B,R)=>u.jsxs("li",{className:"text-red-700 text-base",children:["• ",B]},R))})]}),k&&u.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:[u.jsxs("h3",{className:"text-lg font-bold text-blue-800 mb-3 flex items-center",children:[u.jsx("span",{className:"w-6 h-6 mr-2",children:"📚"}),"学習ポイント"]}),u.jsx("p",{className:"text-blue-700 text-base",children:k})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("button",{onClick:()=>O("features"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 px-6 py-3 rounded-lg font-medium transition-colors",children:[u.jsx(zr,{className:"w-5 h-5"}),u.jsx("span",{children:"特徴を変えて再挑戦"})]}),u.jsx("button",{onClick:()=>a("map"),className:"flex items-center space-x-2 text-white px-8 py-3 rounded-lg font-bold shadow-lg transition-all",style:{background:"linear-gradient(to right, var(--accent), var(--accent-strong))"},children:u.jsx("span",{children:"マップに戻る"})})]})]})]})]})})})}function fg({onUserReady:t}){const[e,r]=v.useState(""),[n,a]=v.useState(""),[i,s]=v.useState(!1),[o,l]=v.useState(null);v.useEffect(()=>{const h=Tt.getCurrentUser();h&&(l(h),t(h))},[t]);const d=async()=>{if(e.trim()){s(!0);try{const h=Tt.loginUser(e.trim(),n.trim()||void 0);l(h),t(h)}catch(h){console.error("ログインに失敗:",h)}finally{s(!1)}}},c=()=>{Tt.logout(),l(null),r(""),a("")};if(o){const h=Tt.getUserStats();return u.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-md w-full mx-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-4 p-8",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full overflow-hidden border-4",style:{borderColor:"var(--gold)"},children:u.jsx("img",{src:o.avatar,alt:o.username,className:"w-full h-full object-cover"})}),u.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-2",children:o.username}),u.jsxs("div",{className:"text-sm text-slate-600",children:["レベル ",o.level," • 経験値 ",o.experience]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[u.jsx(Cn,{className:"w-6 h-6 text-yellow-500 mx-auto mb-2"}),u.jsx("div",{className:"text-lg font-bold text-blue-900",children:o.wins}),u.jsx("div",{className:"text-sm text-blue-700",children:"勝利数"})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[u.jsx(Pr,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),u.jsxs("div",{className:"text-lg font-bold text-green-900",children:[Math.round(o.winRate*100),"%"]}),u.jsx("div",{className:"text-sm text-green-700",children:"勝率"})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex justify-between text-sm text-slate-600 mb-2",children:[u.jsxs("span",{children:["レベル ",o.level]}),u.jsxs("span",{children:[Math.round(h.progress),"%"]})]}),u.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3",children:u.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-300",style:{width:`${h.progress}%`}})}),u.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["次のレベルまで ",h.nextLevelExp-o.experience," EXP"]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:()=>t(o),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 hover:shadow-lg",children:[u.jsx(Lw,{className:"w-5 h-5 inline-block mr-2"}),"対戦を開始"]}),u.jsx("button",{onClick:c,className:"w-full text-slate-600 hover:text-slate-800 py-2 px-4 rounded-lg border-2 border-slate-300 hover:border-slate-400 transition-colors",children:"別のユーザーでログイン"})]})]})})})}return u.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--paper)"},children:u.jsx("div",{className:"max-w-md w-full mx-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-4 p-8",style:{borderColor:"var(--gold)"},children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center",children:u.jsx(Bw,{className:"w-8 h-8 text-white"})}),u.jsx("h1",{className:"text-3xl font-bold text-blue-900 mb-2",children:"プレイヤー登録"}),u.jsx("p",{className:"text-slate-600",children:"オンライン対戦に参加するためのユーザー情報を入力してください"})]}),u.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},className:"space-y-6",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["ユーザー名 ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",value:e,onChange:h=>r(h.target.value),placeholder:"プレイヤー名を入力",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"メールアドレス（任意）"}),u.jsx("input",{type:"email",value:n,onChange:h=>a(h.target.value),placeholder:"メールアドレス（任意）",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),u.jsx("button",{type:"submit",disabled:!e.trim()||i,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 disabled:from-slate-400 disabled:to-slate-500 text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 hover:shadow-lg disabled:cursor-not-allowed",children:i?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"ログイン中..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Uw,{className:"w-5 h-5 inline-block mr-2"}),"対戦を開始"]})})]}),u.jsx("div",{className:"mt-6 text-center",children:u.jsx("p",{className:"text-sm text-slate-500",children:"ユーザー情報はローカルに保存され、統計やリーダーボードに反映されます"})})]})})})}function q4(){const{user:t,currentView:e,loading:r,error:n}=Ms(),[a,i]=v.useState(!1),[s,o]=v.useState(!1),[l,d]=v.useState(null),[c,h]=v.useState("");v.useEffect(()=>{try{console.log("GameContent useEffect開始");const m=Tt.getCurrentUser();console.log("userManager.getCurrentUser():",m),m?(d(m),h("ユーザーが見つかりました - イントロ表示"),o(!0)):(h("ユーザーが見つかりません - 認証画面表示"),i(!0))}catch(m){console.error("GameContent useEffect エラー:",m),h(`エラー: ${m}`)}},[]),v.useEffect(()=>{l&&t&&console.log("ユーザー同期完了:",{currentUser:l,user:t})},[l,t]),console.log("App.tsx state:",{showUserAuth:a,showQuoteIntro:s,currentUser:!!l,user:!!t,currentView:e,loading:r,error:n,debugInfo:c});const f=m=>{d(m),i(!1),o(!1)};return a?u.jsxs("div",{children:[u.jsx(fg,{onUserReady:f}),c&&u.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[u.jsxs("div",{children:["デバッグ: ",c]}),u.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),u.jsxs("div",{children:["Error: ",n||"None"]})]})]}):s?u.jsxs("div",{children:[u.jsx(Qw,{onComplete:()=>o(!1),durationScale:1.3}),c&&u.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[u.jsxs("div",{children:["デバッグ: ",c]}),u.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),u.jsxs("div",{children:["Error: ",n||"None"]})]})]}):r?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-900 to-red-900 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-yellow-400 mx-auto mb-4"}),u.jsx("p",{className:"text-2xl text-yellow-100 font-bold",children:"読み込み中..."})]})}):n?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-900 to-orange-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"max-w-md bg-white/95 rounded-lg shadow-2xl p-8 text-center",children:[u.jsx(mc,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),u.jsx("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"エラーが発生しました"}),u.jsx("p",{className:"text-red-800 mb-6",children:n}),u.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center space-x-2 bg-red-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-red-700 transition-colors mx-auto",children:[u.jsx(Fw,{className:"w-5 h-5"}),u.jsx("span",{children:"ページを再読み込み"})]})]})}):l||t?(console.log("App.tsx currentView:",e),e==="map"?(console.log("日本地図を表示します"),u.jsxs("div",{children:[u.jsx(f4,{}),c&&u.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[u.jsxs("div",{children:["デバッグ: ",c]}),u.jsxs("div",{children:["View: ",e]}),u.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),u.jsxs("div",{children:["Error: ",n||"None"]})]})]})):e==="challenge"?(console.log("チャレンジ画面を表示します"),u.jsxs("div",{children:[u.jsx(W4,{}),c&&u.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[u.jsxs("div",{children:["デバッグ: ",c]}),u.jsxs("div",{children:["View: ",e]}),u.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),u.jsxs("div",{children:["Error: ",n||"None"]})]})]})):(console.log("ホーム画面を表示します"),u.jsxs("div",{children:[u.jsx(u4,{}),c&&u.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[u.jsxs("div",{children:["デバッグ: ",c]}),u.jsxs("div",{children:["View: ",e]}),u.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),u.jsxs("div",{children:["Error: ",n||"None"]})]})]}))):u.jsxs("div",{children:[u.jsx(fg,{onUserReady:f}),c&&u.jsxs("div",{className:"fixed top-4 right-4 bg-black text-white p-2 rounded text-xs max-w-xs",children:[u.jsxs("div",{children:["デバッグ: ",c]}),u.jsxs("div",{children:["Loading: ",r?"Yes":"No"]}),u.jsxs("div",{children:["Error: ",n||"None"]})]})]})}function z4(){return u.jsx(Zw,{children:u.jsx(q4,{})})}async function K4(){try{Sr.showSecurityWarning(),Sr.checkProductionSecurity(),console.log("🚀 アプリケーション初期化開始..."),console.log("🎯 アプリケーション初期化完了")}catch(t){throw console.error("アプリケーション初期化エラー:",t),t}}K4();Kw.createRoot(document.getElementById("root")).render(u.jsx(v.StrictMode,{children:u.jsx(z4,{})}));export{Ke as C,Ti as a};
